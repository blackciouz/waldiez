/**
 * SPDX-License-Identifier: Apache-2.0
 * Copyright 2024 - 2026 Waldiez & contributors
 */

"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("react"),t=require("@xyflow/react"),n=require("@monaco-editor/react"),a=require("react-dom"),s=require("react-select"),r=require("recharts"),o=require("rehype-highlight"),i=require("remark-gfm"),l=require("react-markdown"),c=require("framer-motion");function d(e){const t=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e)for(const n in e)if("default"!==n){const a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,a.get?a:{enumerable:!0,get:()=>e[n]})}return t.default=e,Object.freeze(t)}const u=d(e),h=d(a);class p{systemMessage;humanInputMode;codeExecutionConfig;agentDefaultAutoReply;maxConsecutiveAutoReply;termination;modelIds;tools;parentId;nestedChats;contextVariables;updateAgentStateBeforeReply;afterWork;handoffs;constructor(e={humanInputMode:"NEVER",systemMessage:null,codeExecutionConfig:!1,agentDefaultAutoReply:null,maxConsecutiveAutoReply:null,termination:{type:"none",keywords:[],criterion:null,methodContent:null},modelIds:[],tools:[],parentId:void 0,nestedChats:[{messages:[],triggeredBy:[],condition:{conditionType:"string_llm",prompt:""},available:{type:"none",value:""}}],contextVariables:{},updateAgentStateBeforeReply:[],afterWork:null,handoffs:[]}){this.systemMessage=e.systemMessage,this.humanInputMode=e.humanInputMode,this.codeExecutionConfig=e.codeExecutionConfig,this.agentDefaultAutoReply=e.agentDefaultAutoReply,this.maxConsecutiveAutoReply=e.maxConsecutiveAutoReply,this.termination=e.termination,this.modelIds=e.modelIds,this.tools=e.tools,this.parentId=e.parentId,this.nestedChats=e.nestedChats,this.contextVariables=e.contextVariables,this.updateAgentStateBeforeReply=e.updateAgentStateBeforeReply,this.afterWork=e.afterWork||null,this.handoffs=e.handoffs||[]}}const m=["<Waldiez> - Workflow finished","<Waldiez> - Workflow stopped by user","<Waldiez> - Workflow execution failed:","<Waldiez> - Done running the flow."],g={DEFAULT_PROMPT:"Enter your message to start the conversation:",GENERIC_PROMPTS:[">","> "],WORKFLOW_END_MARKERS:m,PARTICIPANTS_KEY:"participants",SYSTEM_MESSAGES:{GROUP_CHAT_RUN:"Group chat run",CODE_EXECUTION_REPLY:"Generate code execution reply",SPEAKER_SELECTION_HEADER:"## Select a speaker",SPEAKER_SELECTION_PROMPT:"Please select a speaker from the following list:",SPEAKER_SELECTION_NOTE:"**Note:** You can select a speaker by entering the corresponding number."}};const f=function({onlyFirst:e=!1}={}){return new RegExp("(?:\\u001B\\][\\s\\S]*?(?:\\u0007|\\u001B\\u005C|\\u009C))|[\\u001B\\u009B][[\\]()#;?]*(?:\\d{1,4}(?:[;:]\\d{0,4})*)?[\\dA-PR-TZcf-nq-uy=><~]",e?void 0:"g")}();function y(e){if("string"!=typeof e)throw new TypeError(`Expected a \`string\`, got \`${typeof e}\``);return e.replace(f,"")}let b=(e=21)=>{let t="",n=crypto.getRandomValues(new Uint8Array(e|=0));for(;e--;)t+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[63&n[e]];return t};class v{canHandle(e){return"using_auto_reply"===e}handle(e){if(!e||"object"!=typeof e||"using_auto_reply"!==e.type)return;return{message:{id:e.content?.uuid||b(),timestamp:(new Date).toISOString(),type:"using_auto_reply",content:[{type:"text",text:"Using auto reply"}],sender:e.content?.sender,recipient:e.content?.recipient}}}}class x{canHandle(e){return"run_completion"===e}handle(e){if(e&&"object"==typeof e&&e.content&&"object"==typeof e.content)return{isWorkflowEnd:!0,runCompletion:e.content}}}class w{canHandle(e){return"generate_code_execution_reply"===e}static isValidCodeExecutionReply(e){return!(!e||"object"!=typeof e)&&("generate_code_execution_reply"===e.type&&(!(!e.content||"object"!=typeof e.content)&&Boolean("string"==typeof e.content.uuid&&"string"==typeof e.content.sender&&"string"==typeof e.content.recipient)))}handle(e){if(!w.isValidCodeExecutionReply(e))return;return{message:{id:b(),timestamp:(new Date).toISOString(),type:"generate_code_execution_reply",content:[{type:"text",text:g.SYSTEM_MESSAGES.CODE_EXECUTION_REPLY}],sender:e.content.sender,recipient:e.content.recipient}}}}class C{canHandle(e){return"error"===e}static isValidError(e){return Boolean(e&&"object"==typeof e&&"error"===e.type&&(e.content&&"object"==typeof e.content||e.error&&("object"==typeof e.error||"string"==typeof e.error)))}handle(e){if(!C.isValidError(e))return;const t=e.content?.error||e.error?.error||e.error;if("string"!=typeof t)return;const n=`Error: ${t}`;return{message:{id:e.content?.uuid??b(),timestamp:(new Date).toISOString(),type:"error",content:[{type:"text",text:n}],sender:e.content?.sender,recipient:e.content?.recipient,error:t}}}}class k{canHandle(e){return"execute_function"===e}handle(e){if(!e||"object"!=typeof e||"execute_function"!==e.type)return;return{message:{id:e.content.uuid??b(),timestamp:(new Date).toISOString(),type:"execute_function",content:[{type:"text",text:`Execute function: ${e.content.func_name}`},{type:"text",text:`Arguments: ${e.content.arguments}`}],sender:e.content.sender,recipient:e.content.recipient}}}}class j{canHandle(e){return"executed_function"===e}handle(e){if(!e||"object"!=typeof e||"executed_function"!==e.type)return;return{message:{id:e.content.uuid??b(),timestamp:(new Date).toISOString(),type:"executed_function",content:[{type:"text",text:`Executed function: ${e.content.func_name}`}],sender:e.content.sender,recipient:e.content.recipient}}}}const A=["system","post_carryover_processing","group_chat_run_chat","using_auto_reply","tool_call","execute_function","executed_function","tool_response","termination","run_completion","generate_code_execution_reply","group_chat_resume","error","info"];class S{static isPasswordPrompt(e){return!(!e.password||"string"!=typeof e.password&&"boolean"!=typeof e.password)&&("boolean"==typeof e.password?e.password:"true"===e.password.toLowerCase())}static isSystemMessage(e){return!e||"object"!=typeof e||!e.type||"string"!=typeof e.type||(!!e.type.startsWith("debug_")||A.includes(e.type))}static normalizePrompt(e){return g.GENERIC_PROMPTS.includes(e)?g.DEFAULT_PROMPT:e}static generateMessageId(e){return e.id||e.uuid||b()}static generateTimestamp(e){return e.timestamp||(new Date).toISOString()}static replaceImageUrls(e,t){const n=/<img\s+(?!.*src=)([^"'>\s]+)\s*\/?>/g,a=e=>{const a=e.match(n);if(a&&1===a.length){return{type:"image_url",image_url:{url:a[0].replace(n,`<img alt="Image" src="${t}" />`),alt:"Image"}}}return null},s=e=>({...e,image_url:{...e.image_url,url:t}});if(Array.isArray(e))return e.map(e=>{if("string"==typeof e){const t=a(e);return t||{type:"text",text:e}}if("object"!=typeof e||null===e||!("type"in e))return null;if("image_url"===e.type&&e.image_url?.url)return s(e);if("text"===e.type&&e.text){return a(e.text)||e}return e}).filter(Boolean);if("object"==typeof e&&null!==e&&"type"in e){if("image_url"===e.type&&"image_url"in e&&e.image_url&&"object"==typeof e.image_url&&"url"in e.image_url&&e.image_url?.url)return s(e);if("text"===e.type&&"text"in e&&"string"==typeof e.text){return a(e.text)||e}}if("string"==typeof e){const t=a(e);return t||[{type:"text",text:e}]}return e}static normalizeContent(e,t){if("string"==typeof e){if(t){const n=/<img\s+(?!.*src=)([^"'>\s]+)\s*\/?>/g,a=e.match(n);if(a&&1===a.length){return[{type:"image_url",image_url:{url:a[0].replace(n,`<img alt="Image" src="${t}" />`),alt:"Image"}}]}}return[{type:"text",text:e}]}if(Array.isArray(e))return e.map(e=>{const n=S.normalizeContent(e,t);return Array.isArray(n)&&1===n.length?n[0]:n});if("object"==typeof e&&null!==e&&"type"in e){if("text"===e.type&&"string"==typeof e.text)return[{type:"text",text:e.text}];if("image_url"===e.type&&e.image_url?.url)return[{type:"image_url",image_url:{url:e.image_url.url,alt:e.image_url.alt||"Image"}}]}return[e]}static generateSpeakerSelectionMarkdown(e){const t=e.map((e,t)=>`- [${t+1}] ${e}`).join("\n");return[g.SYSTEM_MESSAGES.SPEAKER_SELECTION_HEADER,"",g.SYSTEM_MESSAGES.SPEAKER_SELECTION_PROMPT,"",t,"",g.SYSTEM_MESSAGES.SPEAKER_SELECTION_NOTE].join("\n")}}class N{canHandle(e){return"group_chat_run_chat"===e}static isValidGroupChatRun(e){return Boolean(e&&"object"==typeof e&&"group_chat_run_chat"===e.type&&e.content&&"object"==typeof e.content&&"string"==typeof e.content.uuid&&"string"==typeof e.content.speaker)}handle(e){if(!N.isValidGroupChatRun(e))return;return{message:{id:e.content.uuid,timestamp:(new Date).toISOString(),type:"group_chat_run_chat",content:[{type:"text",text:g.SYSTEM_MESSAGES.GROUP_CHAT_RUN}],sender:e.content.speaker}}}}class T{canHandle(e){return"select_speaker"===e||"select_speaker_invalid_input"===e}static isValidSpeakerSelection(e){return Boolean(e&&"object"==typeof e&&("select_speaker"===e.type||"select_speaker_invalid_input"===e.type)&&e.content&&"object"==typeof e.content&&"string"==typeof e.content.uuid&&Array.isArray(e.content.agents)&&e.content.agents.every(e=>"string"==typeof e))}handle(e){if(!T.isValidSpeakerSelection(e))return;return{message:{id:e.content.uuid,timestamp:(new Date).toISOString(),type:"select_speaker",content:[{type:"text",text:S.generateSpeakerSelectionMarkdown(e.content.agents)}]}}}}class E{canHandle(e){return"group_chat_resume"===e}handle(e,t){return{message:{type:"group_chat_resume",id:e.content?.uuid??b(),timestamp:(new Date).toISOString(),content:"Resume chat",sender:e.content?.sender,recipient:e.content?.recipient}}}}class _{canHandle(e){return"input_request"===e}static isValidInputRequest(e){return!(!e||"object"!=typeof e)&&("input_request"===e.type&&("string"==typeof e.request_id&&""!==e.request_id.trim()&&"string"==typeof e.prompt))}handle(e,t){if(!_.isValidInputRequest(e))return;const n=S.normalizePrompt(e.prompt);return{message:{id:e.request_id,timestamp:S.generateTimestamp(e),request_id:t.requestId||e.request_id,type:"input_request",content:[{type:"text",text:n}],prompt:n,password:S.isPasswordPrompt(e)},requestId:e.request_id}}}class M{canHandle(e){return"participants"===e}static isValidParticipantsData(e){if(e&&"object"==typeof e&&Array.isArray(e.participants)&&e.participants.length>0&&e.participants.every(e=>e&&"string"==typeof e.name))return!0;if(e&&"string"==typeof e)try{const t=JSON.parse(e);return M.isValidParticipantsData(t)}catch{return!1}return!1}static extractParticipants(e){try{const n="string"==typeof e?JSON.parse(e):e;if(M.isValidParticipantsData(n)){if("string"==typeof n)try{const e=JSON.parse(n);return this.extractParticipants(e)}catch(t){return}return{isWorkflowEnd:!1,participants:n.participants.map(e=>({name:e.name,id:e.id||e.name,isUser:"ALWAYS"===e.humanInputMode?.toUpperCase()})).filter(Boolean)}}}catch(n){}}handle(e,t){return M.isValidParticipantsData(e)?M.extractParticipants(e):e.data&&M.isValidParticipantsData(e.data)?M.extractParticipants(e.data):void 0}}class I{canHandle(e){return"print"===e}isEndOfWorkflow(e){if("string"==typeof e)return g.WORKFLOW_END_MARKERS.some(t=>e.includes(t));if("object"!=typeof e&&!e.content&&!e.data)return!1;const t="data"in e?e.data:e.content,n="string"==typeof t?t:JSON.stringify(t);return!!n&&g.WORKFLOW_END_MARKERS.some(e=>n.includes(e))}static isValidPrintMessage(e){return!(!e||"object"!=typeof e)&&("string"==typeof e.type&&"print"===e.type&&(!("data"in e)||"string"!=typeof e.data&&"object"!=typeof e.data?!(!e.content||"object"!=typeof e.content)&&(!!e.content.data&&Boolean("string"==typeof e.content.data||Array.isArray(e.content.data)||"object"==typeof e.content.data)):(e.content={data:e.data},!0)))}handle(e){if(!I.isValidPrintMessage(e))return this.isEndOfWorkflow(e)?{isWorkflowEnd:!0,message:e}:void 0;if(this.isEndOfWorkflow(e.content))return{isWorkflowEnd:!0};const t=e.content.data;return"string"==typeof t&&t.includes(g.PARTICIPANTS_KEY)||"object"==typeof t&&null!==t?M.extractParticipants(t):void 0}}class D{canHandle(e){return"termination"===e}static isValidTerminationMessage(e){return Boolean(e&&"object"==typeof e&&"termination"===e.type&&e.content&&"object"==typeof e.content&&"string"==typeof e.content.termination_reason||e.termination_reason&&"string"==typeof e.termination_reason)}handle(e){if(!D.isValidTerminationMessage(e))return;return{message:{id:b(),timestamp:(new Date).toISOString(),type:"termination",content:[{type:"text",text:e.content?.termination_reason||e.termination_reason||"Chat terminated"}]}}}}class R{canHandle(e){return"termination_and_human_reply_no_input"===e}handle(e){if(!e||"object"!=typeof e||"termination_and_human_reply_no_input"!==e.type)return;return{message:{id:e.content?.uuid||b(),timestamp:(new Date).toISOString(),type:"termination",content:[{type:"text",text:"Chat ended without user input"}],sender:e.content?.sender,recipient:e.content?.recipient}}}}class z{canHandle(e){return"text"===e}static isValidTextMessage(e){if(!e||"object"!=typeof e)return!1;if("text"!==e.type)return!1;if(Array.isArray(e.content))return e.content.every(O);const t=e.content;if(!t||"object"!=typeof t||"string"!=typeof t.sender||"string"!=typeof t.recipient)return!1;const n=t.content;return"string"==typeof n||(Array.isArray(n)?n.every(O):O(n))}handle(e,t){if(!z.isValidTextMessage(e))return;let n=S.normalizeContent(e.content.content,t.imageUrl);t.imageUrl&&(n=S.replaceImageUrls(n,t.imageUrl));return{message:{id:S.generateMessageId(e),timestamp:S.generateTimestamp(e),type:e.type,content:n,sender:e.content.sender,recipient:e.content.recipient},requestId:null}}}function O(e){return"string"==typeof e||e&&"object"==typeof e&&"string"==typeof e.type&&("text"===e.type&&"string"==typeof e.text||"image_url"===e.type&&e.image_url&&"string"==typeof e.image_url.url)}class L{canHandle(e){return"timeline"===e}static isTimelineMessage(e){return Boolean(e&&"timeline"===e.type||e&&"print"===e.type&&"data"in e&&e.data&&"object"==typeof e.data&&"type"in e.data&&"timeline"===e.data.type&&"content"in e.data&&e.data.content&&"object"==typeof e.data.content)}handle(e){if(!e||"object"!=typeof e)return;if("print"===e.type&&e.data&&"timeline"===e.data.type)return this.handle(e.data);if(!e.content||"object"!=typeof e.content)return;const t=Array.isArray(e.content.timeline)?e.content.timeline:[],n=Array.isArray(e.content.cost_timeline)?e.content.cost_timeline:[],a="object"==typeof e.content.summary&&null!==e.content.summary?e.content.summary:void 0,s="object"==typeof e.content.metadata&&null!==e.content.metadata?e.content.metadata:void 0,r=Array.isArray(e.content.agents)?e.content.agents:[];if(!(a&&s&&Array.isArray(t)&&0!==t.length&&Array.isArray(n)&&0!==n.length&&Array.isArray(r)&&0!==r.length))return;return{timeline:{timeline:t,cost_timeline:n,summary:a,metadata:s,agents:r}}}}class P{canHandle(e){return"tool_call"===e}static isValidToolCall(e){return!(!e||"object"!=typeof e)&&("tool_call"===e.type&&!(!e.content||"object"!=typeof e.content))}static extractToolFunctionNames(e){return e.content.tool_calls&&Array.isArray(e.content.tool_calls)?e.content.tool_calls.filter(e=>e.function&&"string"==typeof e.function.name).map(e=>e.function.name):[]}handle(e){if(!P.isValidToolCall(e))return;let t="Tool call";const n=P.extractToolFunctionNames(e);n.length>0&&(t+=`: ${n.join(", ")}`);return{message:{id:e.content.uuid??b(),timestamp:(new Date).toISOString(),type:"tool_call",content:[{type:"text",text:t}],sender:e.content.sender,recipient:e.content.recipient}}}}class B{canHandle(e){return"tool_response"===e}static isValidToolResponse(e){return!(!e||"object"!=typeof e)&&("tool_response"===e.type&&(!(!e.content||"object"!=typeof e.content)&&Array.isArray(e.content.tool_responses)))}handle(e){if(!B.isValidToolResponse(e))return;const t=e.content.tool_responses.map(e=>({tool_call_id:e.tool_call_id,role:e.role,content:e.content}));return{message:{id:e.content.uuid??b(),timestamp:(new Date).toISOString(),type:"tool_response",content:e.content.content,sender:e.content.sender,recipient:e.content.recipient,tool_responses:t}}}}class F{static _handlers=null;static get handlers(){return this._handlers||(this._handlers=[new _,new M,new I,new z,new D,new N,new E,new T,new w,new P,new R,new v,new x,new B,new k,new j,new L,new C]),this._handlers}static process(e,t,n){if(!e)return;let a=e;"string"==typeof e&&(a=y(e.replace("\n","")).trim());const s=F.parseMessage(a);if(!s)return F.findHandler("print",s)?.handle(a,{requestId:t,imageUrl:n});const r=F.findHandler(s.type,s);if(!r)return;const o={requestId:t,imageUrl:n};return r.handle(s,o)}static parseMessage(e){if("object"==typeof e)return e;try{return JSON.parse(e)}catch{return null}}static findHandler(e,t){const n=this.handlers.find(t=>t.canHandle(e));if(t&&"print"===t.type||"print"===e){if(L.isTimelineMessage(t))return F.handlers.find(e=>e instanceof L);if(t&&t.participants&&M.isValidParticipantsData(t))return F.handlers.find(e=>e instanceof M);if(t&&t.data&&t.data.participants&&M.isValidParticipantsData(t.data))return F.handlers.find(e=>e instanceof M)}return t&&t.participants&&M.isValidParticipantsData(t)?F.handlers.find(e=>e instanceof M):n}}const U=()=>{if(window.crypto&&window.crypto.subtle)return window.crypto;if(globalThis.crypto&&globalThis.crypto.subtle)return globalThis.crypto;throw new Error("Web Crypto API not supported in this browser.")},H=async e=>{try{const t=U(),n=(new TextEncoder).encode(e),a=await t.subtle.digest("SHA-256",n);return Array.from(new Uint8Array(a)).map(e=>e.toString(16).padStart(2,"0")).join("")}catch(t){throw new Error("Failed to compute SHA-256 hash. Ensure you are using a supported environment.")}},W=async(e,t,n="")=>{try{const a=U(),s=(e=>{if("string"==typeof e)return(new TextEncoder).encode(e);if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e)){if(e.buffer instanceof SharedArrayBuffer){const t=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),n=new ArrayBuffer(e.byteLength);return new Uint8Array(n).set(t),new Uint8Array(n)}return e}throw new TypeError("Input must be string, ArrayBuffer, or ArrayBufferView")})(e),r=(new TextEncoder).encode(t),o=await a.subtle.importKey("raw",s,{name:"HMAC",hash:"SHA-256"},!1,["sign"]),i=await a.subtle.sign("HMAC",o,r);return"hex"===n?Array.from(new Uint8Array(i)).map(e=>e.toString(16).padStart(2,"0")).join(""):new Uint8Array(i)}catch(a){throw new Error(`Error computing HMAC SHA-256: ${a instanceof Error?a.message:String(a)}`)}};var q="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function V(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function G(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var K,$={exports:{}};function Z(){return K||(K=1,$.exports=function e(t,n,a){function s(o,i){if(!n[o]){if(!t[o]){if(!i&&G)return G(o);if(r)return r(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[o]={exports:{}};t[o][0].call(c.exports,function(e){return s(t[o][1][e]||e)},c,c.exports,e,t,n,a)}return n[o].exports}for(var r=G,o=0;o<a.length;o++)s(a[o]);return s}({1:[function(e,t,n){var a=e("./utils"),s=e("./support"),r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(e){for(var t,n,s,o,i,l,c,d=[],u=0,h=e.length,p=h,m="string"!==a.getTypeOf(e);u<e.length;)p=h-u,s=m?(t=e[u++],n=u<h?e[u++]:0,u<h?e[u++]:0):(t=e.charCodeAt(u++),n=u<h?e.charCodeAt(u++):0,u<h?e.charCodeAt(u++):0),o=t>>2,i=(3&t)<<4|n>>4,l=1<p?(15&n)<<2|s>>6:64,c=2<p?63&s:64,d.push(r.charAt(o)+r.charAt(i)+r.charAt(l)+r.charAt(c));return d.join("")},n.decode=function(e){var t,n,a,o,i,l,c=0,d=0,u="data:";if(e.substr(0,u.length)===u)throw new Error("Invalid base64 input, it looks like a data url.");var h,p=3*(e=e.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(e.charAt(e.length-1)===r.charAt(64)&&p--,e.charAt(e.length-2)===r.charAt(64)&&p--,p%1!=0)throw new Error("Invalid base64 input, bad content length.");for(h=s.uint8array?new Uint8Array(0|p):new Array(0|p);c<e.length;)t=r.indexOf(e.charAt(c++))<<2|(o=r.indexOf(e.charAt(c++)))>>4,n=(15&o)<<4|(i=r.indexOf(e.charAt(c++)))>>2,a=(3&i)<<6|(l=r.indexOf(e.charAt(c++))),h[d++]=t,64!==i&&(h[d++]=n),64!==l&&(h[d++]=a);return h}},{"./support":30,"./utils":32}],2:[function(e,t,n){var a=e("./external"),s=e("./stream/DataWorker"),r=e("./stream/Crc32Probe"),o=e("./stream/DataLengthProbe");function i(e,t,n,a,s){this.compressedSize=e,this.uncompressedSize=t,this.crc32=n,this.compression=a,this.compressedContent=s}i.prototype={getContentWorker:function(){var e=new s(a.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new o("data_length")),t=this;return e.on("end",function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),e},getCompressedWorker:function(){return new s(a.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},i.createWorkerFrom=function(e,t,n){return e.pipe(new r).pipe(new o("uncompressedSize")).pipe(t.compressWorker(n)).pipe(new o("compressedSize")).withStreamInfo("compression",t)},t.exports=i},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,t,n){var a=e("./stream/GenericWorker");n.STORE={magic:"\0\0",compressWorker:function(){return new a("STORE compression")},uncompressWorker:function(){return new a("STORE decompression")}},n.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,t,n){var a=e("./utils"),s=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var a=0;a<8;a++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t){return void 0!==e&&e.length?"string"!==a.getTypeOf(e)?function(e,t,n,a){var r=s,o=a+n;e^=-1;for(var i=a;i<o;i++)e=e>>>8^r[255&(e^t[i])];return-1^e}(0|t,e,e.length,0):function(e,t,n,a){var r=s,o=a+n;e^=-1;for(var i=a;i<o;i++)e=e>>>8^r[255&(e^t.charCodeAt(i))];return-1^e}(0|t,e,e.length,0):0}},{"./utils":32}],5:[function(e,t,n){n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!0,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],6:[function(e,t,n){var a=null;a="undefined"!=typeof Promise?Promise:e("lie"),t.exports={Promise:a}},{lie:37}],7:[function(e,t,n){var a="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,s=e("pako"),r=e("./utils"),o=e("./stream/GenericWorker"),i=a?"uint8array":"array";function l(e,t){o.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}n.magic="\b\0",r.inherits(l,o),l.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(r.transformTo(i,e.data),!1)},l.prototype.flush=function(){o.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},l.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this._pako=null},l.prototype._createPako=function(){this._pako=new s[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},n.compressWorker=function(e){return new l("Deflate",e)},n.uncompressWorker=function(){return new l("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,t,n){function a(e,t){var n,a="";for(n=0;n<t;n++)a+=String.fromCharCode(255&e),e>>>=8;return a}function s(e,t,n,s,o,d){var u,h,p=e.file,m=e.compression,g=d!==i.utf8encode,f=r.transformTo("string",d(p.name)),y=r.transformTo("string",i.utf8encode(p.name)),b=p.comment,v=r.transformTo("string",d(b)),x=r.transformTo("string",i.utf8encode(b)),w=y.length!==p.name.length,C=x.length!==b.length,k="",j="",A="",S=p.dir,N=p.date,T={crc32:0,compressedSize:0,uncompressedSize:0};t&&!n||(T.crc32=e.crc32,T.compressedSize=e.compressedSize,T.uncompressedSize=e.uncompressedSize);var E=0;t&&(E|=8),g||!w&&!C||(E|=2048);var _,M,I,D=0,R=0;S&&(D|=16),"UNIX"===o?(R=798,D|=(_=p.unixPermissions,M=S,I=_,_||(I=M?16893:33204),(65535&I)<<16)):(R=20,D|=function(e){return 63&(e||0)}(p.dosPermissions)),u=N.getUTCHours(),u<<=6,u|=N.getUTCMinutes(),u<<=5,u|=N.getUTCSeconds()/2,h=N.getUTCFullYear()-1980,h<<=4,h|=N.getUTCMonth()+1,h<<=5,h|=N.getUTCDate(),w&&(j=a(1,1)+a(l(f),4)+y,k+="up"+a(j.length,2)+j),C&&(A=a(1,1)+a(l(v),4)+x,k+="uc"+a(A.length,2)+A);var z="";return z+="\n\0",z+=a(E,2),z+=m.magic,z+=a(u,2),z+=a(h,2),z+=a(T.crc32,4),z+=a(T.compressedSize,4),z+=a(T.uncompressedSize,4),z+=a(f.length,2),z+=a(k.length,2),{fileRecord:c.LOCAL_FILE_HEADER+z+f+k,dirRecord:c.CENTRAL_FILE_HEADER+a(R,2)+z+a(v.length,2)+"\0\0\0\0"+a(D,4)+a(s,4)+f+k+v}}var r=e("../utils"),o=e("../stream/GenericWorker"),i=e("../utf8"),l=e("../crc32"),c=e("../signature");function d(e,t,n,a){o.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=n,this.encodeFileName=a,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}r.inherits(d,o),d.prototype.push=function(e){var t=e.meta.percent||0,n=this.entriesCount,a=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,o.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:n?(t+100*(n-a-1))/n:100}}))},d.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var n=s(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:n.fileRecord,meta:{percent:0}})}else this.accumulate=!0},d.prototype.closedSource=function(e){this.accumulate=!1;var t,n=this.streamFiles&&!e.file.dir,r=s(e,n,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(r.dirRecord),n)this.push({data:(t=e,c.DATA_DESCRIPTOR+a(t.crc32,4)+a(t.compressedSize,4)+a(t.uncompressedSize,4)),meta:{percent:100}});else for(this.push({data:r.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},d.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var n,s,o,i,l,d,u=this.bytesWritten-e,h=(n=this.dirRecords.length,s=u,o=e,i=this.zipComment,l=this.encodeFileName,d=r.transformTo("string",l(i)),c.CENTRAL_DIRECTORY_END+"\0\0\0\0"+a(n,2)+a(n,2)+a(s,4)+a(o,4)+a(d.length,2)+d);this.push({data:h,meta:{percent:100}})},d.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},d.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()}),e.on("error",function(e){t.error(e)}),this},d.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},d.prototype.error=function(e){var t=this._sources;if(!o.prototype.error.call(this,e))return!1;for(var n=0;n<t.length;n++)try{t[n].error(e)}catch(a){}return!0},d.prototype.lock=function(){o.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},t.exports=d},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,t,n){var a=e("../compressions"),s=e("./ZipFileWorker");n.generateWorker=function(e,t,n){var r=new s(t.streamFiles,n,t.platform,t.encodeFileName),o=0;try{e.forEach(function(e,n){o++;var s=function(e,t){var n=e||t,s=a[n];if(!s)throw new Error(n+" is not a valid compression method !");return s}(n.options.compression,t.compression),i=n.options.compressionOptions||t.compressionOptions||{},l=n.dir,c=n.date;n._compressWorker(s,i).withStreamInfo("file",{name:e,dir:l,date:c,comment:n.comment||"",unixPermissions:n.unixPermissions,dosPermissions:n.dosPermissions}).pipe(r)}),r.entriesCount=o}catch(i){r.error(i)}return r}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,n){function a(){if(!(this instanceof a))return new a;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var e=new a;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}(a.prototype=e("./object")).loadAsync=e("./load"),a.support=e("./support"),a.defaults=e("./defaults"),a.version="3.10.1",a.loadAsync=function(e,t){return(new a).loadAsync(e,t)},a.external=e("./external"),t.exports=a},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,t,n){var a=e("./utils"),s=e("./external"),r=e("./utf8"),o=e("./zipEntries"),i=e("./stream/Crc32Probe"),l=e("./nodejsUtils");function c(e){return new s.Promise(function(t,n){var a=e.decompressed.getContentWorker().pipe(new i);a.on("error",function(e){n(e)}).on("end",function(){a.streamInfo.crc32!==e.decompressed.crc32?n(new Error("Corrupted zip : CRC32 mismatch")):t()}).resume()})}t.exports=function(e,t){var n=this;return t=a.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:r.utf8decode}),l.isNode&&l.isStream(e)?s.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):a.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then(function(e){var n=new o(t);return n.load(e),n}).then(function(e){var n=[s.Promise.resolve(e)],a=e.files;if(t.checkCRC32)for(var r=0;r<a.length;r++)n.push(c(a[r]));return s.Promise.all(n)}).then(function(e){for(var s=e.shift(),r=s.files,o=0;o<r.length;o++){var i=r[o],l=i.fileNameStr,c=a.resolve(i.fileNameStr);n.file(c,i.decompressed,{binary:!0,optimizedBinaryString:!0,date:i.date,dir:i.dir,comment:i.fileCommentStr.length?i.fileCommentStr:null,unixPermissions:i.unixPermissions,dosPermissions:i.dosPermissions,createFolders:t.createFolders}),i.dir||(n.file(c).unsafeOriginalName=l)}return s.zipComment.length&&(n.comment=s.zipComment),n})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,t,n){var a=e("../utils"),s=e("../stream/GenericWorker");function r(e,t){s.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}a.inherits(r,s),r.prototype._bindStream=function(e){var t=this;(this._stream=e).pause(),e.on("data",function(e){t.push({data:e,meta:{percent:0}})}).on("error",function(e){t.isPaused?this.generatedError=e:t.error(e)}).on("end",function(){t.isPaused?t._upstreamEnded=!0:t.end()})},r.prototype.pause=function(){return!!s.prototype.pause.call(this)&&(this._stream.pause(),!0)},r.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=r},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,t,n){var a=e("readable-stream").Readable;function s(e,t,n){a.call(this,t),this._helper=e;var s=this;e.on("data",function(e,t){s.push(e)||s._helper.pause(),n&&n(t)}).on("error",function(e){s.emit("error",e)}).on("end",function(){s.push(null)})}e("../utils").inherits(s,a),s.prototype._read=function(){this._helper.resume()},t.exports=s},{"../utils":32,"readable-stream":16}],14:[function(e,t,n){t.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(e,t){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,t);if("number"==typeof e)throw new Error('The "data" argument must not be a number');return new Buffer(e,t)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}},{}],15:[function(e,t,n){function a(e,t,n){var a,s=r.getTypeOf(t),i=r.extend(n||{},l);i.date=i.date||new Date,null!==i.compression&&(i.compression=i.compression.toUpperCase()),"string"==typeof i.unixPermissions&&(i.unixPermissions=parseInt(i.unixPermissions,8)),i.unixPermissions&&16384&i.unixPermissions&&(i.dir=!0),i.dosPermissions&&16&i.dosPermissions&&(i.dir=!0),i.dir&&(e=g(e)),i.createFolders&&(a=m(e))&&f.call(this,a,!0);var u="string"===s&&!1===i.binary&&!1===i.base64;n&&void 0!==n.binary||(i.binary=!u),(t instanceof c&&0===t.uncompressedSize||i.dir||!t||0===t.length)&&(i.base64=!1,i.binary=!0,t="",i.compression="STORE",s="string");var y=null;y=t instanceof c||t instanceof o?t:h.isNode&&h.isStream(t)?new p(e,t):r.prepareContent(e,t,i.binary,i.optimizedBinaryString,i.base64);var b=new d(e,y,i);this.files[e]=b}var s=e("./utf8"),r=e("./utils"),o=e("./stream/GenericWorker"),i=e("./stream/StreamHelper"),l=e("./defaults"),c=e("./compressedObject"),d=e("./zipObject"),u=e("./generate"),h=e("./nodejsUtils"),p=e("./nodejs/NodejsStreamInputAdapter"),m=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return 0<t?e.substring(0,t):""},g=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},f=function(e,t){return t=void 0!==t?t:l.createFolders,e=g(e),this.files[e]||a.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function y(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var b={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,n,a;for(t in this.files)a=this.files[t],(n=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(n,a)},filter:function(e){var t=[];return this.forEach(function(n,a){e(n,a)&&t.push(a)}),t},file:function(e,t,n){if(1!==arguments.length)return e=this.root+e,a.call(this,e,t,n),this;if(y(e)){var s=e;return this.filter(function(e,t){return!t.dir&&s.test(e)})}var r=this.files[this.root+e];return r&&!r.dir?r:null},folder:function(e){if(!e)return this;if(y(e))return this.filter(function(t,n){return n.dir&&e.test(t)});var t=this.root+e,n=f.call(this,t),a=this.clone();return a.root=n.name,a},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var n=this.filter(function(t,n){return n.name.slice(0,e.length)===e}),a=0;a<n.length;a++)delete this.files[n[a].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,n={};try{if((n=r.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:s.utf8encode})).type=n.type.toLowerCase(),n.compression=n.compression.toUpperCase(),"binarystring"===n.type&&(n.type="string"),!n.type)throw new Error("No output type specified.");r.checkSupport(n.type),"darwin"!==n.platform&&"freebsd"!==n.platform&&"linux"!==n.platform&&"sunos"!==n.platform||(n.platform="UNIX"),"win32"===n.platform&&(n.platform="DOS");var a=n.comment||this.comment||"";t=u.generateWorker(this,n,a)}catch(l){(t=new o("error")).error(l)}return new i(t,n.type||"string",n.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}};t.exports=b},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,t,n){t.exports=e("stream")},{stream:void 0}],17:[function(e,t,n){var a=e("./DataReader");function s(e){a.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}e("../utils").inherits(s,a),s.prototype.byteAt=function(e){return this.data[this.zero+e]},s.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),n=e.charCodeAt(1),a=e.charCodeAt(2),s=e.charCodeAt(3),r=this.length-4;0<=r;--r)if(this.data[r]===t&&this.data[r+1]===n&&this.data[r+2]===a&&this.data[r+3]===s)return r-this.zero;return-1},s.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1),a=e.charCodeAt(2),s=e.charCodeAt(3),r=this.readData(4);return t===r[0]&&n===r[1]&&a===r[2]&&s===r[3]},s.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=s},{"../utils":32,"./DataReader":18}],18:[function(e,t,n){var a=e("../utils");function s(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}s.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var t,n=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)n=(n<<8)+this.byteAt(t);return this.index+=e,n},readString:function(e){return a.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},t.exports=s},{"../utils":32}],19:[function(e,t,n){var a=e("./Uint8ArrayReader");function s(e){a.call(this,e)}e("../utils").inherits(s,a),s.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=s},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,t,n){var a=e("./DataReader");function s(e){a.call(this,e)}e("../utils").inherits(s,a),s.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},s.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},s.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},s.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=s},{"../utils":32,"./DataReader":18}],21:[function(e,t,n){var a=e("./ArrayReader");function s(e){a.call(this,e)}e("../utils").inherits(s,a),s.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=s},{"../utils":32,"./ArrayReader":17}],22:[function(e,t,n){var a=e("../utils"),s=e("../support"),r=e("./ArrayReader"),o=e("./StringReader"),i=e("./NodeBufferReader"),l=e("./Uint8ArrayReader");t.exports=function(e){var t=a.getTypeOf(e);return a.checkSupport(t),"string"!==t||s.uint8array?"nodebuffer"===t?new i(e):s.uint8array?new l(a.transformTo("uint8array",e)):new r(a.transformTo("array",e)):new o(e)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,t,n){n.LOCAL_FILE_HEADER="PK",n.CENTRAL_FILE_HEADER="PK",n.CENTRAL_DIRECTORY_END="PK",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",n.ZIP64_CENTRAL_DIRECTORY_END="PK",n.DATA_DESCRIPTOR="PK\b"},{}],24:[function(e,t,n){var a=e("./GenericWorker"),s=e("../utils");function r(e){a.call(this,"ConvertWorker to "+e),this.destType=e}s.inherits(r,a),r.prototype.processChunk=function(e){this.push({data:s.transformTo(this.destType,e.data),meta:e.meta})},t.exports=r},{"../utils":32,"./GenericWorker":28}],25:[function(e,t,n){var a=e("./GenericWorker"),s=e("../crc32");function r(){a.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(r,a),r.prototype.processChunk=function(e){this.streamInfo.crc32=s(e.data,this.streamInfo.crc32||0),this.push(e)},t.exports=r},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,t,n){var a=e("../utils"),s=e("./GenericWorker");function r(e){s.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}a.inherits(r,s),r.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}s.prototype.processChunk.call(this,e)},t.exports=r},{"../utils":32,"./GenericWorker":28}],27:[function(e,t,n){var a=e("../utils"),s=e("./GenericWorker");function r(e){s.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then(function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=a.getTypeOf(e),t.isPaused||t._tickAndRepeat()},function(e){t.error(e)})}a.inherits(r,s),r.prototype.cleanUp=function(){s.prototype.cleanUp.call(this),this.data=null},r.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,a.delay(this._tickAndRepeat,[],this)),!0)},r.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(a.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},r.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=r},{"../utils":32,"./GenericWorker":28}],28:[function(e,t,n){function a(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}a.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var n=0;n<this._listeners[e].length;n++)this._listeners[e][n].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.end()}),e.on("error",function(e){t.error(e)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var e=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},t.exports=a},{}],29:[function(e,t,n){var a=e("../utils"),s=e("./ConvertWorker"),r=e("./GenericWorker"),o=e("../base64"),i=e("../support"),l=e("../external"),c=null;if(i.nodestream)try{c=e("../nodejs/NodejsStreamOutputAdapter")}catch(h){}function d(e,t){return new l.Promise(function(n,s){var r=[],i=e._internalType,l=e._outputType,c=e._mimeType;e.on("data",function(e,n){r.push(e),t&&t(n)}).on("error",function(e){r=[],s(e)}).on("end",function(){try{var e=function(e,t,n){switch(e){case"blob":return a.newBlob(a.transformTo("arraybuffer",t),n);case"base64":return o.encode(t);default:return a.transformTo(e,t)}}(l,function(e,t){var n,a=0,s=null,r=0;for(n=0;n<t.length;n++)r+=t[n].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(s=new Uint8Array(r),n=0;n<t.length;n++)s.set(t[n],a),a+=t[n].length;return s;case"nodebuffer":return Buffer.concat(t);default:throw new Error("concat : unsupported type '"+e+"'")}}(i,r),c);n(e)}catch(t){s(t)}r=[]}).resume()})}function u(e,t,n){var o=t;switch(t){case"blob":case"arraybuffer":o="uint8array";break;case"base64":o="string"}try{this._internalType=o,this._outputType=t,this._mimeType=n,a.checkSupport(o),this._worker=e.pipe(new s(o)),e.lock()}catch(i){this._worker=new r("error"),this._worker.error(i)}}u.prototype={accumulate:function(e){return d(this,e)},on:function(e,t){var n=this;return"data"===e?this._worker.on(e,function(e){t.call(n,e.data,e.meta)}):this._worker.on(e,function(){a.delay(t,arguments,n)}),this},resume:function(){return a.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(a.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new c(this,{objectMode:"nodebuffer"!==this._outputType},e)}},t.exports=u},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,t,n){if(n.base64=!0,n.array=!0,n.string=!0,n.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,n.nodebuffer="undefined"!=typeof Buffer,n.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)n.blob=!1;else{var a=new ArrayBuffer(0);try{n.blob=0===new Blob([a],{type:"application/zip"}).size}catch(r){try{var s=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);s.append(a),n.blob=0===s.getBlob("application/zip").size}catch(o){n.blob=!1}}}try{n.nodestream=!!e("readable-stream").Readable}catch(r){n.nodestream=!1}},{"readable-stream":16}],31:[function(e,t,n){for(var a=e("./utils"),s=e("./support"),r=e("./nodejsUtils"),o=e("./stream/GenericWorker"),i=new Array(256),l=0;l<256;l++)i[l]=252<=l?6:248<=l?5:240<=l?4:224<=l?3:192<=l?2:1;function c(){o.call(this,"utf-8 decode"),this.leftOver=null}function d(){o.call(this,"utf-8 encode")}i[254]=i[254]=1,n.utf8encode=function(e){return s.nodebuffer?r.newBufferFrom(e,"utf-8"):function(e){var t,n,a,r,o,i=e.length,l=0;for(r=0;r<i;r++)55296==(64512&(n=e.charCodeAt(r)))&&r+1<i&&56320==(64512&(a=e.charCodeAt(r+1)))&&(n=65536+(n-55296<<10)+(a-56320),r++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=s.uint8array?new Uint8Array(l):new Array(l),r=o=0;o<l;r++)55296==(64512&(n=e.charCodeAt(r)))&&r+1<i&&56320==(64512&(a=e.charCodeAt(r+1)))&&(n=65536+(n-55296<<10)+(a-56320),r++),n<128?t[o++]=n:(n<2048?t[o++]=192|n>>>6:(n<65536?t[o++]=224|n>>>12:(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63),t[o++]=128|n>>>6&63),t[o++]=128|63&n);return t}(e)},n.utf8decode=function(e){return s.nodebuffer?a.transformTo("nodebuffer",e).toString("utf-8"):function(e){var t,n,s,r,o=e.length,l=new Array(2*o);for(t=n=0;t<o;)if((s=e[t++])<128)l[n++]=s;else if(4<(r=i[s]))l[n++]=65533,t+=r-1;else{for(s&=2===r?31:3===r?15:7;1<r&&t<o;)s=s<<6|63&e[t++],r--;1<r?l[n++]=65533:s<65536?l[n++]=s:(s-=65536,l[n++]=55296|s>>10&1023,l[n++]=56320|1023&s)}return l.length!==n&&(l.subarray?l=l.subarray(0,n):l.length=n),a.applyFromCharCode(l)}(e=a.transformTo(s.uint8array?"uint8array":"array",e))},a.inherits(c,o),c.prototype.processChunk=function(e){var t=a.transformTo(s.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(s.uint8array){var r=t;(t=new Uint8Array(r.length+this.leftOver.length)).set(this.leftOver,0),t.set(r,this.leftOver.length)}else t=this.leftOver.concat(t);this.leftOver=null}var o=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;0<=n&&128==(192&e[n]);)n--;return n<0||0===n?t:n+i[e[n]]>t?n:t}(t),l=t;o!==t.length&&(s.uint8array?(l=t.subarray(0,o),this.leftOver=t.subarray(o,t.length)):(l=t.slice(0,o),this.leftOver=t.slice(o,t.length))),this.push({data:n.utf8decode(l),meta:e.meta})},c.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:n.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},n.Utf8DecodeWorker=c,a.inherits(d,o),d.prototype.processChunk=function(e){this.push({data:n.utf8encode(e.data),meta:e.meta})},n.Utf8EncodeWorker=d},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,t,n){var a=e("./support"),s=e("./base64"),r=e("./nodejsUtils"),o=e("./external");function i(e){return e}function l(e,t){for(var n=0;n<e.length;++n)t[n]=255&e.charCodeAt(n);return t}e("setimmediate"),n.newBlob=function(e,t){n.checkSupport("blob");try{return new Blob([e],{type:t})}catch(s){try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return a.append(e),a.getBlob(t)}catch(r){throw new Error("Bug : can't construct the Blob.")}}};var c={stringifyByChunk:function(e,t,n){var a=[],s=0,r=e.length;if(r<=n)return String.fromCharCode.apply(null,e);for(;s<r;)"array"===t||"nodebuffer"===t?a.push(String.fromCharCode.apply(null,e.slice(s,Math.min(s+n,r)))):a.push(String.fromCharCode.apply(null,e.subarray(s,Math.min(s+n,r)))),s+=n;return a.join("")},stringifyByChar:function(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},applyCanBeUsed:{uint8array:function(){try{return a.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return a.nodebuffer&&1===String.fromCharCode.apply(null,r.allocBuffer(1)).length}catch(e){return!1}}()}};function d(e){var t=65536,a=n.getTypeOf(e),s=!0;if("uint8array"===a?s=c.applyCanBeUsed.uint8array:"nodebuffer"===a&&(s=c.applyCanBeUsed.nodebuffer),s)for(;1<t;)try{return c.stringifyByChunk(e,a,t)}catch(r){t=Math.floor(t/2)}return c.stringifyByChar(e)}function u(e,t){for(var n=0;n<e.length;n++)t[n]=e[n];return t}n.applyFromCharCode=d;var h={};h.string={string:i,array:function(e){return l(e,new Array(e.length))},arraybuffer:function(e){return h.string.uint8array(e).buffer},uint8array:function(e){return l(e,new Uint8Array(e.length))},nodebuffer:function(e){return l(e,r.allocBuffer(e.length))}},h.array={string:d,array:i,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return r.newBufferFrom(e)}},h.arraybuffer={string:function(e){return d(new Uint8Array(e))},array:function(e){return u(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:i,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return r.newBufferFrom(new Uint8Array(e))}},h.uint8array={string:d,array:function(e){return u(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:i,nodebuffer:function(e){return r.newBufferFrom(e)}},h.nodebuffer={string:d,array:function(e){return u(e,new Array(e.length))},arraybuffer:function(e){return h.nodebuffer.uint8array(e).buffer},uint8array:function(e){return u(e,new Uint8Array(e.length))},nodebuffer:i},n.transformTo=function(e,t){if(t=t||"",!e)return t;n.checkSupport(e);var a=n.getTypeOf(t);return h[a][e](t)},n.resolve=function(e){for(var t=e.split("/"),n=[],a=0;a<t.length;a++){var s=t[a];"."===s||""===s&&0!==a&&a!==t.length-1||(".."===s?n.pop():n.push(s))}return n.join("/")},n.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":a.nodebuffer&&r.isBuffer(e)?"nodebuffer":a.uint8array&&e instanceof Uint8Array?"uint8array":a.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},n.checkSupport=function(e){if(!a[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(e){var t,n,a="";for(n=0;n<(e||"").length;n++)a+="\\x"+((t=e.charCodeAt(n))<16?"0":"")+t.toString(16).toUpperCase();return a},n.delay=function(e,t,n){setImmediate(function(){e.apply(n||null,t||[])})},n.inherits=function(e,t){function n(){}n.prototype=t.prototype,e.prototype=new n},n.extend=function(){var e,t,n={};for(e=0;e<arguments.length;e++)for(t in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],t)&&void 0===n[t]&&(n[t]=arguments[e][t]);return n},n.prepareContent=function(e,t,r,i,c){return o.Promise.resolve(t).then(function(e){return a.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&"undefined"!=typeof FileReader?new o.Promise(function(t,n){var a=new FileReader;a.onload=function(e){t(e.target.result)},a.onerror=function(e){n(e.target.error)},a.readAsArrayBuffer(e)}):e}).then(function(t){var d,u=n.getTypeOf(t);return u?("arraybuffer"===u?t=n.transformTo("uint8array",t):"string"===u&&(c?t=s.decode(t):r&&!0!==i&&(t=l(d=t,a.uint8array?new Uint8Array(d.length):new Array(d.length)))),t):o.Promise.reject(new Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,t,n){var a=e("./reader/readerFor"),s=e("./utils"),r=e("./signature"),o=e("./zipEntry"),i=e("./support");function l(e){this.files=[],this.loadOptions=e}l.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+s.pretty(t)+", expected "+s.pretty(e)+")")}},isSignature:function(e,t){var n=this.reader.index;this.reader.setIndex(e);var a=this.reader.readString(4)===t;return this.reader.setIndex(n),a},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=i.uint8array?"uint8array":"array",n=s.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(n)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,n,a=this.zip64EndOfCentralSize-44;0<a;)e=this.reader.readInt(2),t=this.reader.readInt(4),n=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(r.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(r.CENTRAL_FILE_HEADER);)(e=new o({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(r.CENTRAL_DIRECTORY_END);if(e<0)throw this.isSignature(0,r.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(e);var t=e;if(this.checkSignature(r.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===s.MAX_VALUE_16BITS||this.diskWithCentralDirStart===s.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===s.MAX_VALUE_16BITS||this.centralDirRecords===s.MAX_VALUE_16BITS||this.centralDirSize===s.MAX_VALUE_32BITS||this.centralDirOffset===s.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(r.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(r.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,r.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(r.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(r.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var n=this.centralDirOffset+this.centralDirSize;this.zip64&&(n+=20,n+=12+this.zip64EndOfCentralSize);var a=t-n;if(0<a)this.isSignature(t,r.CENTRAL_FILE_HEADER)||(this.reader.zero=a);else if(a<0)throw new Error("Corrupted zip: missing "+Math.abs(a)+" bytes.")},prepareReader:function(e){this.reader=a(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=l},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,t,n){var a=e("./reader/readerFor"),s=e("./utils"),r=e("./compressedObject"),o=e("./crc32"),i=e("./utf8"),l=e("./compressions"),c=e("./support");function d(e,t){this.options=e,this.loadOptions=t}d.prototype={isEncrypted:function(){return!(1&~this.bitFlag)},useUTF8:function(){return!(2048&~this.bitFlag)},readLocalPart:function(e){var t,n;if(e.skip(22),this.fileNameLength=e.readInt(2),n=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(n),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in l)if(Object.prototype.hasOwnProperty.call(l,t)&&l[t].magic===e)return l[t];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+s.pretty(this.compressionMethod)+" unknown (inner file : "+s.transformTo("string",this.fileName)+")");this.decompressed=new r(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==e&&(this.dosPermissions=63&this.externalFileAttributes),3==e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var e=a(this.extraFields[1].value);this.uncompressedSize===s.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===s.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===s.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===s.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(e){var t,n,a,s=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index+4<s;)t=e.readInt(2),n=e.readInt(2),a=e.readData(n),this.extraFields[t]={id:t,length:n,value:a};e.setIndex(s)},handleUTF8:function(){var e=c.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=i.utf8decode(this.fileName),this.fileCommentStr=i.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var n=s.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(n)}var a=this.findExtraFieldUnicodeComment();if(null!==a)this.fileCommentStr=a;else{var r=s.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(r)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=a(e.value);return 1!==t.readInt(1)||o(this.fileName)!==t.readInt(4)?null:i.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=a(e.value);return 1!==t.readInt(1)||o(this.fileComment)!==t.readInt(4)?null:i.utf8decode(t.readData(e.length-5))}return null}},t.exports=d},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,t,n){function a(e,t,n){this.name=e,this.dir=n.dir,this.date=n.date,this.comment=n.comment,this.unixPermissions=n.unixPermissions,this.dosPermissions=n.dosPermissions,this._data=t,this._dataBinary=n.binary,this.options={compression:n.compression,compressionOptions:n.compressionOptions}}var s=e("./stream/StreamHelper"),r=e("./stream/DataWorker"),o=e("./utf8"),i=e("./compressedObject"),l=e("./stream/GenericWorker");a.prototype={internalStream:function(e){var t=null,n="string";try{if(!e)throw new Error("No output type specified.");var a="string"===(n=e.toLowerCase())||"text"===n;"binarystring"!==n&&"text"!==n||(n="string"),t=this._decompressWorker();var r=!this._dataBinary;r&&!a&&(t=t.pipe(new o.Utf8EncodeWorker)),!r&&a&&(t=t.pipe(new o.Utf8DecodeWorker))}catch(i){(t=new l("error")).error(i)}return new s(t,n,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof i&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var n=this._decompressWorker();return this._dataBinary||(n=n.pipe(new o.Utf8EncodeWorker)),i.createWorkerFrom(n,e,t)},_decompressWorker:function(){return this._data instanceof i?this._data.getContentWorker():this._data instanceof l?this._data:new r(this._data)}};for(var c=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],d=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},u=0;u<c.length;u++)a.prototype[c[u]]=d;t.exports=a},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,t,n){(function(e){var n,a,s=e.MutationObserver||e.WebKitMutationObserver;if(s){var r=0,o=new s(d),i=e.document.createTextNode("");o.observe(i,{characterData:!0}),n=function(){i.data=r=++r%2}}else if(e.setImmediate||void 0===e.MessageChannel)n="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){d(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(d,0)};else{var l=new e.MessageChannel;l.port1.onmessage=d,n=function(){l.port2.postMessage(0)}}var c=[];function d(){var e,t;a=!0;for(var n=c.length;n;){for(t=c,c=[],e=-1;++e<n;)t[e]();n=c.length}a=!1}t.exports=function(e){1!==c.push(e)||a||n()}}).call(this,void 0!==q?q:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(e,t,n){var a=e("immediate");function s(){}var r={},o=["REJECTED"],i=["FULFILLED"],l=["PENDING"];function c(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,e!==s&&p(this,e)}function d(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function u(e,t,n){a(function(){var a;try{a=t(n)}catch(s){return r.reject(e,s)}a===e?r.reject(e,new TypeError("Cannot resolve promise with itself")):r.resolve(e,a)})}function h(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function p(e,t){var n=!1;function a(t){n||(n=!0,r.reject(e,t))}function s(t){n||(n=!0,r.resolve(e,t))}var o=m(function(){t(s,a)});"error"===o.status&&a(o.value)}function m(e,t){var n={};try{n.value=e(t),n.status="success"}catch(a){n.status="error",n.value=a}return n}(t.exports=c).prototype.finally=function(e){if("function"!=typeof e)return this;var t=this.constructor;return this.then(function(n){return t.resolve(e()).then(function(){return n})},function(n){return t.resolve(e()).then(function(){throw n})})},c.prototype.catch=function(e){return this.then(null,e)},c.prototype.then=function(e,t){if("function"!=typeof e&&this.state===i||"function"!=typeof t&&this.state===o)return this;var n=new this.constructor(s);return this.state!==l?u(n,this.state===i?e:t,this.outcome):this.queue.push(new d(n,e,t)),n},d.prototype.callFulfilled=function(e){r.resolve(this.promise,e)},d.prototype.otherCallFulfilled=function(e){u(this.promise,this.onFulfilled,e)},d.prototype.callRejected=function(e){r.reject(this.promise,e)},d.prototype.otherCallRejected=function(e){u(this.promise,this.onRejected,e)},r.resolve=function(e,t){var n=m(h,t);if("error"===n.status)return r.reject(e,n.value);var a=n.value;if(a)p(e,a);else{e.state=i,e.outcome=t;for(var s=-1,o=e.queue.length;++s<o;)e.queue[s].callFulfilled(t)}return e},r.reject=function(e,t){e.state=o,e.outcome=t;for(var n=-1,a=e.queue.length;++n<a;)e.queue[n].callRejected(t);return e},c.resolve=function(e){return e instanceof this?e:r.resolve(new this(s),e)},c.reject=function(e){var t=new this(s);return r.reject(t,e)},c.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,a=!1;if(!n)return this.resolve([]);for(var o=new Array(n),i=0,l=-1,c=new this(s);++l<n;)d(e[l],l);return c;function d(e,s){t.resolve(e).then(function(e){o[s]=e,++i!==n||a||(a=!0,r.resolve(c,o))},function(e){a||(a=!0,r.reject(c,e))})}},c.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,a=!1;if(!n)return this.resolve([]);for(var o,i=-1,l=new this(s);++i<n;)o=e[i],t.resolve(o).then(function(e){a||(a=!0,r.resolve(l,e))},function(e){a||(a=!0,r.reject(l,e))});return l}},{immediate:36}],38:[function(e,t,n){var a={};(0,e("./lib/utils/common").assign)(a,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=a},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,t,n){var a=e("./zlib/deflate"),s=e("./utils/common"),r=e("./utils/strings"),o=e("./zlib/messages"),i=e("./zlib/zstream"),l=Object.prototype.toString,c=0,d=-1,u=0,h=8;function p(e){if(!(this instanceof p))return new p(e);this.options=s.assign({level:d,method:h,chunkSize:16384,windowBits:15,memLevel:8,strategy:u,to:""},e||{});var t=this.options;t.raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new i,this.strm.avail_out=0;var n=a.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==c)throw new Error(o[n]);if(t.header&&a.deflateSetHeader(this.strm,t.header),t.dictionary){var m;if(m="string"==typeof t.dictionary?r.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(n=a.deflateSetDictionary(this.strm,m))!==c)throw new Error(o[n]);this._dict_set=!0}}function m(e,t){var n=new p(t);if(n.push(e,!0),n.err)throw n.msg||o[n.err];return n.result}p.prototype.push=function(e,t){var n,o,i=this.strm,d=this.options.chunkSize;if(this.ended)return!1;o=t===~~t?t:!0===t?4:0,"string"==typeof e?i.input=r.string2buf(e):"[object ArrayBuffer]"===l.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;do{if(0===i.avail_out&&(i.output=new s.Buf8(d),i.next_out=0,i.avail_out=d),1!==(n=a.deflate(i,o))&&n!==c)return this.onEnd(n),!(this.ended=!0);0!==i.avail_out&&(0!==i.avail_in||4!==o&&2!==o)||("string"===this.options.to?this.onData(r.buf2binstring(s.shrinkBuf(i.output,i.next_out))):this.onData(s.shrinkBuf(i.output,i.next_out)))}while((0<i.avail_in||0===i.avail_out)&&1!==n);return 4===o?(n=a.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===c):2!==o||(this.onEnd(c),!(i.avail_out=0))},p.prototype.onData=function(e){this.chunks.push(e)},p.prototype.onEnd=function(e){e===c&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Deflate=p,n.deflate=m,n.deflateRaw=function(e,t){return(t=t||{}).raw=!0,m(e,t)},n.gzip=function(e,t){return(t=t||{}).gzip=!0,m(e,t)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,t,n){var a=e("./zlib/inflate"),s=e("./utils/common"),r=e("./utils/strings"),o=e("./zlib/constants"),i=e("./zlib/messages"),l=e("./zlib/zstream"),c=e("./zlib/gzheader"),d=Object.prototype.toString;function u(e){if(!(this instanceof u))return new u(e);this.options=s.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&!(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var n=a.inflateInit2(this.strm,t.windowBits);if(n!==o.Z_OK)throw new Error(i[n]);this.header=new c,a.inflateGetHeader(this.strm,this.header)}function h(e,t){var n=new u(t);if(n.push(e,!0),n.err)throw n.msg||i[n.err];return n.result}u.prototype.push=function(e,t){var n,i,l,c,u,h,p=this.strm,m=this.options.chunkSize,g=this.options.dictionary,f=!1;if(this.ended)return!1;i=t===~~t?t:!0===t?o.Z_FINISH:o.Z_NO_FLUSH,"string"==typeof e?p.input=r.binstring2buf(e):"[object ArrayBuffer]"===d.call(e)?p.input=new Uint8Array(e):p.input=e,p.next_in=0,p.avail_in=p.input.length;do{if(0===p.avail_out&&(p.output=new s.Buf8(m),p.next_out=0,p.avail_out=m),(n=a.inflate(p,o.Z_NO_FLUSH))===o.Z_NEED_DICT&&g&&(h="string"==typeof g?r.string2buf(g):"[object ArrayBuffer]"===d.call(g)?new Uint8Array(g):g,n=a.inflateSetDictionary(this.strm,h)),n===o.Z_BUF_ERROR&&!0===f&&(n=o.Z_OK,f=!1),n!==o.Z_STREAM_END&&n!==o.Z_OK)return this.onEnd(n),!(this.ended=!0);p.next_out&&(0!==p.avail_out&&n!==o.Z_STREAM_END&&(0!==p.avail_in||i!==o.Z_FINISH&&i!==o.Z_SYNC_FLUSH)||("string"===this.options.to?(l=r.utf8border(p.output,p.next_out),c=p.next_out-l,u=r.buf2string(p.output,l),p.next_out=c,p.avail_out=m-c,c&&s.arraySet(p.output,p.output,l,c,0),this.onData(u)):this.onData(s.shrinkBuf(p.output,p.next_out)))),0===p.avail_in&&0===p.avail_out&&(f=!0)}while((0<p.avail_in||0===p.avail_out)&&n!==o.Z_STREAM_END);return n===o.Z_STREAM_END&&(i=o.Z_FINISH),i===o.Z_FINISH?(n=a.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===o.Z_OK):i!==o.Z_SYNC_FLUSH||(this.onEnd(o.Z_OK),!(p.avail_out=0))},u.prototype.onData=function(e){this.chunks.push(e)},u.prototype.onEnd=function(e){e===o.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Inflate=u,n.inflate=h,n.inflateRaw=function(e,t){return(t=t||{}).raw=!0,h(e,t)},n.ungzip=h},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,t,n){var a="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;n.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var a in n)n.hasOwnProperty(a)&&(e[a]=n[a])}}return e},n.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var s={arraySet:function(e,t,n,a,s){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+a),s);else for(var r=0;r<a;r++)e[s+r]=t[n+r]},flattenChunks:function(e){var t,n,a,s,r,o;for(t=a=0,n=e.length;t<n;t++)a+=e[t].length;for(o=new Uint8Array(a),t=s=0,n=e.length;t<n;t++)r=e[t],o.set(r,s),s+=r.length;return o}},r={arraySet:function(e,t,n,a,s){for(var r=0;r<a;r++)e[s+r]=t[n+r]},flattenChunks:function(e){return[].concat.apply([],e)}};n.setTyped=function(e){e?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,s)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,r))},n.setTyped(a)},{}],42:[function(e,t,n){var a=e("./common"),s=!0,r=!0;try{String.fromCharCode.apply(null,[0])}catch(c){s=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(c){r=!1}for(var o=new a.Buf8(256),i=0;i<256;i++)o[i]=252<=i?6:248<=i?5:240<=i?4:224<=i?3:192<=i?2:1;function l(e,t){if(t<65537&&(e.subarray&&r||!e.subarray&&s))return String.fromCharCode.apply(null,a.shrinkBuf(e,t));for(var n="",o=0;o<t;o++)n+=String.fromCharCode(e[o]);return n}o[254]=o[254]=1,n.string2buf=function(e){var t,n,s,r,o,i=e.length,l=0;for(r=0;r<i;r++)55296==(64512&(n=e.charCodeAt(r)))&&r+1<i&&56320==(64512&(s=e.charCodeAt(r+1)))&&(n=65536+(n-55296<<10)+(s-56320),r++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=new a.Buf8(l),r=o=0;o<l;r++)55296==(64512&(n=e.charCodeAt(r)))&&r+1<i&&56320==(64512&(s=e.charCodeAt(r+1)))&&(n=65536+(n-55296<<10)+(s-56320),r++),n<128?t[o++]=n:(n<2048?t[o++]=192|n>>>6:(n<65536?t[o++]=224|n>>>12:(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63),t[o++]=128|n>>>6&63),t[o++]=128|63&n);return t},n.buf2binstring=function(e){return l(e,e.length)},n.binstring2buf=function(e){for(var t=new a.Buf8(e.length),n=0,s=t.length;n<s;n++)t[n]=e.charCodeAt(n);return t},n.buf2string=function(e,t){var n,a,s,r,i=t||e.length,c=new Array(2*i);for(n=a=0;n<i;)if((s=e[n++])<128)c[a++]=s;else if(4<(r=o[s]))c[a++]=65533,n+=r-1;else{for(s&=2===r?31:3===r?15:7;1<r&&n<i;)s=s<<6|63&e[n++],r--;1<r?c[a++]=65533:s<65536?c[a++]=s:(s-=65536,c[a++]=55296|s>>10&1023,c[a++]=56320|1023&s)}return l(c,a)},n.utf8border=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;0<=n&&128==(192&e[n]);)n--;return n<0||0===n?t:n+o[e[n]]>t?n:t}},{"./common":41}],43:[function(e,t,n){t.exports=function(e,t,n,a){for(var s=65535&e,r=e>>>16&65535,o=0;0!==n;){for(n-=o=2e3<n?2e3:n;r=r+(s=s+t[a++]|0)|0,--o;);s%=65521,r%=65521}return s|r<<16}},{}],44:[function(e,t,n){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,t,n){var a=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var a=0;a<8;a++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t,n,s){var r=a,o=s+n;e^=-1;for(var i=s;i<o;i++)e=e>>>8^r[255&(e^t[i])];return-1^e}},{}],46:[function(e,t,n){var a,s=e("../utils/common"),r=e("./trees"),o=e("./adler32"),i=e("./crc32"),l=e("./messages"),c=0,d=4,u=0,h=-2,p=-1,m=4,g=2,f=8,y=9,b=286,v=30,x=19,w=2*b+1,C=15,k=3,j=258,A=j+k+1,S=42,N=113,T=1,E=2,_=3,M=4;function I(e,t){return e.msg=l[t],t}function D(e){return(e<<1)-(4<e?9:0)}function R(e){for(var t=e.length;0<=--t;)e[t]=0}function z(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(s.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function O(e,t){r._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,z(e.strm)}function L(e,t){e.pending_buf[e.pending++]=t}function P(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function B(e,t){var n,a,s=e.max_chain_length,r=e.strstart,o=e.prev_length,i=e.nice_match,l=e.strstart>e.w_size-A?e.strstart-(e.w_size-A):0,c=e.window,d=e.w_mask,u=e.prev,h=e.strstart+j,p=c[r+o-1],m=c[r+o];e.prev_length>=e.good_match&&(s>>=2),i>e.lookahead&&(i=e.lookahead);do{if(c[(n=t)+o]===m&&c[n+o-1]===p&&c[n]===c[r]&&c[++n]===c[r+1]){r+=2,n++;do{}while(c[++r]===c[++n]&&c[++r]===c[++n]&&c[++r]===c[++n]&&c[++r]===c[++n]&&c[++r]===c[++n]&&c[++r]===c[++n]&&c[++r]===c[++n]&&c[++r]===c[++n]&&r<h);if(a=j-(h-r),r=h-j,o<a){if(e.match_start=t,i<=(o=a))break;p=c[r+o-1],m=c[r+o]}}}while((t=u[t&d])>l&&0!=--s);return o<=e.lookahead?o:e.lookahead}function F(e){var t,n,a,r,l,c,d,u,h,p,m=e.w_size;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=m+(m-A)){for(s.arraySet(e.window,e.window,m,m,0),e.match_start-=m,e.strstart-=m,e.block_start-=m,t=n=e.hash_size;a=e.head[--t],e.head[t]=m<=a?a-m:0,--n;);for(t=n=m;a=e.prev[--t],e.prev[t]=m<=a?a-m:0,--n;);r+=m}if(0===e.strm.avail_in)break;if(c=e.strm,d=e.window,u=e.strstart+e.lookahead,p=void 0,(h=r)<(p=c.avail_in)&&(p=h),n=0===p?0:(c.avail_in-=p,s.arraySet(d,c.input,c.next_in,p,u),1===c.state.wrap?c.adler=o(c.adler,d,p,u):2===c.state.wrap&&(c.adler=i(c.adler,d,p,u)),c.next_in+=p,c.total_in+=p,p),e.lookahead+=n,e.lookahead+e.insert>=k)for(l=e.strstart-e.insert,e.ins_h=e.window[l],e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+k-1])&e.hash_mask,e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(e.lookahead+e.insert<k)););}while(e.lookahead<A&&0!==e.strm.avail_in)}function U(e,t){for(var n,a;;){if(e.lookahead<A){if(F(e),e.lookahead<A&&t===c)return T;if(0===e.lookahead)break}if(n=0,e.lookahead>=k&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+k-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-A&&(e.match_length=B(e,n)),e.match_length>=k)if(a=r._tr_tally(e,e.strstart-e.match_start,e.match_length-k),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=k){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+k-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else a=r._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(a&&(O(e,!1),0===e.strm.avail_out))return T}return e.insert=e.strstart<k-1?e.strstart:k-1,t===d?(O(e,!0),0===e.strm.avail_out?_:M):e.last_lit&&(O(e,!1),0===e.strm.avail_out)?T:E}function H(e,t){for(var n,a,s;;){if(e.lookahead<A){if(F(e),e.lookahead<A&&t===c)return T;if(0===e.lookahead)break}if(n=0,e.lookahead>=k&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+k-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=k-1,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-A&&(e.match_length=B(e,n),e.match_length<=5&&(1===e.strategy||e.match_length===k&&4096<e.strstart-e.match_start)&&(e.match_length=k-1)),e.prev_length>=k&&e.match_length<=e.prev_length){for(s=e.strstart+e.lookahead-k,a=r._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-k),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=s&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+k-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=k-1,e.strstart++,a&&(O(e,!1),0===e.strm.avail_out))return T}else if(e.match_available){if((a=r._tr_tally(e,0,e.window[e.strstart-1]))&&O(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return T}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(a=r._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<k-1?e.strstart:k-1,t===d?(O(e,!0),0===e.strm.avail_out?_:M):e.last_lit&&(O(e,!1),0===e.strm.avail_out)?T:E}function W(e,t,n,a,s){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=a,this.func=s}function q(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=f,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new s.Buf16(2*w),this.dyn_dtree=new s.Buf16(2*(2*v+1)),this.bl_tree=new s.Buf16(2*(2*x+1)),R(this.dyn_ltree),R(this.dyn_dtree),R(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new s.Buf16(C+1),this.heap=new s.Buf16(2*b+1),R(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new s.Buf16(2*b+1),R(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function V(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=g,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?S:N,e.adler=2===t.wrap?0:1,t.last_flush=c,r._tr_init(t),u):I(e,h)}function G(e){var t,n=V(e);return n===u&&((t=e.state).window_size=2*t.w_size,R(t.head),t.max_lazy_match=a[t.level].max_lazy,t.good_match=a[t.level].good_length,t.nice_match=a[t.level].nice_length,t.max_chain_length=a[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=k-1,t.match_available=0,t.ins_h=0),n}function K(e,t,n,a,r,o){if(!e)return h;var i=1;if(t===p&&(t=6),a<0?(i=0,a=-a):15<a&&(i=2,a-=16),r<1||y<r||n!==f||a<8||15<a||t<0||9<t||o<0||m<o)return I(e,h);8===a&&(a=9);var l=new q;return(e.state=l).strm=e,l.wrap=i,l.gzhead=null,l.w_bits=a,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=r+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+k-1)/k),l.window=new s.Buf8(2*l.w_size),l.head=new s.Buf16(l.hash_size),l.prev=new s.Buf16(l.w_size),l.lit_bufsize=1<<r+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new s.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=o,l.method=n,G(e)}a=[new W(0,0,0,0,function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(F(e),0===e.lookahead&&t===c)return T;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var a=e.block_start+n;if((0===e.strstart||e.strstart>=a)&&(e.lookahead=e.strstart-a,e.strstart=a,O(e,!1),0===e.strm.avail_out))return T;if(e.strstart-e.block_start>=e.w_size-A&&(O(e,!1),0===e.strm.avail_out))return T}return e.insert=0,t===d?(O(e,!0),0===e.strm.avail_out?_:M):(e.strstart>e.block_start&&(O(e,!1),e.strm.avail_out),T)}),new W(4,4,8,4,U),new W(4,5,16,8,U),new W(4,6,32,32,U),new W(4,4,16,16,H),new W(8,16,32,32,H),new W(8,16,128,128,H),new W(8,32,128,256,H),new W(32,128,258,1024,H),new W(32,258,258,4096,H)],n.deflateInit=function(e,t){return K(e,t,f,15,8,0)},n.deflateInit2=K,n.deflateReset=G,n.deflateResetKeep=V,n.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?h:(e.state.gzhead=t,u):h},n.deflate=function(e,t){var n,s,o,l;if(!e||!e.state||5<t||t<0)return e?I(e,h):h;if(s=e.state,!e.output||!e.input&&0!==e.avail_in||666===s.status&&t!==d)return I(e,0===e.avail_out?-5:h);if(s.strm=e,n=s.last_flush,s.last_flush=t,s.status===S)if(2===s.wrap)e.adler=0,L(s,31),L(s,139),L(s,8),s.gzhead?(L(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(s.gzhead.extra?4:0)+(s.gzhead.name?8:0)+(s.gzhead.comment?16:0)),L(s,255&s.gzhead.time),L(s,s.gzhead.time>>8&255),L(s,s.gzhead.time>>16&255),L(s,s.gzhead.time>>24&255),L(s,9===s.level?2:2<=s.strategy||s.level<2?4:0),L(s,255&s.gzhead.os),s.gzhead.extra&&s.gzhead.extra.length&&(L(s,255&s.gzhead.extra.length),L(s,s.gzhead.extra.length>>8&255)),s.gzhead.hcrc&&(e.adler=i(e.adler,s.pending_buf,s.pending,0)),s.gzindex=0,s.status=69):(L(s,0),L(s,0),L(s,0),L(s,0),L(s,0),L(s,9===s.level?2:2<=s.strategy||s.level<2?4:0),L(s,3),s.status=N);else{var p=f+(s.w_bits-8<<4)<<8;p|=(2<=s.strategy||s.level<2?0:s.level<6?1:6===s.level?2:3)<<6,0!==s.strstart&&(p|=32),p+=31-p%31,s.status=N,P(s,p),0!==s.strstart&&(P(s,e.adler>>>16),P(s,65535&e.adler)),e.adler=1}if(69===s.status)if(s.gzhead.extra){for(o=s.pending;s.gzindex<(65535&s.gzhead.extra.length)&&(s.pending!==s.pending_buf_size||(s.gzhead.hcrc&&s.pending>o&&(e.adler=i(e.adler,s.pending_buf,s.pending-o,o)),z(e),o=s.pending,s.pending!==s.pending_buf_size));)L(s,255&s.gzhead.extra[s.gzindex]),s.gzindex++;s.gzhead.hcrc&&s.pending>o&&(e.adler=i(e.adler,s.pending_buf,s.pending-o,o)),s.gzindex===s.gzhead.extra.length&&(s.gzindex=0,s.status=73)}else s.status=73;if(73===s.status)if(s.gzhead.name){o=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>o&&(e.adler=i(e.adler,s.pending_buf,s.pending-o,o)),z(e),o=s.pending,s.pending===s.pending_buf_size)){l=1;break}l=s.gzindex<s.gzhead.name.length?255&s.gzhead.name.charCodeAt(s.gzindex++):0,L(s,l)}while(0!==l);s.gzhead.hcrc&&s.pending>o&&(e.adler=i(e.adler,s.pending_buf,s.pending-o,o)),0===l&&(s.gzindex=0,s.status=91)}else s.status=91;if(91===s.status)if(s.gzhead.comment){o=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>o&&(e.adler=i(e.adler,s.pending_buf,s.pending-o,o)),z(e),o=s.pending,s.pending===s.pending_buf_size)){l=1;break}l=s.gzindex<s.gzhead.comment.length?255&s.gzhead.comment.charCodeAt(s.gzindex++):0,L(s,l)}while(0!==l);s.gzhead.hcrc&&s.pending>o&&(e.adler=i(e.adler,s.pending_buf,s.pending-o,o)),0===l&&(s.status=103)}else s.status=103;if(103===s.status&&(s.gzhead.hcrc?(s.pending+2>s.pending_buf_size&&z(e),s.pending+2<=s.pending_buf_size&&(L(s,255&e.adler),L(s,e.adler>>8&255),e.adler=0,s.status=N)):s.status=N),0!==s.pending){if(z(e),0===e.avail_out)return s.last_flush=-1,u}else if(0===e.avail_in&&D(t)<=D(n)&&t!==d)return I(e,-5);if(666===s.status&&0!==e.avail_in)return I(e,-5);if(0!==e.avail_in||0!==s.lookahead||t!==c&&666!==s.status){var m=2===s.strategy?function(e,t){for(var n;;){if(0===e.lookahead&&(F(e),0===e.lookahead)){if(t===c)return T;break}if(e.match_length=0,n=r._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(O(e,!1),0===e.strm.avail_out))return T}return e.insert=0,t===d?(O(e,!0),0===e.strm.avail_out?_:M):e.last_lit&&(O(e,!1),0===e.strm.avail_out)?T:E}(s,t):3===s.strategy?function(e,t){for(var n,a,s,o,i=e.window;;){if(e.lookahead<=j){if(F(e),e.lookahead<=j&&t===c)return T;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=k&&0<e.strstart&&(a=i[s=e.strstart-1])===i[++s]&&a===i[++s]&&a===i[++s]){o=e.strstart+j;do{}while(a===i[++s]&&a===i[++s]&&a===i[++s]&&a===i[++s]&&a===i[++s]&&a===i[++s]&&a===i[++s]&&a===i[++s]&&s<o);e.match_length=j-(o-s),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=k?(n=r._tr_tally(e,1,e.match_length-k),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=r._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(O(e,!1),0===e.strm.avail_out))return T}return e.insert=0,t===d?(O(e,!0),0===e.strm.avail_out?_:M):e.last_lit&&(O(e,!1),0===e.strm.avail_out)?T:E}(s,t):a[s.level].func(s,t);if(m!==_&&m!==M||(s.status=666),m===T||m===_)return 0===e.avail_out&&(s.last_flush=-1),u;if(m===E&&(1===t?r._tr_align(s):5!==t&&(r._tr_stored_block(s,0,0,!1),3===t&&(R(s.head),0===s.lookahead&&(s.strstart=0,s.block_start=0,s.insert=0))),z(e),0===e.avail_out))return s.last_flush=-1,u}return t!==d?u:s.wrap<=0?1:(2===s.wrap?(L(s,255&e.adler),L(s,e.adler>>8&255),L(s,e.adler>>16&255),L(s,e.adler>>24&255),L(s,255&e.total_in),L(s,e.total_in>>8&255),L(s,e.total_in>>16&255),L(s,e.total_in>>24&255)):(P(s,e.adler>>>16),P(s,65535&e.adler)),z(e),0<s.wrap&&(s.wrap=-s.wrap),0!==s.pending?u:1)},n.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==S&&69!==t&&73!==t&&91!==t&&103!==t&&t!==N&&666!==t?I(e,h):(e.state=null,t===N?I(e,-3):u):h},n.deflateSetDictionary=function(e,t){var n,a,r,i,l,c,d,p,m=t.length;if(!e||!e.state)return h;if(2===(i=(n=e.state).wrap)||1===i&&n.status!==S||n.lookahead)return h;for(1===i&&(e.adler=o(e.adler,t,m,0)),n.wrap=0,m>=n.w_size&&(0===i&&(R(n.head),n.strstart=0,n.block_start=0,n.insert=0),p=new s.Buf8(n.w_size),s.arraySet(p,t,m-n.w_size,n.w_size,0),t=p,m=n.w_size),l=e.avail_in,c=e.next_in,d=e.input,e.avail_in=m,e.next_in=0,e.input=t,F(n);n.lookahead>=k;){for(a=n.strstart,r=n.lookahead-(k-1);n.ins_h=(n.ins_h<<n.hash_shift^n.window[a+k-1])&n.hash_mask,n.prev[a&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=a,a++,--r;);n.strstart=a,n.lookahead=k-1,F(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=k-1,n.match_available=0,e.next_in=c,e.input=d,e.avail_in=l,n.wrap=i,u},n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,t,n){t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,t,n){t.exports=function(e,t){var n,a,s,r,o,i,l,c,d,u,h,p,m,g,f,y,b,v,x,w,C,k,j,A,S;n=e.state,a=e.next_in,A=e.input,s=a+(e.avail_in-5),r=e.next_out,S=e.output,o=r-(t-e.avail_out),i=r+(e.avail_out-257),l=n.dmax,c=n.wsize,d=n.whave,u=n.wnext,h=n.window,p=n.hold,m=n.bits,g=n.lencode,f=n.distcode,y=(1<<n.lenbits)-1,b=(1<<n.distbits)-1;e:do{m<15&&(p+=A[a++]<<m,m+=8,p+=A[a++]<<m,m+=8),v=g[p&y];t:for(;;){if(p>>>=x=v>>>24,m-=x,0==(x=v>>>16&255))S[r++]=65535&v;else{if(!(16&x)){if(!(64&x)){v=g[(65535&v)+(p&(1<<x)-1)];continue t}if(32&x){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}w=65535&v,(x&=15)&&(m<x&&(p+=A[a++]<<m,m+=8),w+=p&(1<<x)-1,p>>>=x,m-=x),m<15&&(p+=A[a++]<<m,m+=8,p+=A[a++]<<m,m+=8),v=f[p&b];n:for(;;){if(p>>>=x=v>>>24,m-=x,!(16&(x=v>>>16&255))){if(!(64&x)){v=f[(65535&v)+(p&(1<<x)-1)];continue n}e.msg="invalid distance code",n.mode=30;break e}if(C=65535&v,m<(x&=15)&&(p+=A[a++]<<m,(m+=8)<x&&(p+=A[a++]<<m,m+=8)),l<(C+=p&(1<<x)-1)){e.msg="invalid distance too far back",n.mode=30;break e}if(p>>>=x,m-=x,(x=r-o)<C){if(d<(x=C-x)&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(j=h,(k=0)===u){if(k+=c-x,x<w){for(w-=x;S[r++]=h[k++],--x;);k=r-C,j=S}}else if(u<x){if(k+=c+u-x,(x-=u)<w){for(w-=x;S[r++]=h[k++],--x;);if(k=0,u<w){for(w-=x=u;S[r++]=h[k++],--x;);k=r-C,j=S}}}else if(k+=u-x,x<w){for(w-=x;S[r++]=h[k++],--x;);k=r-C,j=S}for(;2<w;)S[r++]=j[k++],S[r++]=j[k++],S[r++]=j[k++],w-=3;w&&(S[r++]=j[k++],1<w&&(S[r++]=j[k++]))}else{for(k=r-C;S[r++]=S[k++],S[r++]=S[k++],S[r++]=S[k++],2<(w-=3););w&&(S[r++]=S[k++],1<w&&(S[r++]=S[k++]))}break}}break}}while(a<s&&r<i);a-=w=m>>3,p&=(1<<(m-=w<<3))-1,e.next_in=a,e.next_out=r,e.avail_in=a<s?s-a+5:5-(a-s),e.avail_out=r<i?i-r+257:257-(r-i),n.hold=p,n.bits=m}},{}],49:[function(e,t,n){var a=e("../utils/common"),s=e("./adler32"),r=e("./crc32"),o=e("./inffast"),i=e("./inftrees"),l=1,c=2,d=0,u=-2,h=1,p=852,m=592;function g(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function f(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new a.Buf16(320),this.work=new a.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function y(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=h,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new a.Buf32(p),t.distcode=t.distdyn=new a.Buf32(m),t.sane=1,t.back=-1,d):u}function b(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,y(e)):u}function v(e,t){var n,a;return e&&e.state?(a=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t)?u:(null!==a.window&&a.wbits!==t&&(a.window=null),a.wrap=n,a.wbits=t,b(e))):u}function x(e,t){var n,a;return e?(a=new f,(e.state=a).window=null,(n=v(e,t))!==d&&(e.state=null),n):u}var w,C,k=!0;function j(e){if(k){var t;for(w=new a.Buf32(512),C=new a.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(i(l,e.lens,0,288,w,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;i(c,e.lens,0,32,C,0,e.work,{bits:5}),k=!1}e.lencode=w,e.lenbits=9,e.distcode=C,e.distbits=5}function A(e,t,n,s){var r,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new a.Buf8(o.wsize)),s>=o.wsize?(a.arraySet(o.window,t,n-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):(s<(r=o.wsize-o.wnext)&&(r=s),a.arraySet(o.window,t,n-s,r,o.wnext),(s-=r)?(a.arraySet(o.window,t,n-s,s,0),o.wnext=s,o.whave=o.wsize):(o.wnext+=r,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=r))),0}n.inflateReset=b,n.inflateReset2=v,n.inflateResetKeep=y,n.inflateInit=function(e){return x(e,15)},n.inflateInit2=x,n.inflate=function(e,t){var n,p,m,f,y,b,v,x,w,C,k,S,N,T,E,_,M,I,D,R,z,O,L,P,B=0,F=new a.Buf8(4),U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return u;12===(n=e.state).mode&&(n.mode=13),y=e.next_out,m=e.output,v=e.avail_out,f=e.next_in,p=e.input,b=e.avail_in,x=n.hold,w=n.bits,C=b,k=v,O=d;e:for(;;)switch(n.mode){case h:if(0===n.wrap){n.mode=13;break}for(;w<16;){if(0===b)break e;b--,x+=p[f++]<<w,w+=8}if(2&n.wrap&&35615===x){F[n.check=0]=255&x,F[1]=x>>>8&255,n.check=r(n.check,F,2,0),w=x=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&x)<<8)+(x>>8))%31){e.msg="incorrect header check",n.mode=30;break}if(8!=(15&x)){e.msg="unknown compression method",n.mode=30;break}if(w-=4,z=8+(15&(x>>>=4)),0===n.wbits)n.wbits=z;else if(z>n.wbits){e.msg="invalid window size",n.mode=30;break}n.dmax=1<<z,e.adler=n.check=1,n.mode=512&x?10:12,w=x=0;break;case 2:for(;w<16;){if(0===b)break e;b--,x+=p[f++]<<w,w+=8}if(n.flags=x,8!=(255&n.flags)){e.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=x>>8&1),512&n.flags&&(F[0]=255&x,F[1]=x>>>8&255,n.check=r(n.check,F,2,0)),w=x=0,n.mode=3;case 3:for(;w<32;){if(0===b)break e;b--,x+=p[f++]<<w,w+=8}n.head&&(n.head.time=x),512&n.flags&&(F[0]=255&x,F[1]=x>>>8&255,F[2]=x>>>16&255,F[3]=x>>>24&255,n.check=r(n.check,F,4,0)),w=x=0,n.mode=4;case 4:for(;w<16;){if(0===b)break e;b--,x+=p[f++]<<w,w+=8}n.head&&(n.head.xflags=255&x,n.head.os=x>>8),512&n.flags&&(F[0]=255&x,F[1]=x>>>8&255,n.check=r(n.check,F,2,0)),w=x=0,n.mode=5;case 5:if(1024&n.flags){for(;w<16;){if(0===b)break e;b--,x+=p[f++]<<w,w+=8}n.length=x,n.head&&(n.head.extra_len=x),512&n.flags&&(F[0]=255&x,F[1]=x>>>8&255,n.check=r(n.check,F,2,0)),w=x=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&(b<(S=n.length)&&(S=b),S&&(n.head&&(z=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),a.arraySet(n.head.extra,p,f,S,z)),512&n.flags&&(n.check=r(n.check,p,S,f)),b-=S,f+=S,n.length-=S),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===b)break e;for(S=0;z=p[f+S++],n.head&&z&&n.length<65536&&(n.head.name+=String.fromCharCode(z)),z&&S<b;);if(512&n.flags&&(n.check=r(n.check,p,S,f)),b-=S,f+=S,z)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===b)break e;for(S=0;z=p[f+S++],n.head&&z&&n.length<65536&&(n.head.comment+=String.fromCharCode(z)),z&&S<b;);if(512&n.flags&&(n.check=r(n.check,p,S,f)),b-=S,f+=S,z)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;w<16;){if(0===b)break e;b--,x+=p[f++]<<w,w+=8}if(x!==(65535&n.check)){e.msg="header crc mismatch",n.mode=30;break}w=x=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=12;break;case 10:for(;w<32;){if(0===b)break e;b--,x+=p[f++]<<w,w+=8}e.adler=n.check=g(x),w=x=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=y,e.avail_out=v,e.next_in=f,e.avail_in=b,n.hold=x,n.bits=w,2;e.adler=n.check=1,n.mode=12;case 12:if(5===t||6===t)break e;case 13:if(n.last){x>>>=7&w,w-=7&w,n.mode=27;break}for(;w<3;){if(0===b)break e;b--,x+=p[f++]<<w,w+=8}switch(n.last=1&x,w-=1,3&(x>>>=1)){case 0:n.mode=14;break;case 1:if(j(n),n.mode=20,6!==t)break;x>>>=2,w-=2;break e;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=30}x>>>=2,w-=2;break;case 14:for(x>>>=7&w,w-=7&w;w<32;){if(0===b)break e;b--,x+=p[f++]<<w,w+=8}if((65535&x)!=(x>>>16^65535)){e.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&x,w=x=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(S=n.length){if(b<S&&(S=b),v<S&&(S=v),0===S)break e;a.arraySet(m,p,f,S,y),b-=S,f+=S,v-=S,y+=S,n.length-=S;break}n.mode=12;break;case 17:for(;w<14;){if(0===b)break e;b--,x+=p[f++]<<w,w+=8}if(n.nlen=257+(31&x),x>>>=5,w-=5,n.ndist=1+(31&x),x>>>=5,w-=5,n.ncode=4+(15&x),x>>>=4,w-=4,286<n.nlen||30<n.ndist){e.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;w<3;){if(0===b)break e;b--,x+=p[f++]<<w,w+=8}n.lens[U[n.have++]]=7&x,x>>>=3,w-=3}for(;n.have<19;)n.lens[U[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,L={bits:n.lenbits},O=i(0,n.lens,0,19,n.lencode,0,n.work,L),n.lenbits=L.bits,O){e.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;_=(B=n.lencode[x&(1<<n.lenbits)-1])>>>16&255,M=65535&B,!((E=B>>>24)<=w);){if(0===b)break e;b--,x+=p[f++]<<w,w+=8}if(M<16)x>>>=E,w-=E,n.lens[n.have++]=M;else{if(16===M){for(P=E+2;w<P;){if(0===b)break e;b--,x+=p[f++]<<w,w+=8}if(x>>>=E,w-=E,0===n.have){e.msg="invalid bit length repeat",n.mode=30;break}z=n.lens[n.have-1],S=3+(3&x),x>>>=2,w-=2}else if(17===M){for(P=E+3;w<P;){if(0===b)break e;b--,x+=p[f++]<<w,w+=8}w-=E,z=0,S=3+(7&(x>>>=E)),x>>>=3,w-=3}else{for(P=E+7;w<P;){if(0===b)break e;b--,x+=p[f++]<<w,w+=8}w-=E,z=0,S=11+(127&(x>>>=E)),x>>>=7,w-=7}if(n.have+S>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=30;break}for(;S--;)n.lens[n.have++]=z}}if(30===n.mode)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,L={bits:n.lenbits},O=i(l,n.lens,0,n.nlen,n.lencode,0,n.work,L),n.lenbits=L.bits,O){e.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,L={bits:n.distbits},O=i(c,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,L),n.distbits=L.bits,O){e.msg="invalid distances set",n.mode=30;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(6<=b&&258<=v){e.next_out=y,e.avail_out=v,e.next_in=f,e.avail_in=b,n.hold=x,n.bits=w,o(e,k),y=e.next_out,m=e.output,v=e.avail_out,f=e.next_in,p=e.input,b=e.avail_in,x=n.hold,w=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;_=(B=n.lencode[x&(1<<n.lenbits)-1])>>>16&255,M=65535&B,!((E=B>>>24)<=w);){if(0===b)break e;b--,x+=p[f++]<<w,w+=8}if(_&&!(240&_)){for(I=E,D=_,R=M;_=(B=n.lencode[R+((x&(1<<I+D)-1)>>I)])>>>16&255,M=65535&B,!(I+(E=B>>>24)<=w);){if(0===b)break e;b--,x+=p[f++]<<w,w+=8}x>>>=I,w-=I,n.back+=I}if(x>>>=E,w-=E,n.back+=E,n.length=M,0===_){n.mode=26;break}if(32&_){n.back=-1,n.mode=12;break}if(64&_){e.msg="invalid literal/length code",n.mode=30;break}n.extra=15&_,n.mode=22;case 22:if(n.extra){for(P=n.extra;w<P;){if(0===b)break e;b--,x+=p[f++]<<w,w+=8}n.length+=x&(1<<n.extra)-1,x>>>=n.extra,w-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;_=(B=n.distcode[x&(1<<n.distbits)-1])>>>16&255,M=65535&B,!((E=B>>>24)<=w);){if(0===b)break e;b--,x+=p[f++]<<w,w+=8}if(!(240&_)){for(I=E,D=_,R=M;_=(B=n.distcode[R+((x&(1<<I+D)-1)>>I)])>>>16&255,M=65535&B,!(I+(E=B>>>24)<=w);){if(0===b)break e;b--,x+=p[f++]<<w,w+=8}x>>>=I,w-=I,n.back+=I}if(x>>>=E,w-=E,n.back+=E,64&_){e.msg="invalid distance code",n.mode=30;break}n.offset=M,n.extra=15&_,n.mode=24;case 24:if(n.extra){for(P=n.extra;w<P;){if(0===b)break e;b--,x+=p[f++]<<w,w+=8}n.offset+=x&(1<<n.extra)-1,x>>>=n.extra,w-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===v)break e;if(S=k-v,n.offset>S){if((S=n.offset-S)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=30;break}N=S>n.wnext?(S-=n.wnext,n.wsize-S):n.wnext-S,S>n.length&&(S=n.length),T=n.window}else T=m,N=y-n.offset,S=n.length;for(v<S&&(S=v),v-=S,n.length-=S;m[y++]=T[N++],--S;);0===n.length&&(n.mode=21);break;case 26:if(0===v)break e;m[y++]=n.length,v--,n.mode=21;break;case 27:if(n.wrap){for(;w<32;){if(0===b)break e;b--,x|=p[f++]<<w,w+=8}if(k-=v,e.total_out+=k,n.total+=k,k&&(e.adler=n.check=n.flags?r(n.check,m,k,y-k):s(n.check,m,k,y-k)),k=v,(n.flags?x:g(x))!==n.check){e.msg="incorrect data check",n.mode=30;break}w=x=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;w<32;){if(0===b)break e;b--,x+=p[f++]<<w,w+=8}if(x!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=30;break}w=x=0}n.mode=29;case 29:O=1;break e;case 30:O=-3;break e;case 31:return-4;default:return u}return e.next_out=y,e.avail_out=v,e.next_in=f,e.avail_in=b,n.hold=x,n.bits=w,(n.wsize||k!==e.avail_out&&n.mode<30&&(n.mode<27||4!==t))&&A(e,e.output,e.next_out,k-e.avail_out)?(n.mode=31,-4):(C-=e.avail_in,k-=e.avail_out,e.total_in+=C,e.total_out+=k,n.total+=k,n.wrap&&k&&(e.adler=n.check=n.flags?r(n.check,m,k,e.next_out-k):s(n.check,m,k,e.next_out-k)),e.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),(0==C&&0===k||4===t)&&O===d&&(O=-5),O)},n.inflateEnd=function(e){if(!e||!e.state)return u;var t=e.state;return t.window&&(t.window=null),e.state=null,d},n.inflateGetHeader=function(e,t){var n;return e&&e.state&&2&(n=e.state).wrap?((n.head=t).done=!1,d):u},n.inflateSetDictionary=function(e,t){var n,a=t.length;return e&&e.state?0!==(n=e.state).wrap&&11!==n.mode?u:11===n.mode&&s(1,t,a,0)!==n.check?-3:A(e,t,a,a)?(n.mode=31,-4):(n.havedict=1,d):u},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,t,n){var a=e("../utils/common"),s=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],r=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],i=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,n,l,c,d,u,h){var p,m,g,f,y,b,v,x,w,C=h.bits,k=0,j=0,A=0,S=0,N=0,T=0,E=0,_=0,M=0,I=0,D=null,R=0,z=new a.Buf16(16),O=new a.Buf16(16),L=null,P=0;for(k=0;k<=15;k++)z[k]=0;for(j=0;j<l;j++)z[t[n+j]]++;for(N=C,S=15;1<=S&&0===z[S];S--);if(S<N&&(N=S),0===S)return c[d++]=20971520,c[d++]=20971520,h.bits=1,0;for(A=1;A<S&&0===z[A];A++);for(N<A&&(N=A),k=_=1;k<=15;k++)if(_<<=1,(_-=z[k])<0)return-1;if(0<_&&(0===e||1!==S))return-1;for(O[1]=0,k=1;k<15;k++)O[k+1]=O[k]+z[k];for(j=0;j<l;j++)0!==t[n+j]&&(u[O[t[n+j]]++]=j);if(b=0===e?(D=L=u,19):1===e?(D=s,R-=257,L=r,P-=257,256):(D=o,L=i,-1),k=A,y=d,E=j=I=0,g=-1,f=(M=1<<(T=N))-1,1===e&&852<M||2===e&&592<M)return 1;for(;;){for(v=k-E,w=u[j]<b?(x=0,u[j]):u[j]>b?(x=L[P+u[j]],D[R+u[j]]):(x=96,0),p=1<<k-E,A=m=1<<T;c[y+(I>>E)+(m-=p)]=v<<24|x<<16|w,0!==m;);for(p=1<<k-1;I&p;)p>>=1;if(0!==p?(I&=p-1,I+=p):I=0,j++,0==--z[k]){if(k===S)break;k=t[n+u[j]]}if(N<k&&(I&f)!==g){for(0===E&&(E=N),y+=A,_=1<<(T=k-E);T+E<S&&!((_-=z[T+E])<=0);)T++,_<<=1;if(M+=1<<T,1===e&&852<M||2===e&&592<M)return 1;c[g=I&f]=N<<24|T<<16|y-d}}return 0!==I&&(c[y+I]=k-E<<24|64<<16),h.bits=N,0}},{"../utils/common":41}],51:[function(e,t,n){t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,t,n){var a=e("../utils/common"),s=0,r=1;function o(e){for(var t=e.length;0<=--t;)e[t]=0}var i=0,l=29,c=256,d=c+1+l,u=30,h=19,p=2*d+1,m=15,g=16,f=7,y=256,b=16,v=17,x=18,w=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],C=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],k=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],j=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],A=new Array(2*(d+2));o(A);var S=new Array(2*u);o(S);var N=new Array(512);o(N);var T=new Array(256);o(T);var E=new Array(l);o(E);var _,M,I,D=new Array(u);function R(e,t,n,a,s){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=a,this.max_length=s,this.has_stree=e&&e.length}function z(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function O(e){return e<256?N[e]:N[256+(e>>>7)]}function L(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function P(e,t,n){e.bi_valid>g-n?(e.bi_buf|=t<<e.bi_valid&65535,L(e,e.bi_buf),e.bi_buf=t>>g-e.bi_valid,e.bi_valid+=n-g):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function B(e,t,n){P(e,n[2*t],n[2*t+1])}function F(e,t){for(var n=0;n|=1&e,e>>>=1,n<<=1,0<--t;);return n>>>1}function U(e,t,n){var a,s,r=new Array(m+1),o=0;for(a=1;a<=m;a++)r[a]=o=o+n[a-1]<<1;for(s=0;s<=t;s++){var i=e[2*s+1];0!==i&&(e[2*s]=F(r[i]++,i))}}function H(e){var t;for(t=0;t<d;t++)e.dyn_ltree[2*t]=0;for(t=0;t<u;t++)e.dyn_dtree[2*t]=0;for(t=0;t<h;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*y]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function W(e){8<e.bi_valid?L(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function q(e,t,n,a){var s=2*t,r=2*n;return e[s]<e[r]||e[s]===e[r]&&a[t]<=a[n]}function V(e,t,n){for(var a=e.heap[n],s=n<<1;s<=e.heap_len&&(s<e.heap_len&&q(t,e.heap[s+1],e.heap[s],e.depth)&&s++,!q(t,a,e.heap[s],e.depth));)e.heap[n]=e.heap[s],n=s,s<<=1;e.heap[n]=a}function G(e,t,n){var a,s,r,o,i=0;if(0!==e.last_lit)for(;a=e.pending_buf[e.d_buf+2*i]<<8|e.pending_buf[e.d_buf+2*i+1],s=e.pending_buf[e.l_buf+i],i++,0===a?B(e,s,t):(B(e,(r=T[s])+c+1,t),0!==(o=w[r])&&P(e,s-=E[r],o),B(e,r=O(--a),n),0!==(o=C[r])&&P(e,a-=D[r],o)),i<e.last_lit;);B(e,y,t)}function K(e,t){var n,a,s,r=t.dyn_tree,o=t.stat_desc.static_tree,i=t.stat_desc.has_stree,l=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=p,n=0;n<l;n++)0!==r[2*n]?(e.heap[++e.heap_len]=c=n,e.depth[n]=0):r[2*n+1]=0;for(;e.heap_len<2;)r[2*(s=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[s]=0,e.opt_len--,i&&(e.static_len-=o[2*s+1]);for(t.max_code=c,n=e.heap_len>>1;1<=n;n--)V(e,r,n);for(s=l;n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],V(e,r,1),a=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=a,r[2*s]=r[2*n]+r[2*a],e.depth[s]=(e.depth[n]>=e.depth[a]?e.depth[n]:e.depth[a])+1,r[2*n+1]=r[2*a+1]=s,e.heap[1]=s++,V(e,r,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,a,s,r,o,i,l=t.dyn_tree,c=t.max_code,d=t.stat_desc.static_tree,u=t.stat_desc.has_stree,h=t.stat_desc.extra_bits,g=t.stat_desc.extra_base,f=t.stat_desc.max_length,y=0;for(r=0;r<=m;r++)e.bl_count[r]=0;for(l[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<p;n++)f<(r=l[2*l[2*(a=e.heap[n])+1]+1]+1)&&(r=f,y++),l[2*a+1]=r,c<a||(e.bl_count[r]++,o=0,g<=a&&(o=h[a-g]),i=l[2*a],e.opt_len+=i*(r+o),u&&(e.static_len+=i*(d[2*a+1]+o)));if(0!==y){do{for(r=f-1;0===e.bl_count[r];)r--;e.bl_count[r]--,e.bl_count[r+1]+=2,e.bl_count[f]--,y-=2}while(0<y);for(r=f;0!==r;r--)for(a=e.bl_count[r];0!==a;)c<(s=e.heap[--n])||(l[2*s+1]!==r&&(e.opt_len+=(r-l[2*s+1])*l[2*s],l[2*s+1]=r),a--)}}(e,t),U(r,c,e.bl_count)}function $(e,t,n){var a,s,r=-1,o=t[1],i=0,l=7,c=4;for(0===o&&(l=138,c=3),t[2*(n+1)+1]=65535,a=0;a<=n;a++)s=o,o=t[2*(a+1)+1],++i<l&&s===o||(i<c?e.bl_tree[2*s]+=i:0!==s?(s!==r&&e.bl_tree[2*s]++,e.bl_tree[2*b]++):i<=10?e.bl_tree[2*v]++:e.bl_tree[2*x]++,r=s,c=(i=0)===o?(l=138,3):s===o?(l=6,3):(l=7,4))}function Z(e,t,n){var a,s,r=-1,o=t[1],i=0,l=7,c=4;for(0===o&&(l=138,c=3),a=0;a<=n;a++)if(s=o,o=t[2*(a+1)+1],!(++i<l&&s===o)){if(i<c)for(;B(e,s,e.bl_tree),0!=--i;);else 0!==s?(s!==r&&(B(e,s,e.bl_tree),i--),B(e,b,e.bl_tree),P(e,i-3,2)):i<=10?(B(e,v,e.bl_tree),P(e,i-3,3)):(B(e,x,e.bl_tree),P(e,i-11,7));r=s,c=(i=0)===o?(l=138,3):s===o?(l=6,3):(l=7,4)}}o(D);var Q=!1;function Y(e,t,n,s){var r,o,l;P(e,(i<<1)+(s?1:0),3),o=t,l=n,W(r=e),L(r,l),L(r,~l),a.arraySet(r.pending_buf,r.window,o,l,r.pending),r.pending+=l}n._tr_init=function(e){Q||(function(){var e,t,n,a,s,r=new Array(m+1);for(a=n=0;a<l-1;a++)for(E[a]=n,e=0;e<1<<w[a];e++)T[n++]=a;for(T[n-1]=a,a=s=0;a<16;a++)for(D[a]=s,e=0;e<1<<C[a];e++)N[s++]=a;for(s>>=7;a<u;a++)for(D[a]=s<<7,e=0;e<1<<C[a]-7;e++)N[256+s++]=a;for(t=0;t<=m;t++)r[t]=0;for(e=0;e<=143;)A[2*e+1]=8,e++,r[8]++;for(;e<=255;)A[2*e+1]=9,e++,r[9]++;for(;e<=279;)A[2*e+1]=7,e++,r[7]++;for(;e<=287;)A[2*e+1]=8,e++,r[8]++;for(U(A,d+1,r),e=0;e<u;e++)S[2*e+1]=5,S[2*e]=F(e,5);_=new R(A,w,c+1,d,m),M=new R(S,C,0,u,m),I=new R(new Array(0),k,0,h,f)}(),Q=!0),e.l_desc=new z(e.dyn_ltree,_),e.d_desc=new z(e.dyn_dtree,M),e.bl_desc=new z(e.bl_tree,I),e.bi_buf=0,e.bi_valid=0,H(e)},n._tr_stored_block=Y,n._tr_flush_block=function(e,t,n,a){var o,i,l=0;0<e.level?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return s;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return r;for(t=32;t<c;t++)if(0!==e.dyn_ltree[2*t])return r;return s}(e)),K(e,e.l_desc),K(e,e.d_desc),l=function(e){var t;for($(e,e.dyn_ltree,e.l_desc.max_code),$(e,e.dyn_dtree,e.d_desc.max_code),K(e,e.bl_desc),t=h-1;3<=t&&0===e.bl_tree[2*j[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),o=e.opt_len+3+7>>>3,(i=e.static_len+3+7>>>3)<=o&&(o=i)):o=i=n+5,n+4<=o&&-1!==t?Y(e,t,n,a):4===e.strategy||i===o?(P(e,2+(a?1:0),3),G(e,A,S)):(P(e,4+(a?1:0),3),function(e,t,n,a){var s;for(P(e,t-257,5),P(e,n-1,5),P(e,a-4,4),s=0;s<a;s++)P(e,e.bl_tree[2*j[s]+1],3);Z(e,e.dyn_ltree,t-1),Z(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,l+1),G(e,e.dyn_ltree,e.dyn_dtree)),H(e),a&&W(e)},n._tr_tally=function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(T[n]+c+1)]++,e.dyn_dtree[2*O(t)]++),e.last_lit===e.lit_bufsize-1},n._tr_align=function(e){var t;P(e,2,3),B(e,y,A),16===(t=e).bi_valid?(L(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):8<=t.bi_valid&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}},{"../utils/common":41}],53:[function(e,t,n){t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,t,n){(function(e){!function(e,t){if(!e.setImmediate){var n,a,s,r,o=1,i={},l=!1,c=e.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(e);d=d&&d.setTimeout?d:e,n="[object process]"==={}.toString.call(e.process)?function(e){process.nextTick(function(){h(e)})}:function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?(r="setImmediate$"+Math.random()+"$",e.addEventListener?e.addEventListener("message",p,!1):e.attachEvent("onmessage",p),function(t){e.postMessage(r+t,"*")}):e.MessageChannel?((s=new MessageChannel).port1.onmessage=function(e){h(e.data)},function(e){s.port2.postMessage(e)}):c&&"onreadystatechange"in c.createElement("script")?(a=c.documentElement,function(e){var t=c.createElement("script");t.onreadystatechange=function(){h(e),t.onreadystatechange=null,a.removeChild(t),t=null},a.appendChild(t)}):function(e){setTimeout(h,0,e)},d.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),a=0;a<t.length;a++)t[a]=arguments[a+1];var s={callback:e,args:t};return i[o]=s,n(o),o++},d.clearImmediate=u}function u(e){delete i[e]}function h(e){if(l)setTimeout(h,0,e);else{var n=i[e];if(n){l=!0;try{!function(e){var n=e.callback,a=e.args;switch(a.length){case 0:n();break;case 1:n(a[0]);break;case 2:n(a[0],a[1]);break;case 3:n(a[0],a[1],a[2]);break;default:n.apply(t,a)}}(n)}finally{u(e),l=!1}}}}function p(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(r)&&h(+t.data.slice(r.length))}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,void 0!==q?q:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[10])(10)),$.exports}const Q=V(Z()),Y=e=>{let t=".waldiez";return"flow"!==e&&(t+=e.charAt(0).toUpperCase()+e.slice(1)),(()=>{if("userAgentData"in navigator&&"object"==typeof navigator.userAgentData){const e=navigator.userAgentData;if(e&&"platform"in e&&"string"==typeof e.platform){const t=e.platform.toLowerCase();return t.includes("mac")||t.includes("ios")}}const e=navigator.userAgent;return/Macintosh|Mac OS X|iPhone|iPad|iPod/i.test(e)})()&&(t+=".zip"),t},X=(e,t)=>{const n=URL.createObjectURL(e),a=document.createElement("a");a.href=n,a.download=t,a.click(),URL.revokeObjectURL(n)},J=async(e,t,n,a=()=>{})=>{const s=n();if(s){const n=JSON.stringify(s,null,2),r=((e,t)=>{const n=Y(t);let a=e||"flow";return a.length<3&&(a="flow"),a.length>100&&(a=a.slice(0,100)),`${a}${n}`})(e,t);if(r.endsWith(".zip"))await(async(e,t,n)=>{try{const n=e.replace(/\.zip$/,""),a=new Q;a.file(n,t);const s=await a.generateAsync({type:"blob"});X(s,e)}catch{n()}})(r,n,a);else{const e=new Blob([n],{type:"application/json; charset=utf-8"});X(e,r)}}else a()},ee=()=>`${Date.now()}${b()}`,te=(e,t,n)=>{const a=e.target.files?.[0];if(a){const e=new FileReader;e.onload=()=>{const a=t();if(a){const t=e.result;try{const e=JSON.parse(t);n(a,e)}catch(s){}}},e.readAsText(a)}},ne=(e,t=!1)=>{let n=document.getElementById(`rf-root-${e}`);return!n&&t&&(n=document.body),n};const ae=["<Waldiez step-by-step> - Starting workflow..."],se=["<Waldiez step-by-step> - Workflow finished","<Waldiez step-by-step> - Workflow stopped by user","<Waldiez step-by-step> - Workflow execution failed:"],re=[...ae,...se];function oe(e){if("string"==typeof e)return e;if("object"!=typeof e||null===e||!("kind"in e)||"string"!=typeof e.kind)return String(e);switch(e.kind){case"continue":return"c";case"step":return"s";case"run":return"r";case"quit":return"q";case"info":return"i";case"help":return"h";case"stats":return"st";case"add_breakpoint":return"ab";case"remove_breakpoint":return"rb";case"list_breakpoints":return"lb";case"clear_breakpoints":return"cb";case"raw":return e.value;default:return String(e)}}class ie{canHandle(e){return["debug_breakpoints_list","debug_breakpoint_added","debug_breakpoint_removed","debug_breakpoint_cleared","breakpoints_list","breakpoint_added","breakpoint_removed","breakpoint_cleared"].includes(e)}handle(e,t){const n={debugMessage:e};if(a=e,Boolean(a&&("debug_breakpoints_list"===a.type||"breakpoints_list"===a.type)&&Array.isArray(a.breakpoints)))n.stateUpdate={breakpoints:e.breakpoints||[]},n.controlAction={type:"update_breakpoints",breakpoints:e.breakpoints||[]};else if((e=>Boolean(e&&("debug_breakpoint_added"===e.type||"breakpoint_added"===e.type)&&e.breakpoint&&("object"==typeof e.breakpoint||"string"==typeof e.breakpoint)))(e)){const a=[...t.currentState?.breakpoints||[],e.breakpoint];n.stateUpdate={breakpoints:a},n.controlAction={type:"show_notification",message:`Breakpoint added: ${e.breakpoint}`,severity:"success"}}else if((e=>Boolean(e&&("debug_breakpoint_removed"===e.type||"breakpoint_removed"===e.type)&&e.breakpoint&&("object"==typeof e.breakpoint||"string"==typeof e.breakpoint)))(e)){const a=(t.currentState?.breakpoints||[]).filter(t=>t!==e.breakpoint);n.stateUpdate={breakpoints:a},n.controlAction={type:"show_notification",message:`Breakpoint removed: ${e.breakpoint}`,severity:"info"}}else{if(!(e=>Boolean(e&&("debug_breakpoint_cleared"===e.type||"breakpoint_cleared"===e.type)&&"string"==typeof e.message))(e))return{error:{message:`Unknown breakpoint message type: ${e.type}`,originalData:e}};n.stateUpdate={breakpoints:[]},n.controlAction={type:"show_notification",message:e.message||"All breakpoints cleared",severity:"info"}}var a;return n}}class le{canHandle(e){return"debug_error"===e||"error"===e}handle(e,t){return n=e,Boolean(n&&("debug_error"===n.type||"error"===n.type)&&"string"==typeof n.error)?{debugMessage:e,stateUpdate:{lastError:e.error},controlAction:{type:"show_notification",message:e.error,severity:"error"}}:{error:{message:"Invalid debug_error structure",originalData:e}};var n}}class ce{canHandle(e){return"debug_event_info"===e||"event_info"===e}handle(e,t){if(n=e,!Boolean(n&&("debug_event_info"===n.type||"event_info"===n.type)&&n.event&&"object"==typeof n.event))return{error:{message:"Invalid debug_event_info structure",originalData:e}};var n;const a=e.event;return{debugMessage:e,stateUpdate:{currentEvent:a,eventHistory:[...t.currentState?.eventHistory||[],a]},controlAction:{type:"scroll_to_latest"}}}}class de{canHandle(e){return"debug_help"===e||"help"===e}handle(e,t){return n=e,Boolean(n&&("debug_help"===n.type||"help"===n.type)&&Array.isArray(n.help))?{debugMessage:e,stateUpdate:{help:e.help}}:{error:{message:"Invalid debug_help structure",originalData:e}};var n}}class ue{canHandle(e){return"debug_input_request"===e||"input_request"===e}handle(e,t){return n=e,Boolean(n&&("debug_input_request"===n.type||"input_request"===n.type)&&"string"==typeof n.request_id&&"string"==typeof n.prompt)?"[Step] (c)ontinue, (r)un, (q)uit, (i)nfo, (h)elp, (st)ats:"===e.prompt.trim()||"debug_input_request"===e.type?{debugMessage:e,stateUpdate:{pendingControlInput:{request_id:e.request_id,prompt:e.prompt}},controlAction:{type:"debug_input_request_received",requestId:e.request_id,prompt:e.prompt}}:{debugMessage:e,stateUpdate:{activeRequest:{request_id:e.request_id,prompt:e.prompt}}}:{error:{message:"Invalid debug_input_request structure",originalData:e}};var n}}class he{canHandle(e){return"debug_print"===e||"print"===e}handle(e,t){if("debug_print"!==e.type&&"print"!==e.type)return{error:{message:"Invalid debug_print structure",originalData:e}};let n=e.content;const a=e;if("string"!=typeof a.content){if("string"!=typeof a.data)return{error:{message:"Invalid debug_print structure",originalData:e}};n=a.data}const s=this.isWorkflowEndMessage(n),r={debugMessage:e,isWorkflowEnd:s};return s&&(r.controlAction={type:"workflow_ended",reason:this.extractEndReason(n)},r.stateUpdate={pendingControlInput:null,activeRequest:null}),r}isWorkflowEndMessage(e){return!!e&&se.some(t=>e.includes(t))}extractEndReason(e){return e.includes("Workflow finished")?"completed":e.includes("stopped by user")?"user_stopped":e.includes("execution failed")?"error":void 0}}class pe{canHandle(e){return"debug_stats"===e||"stats"===e}handle(e,t){return n=e,Boolean(n&&("debug_stats"===n.type||"stats"===n.type)&&n.stats&&"object"==typeof n.stats)?{debugMessage:e,stateUpdate:{stats:e.stats,stepMode:e.stats.step_mode,autoContinue:e.stats.auto_continue,breakpoints:e.stats.breakpoints||[]}}:{error:{message:"Invalid debug_stats structure",originalData:e}};var n}}class me{static _handlers=null;static get handlers(){return this._handlers||(this._handlers=[new ue,new ce,new pe,new le,new de,new ie,new he]),this._handlers}static process(e,t={}){if(!e)return;let n=null;return"string"==typeof e?n=me.parseMessage(e):"object"==typeof e&&me.isValidDebugMessage(e)&&(n=e),n?this._doProcess(n,t):me.earlyError(e)}static _doProcess(e,t){let n;const a=me.findHandler(e.type);if(a||(n=F.findHandler(e.type,e)),!a&&!n)return{error:{message:`No handler found for message type: ${e.type}`,code:"UNKNOWN_MESSAGE_TYPE",originalData:e}};try{return a?.handle(e,t)}catch(s){if(n)try{const a=n.handle(e,t);if(a)return me._chatResultToStepResult(a)}catch(r){return{error:{message:`Handler error: ${s instanceof Error?s.message:String(s)}`,code:"HANDLER_ERROR",originalData:e}}}return{error:{message:`Handler error: ${s instanceof Error?s.message:String(s)}`,code:"HANDLER_ERROR",originalData:e}}}}static _chatResultToStepResult(e){return e.participants?{debugMessage:{type:"print",content:e.participants},stateUpdate:{participants:e.participants}}:e.timeline?{debugMessage:{type:"print",content:e.timeline},stateUpdate:{timeline:e.timeline}}:e.isWorkflowEnd?{debugMessage:{type:"print",content:"Workflow has ended."},stateUpdate:{eventHistory:[{type:"workflow_end",...e.runCompletion||e.message||{}}]}}:e.message&&e.message.content?{debugMessage:{type:"print",content:e.message},stateUpdate:{eventHistory:[e]}}:void 0}static earlyError(e){try{const t=JSON.parse(e||"");return{error:{message:`No handler found for message type: ${t.type}`,originalData:e}}}catch{return{error:{message:"Failed to parse debug message as JSON",originalData:e}}}}static parseMessage(e){if(!e)return null;if("string"!=typeof e&&me.isValidDebugMessage(e))return e;const t=y(e).replace(/\r?\n/g," ").trim();if(!t)return null;const n=fe(t)??t,a=ge(n);if(a&&me.isValidDebugMessage(a))return a;const s=ye(n),r=ge(s);return r&&me.isValidDebugMessage(r)?r:null}static findHandler(e){return me.handlers.find(t=>t.canHandle(e))}static isValidDebugMessage(e){return!(!e||"object"!=typeof e||!e.type||"string"!=typeof e.type)}}const ge=e=>{try{return JSON.parse(e)}catch{return null}},fe=e=>{const t=new Set(["{","["]),n={"{":"}","[":"]"};let a=-1;const s=[];let r=null,o=!1;for(let i=0;i<e.length;i++){const l=e[i];if(void 0!==l)if(r){if(o){o=!1;continue}if("\\"===l){o=!0;continue}l===r&&(r=null)}else if('"'!==l&&"'"!==l){if(t.has(l))s.push(l),-1===a&&(a=i);else if(s.length){const t=s[s.length-1];if(void 0!==t&&l===n[t]&&(s.pop(),!s.length&&-1!==a))return e.slice(a,i+1)}}else r=l}return null},ye=e=>{let t="",n=0;const a=e.length;let s=null,r=!1;const o=e=>/[A-Za-z0-9_]/.test(e||"");for(;n<a;){const i=e[n];if(s){if(r){t+="\\"+i,r=!1,n++;continue}if("\\"===i){r=!0,n++;continue}if(i===s){t+='"',s=null,n++;continue}t+="'"===s&&'"'===i?'\\"':i,n++}else if("'"!==i&&'"'!==i){if(/[A-Za-z_]/.test(i||"")){let s=n+1;for(;s<a&&o(e[s]);)s++;const r=e.slice(n,s),i=n>0?e[n-1]:"",l=s<a?e[s]:"",c=!!i&&o(i),d=!!l&&o(l);if(!c&&!d){if("True"===r){t+="true",n=s;continue}if("False"===r){t+="false",n=s;continue}if("None"===r){t+="null",n=s;continue}}t+=r,n=s;continue}t+=i,n++}else s=i,t+='"',n++}return s?e:t};class be{static extractEventParticipants(e){let t,n,a;if("string"==typeof e.sender&&(t=e.sender),"string"==typeof e.recipient&&(n=e.recipient),"string"==typeof e.type&&(a=e.type),e.event&&"object"==typeof e.event){const s=e.event;"string"==typeof s.sender&&(t=s.sender),"string"==typeof s.recipient&&(n=s.recipient),"string"==typeof s.type&&(a=s.type)}if(e.data&&"object"==typeof e.data){const s=e.data;"string"==typeof s.sender&&(t=s.sender),"string"==typeof s.recipient&&(n=s.recipient),"string"==typeof s.type&&(a=a||s.type)}if(e.content&&"object"==typeof e.content){const s=e.content;"string"==typeof s.sender&&(t=s.sender),"string"==typeof s.recipient&&(n=s.recipient),"string"==typeof s.type&&(a=a||s.type),"string"==typeof s.speaker&&(t=s.speaker)}if(e.message&&"object"==typeof e.message){const a=e.message;"string"==typeof a.sender&&(t=a.sender),"string"==typeof a.recipient&&(n=a.recipient)}return{sender:"string"==typeof t?t:void 0,recipient:"string"==typeof n?n:void 0,eventType:"string"==typeof a?a:void 0}}static formatEventContent(e,t=100){const n=e.content;if("string"==typeof n)return n.length>t?`${n.substring(0,t)}...`:n;if(n&&"object"==typeof n){const e=JSON.stringify(n);return e.length>t?`${e.substring(0,t)}...`:e}return""}static extractWorkflowEndReason(e){const t=e.toLowerCase();return t.includes("workflow finished")?"completed":t.includes("stopped by user")?"user_stopped":t.includes("execution failed")?"error":"unknown"}static createControlResponse(e,t){return{type:"debug_input_response",request_id:e,data:t}}}const ve=e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase();class xe{id;type="agent";agentType;name;description;tags;requirements;createdAt;updatedAt;data;rest;constructor(e){this.id=e.id,this.agentType=e.agentType,this.name=e.name,this.description=e.description,this.tags=e.tags,this.requirements=e.requirements,this.createdAt=e.createdAt,this.updatedAt=e.updatedAt,this.data=e.data,this.rest=e.rest}static create(e){let t,n;"group_manager"===e?(t="Manager",n="The group manager agent"):(t=ve(e.replace("_proxy","").replace("_"," ")),n=`A new ${t} agent`);const a=new xe({id:`wa-${ee()}`,agentType:e,name:t,description:n,tags:[],requirements:[],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),data:new p});return we(a,e),a}}const we=(e,t)=>{e.data.humanInputMode="NEVER",["user_proxy","rag_user_proxy"].includes(t)&&(e.data.humanInputMode="ALWAYS","rag_user_proxy"===t&&Ce(e.data)),"reasoning"===t&&ke(e.data),"captain"===t&&je(e.data),"group_manager"===t&&Ae(e.data)},Ce=e=>{e.retrieveConfig={task:"default",vectorDb:"chroma",dbConfig:{model:"all-MiniLM-L6-v2",useMemory:!1,useLocalStorage:!1,localStoragePath:null,connectionUrl:null,waitUntilIndexReady:null,waitUntilDocumentReady:null,metadata:null},docsPath:[],newDocs:!0,model:null,chunkTokenSize:null,contextMaxTokens:null,chunkMode:"multi_lines",mustBreakAtEmptyLine:!0,useCustomEmbedding:!1,embeddingFunction:null,customizedPrompt:null,customizedAnswerPrefix:null,updateContext:!0,collectionName:"autogen-docs",getOrCreate:!0,overwrite:!1,useCustomTokenCount:!1,customTokenCountFunction:null,useCustomTextSplit:!1,customTextSplitFunction:null,customTextTypes:[],recursive:!0,distanceThreshold:-1,nResults:null}},ke=e=>{e.verbose=!0,e.reasonConfig={method:"beam_search",maxDepth:3,forestSize:1,ratingScale:10,beamSize:3,answerApproach:"pool",nsim:3,explorationConstant:1.41}},je=e=>{e.agentLib=[],e.toolLib=null,e.maxRound=10,e.maxTurns=5},Ae=e=>{e.groupName="Group",e.maxRound=20,e.adminName=null,e.contextVariables={},e.enableClearHistory=!1,e.sendIntroductions=!1,e.initialAgentId=void 0,e.speakers={selectionMethod:"auto",selectionCustomMethod:"",maxRetriesForSelecting:null,selectionMode:"repeat",allowRepeat:!0,allowedOrDisallowedTransitions:{},transitionsType:"allowed"}},Se=["AgentTarget","RandomAgentTarget","GroupChatTarget","NestedChatTarget","AskUserTarget","GroupManagerTarget","RevertToUserTarget","StayTarget","TerminateTarget"],Ne=["string_llm","context_str_llm","string_context","expression_context"];class Te extends p{isMultimodal;constructor(e={humanInputMode:"NEVER",systemMessage:null,codeExecutionConfig:!1,agentDefaultAutoReply:null,maxConsecutiveAutoReply:null,termination:{type:"none",keywords:[],criterion:null,methodContent:null},modelIds:[],tools:[],parentId:void 0,nestedChats:[{messages:[],triggeredBy:[],condition:{conditionType:"string_llm",prompt:""},available:{type:"none",value:""}}],contextVariables:{},updateAgentStateBeforeReply:[],afterWork:null,handoffs:[],isMultimodal:!1}){super(e),this.isMultimodal=e.isMultimodal}}class Ee extends xe{data;agentType="assistant";constructor(e){super(e),this.agentType="assistant",this.data=e.data,this.rest=e.rest||{}}}class _e extends p{agentLib;toolLib;maxRound;maxTurns;constructor(e={humanInputMode:"NEVER",systemMessage:null,codeExecutionConfig:!1,agentDefaultAutoReply:null,maxConsecutiveAutoReply:null,termination:{type:"none",keywords:[],criterion:null,methodContent:null},modelIds:[],tools:[],parentId:void 0,nestedChats:[{messages:[],triggeredBy:[],condition:{conditionType:"string_llm",prompt:""},available:{type:"none",value:""}}],contextVariables:{},updateAgentStateBeforeReply:[],handoffs:[],afterWork:null,agentLib:[],toolLib:null,maxRound:10,maxTurns:5}){super(e),this.agentLib=e.agentLib,this.toolLib=e.toolLib,this.maxRound=e.maxRound,this.maxTurns=e.maxTurns}}class Me extends xe{data;agentType="captain";constructor(e){super(e),this.data=e.data,this.agentType="captain",this.rest=e.rest||{}}}class Ie extends p{collectionName;resetCollection;parsedDocsPath;queryEngine;constructor(e={humanInputMode:"NEVER",systemMessage:null,codeExecutionConfig:!1,agentDefaultAutoReply:null,maxConsecutiveAutoReply:null,termination:{type:"none",keywords:[],criterion:null,methodContent:null},modelIds:[],tools:[],parentId:void 0,nestedChats:[{messages:[],triggeredBy:[],condition:{conditionType:"string_llm",prompt:""},available:{type:"none",value:""}}],contextVariables:{},updateAgentStateBeforeReply:[],afterWork:null,handoffs:[],collectionName:null,resetCollection:!1,parsedDocsPath:null,queryEngine:null}){super(e),this.collectionName=e.collectionName??null,this.resetCollection=e.resetCollection??!1,this.parsedDocsPath=e.parsedDocsPath??null,this.queryEngine=e.queryEngine??null}}class De extends xe{data;agentType="doc_agent";constructor(e){super(e),this.agentType="doc_agent",this.data=e.data,this.rest=e.rest||{}}}class Re extends p{maxRound;adminName;speakers;enableClearHistory;sendIntroductions;groupName;initialAgentId;constructor(e={humanInputMode:"NEVER",systemMessage:null,codeExecutionConfig:!1,agentDefaultAutoReply:null,maxConsecutiveAutoReply:null,termination:{type:"none",keywords:[],criterion:null,methodContent:null},modelIds:[],tools:[],parentId:void 0,nestedChats:[{messages:[],triggeredBy:[],condition:{conditionType:"string_llm",prompt:""},available:{type:"none",value:""}}],contextVariables:{},updateAgentStateBeforeReply:[],afterWork:null,handoffs:[],maxRound:20,adminName:null,speakers:{selectionMethod:"auto",selectionCustomMethod:"",maxRetriesForSelecting:null,selectionMode:"repeat",allowRepeat:!0,allowedOrDisallowedTransitions:{},transitionsType:"allowed",order:[]},enableClearHistory:void 0,sendIntroductions:void 0,groupName:void 0,initialAgentId:void 0}){e.parentId=void 0,super(e),this.maxRound=e.maxRound,this.adminName=e.adminName,this.speakers=e.speakers,this.enableClearHistory=e.enableClearHistory,this.sendIntroductions=e.sendIntroductions,this.groupName=e.groupName,this.initialAgentId=e.initialAgentId}}class ze extends xe{data;agentType="group_manager";constructor(e){super(e),this.agentType="group_manager",this.data=e.data,this.rest=e.rest||{}}}const Oe={task:"default",vectorDb:"chroma",dbConfig:{model:"all-MiniLM-L6-v2",useMemory:!1,useLocalStorage:!1,localStoragePath:null,connectionUrl:null,waitUntilIndexReady:null,waitUntilDocumentReady:null,metadata:null},docsPath:[],newDocs:!0,model:null,chunkTokenSize:null,contextMaxTokens:null,chunkMode:"multi_lines",mustBreakAtEmptyLine:!0,useCustomEmbedding:!1,embeddingFunction:null,customizedPrompt:null,customizedAnswerPrefix:null,updateContext:!0,collectionName:"autogen-docs",getOrCreate:!0,overwrite:!1,useCustomTokenCount:!1,customTokenCountFunction:null,useCustomTextSplit:!1,customTextSplitFunction:null,customTextTypes:[],recursive:!0,distanceThreshold:-1,nResults:null};class Le extends p{retrieveConfig;constructor(e={humanInputMode:"ALWAYS",systemMessage:null,codeExecutionConfig:!1,agentDefaultAutoReply:null,maxConsecutiveAutoReply:null,termination:{type:"none",keywords:[],criterion:null,methodContent:null},modelIds:[],tools:[],parentId:void 0,nestedChats:[{messages:[],triggeredBy:[],condition:{conditionType:"string_llm",prompt:""},available:{type:"none",value:""}}],contextVariables:{},updateAgentStateBeforeReply:[],afterWork:null,handoffs:[],retrieveConfig:Oe}){super(e),this.retrieveConfig=e.retrieveConfig}}class Pe extends xe{data;agentType="rag_user_proxy";constructor(e){super(e),this.data=e.data,this.agentType="rag_user_proxy",this.rest=e.rest||{}}}const Be={method:"beam_search",maxDepth:3,forestSize:1,ratingScale:10,beamSize:3,answerApproach:"pool",nsim:3,explorationConstant:1.41};class Fe extends p{verbose;reasonConfig;constructor(e={humanInputMode:"NEVER",systemMessage:null,codeExecutionConfig:!1,agentDefaultAutoReply:null,maxConsecutiveAutoReply:null,termination:{type:"none",keywords:[],criterion:null,methodContent:null},modelIds:[],tools:[],parentId:void 0,nestedChats:[{messages:[],triggeredBy:[],condition:{conditionType:"string_llm",prompt:""},available:{type:"none",value:""}}],contextVariables:{},updateAgentStateBeforeReply:[],handoffs:[],afterWork:null,verbose:!0,reasonConfig:Be}){super(e),this.verbose=e.verbose,this.reasonConfig=e.reasonConfig}}let Ue=class extends xe{data;agentType="reasoning";constructor(e){super(e),this.data=e.data,this.agentType="reasoning",this.rest=e.rest||{}}};class He extends xe{data;agentType="user_proxy";constructor(e){super(e),this.agentType="user_proxy",this.data=e.data,this.rest=e.rest||{}}}const We=["user_proxy","assistant","rag_user_proxy","reasoning","captain","group_manager","doc_agent"],qe=e=>{const t=[];if("agentLib"in e&&Array.isArray(e.agentLib))for(const n of e.agentLib)"object"==typeof n&&"name"in n&&"description"in n&&"systemMessage"in n&&t.push(n);return t},Ve=e=>!("toolLib"in e)||"default"!==e.toolLib&&null!==e.toolLib?null:e.toolLib,Ge=e=>{if("maxRound"in e&&"number"==typeof e.maxRound){const t=parseInt(e.maxRound.toString(),10);if(t>0)return t}return 10},Ke=e=>{if("maxTurns"in e&&"number"==typeof e.maxTurns){const t=parseInt(e.maxTurns.toString(),10);if(t>0)return t}return 5},$e=e=>"type"in e&&"string"==typeof e.type&&["none","keyword","method"].includes(e.type)?e.type:"none",Ze=e=>{let t=[];return"keywords"in e&&Array.isArray(e.keywords)&&(t=e.keywords.filter(e=>"string"==typeof e)),t},Qe=e=>"criterion"in e&&"string"==typeof e.criterion&&["found","ending","exact"].includes(e.criterion)?e.criterion:null,Ye=e=>"methodContent"in e&&"string"==typeof e.methodContent?e.methodContent:null,Xe=e=>{let t=`w-${ee()}`;if("id"in e&&"string"==typeof e.id)t=e.id;else if("type"in e&&"string"==typeof e.type&&e.type.length>0){const n=e.type[0]?.toLowerCase();t=`w${n}-${ee()}`}return t},Je=(e,t)=>{let n=t;return"name"in e&&"string"==typeof e.name?n=e.name:"label"in e&&"string"==typeof e.label&&(n=e.label),n},et=(e,t)=>{let n=t;return"description"in e&&"string"==typeof e.description&&(n=e.description),n},tt=e=>{let t=[];return"tags"in e&&Array.isArray(e.tags)&&(t=e.tags.filter(e=>"string"==typeof e)),t},nt=e=>{let t=[];return"requirements"in e&&Array.isArray(e.requirements)&&(t=e.requirements.filter(e=>"string"==typeof e)),t},at=e=>{let t=(new Date).toISOString();return"createdAt"in e&&"string"==typeof e.createdAt&&(t=e.createdAt),t},st=e=>{let t=(new Date).toISOString();return"updatedAt"in e&&"string"==typeof e.updatedAt&&(t=e.updatedAt),t},rt=(e,t)=>{const n={};return Object.keys(e).forEach(a=>{t.includes(a)||(n[a]=e[a])}),n},ot=(e,t)=>{const n={x:20,y:20};return t&&(n.x=t.x,n.y=t.y),"rest"in e&&"object"==typeof e.rest&&e.rest&&"position"in e.rest&&e.rest.position?"object"==typeof e.rest.position&&"x"in e.rest.position&&"number"==typeof e.rest.position.x&&"y"in e.rest.position&&"number"==typeof e.rest.position.y&&(n.x=e.rest.position.x,n.y=e.rest.position.y):"position"in e&&"object"==typeof e.position&&e.position&&"x"in e.position&&"number"==typeof e.position.x&&"y"in e.position&&"number"==typeof e.position.y&&(n.x=e.position.x,n.y=e.position.y),n},it=e=>{const t={type:"none",value:""};return"available"in e&&e.available&&"object"==typeof e.available&&("type"in e.available&&"string"==typeof e.available.type&&["string","expression","none"].includes(e.available.type)&&(t.type=e.available.type),"value"in e.available&&"string"==typeof e.available.value&&(t.value=e.available.value)),t},lt=(e,t="")=>{let n={conditionType:"string_llm",prompt:t};if("condition"in e&&e.condition&&"object"==typeof e.condition&&"conditionType"in e.condition&&e.condition.conditionType&&Ne.includes(e.condition.conditionType)){switch(e.condition.conditionType){case"string_llm":n=((e,t="")=>{let n={conditionType:"string_llm",prompt:t};return"conditionType"in e&&"string_llm"===e.conditionType&&"prompt"in e&&"string"==typeof e.prompt&&(n={conditionType:"string_llm",prompt:e.prompt}),n})(e.condition,t);break;case"context_str_llm":n=(e=>{let t={conditionType:"context_str_llm",context_str:""};return"conditionType"in e&&"context_str_llm"===e.conditionType&&"context_str"in e&&"string"==typeof e.context_str&&(t={conditionType:"context_str_llm",context_str:e.context_str}),t})(e.condition);break;case"string_context":n=(e=>{let t={conditionType:"string_context",variable_name:""};return"conditionType"in e&&"string_context"===e.conditionType&&"variable_name"in e&&"string"==typeof e.variable_name&&(t={conditionType:"string_context",variable_name:e.variable_name}),t})(e.condition);break;case"expression_context":n=(e=>{let t={conditionType:"expression_context",expression:""};return"conditionType"in e&&"expression_context"===e.conditionType&&"expression"in e&&"string"==typeof e.expression&&(t={conditionType:"expression_context",expression:e.expression}),t})(e.condition)}}return n},ct=e=>"afterWork"in e&&"object"==typeof e.afterWork&&e.afterWork&&(e=>{if(!e||"object"!=typeof e)return!1;const t=e;return"targetType"in t&&"string"==typeof t.targetType&&!!Se.includes(t.targetType)&&"value"in t&&Array.isArray(t.value)&&t.value.every(e=>"string"==typeof e)})(e.afterWork)?e.afterWork:null,dt=["user_proxy","assistant","captain","rag_user_proxy","reasoning","group_manager","doc_agent"],ut=(e,t)=>{const n=((e,t)=>{let n="Agent";return"user_proxy"===t?n="user_proxy":"assistant"===t?n="Assistant":"rag_user_proxy"===t?n="RAG User":"reasoning"===t?n="Reasoning Agent":"captain"===t?n="Captain":"group_manager"===t&&(n="Group Manager"),Je(e,n)})(e,t),a=(e=>{let t="An agent";return"user_proxy"===e?t="A user agent":"assistant"===e?t="An assistant agent":"rag_user_proxy"===e?t="A RAG user agent":"reasoning"===e?t="A reasoning agent":"captain"===e&&(t="A captain agent"),t})(t);return{name:n,description:et(e,a),tags:tt(e),requirements:nt(e),createdAt:at(e),updatedAt:st(e)}},ht=e=>"isMultimodal"in e&&"boolean"==typeof e.isMultimodal?e.isMultimodal:"is_multimodal"in e&&"boolean"==typeof e.is_multimodal&&e.is_multimodal,pt=e=>{let t=[];return"messages"in e&&Array.isArray(e.messages)&&(t=e.messages.filter(e=>"object"==typeof e&&e&&"id"in e&&"string"==typeof e.id&&"isReply"in e&&"boolean"==typeof e.isReply)),t},mt=(e,t)=>{const n=(e=>"systemMessage"in e&&"string"==typeof e.systemMessage?e.systemMessage:null)(e),a=((e,t)=>{let n="NEVER";return["user_proxy","rag_user_proxy"].includes(t)&&(n="ALWAYS"),"humanInputMode"in e&&"string"==typeof e.humanInputMode&&["ALWAYS","NEVER","TERMINATE"].includes(e.humanInputMode)&&(n=e.humanInputMode),n})(e,t),s=(e=>!(!("codeExecutionConfig"in e)||"object"!=typeof e.codeExecutionConfig||!e.codeExecutionConfig)&&e.codeExecutionConfig)(e),r=(e=>"agentDefaultAutoReply"in e&&"string"==typeof e.agentDefaultAutoReply?e.agentDefaultAutoReply:null)(e),o=(e=>"maxConsecutiveAutoReply"in e&&"number"==typeof e.maxConsecutiveAutoReply?e.maxConsecutiveAutoReply:null)(e),i=(e=>{if("termination"in e&&"object"==typeof e.termination&&e.termination){const t=e.termination;return{type:$e(t),keywords:Ze(t),criterion:Qe(t),methodContent:Ye(t)}}return{type:"none",keywords:[],criterion:null,methodContent:null}})(e),l=(e=>{const t=[];if("modelIds"in e&&Array.isArray(e.modelIds))for(const n of e.modelIds)"string"==typeof n&&t.push(n);return t})(e),c=(e=>{let t=[];return"tools"in e&&Array.isArray(e.tools)&&(t=e.tools.filter(e=>"object"==typeof e&&e&&"id"in e&&"executorId"in e&&"string"==typeof e.id&&"string"==typeof e.executorId)),t})(e),d=(e=>{if("parentId"in e&&"string"==typeof e.parentId)return e.parentId})(e),u=(e=>{const t=[],n={conditionType:"string_llm",prompt:""};if("nestedChats"in e&&Array.isArray(e.nestedChats))for(const a of e.nestedChats){let e=[];"triggeredBy"in a&&Array.isArray(a.triggeredBy)&&(e=a.triggeredBy.filter(e=>"string"==typeof e));const n=pt(a),s=lt(a,""),r=it(a);t.push({triggeredBy:e,messages:n,condition:s,available:r})}return 0===t.length&&t.push({triggeredBy:[],messages:[],condition:n,available:{type:"none",value:""}}),t})(e),h=(e=>"contextVariables"in e&&"object"==typeof e.contextVariables?e.contextVariables:{})(e),m=(e=>{if("updateAgentStateBeforeReply"in e&&"object"==typeof e.updateAgentStateBeforeReply&&e.updateAgentStateBeforeReply)if("type"in e.updateAgentStateBeforeReply&&"content"in e.updateAgentStateBeforeReply){if("string"==typeof e.updateAgentStateBeforeReply.type&&"string"==typeof e.updateAgentStateBeforeReply.content){if("string"===e.updateAgentStateBeforeReply.type)return[{type:"string",content:e.updateAgentStateBeforeReply.content}];if("callable"===e.updateAgentStateBeforeReply.type)return[{type:"callable",content:e.updateAgentStateBeforeReply.content}]}}else if(Array.isArray(e.updateAgentStateBeforeReply))return e.updateAgentStateBeforeReply.filter(e=>"object"==typeof e&&e&&"type"in e&&"string"==typeof e.type&&"content"in e&&"string"==typeof e.content);return[]})(e),g=ct(e),f=(e=>"handoffs"in e&&Array.isArray(e.handoffs)?e.handoffs.filter(e=>"string"==typeof e):[])(e);return new p({systemMessage:n,humanInputMode:a,codeExecutionConfig:s,agentDefaultAutoReply:r,maxConsecutiveAutoReply:o,termination:i,modelIds:l,tools:c,parentId:d,nestedChats:u,contextVariables:h,updateAgentStateBeforeReply:m,afterWork:g,handoffs:f})},gt=e=>e.collectionName?String(e.collectionName):null,ft=e=>!0===e.resetCollection||"true"===String(e.resetCollection).toLowerCase(),yt=e=>{if(!e.queryEngine)return null;let t="VectorChromaQueryEngine";e.queryEngine.type&&"string"==typeof e.queryEngine.type&&["VectorChromaQueryEngine","VectorChromaCitationQueryEngine","InMemoryQueryEngine"].includes(e.queryEngine.type)&&(t=e.queryEngine.type);let n=null;e.queryEngine.dbPath&&"string"==typeof e.queryEngine.dbPath&&(n=e.queryEngine.dbPath);let a,s=!1;return e.queryEngine.enableQueryCitations&&"boolean"==typeof e.queryEngine.enableQueryCitations&&(s=e.queryEngine.enableQueryCitations),e.queryEngine.citationChunkSize&&"number"==typeof e.queryEngine.citationChunkSize&&e.queryEngine.citationChunkSize>0&&(a=e.queryEngine.citationChunkSize),{type:t,dbPath:n,enableQueryCitations:s,citationChunkSize:a}},bt=e=>e.parsedDocsPath?String(e.parsedDocsPath):null,vt=e=>{let t={selectionMethod:"auto",selectionCustomMethod:"",maxRetriesForSelecting:null,selectionMode:"repeat",allowRepeat:!0,allowedOrDisallowedTransitions:{},transitionsType:"allowed",order:[]};if("speakers"in e&&"object"==typeof e.speakers){const n=e.speakers;t={selectionMethod:St(n),selectionCustomMethod:Nt(n),maxRetriesForSelecting:Tt(n),selectionMode:Et(n),allowRepeat:_t(n),allowedOrDisallowedTransitions:Mt(n),transitionsType:It(n),order:Dt(n)}}return t},xt=e=>{let t=20;if("maxRound"in e&&"number"==typeof e.maxRound)try{t=parseInt(e.maxRound.toString(),10)}catch(n){}return t},wt=e=>{let t=null;return"adminName"in e&&"string"==typeof e.adminName&&(t=e.adminName),t},Ct=e=>{let t=!1;return"enableClearHistory"in e&&"boolean"==typeof e.enableClearHistory&&(t=e.enableClearHistory),t},kt=e=>{let t=!1;return"sendIntroductions"in e&&"boolean"==typeof e.sendIntroductions&&(t=e.sendIntroductions),t},jt=e=>{let t;return"groupName"in e&&"string"==typeof e.groupName&&(t=e.groupName),t},At=e=>{let t;return"initialAgentId"in e&&"string"==typeof e.initialAgentId&&(t=e.initialAgentId),t},St=e=>{let t="auto";return"selectionMethod"in e&&"string"==typeof e.selectionMethod&&["auto","manual","random","round_robin","default"].includes(e.selectionMethod)&&(t=e.selectionMethod),t},Nt=e=>{let t="";return"selectionCustomMethod"in e&&"string"==typeof e.selectionCustomMethod&&(t=e.selectionCustomMethod),t},Tt=e=>{let t=null;return"maxRetriesForSelecting"in e&&"number"==typeof e.maxRetriesForSelecting&&(t=e.maxRetriesForSelecting),t},Et=e=>{let t="repeat";return"selectionMode"in e&&"string"==typeof e.selectionMode&&["repeat","transition"].includes(e.selectionMode)&&(t=e.selectionMode),t},_t=e=>{let t=!0;return"allowRepeat"in e&&"boolean"==typeof e.allowRepeat&&(t=e.allowRepeat),t},Mt=e=>{let t={};if("allowedOrDisallowedTransitions"in e&&"object"==typeof e.allowedOrDisallowedTransitions&&e.allowedOrDisallowedTransitions){const n={};for(const[t,a]of Object.entries(e.allowedOrDisallowedTransitions))"string"==typeof t&&Array.isArray(a)&&(n[t]=a.filter(e=>"string"==typeof e));t=n}return t},It=e=>{let t="allowed";return"transitionsType"in e&&"string"==typeof e.transitionsType&&["allowed","disallowed"].includes(e.transitionsType)&&(t=e.transitionsType),t},Dt=e=>{let t=[];return"order"in e&&Array.isArray(e.order)&&(t=e.order.filter(e=>"string"==typeof e)),t},Rt=e=>"object"!=typeof e||("verbose"in e&&"boolean"==typeof e.verbose?e.verbose:!("data"in e)||"object"!=typeof e.data||!("verbose"in e.data)||"boolean"!=typeof e.data.verbose||e.data.verbose),zt=e=>{if("object"!=typeof e)return Be;let t=null;return"reasonConfig"in e&&"object"==typeof e.reasonConfig&&e.reasonConfig?t=e.reasonConfig:"data"in e&&"object"==typeof e.data&&e.data&&"reasonConfig"in e.data&&"object"==typeof e.data.reasonConfig&&e.data.reasonConfig&&(t=e.data.reasonConfig),t?{method:Ot(t),maxDepth:Lt(t),forestSize:Pt(t),ratingScale:Bt(t),beamSize:Ft(t),answerApproach:Ut(t),nsim:Ht(t),explorationConstant:Wt(t)}:Be},Ot=e=>"method"in e&&"string"==typeof e.method&&["beam_search","mcts","lats","dfs"].includes(e.method)?e.method:"beam_search",Lt=e=>"maxDepth"in e&&"number"==typeof e.maxDepth?e.maxDepth:3,Pt=e=>"forestSize"in e&&"number"==typeof e.forestSize?e.forestSize:1,Bt=e=>"ratingScale"in e&&"number"==typeof e.ratingScale?e.ratingScale:10,Ft=e=>"beamSize"in e&&"number"==typeof e.beamSize?e.beamSize:3,Ut=e=>"answerApproach"in e&&"string"==typeof e.answerApproach&&["pool","best"].includes(e.answerApproach)?e.answerApproach:"pool",Ht=e=>"nsim"in e&&"number"==typeof e.nsim?e.nsim:3,Wt=e=>"explorationConstant"in e&&"number"==typeof e.explorationConstant?e.explorationConstant:1.41,qt=e=>{if("object"!=typeof e)return Oe;let t=null;return"retrieveConfig"in e&&"object"==typeof e.retrieveConfig&&e.retrieveConfig?t=e.retrieveConfig:"data"in e&&"object"==typeof e.data&&e.data&&"retrieveConfig"in e.data&&"object"==typeof e.data.retrieveConfig&&e.data.retrieveConfig&&(t=e.data.retrieveConfig),t?{task:Vt(t),vectorDb:Gt(t),dbConfig:tn(t),docsPath:nn(t),newDocs:an(t),model:sn(t),chunkTokenSize:rn(t),contextMaxTokens:on(t),chunkMode:ln(t),mustBreakAtEmptyLine:cn(t),useCustomEmbedding:dn(t),embeddingFunction:un(t),customizedPrompt:hn(t),customizedAnswerPrefix:pn(t),updateContext:mn(t),collectionName:gn(t),getOrCreate:fn(t),overwrite:yn(t),useCustomTokenCount:bn(t),customTokenCountFunction:vn(t),useCustomTextSplit:xn(t),customTextSplitFunction:wn(t),customTextTypes:Cn(t),recursive:kn(t),distanceThreshold:jn(t),nResults:An(t)}:Oe},Vt=e=>{let t="default";return"task"in e&&"string"==typeof e.task&&["code","qa","default"].includes(e.task)&&(t=e.task),t},Gt=e=>{let t="chroma";return"vectorDb"in e&&"string"==typeof e.vectorDb&&["chroma","pgvector","mongodb","qdrant"].includes(e.vectorDb)&&(t=e.vectorDb),t},Kt=e=>{let t="all-MiniLM-L6-v2";return"model"in e&&"string"==typeof e.model&&e.model.length>0&&(t=e.model),t},$t=e=>{let t=!1;return"useMemory"in e&&"boolean"==typeof e.useMemory&&(t=e.useMemory),t},Zt=e=>{let t=!1;return"useLocalStorage"in e&&"boolean"==typeof e.useLocalStorage&&(t=e.useLocalStorage),t},Qt=e=>{let t=null;return"localStoragePath"in e&&"string"==typeof e.localStoragePath&&e.localStoragePath.length>0&&(t=e.localStoragePath),t},Yt=e=>{let t=null;return"connectionUrl"in e&&"string"==typeof e.connectionUrl&&e.connectionUrl.length>0&&(t=e.connectionUrl),t},Xt=e=>{let t=null;return"waitUntilIndexReady"in e&&"boolean"==typeof e.waitUntilIndexReady&&(t=e.waitUntilIndexReady),t},Jt=e=>{let t=null;return"waitUntilDocumentReady"in e&&"boolean"==typeof e.waitUntilDocumentReady&&(t=e.waitUntilDocumentReady),t},en=e=>{let t=null;return"metadata"in e&&"object"==typeof e.metadata&&e.metadata&&(t=e.metadata),t},tn=e=>{let t={model:"all-MiniLM-L6-v2",useMemory:!1,useLocalStorage:!1,localStoragePath:null,connectionUrl:null,waitUntilIndexReady:null,waitUntilDocumentReady:null,metadata:null};return"dbConfig"in e&&"object"==typeof e.dbConfig&&(t={model:Kt(e.dbConfig),useMemory:$t(e.dbConfig),useLocalStorage:Zt(e.dbConfig),localStoragePath:Qt(e.dbConfig),connectionUrl:Yt(e.dbConfig),waitUntilIndexReady:Xt(e.dbConfig),waitUntilDocumentReady:Jt(e.dbConfig),metadata:en(e.dbConfig)}),t},nn=e=>{let t=[];return"docsPath"in e&&Array.isArray(e.docsPath)&&e.docsPath.length>0&&(t=e.docsPath.filter(e=>"string"==typeof e&&e.length>0)),t},an=e=>{let t=!0;return"newDocs"in e&&"boolean"==typeof e.newDocs&&(t=e.newDocs),t},sn=e=>{let t=null;return"model"in e&&"string"==typeof e.model&&(t=e.model),t},rn=e=>{let t=null;return"chunkTokenSize"in e&&"number"==typeof e.chunkTokenSize&&(t=e.chunkTokenSize),t},on=e=>{let t=null;return"contextMaxTokens"in e&&"number"==typeof e.contextMaxTokens&&(t=e.contextMaxTokens),t},ln=e=>{let t="multi_lines";return"chunkMode"in e&&"string"==typeof e.chunkMode&&["multi_lines","one_line"].includes(e.chunkMode)&&(t=e.chunkMode),t},cn=e=>{let t=!0;return"mustBreakAtEmptyLine"in e&&"boolean"==typeof e.mustBreakAtEmptyLine&&(t=e.mustBreakAtEmptyLine),t},dn=e=>{let t=!1;return"useCustomEmbedding"in e&&"boolean"==typeof e.useCustomEmbedding&&(t=e.useCustomEmbedding),t},un=e=>{let t=null;return"embeddingFunction"in e&&"string"==typeof e.embeddingFunction&&(t=e.embeddingFunction),t},hn=e=>{let t=null;return"customizedPrompt"in e&&"string"==typeof e.customizedPrompt&&(t=e.customizedPrompt),t},pn=e=>{let t=null;return"customizedAnswerPrefix"in e&&"string"==typeof e.customizedAnswerPrefix&&(t=e.customizedAnswerPrefix),t},mn=e=>{let t=!0;return"updateContext"in e&&"boolean"==typeof e.updateContext&&(t=e.updateContext),t},gn=e=>{let t="autogen-docs";return"collectionName"in e&&"string"==typeof e.collectionName&&(t=e.collectionName),t},fn=e=>{let t=!0;return"getOrCreate"in e&&"boolean"==typeof e.getOrCreate&&(t=e.getOrCreate),t},yn=e=>{let t=!1;return"overwrite"in e&&"boolean"==typeof e.overwrite&&(t=e.overwrite),t},bn=e=>{let t=!1;return"useCustomTokenCount"in e&&"boolean"==typeof e.useCustomTokenCount&&(t=e.useCustomTokenCount),t},vn=e=>{let t=null;return"customTokenCountFunction"in e&&"string"==typeof e.customTokenCountFunction&&(t=e.customTokenCountFunction),t},xn=e=>{let t=!1;return"useCustomTextSplit"in e&&"boolean"==typeof e.useCustomTextSplit&&(t=e.useCustomTextSplit),t},wn=e=>{let t=null;return"customTextSplitFunction"in e&&"string"==typeof e.customTextSplitFunction&&(t=e.customTextSplitFunction),t},Cn=e=>{let t=[];return"customTextTypes"in e&&Array.isArray(e.customTextTypes)&&e.customTextTypes.length>0&&(t=e.customTextTypes.filter(e=>"string"==typeof e&&e.length>0)),t},kn=e=>{let t=!0;return"recursive"in e&&"boolean"==typeof e.recursive&&(t=e.recursive),t},jn=e=>{let t=-1;return"distanceThreshold"in e&&"number"==typeof e.distanceThreshold&&(t=e.distanceThreshold),t},An=e=>{let t=null;return"nResults"in e&&"number"==typeof e.nResults&&(t=e.nResults),t},Sn={agent:"#005490",assistant:"#66bc57",captain:"#0e2766",user_proxy:"#bc76f5",rag_user_proxy:"#e34561",doc_agent:"#e34561",reasoning:"#63D0D4",group_manager:"#ed8a34"},Nn={agent:"#005490",assistant:"#66bc57",captain:"#284ca4",user_proxy:"#bc76f5",rag_user_proxy:"#e34561",doc_agent:"#e34561",reasoning:"#63D0D4",group_manager:"#ed8a34"},Tn="data:image/svg+xml,%3csvg%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2016%2016'%3e%3cpath%20d='M16%208.016A8.522%208.522%200%20008.016%2016h-.032A8.521%208.521%200%20000%208.016v-.032A8.521%208.521%200%20007.984%200h.032A8.522%208.522%200%200016%207.984v.032z'%20fill='url(%23prefix__paint0_radial_980_20147)'/%3e%3cdefs%3e%3cradialGradient%20id='prefix__paint0_radial_980_20147'%20cx='0'%20cy='0'%20r='1'%20gradientUnits='userSpaceOnUse'%20gradientTransform='matrix(16.1326%205.4553%20-43.70045%20129.2322%201.588%206.503)'%3e%3cstop%20offset='.067'%20stop-color='%239168C0'/%3e%3cstop%20offset='.343'%20stop-color='%235684D1'/%3e%3cstop%20offset='.672'%20stop-color='%231BA1E3'/%3e%3c/radialGradient%3e%3c/defs%3e%3c/svg%3e",En="data:image/webp;base64,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",_n={openai:"data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20viewBox='0%200%20320%20320'%20version='1.1'%20id='svg7'%20width='320'%20height='320'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:svg='http://www.w3.org/2000/svg'%3e%3cdefs%20id='defs7'%20/%3e%3cpath%20d='M%20298.89867,130.97427%20C%20306.25636,109.18381%20303.72272,85.313302%20291.9565,65.492879%20274.26156,35.092232%20238.68927,19.451898%20203.94801,26.812055%20188.49281,9.6316894%20166.288,-0.13851872%20143.00893,0.00148426%20107.49744,-0.07851744%2075.989107,22.481963%2065.064056,55.822673%2042.25117,60.432772%2022.559727,74.523072%2011.036736,94.493497%20-6.7899476,124.81414%20-2.7259906,163.03495%2021.090216,189.03551%20c%20-7.357688,21.79046%20-4.824049,45.66097%206.942171,65.48139%2017.694935,30.40065%2053.267228,46.04098%2088.008483,38.68083%2015.44507,17.18036%2037.66001,26.95057%2060.93909,26.80057%2035.53175,0.09%2067.05022,-22.49048%2077.97527,-55.86119%2022.81289,-4.6101%2042.50433,-18.7004%2054.02732,-38.67083%2017.80642,-30.32064%2013.73233,-68.51146%20-10.07375,-94.51201%20z%20M%20177.00023,299.08785%20c%20-14.21879,0.02%20-27.99165,-4.8901%20-38.90656,-13.88029%200.49659,-0.26001%201.35803,-0.73002%201.91543,-1.07003%20l%2064.57739,-36.80078%20c%203.30386,-1.85004%205.33078,-5.32011%205.31051,-9.07019%20v%20-89.83192%20l%2027.29236,15.55033%20c%200.2939,0.14001%200.48646,0.42001%200.52699,0.74002%20v%2074.39158%20c%20-0.0405,33.08071%20-27.19101,59.90128%20-60.71612,59.97128%20z%20M%2046.426607,244.05668%20c%20-7.124593,-12.14026%20-9.688636,-26.37056%20-7.246208,-40.18086%200.476324,0.28001%201.317492,0.79002%201.915431,1.13003%20l%2064.57739,36.80078%20c%203.27346,1.89004%207.32728,1.89004%2010.61088,0%20l%2078.83671,-44.92096%20v%2031.10067%20c%200.0203,0.32%20-0.13175,0.63001%20-0.38511,0.83002%20l%20-65.27668,37.19079%20C%20100.38298,282.5275%2063.24997,272.70729%2046.436741,244.05668%20Z%20M%2029.430956,104.96372%20c%207.094189,-12.160259%2018.292874,-21.460457%2031.62995,-26.29056%200,0.550012%20-0.0304,1.520033%20-0.0304,2.200047%20v%2073.611563%20c%20-0.02027,3.74008%202.006642,7.21016%205.300373,9.06019%20l%2078.836711,44.91096%20-27.29236,15.55033%20c%20-0.27364,0.18001%20-0.61821,0.21001%20-0.92225,0.08%20L%2051.666172,186.86546%20C%2022.650938,170.28511%2012.698804,133.65433%2029.420821,104.97372%20Z%20m%20224.237184,51.49109%20-78.83671,-44.92095%2027.29236,-15.540331%20c%200.27363,-0.180004%200.61821,-0.210004%200.92225,-0.08%20l%2065.28681,37.190791%20c%2029.0659,16.57035%2039.02817,53.26113%2022.23521,81.94174%20-7.10432,12.14026%20-18.29287,21.44046%20-31.61981,26.28056%20v%20-75.81161%20c%200.0304,-3.74008%20-1.98637,-7.20016%20-5.26997,-9.0602%20z%20m%2027.16062,-40.34086%20c%20-0.47633,-0.29%20-1.3175,-0.79001%20-1.91544,-1.13002%20L%20214.33593,78.18315%20c%20-3.27346,-1.890041%20-7.32728,-1.890041%20-10.61088,0%20L%20124.88834,123.1041%20V%2092.003444%20c%20-0.0203,-0.320007%200.13175,-0.630013%200.38511,-0.830017%20l%2065.27668,-37.160792%20c%2029.07604,-16.550353%2066.24959,-6.700143%2083.01215,22.000469%207.08405,12.120258%209.6481,26.310556%207.24621,40.100846%20z%20M%20110.05135,171.54513%2082.748856,155.9948%20c%20-0.293902,-0.14%20-0.486458,-0.42001%20-0.526997,-0.74001%20V%2080.863207%20c%200.02027,-33.120706%2027.251821,-59.961278%2060.817471,-59.941277%2014.19851,0%2027.94097,4.920105%2038.85589,13.880295%20-0.4966,0.260006%20-1.3479,0.730016%20-1.91543,1.070023%20l%20-64.5774,36.800784%20c%20-3.30386,1.85004%20-5.33077,5.310113%20-5.3105,9.060193%20l%20-0.0405,89.791905%20z%20m%2014.82685,-31.54067%2035.11624,-20.01042%2035.11624,20.00042%20v%2040.01086%20l%20-35.11624,20.00042%20-35.11624,-20.00042%20z'%20id='path7'%20style='stroke-width:1.00672'%20/%3e%3c/svg%3e",azure:"data:image/svg+xml,%3csvg%20width='150'%20height='150'%20viewBox='0%200%2096%2096'%20xmlns='http://www.w3.org/2000/svg'%3e%3cdefs%3e%3clinearGradient%20id='e399c19f-b68f-429d-b176-18c2117ff73c'%20x1='-1032.172'%20x2='-1059.213'%20y1='145.312'%20y2='65.426'%20gradientTransform='matrix(1%200%200%20-1%201075%20158)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%23114a8b'/%3e%3cstop%20offset='1'%20stop-color='%230669bc'/%3e%3c/linearGradient%3e%3clinearGradient%20id='ac2a6fc2-ca48-4327-9a3c-d4dcc3256e15'%20x1='-1023.725'%20x2='-1029.98'%20y1='108.083'%20y2='105.968'%20gradientTransform='matrix(1%200%200%20-1%201075%20158)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-opacity='.3'/%3e%3cstop%20offset='.071'%20stop-opacity='.2'/%3e%3cstop%20offset='.321'%20stop-opacity='.1'/%3e%3cstop%20offset='.623'%20stop-opacity='.05'/%3e%3cstop%20offset='1'%20stop-opacity='0'/%3e%3c/linearGradient%3e%3clinearGradient%20id='a7fee970-a784-4bb1-af8d-63d18e5f7db9'%20x1='-1027.165'%20x2='-997.482'%20y1='147.642'%20y2='68.561'%20gradientTransform='matrix(1%200%200%20-1%201075%20158)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%233ccbf4'/%3e%3cstop%20offset='1'%20stop-color='%232892df'/%3e%3c/linearGradient%3e%3c/defs%3e%3cpath%20fill='url(%23e399c19f-b68f-429d-b176-18c2117ff73c)'%20d='M33.338%206.544h26.038l-27.03%2080.087a4.152%204.152%200%200%201-3.933%202.824H8.149a4.145%204.145%200%200%201-3.928-5.47L29.404%209.368a4.152%204.152%200%200%201%203.934-2.825z'/%3e%3cpath%20fill='%230078d4'%20d='M71.175%2060.261h-41.29a1.911%201.911%200%200%200-1.305%203.309l26.532%2024.764a4.171%204.171%200%200%200%202.846%201.121h23.38z'/%3e%3cpath%20fill='url(%23ac2a6fc2-ca48-4327-9a3c-d4dcc3256e15)'%20d='M33.338%206.544a4.118%204.118%200%200%200-3.943%202.879L4.252%2083.917a4.14%204.14%200%200%200%203.908%205.538h20.787a4.443%204.443%200%200%200%203.41-2.9l5.014-14.777%2017.91%2016.705a4.237%204.237%200%200%200%202.666.972H81.24L71.024%2060.261l-29.781.007L59.47%206.544z'/%3e%3cpath%20fill='url(%23a7fee970-a784-4bb1-af8d-63d18e5f7db9)'%20d='M66.595%209.364a4.145%204.145%200%200%200-3.928-2.82H33.648a4.146%204.146%200%200%201%203.928%202.82l25.184%2074.62a4.146%204.146%200%200%201-3.928%205.472h29.02a4.146%204.146%200%200%200%203.927-5.472z'/%3e%3c/svg%3e",bedrock:"data:image/svg+xml,%3csvg%20fill='currentColor'%20fill-rule='evenodd'%20height='1em'%20style='flex:none;line-height:1'%20viewBox='0%200%2024%2024'%20width='1em'%20xmlns='http://www.w3.org/2000/svg'%3e%3ctitle%3eBedrock%3c/title%3e%3cpath%20d='M13.05%2015.513h3.08c.214%200%20.389.177.389.394v1.82a1.704%201.704%200%20011.296%201.661c0%20.943-.755%201.708-1.685%201.708-.931%200-1.686-.765-1.686-1.708%200-.807.554-1.484%201.297-1.662v-1.425h-2.69v4.663a.395.395%200%2001-.188.338l-2.69%201.641a.385.385%200%2001-.405-.002l-4.926-3.086a.395.395%200%2001-.185-.336V16.3L2.196%2014.87A.395.395%200%20012%2014.555L2%2014.528V9.406c0-.14.073-.27.192-.34l2.465-1.462V4.448c0-.129.062-.249.165-.322l.021-.014L9.77%201.058a.385.385%200%2001.407%200l2.69%201.675a.395.395%200%2001.185.336V7.6h3.856V5.683a1.704%201.704%200%2001-1.296-1.662c0-.943.755-1.708%201.685-1.708.931%200%201.685.765%201.685%201.708%200%20.807-.553%201.484-1.296%201.662v2.311a.391.391%200%2001-.389.394h-4.245v1.806h6.624a1.69%201.69%200%20011.64-1.313c.93%200%201.685.764%201.685%201.707%200%20.943-.754%201.708-1.685%201.708a1.69%201.69%200%2001-1.64-1.314H13.05v1.937h4.953l.915%201.18a1.66%201.66%200%2001.84-.227c.931%200%201.685.764%201.685%201.707%200%20.943-.754%201.708-1.685%201.708-.93%200-1.685-.765-1.685-1.708%200-.346.102-.668.276-.937l-.724-.935H13.05v1.806zM9.973%201.856L7.93%203.122V6.09h-.778V3.604L5.435%204.669v2.945l2.11%201.36L9.712%207.61V5.334h.778V7.83c0%20.136-.07.263-.184.335L7.963%209.638v2.081l1.422%201.009-.446.646-1.406-.998-1.53%201.005-.423-.66%201.605-1.055v-1.99L5.038%208.29l-2.26%201.34v1.676l1.972-1.189.398.677-2.37%201.429V14.3l2.166%201.258%202.27-1.368.397.677-2.176%201.311V19.3l1.876%201.175%202.365-1.426.398.678-2.017%201.216%201.918%201.201%202.298-1.403v-5.78l-4.758%202.893-.4-.675%205.158-3.136V3.289L9.972%201.856zM16.13%2018.47a.913.913%200%2000-.908.92c0%20.507.406.918.908.918a.913.913%200%2000.907-.919.913.913%200%2000-.907-.92zm3.63-3.81a.913.913%200%2000-.908.92c0%20.508.406.92.907.92a.913.913%200%2000.908-.92.913.913%200%2000-.908-.92zm1.555-4.99a.913.913%200%2000-.908.92c0%20.507.407.918.908.918a.913.913%200%2000.907-.919.913.913%200%2000-.907-.92zM17.296%203.1a.913.913%200%2000-.907.92c0%20.508.406.92.907.92a.913.913%200%2000.908-.92.913.913%200%2000-.908-.92z'%3e%3c/path%3e%3c/svg%3e",deepseek:"data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg:svg%20width='64'%20height='64'%20viewBox='0%200%2064%2064.000039'%20fill='none'%20version='1.1'%20id='svg7'%20xmlns:svg='http://www.w3.org/2000/svg'%3e%3csvg:path%20id='path7'%20d='m%2059.511568,14.791492%20c%20-0.5953,-0.29175%20-0.8517,0.26416%20-1.1998,0.54663%20-0.1191,0.09107%20-0.2198,0.20947%20-0.3206,0.31885%20-0.8701,0.9292%20-1.8867,1.53979%20-3.2148,1.4668%20-1.9417,-0.10938%20-3.5995,0.50122%20-5.065,1.98632%20-0.3114,-1.83129%20-1.3463,-2.9248%20-2.9217,-3.62622%20-0.8242,-0.3645%20-1.6577,-0.729%20-2.2348,-1.52172%20-0.4029,-0.5647%20-0.5129,-1.19336%20-0.7143,-1.812993%20-0.1283,-0.373535%20-0.2565,-0.756347%20-0.687,-0.820068%20-0.4671,-0.07275%20-0.6503,0.318848%20-0.8335,0.646973%20-0.7327,1.339358%20-1.0166,2.815428%20-0.9892,4.309568%200.0641,3.36206%201.4838,6.04057%204.3048,7.94487%200.3206,0.2187%200.403,0.4372%200.3023,0.7563%20-0.1924,0.656%20-0.4214,1.2937%20-0.6228,1.9497%20-0.1283,0.4192%20-0.3207,0.5103%20-0.7694,0.3279%20-1.5479,-0.6467%20-2.8852,-1.6035%20-4.0667,-2.7605%20-2.0058,-1.9407%20-3.8193,-4.08179%20-6.0815,-5.75831%20-0.5313,-0.39184%20-1.0625,-0.7561%20-1.6121,-1.10254%20-2.3081,-2.24121%200.3023,-4.08178%200.9068,-4.30029%200.6319,-0.22778%200.2198,-1.01147%20-1.8227,-1.0022%20-2.0425,0.009%20-3.9109,0.69239%20-6.2922,1.60352%20-0.348,0.13672%20-0.7145,0.23682%20-1.09,0.31885%20-2.1615,-0.40992%20-4.4055,-0.50122%20-6.7502,-0.23682%20-4.414689,0.49194%20-7.9408194,2.57837%20-10.5328594,6.14087%20-3.1141341,4.28222%20-3.8468001,9.14742%20-2.9492171,14.22242%200.9433571,5.3481%203.6727271,9.7761%207.8675575,13.2385%204.350619,3.5896%209.360619,5.3482%2015.075819,5.011%203.4713,-0.2004%207.3364,-0.665%2011.6961,-4.355%201.099,0.5467%202.2531,0.7652%204.1674,0.9292%201.4746,0.1367%202.8943,-0.0727%203.9933,-0.3005%201.7219,-0.3645%201.6029,-1.959%200.9801,-2.2505%20-5.0466,-2.3506%20-3.9385,-1.394%20-4.9459,-2.1685%202.5645,-3.0339%206.4297,-6.1865%207.9409,-16.4001%200.119,-0.8108%200.0183,-1.3211%200,-1.9771%20-0.0092,-0.4008%200.0824,-0.5556%200.5404,-0.6013%201.2639,-0.1457%202.4912,-0.4919%203.6178,-1.1115%203.2698,-1.7857%204.5886,-4.71953%204.9,-8.23638%200.0459,-0.53759%20-0.0091,-1.0935%20-0.577,-1.37573%20z%20m%20-28.4938,31.65181%20c%20-4.8909,-3.8447%20-7.263,-5.1113%20-8.2431,-5.0566%20-0.9159,0.0547%20-0.751,1.1025%20-0.5496,1.7859%200.2107,0.6741%200.4855,1.1389%200.8701,1.731%200.2656,0.3918%200.4489,0.9748%20-0.2655,1.4123%20-1.5754,0.9749%20-4.314,-0.3281%20-4.4423,-0.3918%20-3.1872,-1.877%20-5.852489,-4.3553%20-7.730179,-7.7444%20-1.8134704,-3.262%20-2.8667004,-6.7605%20-3.0407704,-10.4961%20-0.04577,-0.9019%200.21985,-1.221%201.11743,-1.3848%201.18152,-0.2187%202.3996604,-0.2644%203.5811804,-0.0913%204.991739,0.729%209.241439,2.9612%2012.804339,6.4963%202.0333,2.0135%203.572,4.419%205.1566,6.7696%201.6852,2.4963%203.4987,4.8745%205.8068,6.8242%200.8151,0.6833%201.4654,1.2026%202.0882,1.5854%20-1.8775,0.2095%20-5.01,0.2552%20-7.1532,-1.4397%20z%20m%202.3447,-15.0788%20c%200,-0.4009%200.3206,-0.7197%200.7237,-0.7197%200.0915,0%200.1739,0.018%200.2472,0.0454%200.1008,0.0366%200.1924,0.0913%200.2656,0.1731%200.1283,0.1277%200.2015,0.3098%200.2015,0.5012%200,0.4009%20-0.3205,0.7197%20-0.7235,0.7197%20-0.4031,0%20-0.7145,-0.3188%20-0.7145,-0.7197%20z%20m%207.2815,3.7356%20c%20-0.4671,0.1914%20-0.9342,0.3552%20-1.383,0.3735%20-0.6961,0.0364%20-1.4563,-0.2461%20-1.8684,-0.5923%20-0.6411,-0.5376%20-1.0991,-0.8381%20-1.2915,-1.7766%20-0.0824,-0.4009%20-0.0367,-1.0205%200.0367,-1.3757%200.1648,-0.7654%20-0.0184,-1.2573%20-0.5587,-1.7039%20-0.4397,-0.3645%20-0.9984,-0.4646%20-1.6121,-0.4646%20-0.229,0%20-0.4395,-0.1003%20-0.5953,-0.1823%20-0.2565,-0.1275%20-0.467,-0.4463%20-0.2656,-0.8382%200.0641,-0.1274%200.3756,-0.4372%200.4488,-0.4919%200.8335,-0.4739%201.7952,-0.3189%202.6836,0.0364%200.8244,0.3371%201.4472,0.9567%202.3447,1.8313%200.9159,1.0568%201.0807,1.3486%201.6028,2.1411%200.4123,0.6196%200.7878,1.2573%201.0442,1.9863%200.1557,0.4556%20-0.0458,0.8291%20-0.5862,1.0569%20z'%20fill-rule='nonzero'%20fill='%234d6bfe'%20/%3e%3cscript%20/%3e%3c/svg:svg%3e",google:Tn,gemini:Tn,anthropic:"data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20version='1.1'%20viewBox='0%200%20149.99999%20150'%20width='150'%20height='150'%20id='svg1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:svg='http://www.w3.org/2000/svg'%3e%3cdefs%20id='defs1'%3e%3cstyle%20id='style1'%3e%20.cls-1%20{%20fill:%20%230f0f0d;%20}%20.cls-1,%20.cls-2%20{%20stroke-width:%200px;%20}%20.cls-2%20{%20fill:%20%23d97757;%20}%20%3c/style%3e%3c/defs%3e%3cpath%20class='cls-2'%20d='m%2030.005,99.45%2029.14,-16.35%200.49,-1.42%20-0.49,-0.79%20h%20-1.42%20l%20-4.87,-0.3%20-16.65,-0.45%20-14.44,-0.6%20-13.99,-0.75%20-3.52,-0.75%20-3.3,-4.35%200.34,-2.17%202.96,-1.99%204.24,0.37%209.37,0.64%2014.06,0.97%2010.2,0.6%2015.11,1.57%20h%202.4%20l%200.34,-0.97%20-0.82,-0.6%20-0.64,-0.6%20-14.55,-9.86%20-15.75,-10.42%20-8.25,-6%20-4.46,-3.04%20-2.25,-2.85%20-0.97,-6.22%204.05,-4.46%205.44,0.37%201.39,0.37%205.51,4.24%2011.77,9.11%2015.37,11.32%202.25,1.87%200.9,-0.64%200.11,-0.45%20-1.01,-1.69%20-8.36,-15.11%20-8.92,-15.37%20-3.97,-6.37%20-1.05,-3.82%20c%20-0.37,-1.57%20-0.64,-2.89%20-0.64,-4.5%20l%204.61,-6.26%202.55,-0.82%206.15,0.82%202.59,2.25%203.82,8.74%206.19,13.76%209.6,18.71%202.81,5.55%201.5,5.14%200.56,1.57%20h%200.97%20v%20-0.9%20l%200.79,-10.54%201.46,-12.94%201.42,-16.65%200.49,-4.69%202.32,-5.62%204.61,-3.04%203.6,1.72%202.96,4.24%20-0.41,2.74%20-1.76,11.44%20-3.45,17.92%20-2.25,12%20h%201.31%20l%201.5,-1.5%206.07,-8.06%2010.2,-12.75%204.5,-5.06%205.25,-5.59%203.37,-2.66%20h%206.37%20l%204.69,6.97%20-2.1,7.2%20-6.56,8.32%20-5.44,7.05%20-7.8,10.5%20-4.87,8.4%200.45,0.67%201.16,-0.11%2017.62,-3.75%209.52,-1.72%2011.36,-1.95%205.14,2.4%200.56,2.44%20-2.02,4.99%20-12.15,3%20-14.25,2.85%20-21.22,5.02%20-0.26,0.19%200.3,0.37%209.56,0.9%204.09,0.22%20h%2010.01%20l%2018.64,1.39%204.87,3.22%202.92,3.94%20-0.49,3%20-7.5,3.82%20-10.12,-2.4%20-23.62,-5.62%20-8.1,-2.02%20h%20-1.12%20v%200.67%20l%206.75,6.6%2012.37,11.17%2015.49,14.4%200.79,3.56%20-1.99,2.81%20-2.1,-0.3%20-13.61,-10.24%20-5.25,-4.61%20-11.89,-10.01%20h%20-0.79%20v%201.05%20l%202.74,4.01%2014.47,21.75%200.75,6.67%20-1.05,2.17%20-3.75,1.31%20-4.12,-0.75%20-8.47,-11.89%20-8.74,-13.39%20-7.05,-12%20-0.86,0.49%20-4.16,44.81%20-1.95,2.29%20-4.5,1.72%20-3.75,-2.85%20-1.99,-4.61%201.99,-9.11%202.4,-11.89%201.95,-9.45%201.76,-11.74%201.05,-3.9%20-0.07,-0.26%20-0.86,0.11%20-8.85,12.15%20-13.46,18.19%20-10.65,11.4%20-2.55,1.01%20-4.42,-2.29%200.41,-4.09%202.47,-3.64%2014.74,-18.75%208.89,-11.62%205.74,-6.71%20-0.04,-0.97%20h%20-0.34%20l%20-39.15,25.42%20-6.97,0.9%20-3,-2.81%200.37,-4.61%201.42,-1.5%2011.77,-8.1%20-0.04,0.04%20z'%20shape-rendering='optimizeQuality'%20id='path1'%20/%3e%3c/svg%3e",cohere:"data:image/svg+xml,%3csvg%20height='1em'%20style='flex:none;line-height:1'%20viewBox='0%200%2024%2024'%20width='1em'%20xmlns='http://www.w3.org/2000/svg'%3e%3ctitle%3eCohere%3c/title%3e%3cpath%20clip-rule='evenodd'%20d='M8.128%2014.099c.592%200%201.77-.033%203.398-.703%201.897-.781%205.672-2.2%208.395-3.656%201.905-1.018%202.74-2.366%202.74-4.18A4.56%204.56%200%200018.1%201H7.549A6.55%206.55%200%20001%207.55c0%203.617%202.745%206.549%207.128%206.549z'%20fill='%2339594D'%20fill-rule='evenodd'%3e%3c/path%3e%3cpath%20clip-rule='evenodd'%20d='M9.912%2018.61a4.387%204.387%200%20012.705-4.052l3.323-1.38c3.361-1.394%207.06%201.076%207.06%204.715a5.104%205.104%200%2001-5.105%205.104l-3.597-.001a4.386%204.386%200%2001-4.386-4.387z'%20fill='%23D18EE2'%20fill-rule='evenodd'%3e%3c/path%3e%3cpath%20d='M4.776%2014.962A3.775%203.775%200%20001%2018.738v.489a3.776%203.776%200%20007.551%200v-.49a3.775%203.775%200%2000-3.775-3.775z'%20fill='%23FF7759'%3e%3c/path%3e%3c/svg%3e",mistral:"data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20version='1.1'%20id='Layer_1'%20x='0px'%20y='0px'%20viewBox='0%200%20500%20500'%20style='enable-background:new%200%200%20500%20500;'%20xml:space='preserve'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:svg='http://www.w3.org/2000/svg'%3e%3cdefs%20id='defs119'%20/%3e%3cg%20id='g94'%3e%3c/g%3e%3cg%20id='g119'%3e%3crect%20x='352.273'%20y='45.455'%20width='81.818'%20height='81.818'%20id='rect94'%20/%3e%3crect%20x='393.182'%20y='45.455'%20style='fill:%23F7D046;'%20width='81.818'%20height='81.818'%20id='rect95'%20/%3e%3crect%20x='25'%20y='45.455'%20width='81.818'%20height='81.818'%20id='rect96'%20/%3e%3crect%20x='25'%20y='127.273'%20width='81.818'%20height='81.818'%20id='rect97'%20/%3e%3crect%20x='25'%20y='209.091'%20width='81.818'%20height='81.818'%20id='rect98'%20/%3e%3crect%20x='25'%20y='290.909'%20width='81.818'%20height='81.818'%20id='rect99'%20/%3e%3crect%20x='25'%20y='372.727'%20width='81.818'%20height='81.818'%20id='rect100'%20/%3e%3crect%20x='65.909'%20y='45.455'%20style='fill:%23F7D046;'%20width='81.818'%20height='81.818'%20id='rect101'%20/%3e%3crect%20x='393.182'%20y='127.273'%20style='fill:%23F2A73B;'%20width='81.818'%20height='81.818'%20id='rect102'%20/%3e%3crect%20x='65.909'%20y='127.273'%20style='fill:%23F2A73B;'%20width='81.818'%20height='81.818'%20id='rect103'%20/%3e%3crect%20x='270.455'%20y='127.273'%20width='81.818'%20height='81.818'%20id='rect104'%20/%3e%3crect%20x='311.364'%20y='127.273'%20style='fill:%23F2A73B;'%20width='81.818'%20height='81.818'%20id='rect105'%20/%3e%3crect%20x='147.727'%20y='127.273'%20style='fill:%23F2A73B;'%20width='81.818'%20height='81.818'%20id='rect106'%20/%3e%3crect%20x='229.545'%20y='209.091'%20style='fill:%23EE792F;'%20width='81.818'%20height='81.818'%20id='rect107'%20/%3e%3crect%20x='311.364'%20y='209.091'%20style='fill:%23EE792F;'%20width='81.818'%20height='81.818'%20id='rect108'%20/%3e%3crect%20x='147.727'%20y='209.091'%20style='fill:%23EE792F;'%20width='81.818'%20height='81.818'%20id='rect109'%20/%3e%3crect%20x='188.636'%20y='290.909'%20width='81.818'%20height='81.818'%20id='rect110'%20/%3e%3crect%20x='229.545'%20y='290.909'%20style='fill:%23EB5829;'%20width='81.818'%20height='81.818'%20id='rect111'%20/%3e%3crect%20x='393.182'%20y='209.091'%20style='fill:%23EE792F;'%20width='81.818'%20height='81.818'%20id='rect112'%20/%3e%3crect%20x='65.909'%20y='209.091'%20style='fill:%23EE792F;'%20width='81.818'%20height='81.818'%20id='rect113'%20/%3e%3crect%20x='352.273'%20y='290.909'%20width='81.818'%20height='81.818'%20id='rect114'%20/%3e%3crect%20x='393.182'%20y='290.909'%20style='fill:%23EB5829;'%20width='81.818'%20height='81.818'%20id='rect115'%20/%3e%3crect%20x='352.273'%20y='372.727'%20width='81.818'%20height='81.818'%20id='rect116'%20/%3e%3crect%20x='65.909'%20y='290.909'%20style='fill:%23EB5829;'%20width='81.818'%20height='81.818'%20id='rect117'%20/%3e%3crect%20x='393.182'%20y='372.727'%20style='fill:%23EA3326;'%20width='81.818'%20height='81.818'%20id='rect118'%20/%3e%3crect%20x='65.909'%20y='372.727'%20style='fill:%23EA3326;'%20width='81.818'%20height='81.818'%20id='rect119'%20/%3e%3c/g%3e%3c/svg%3e",groq:"data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='120'%20height='120'%20viewBox='0%200%2031.749999%2031.75'%20version='1.1'%20id='svg1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:svg='http://www.w3.org/2000/svg'%3e%3cdefs%20id='defs1'%20/%3e%3cg%20id='layer1'%20transform='translate(-1.0583336,-1.0583335)'%3e%3cg%20id='g1'%20transform='matrix(0.0839389,0,0,0.0839389,5.9375622,2.6051197)'%20style='fill:%23f55036;fill-opacity:1'%3e%3cpath%20d='M%20131.6,6.5%20C%2069.5,6%2018.7,55.8%2018.1,117.9%2017.5,180%2067.4,230.8%20129.5,231.4%20c%200.7,0%201.4,0%202.1,0%20h%2037%20v%20-42.1%20h%20-37%20C%2092.8,189.8%2061,158.7%2060.5,119.9%2060,81.1%2091.1,49.3%20129.9,48.8%20c%200.5,0%201.1,0%201.6,0%2038.7,0%2070.4,31.5%2070.4,70.3%20v%200%20103.5%200%20c%200,38.5%20-31.3,69.8%20-69.7,70.3%20-18.4,-0.2%20-35.9,-7.5%20-48.9,-20.6%20L%2053.5,302%20c%2020.7,20.8%2048.7,32.6%2078,32.9%20v%200%20h%201.5%20v%200%20C%20194.3,334%20243.6,284.3%20243.9,223%20V%20116.2%20C%20242.4,55.2%20192.5,6.6%20131.6,6.5%20Z'%20id='path2'%20style='fill:%23f55036;fill-opacity:1'%20/%3e%3c/g%3e%3c/g%3e%3c/svg%3e",together:"data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3c!--%20Created%20with%20Inkscape%20(http://www.inkscape.org/)%20--%3e%3csvg%20width='74'%20height='74'%20viewBox='0%200%2019.579168%2019.579168'%20version='1.1'%20id='svg1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:svg='http://www.w3.org/2000/svg'%3e%3cdefs%20id='defs1'%20/%3e%3cg%20id='layer1'%3e%3cg%20id='g1'%20transform='translate(-0.147916,-0.147916)'%3e%3ccircle%20style='fill:%230f6eff;fill-opacity:1;stroke:none;stroke-width:0.244828;stroke-opacity:1'%20id='path1'%20cx='9.9375'%20cy='4.1166668'%20r='2'%20/%3e%3ccircle%20style='fill:%23d3d3d3;fill-opacity:1;stroke:none;stroke-width:0.244828;stroke-opacity:1'%20id='path1-5-7-6'%20cx='4.1166668'%20cy='9.9375'%20r='2'%20/%3e%3ccircle%20style='fill:%23d3d3d3;fill-opacity:1;stroke:none;stroke-width:0.244828;stroke-opacity:1'%20id='path1-5-7-6-2'%20cx='9.9375'%20cy='9.9375'%20r='2'%20/%3e%3ccircle%20style='fill:%23d3d3d3;fill-opacity:1;stroke:none;stroke-width:0.244828;stroke-opacity:1'%20id='path1-5-7-6-2-7'%20cx='15.758333'%20cy='9.9375'%20r='2'%20/%3e%3ccircle%20style='fill:%23d3d3d3;fill-opacity:1;stroke:none;stroke-width:0.244828;stroke-opacity:1'%20id='path1-5-7-6-9'%20cx='4.1166668'%20cy='15.758333'%20r='2'%20/%3e%3ccircle%20style='fill:%23d3d3d3;fill-opacity:1;stroke:none;stroke-width:0.244828;stroke-opacity:1'%20id='path1-5-7-6-2-3'%20cx='9.9920893'%20cy='15.758333'%20r='2'%20/%3e%3ccircle%20style='fill:%23d3d3d3;fill-opacity:1;stroke:none;stroke-width:0.244828;stroke-opacity:1'%20id='path1-5-7-6-2-7-1'%20cx='15.758333'%20cy='15.758333'%20r='2'%20/%3e%3ccircle%20style='fill:%23d3d3d3;fill-opacity:1;stroke:none;stroke-width:0.244828;stroke-opacity:1'%20id='path1-5-7-6-2-7-1-37'%20cx='15.758333'%20cy='4.1166668'%20r='2'%20/%3e%3c/g%3e%3c/g%3e%3c/svg%3e",nim:"data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg:svg%20version='1.1'%20x='0px'%20y='0px'%20width='196'%20height='196'%20viewBox='0%200%20196%20196'%20enable-background='new%200%200%20700%20550'%20xml:space='preserve'%20xmlns:svg='http://www.w3.org/2000/svg'%3e%3csvg:defs%20id='defs1'%20/%3e%3csvg:path%20id='Eye_Mark_1_'%20fill='%2374b71b'%20d='M%2073.456372,72.194042%20V%2060.631527%20c%201.12198,-0.07937%202.255948,-0.139319%203.411415,-0.176111%2031.622563,-0.993824%2052.369263,27.171848%2052.369263,27.171848%200,0%20-22.40735,31.122346%20-46.43236,31.122346%20-3.460197,0%20-6.55701,-0.55769%20-9.348318,-1.49488%20V%2082.193886%20c%2012.310363,1.487017%2014.78583,6.924941%2022.189081,19.262174%20L%20112.10639,87.577242%20c%200,0%20-12.0156,-15.759812%20-32.271598,-15.759812%20-2.204274,4.13e-4%20-4.310571,0.155853%20-6.37842,0.376612%20m%200,-38.194042%20v%2017.270393%20c%201.134795,-0.09013%202.271245,-0.161642%203.411415,-0.203395%2043.975923,-1.481642%2072.626093,36.065421%2072.626093,36.065421%200,0%20-32.90865,40.016331%20-67.191477,40.016331%20-3.141461,0%20-6.082834,-0.29021%20-8.846445,-0.77927%20v%2010.67535%20c%202.363435,0.30054%204.811617,0.47748%207.366457,0.47748%2031.904925,0%2054.977025,-16.29186%2077.319065,-35.57636%203.70121,2.96618%2018.86737,10.18133%2021.9861,13.34346%20-21.24446,17.78301%20-70.74883,32.11575%20-98.81404,32.11575%20-2.704906,0%20-5.306049,-0.16329%20-7.857582,-0.40844%20V%20162%20H%20194.71746%20V%2034%20Z%20m%200,83.25473%20v%209.11475%20c%20-29.508411,-5.26099%20-37.69837,-35.934786%20-37.69837,-35.934786%200,0%2014.167377,-15.697388%2037.69837,-18.241066%20v%2010.000258%20c%20-0.0182,0%20-0.03018,-0.0045%20-0.0463,-0.0045%20-12.347156,-1.482881%20-21.995608,10.054415%20-21.995608,10.054415%200,0%205.40568,19.421749%2022.04191,25.010979%20M%2021.046171,89.105598%20c%200,0%2017.48867,-25.805957%2052.409787,-28.474484%20v%20-9.360721%20c%20-38.678551,3.103842%20-72.173423,35.86244%20-72.173423,35.86244%200,0%2018.969486,54.843917%2072.173423,59.864297%20v%20-9.95189%20C%2034.414436,132.13317%2021.046171,89.105598%2021.046171,89.105598%20Z'%20style='stroke-width:0.413405'%20/%3e%3cscript%20/%3e%3c/svg:svg%3e",other:"data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Generator:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='800px'%20height='800px'%20viewBox='0%200%2064%2064'%20xmlns='http://www.w3.org/2000/svg'%20stroke-width='3'%20stroke='%23000000'%20fill='none'%3e%3ccircle%20cx='34.52'%20cy='11.43'%20r='5.82'/%3e%3ccircle%20cx='53.63'%20cy='31.6'%20r='5.82'/%3e%3ccircle%20cx='34.52'%20cy='50.57'%20r='5.82'/%3e%3ccircle%20cx='15.16'%20cy='42.03'%20r='5.82'/%3e%3ccircle%20cx='15.16'%20cy='19.27'%20r='5.82'/%3e%3ccircle%20cx='34.51'%20cy='29.27'%20r='4.7'/%3e%3cline%20x1='20.17'%20y1='16.3'%20x2='28.9'%20y2='12.93'/%3e%3cline%20x1='38.6'%20y1='15.59'%20x2='49.48'%20y2='27.52'/%3e%3cline%20x1='50.07'%20y1='36.2'%20x2='38.67'%20y2='46.49'/%3e%3cline%20x1='18.36'%20y1='24.13'%20x2='30.91'%20y2='46.01'/%3e%3cline%20x1='20.31'%20y1='44.74'%20x2='28.7'%20y2='48.63'/%3e%3cline%20x1='17.34'%20y1='36.63'%20x2='31.37'%20y2='16.32'/%3e%3cline%20x1='20.52'%20y1='21.55'%20x2='30.34'%20y2='27.1'/%3e%3cline%20x1='39.22'%20y1='29.8'%20x2='47.81'%20y2='30.45'/%3e%3cline%20x1='34.51'%20y1='33.98'%20x2='34.52'%20y2='44.74'/%3e%3c/svg%3e"},Mn={user_proxy:"data:image/webp;base64,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",rag_user_proxy:En,doc_agent:En,captain:"data:image/webp;base64,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",assistant:"data:image/webp;base64,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",reasoning:"data:image/webp;base64,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",group_manager:"data:image/webp;base64,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"},In="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2048%2048'%20width='48px'%20height='48px'%3e%3cpath%20fill='%23FFC107'%20d='M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z'/%3e%3cpath%20fill='%23FF3D00'%20d='M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z'/%3e%3cpath%20fill='%234CAF50'%20d='M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z'/%3e%3cpath%20fill='%231976D2'%20d='M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z'/%3e%3c/svg%3e",Dn="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2048%2048'%20width='48px'%20height='48px'%3e%3cpath%20fill='%23767676'%20d='M9.691,14.851c0,0,3.766,0.83,5.777-0.128c0.798-0.383-0.223-0.67-0.191-1.085%20s0.255-0.638,1.021-0.957c0.766-0.319,1.691-0.383,1.628,0.255c-0.064,0.638-0.064,0.989,0.734,0.862s4.628-1.628,5.266-2.234%20c0.638-0.606,2.33,3.862,2.33,3.862l-3.734,5.394l-8.649,2.138l-6.702-3.16L9.691,14.851z'/%3e%3cpath%20fill='%23767676'%20d='M31.638,17.404c0-3.607-1.495-6.861-3.893-9.19c-0.601,0.115-1.104,0.162-1.306,0.174%20c-0.407,0.024-0.862-0.407-0.814-0.694s-0.455-0.622-1.34-0.407c-0.886,0.215-0.942,0.576-0.942,0.576l-0.04,0.075%20c-0.053,0.099-0.032,0.096-0.032,0.096s0.546,0.367,0.535,0.665c-0.054,0.072-0.132,0.15-0.262,0.24%20c-0.648,0.443-1.721,0.607-2.285,0.665c-0.209,0.021-0.36,0.177-0.403,0.375c-0.051,0.075-0.087,0.162-0.09,0.26%20c-0.013,0.403,0.048,1.031,0.437,1.637c0.15,0.234,0.477,0.295,0.698,0.126c0.741-0.569,1.412-0.914,1.906-0.091%20c0.183,0.305,0.242,0.607,0.183,0.857c-0.196,0.352-0.709,0.534-1.602,0.308c-0.272-0.069-0.545,0.103-0.604,0.368%20c-0.047,0.066-0.083,0.141-0.091,0.228c-0.084,0.95,0.081,2.359,0.416,3.284c-1.208,0.236-3.985,0.631-5.188,1.265%20c-0.099,0.052-0.153,0.15-0.163,0.253c-0.1,0.123-0.105,0.311,0.017,0.427c0.26,0.249,0.483,0.608,0.419,0.947%20c-0.149,0.285-0.536,0.54-1.359,0.676c-1.287,0.212-1.485-0.246-1.307-0.752c0.076-0.151,0.172-0.3,0.283-0.431%20c0.043-0.051,0.064-0.11,0.07-0.169c0.001-0.001,0.001-0.001,0.002-0.002c0.164-0.194,0.041-0.494-0.21-0.528%20c-1.273-0.174-3.487-0.145-4.655,0.112c0,0-0.087-1.288,0.393-2.56c0.166-0.394,0.328-0.656,0.63-0.997%20c0.234-0.234,0.581,0.133,0.793,0.416c0.132,0.175,0.427,0.082,0.608-0.04c0.234-0.158,0.516-0.429,0.666-0.841%20c0.184-0.367,0.265-0.868,0.049-1.55c-0.066-0.207-0.729-0.525-0.939-0.47c-0.529,0.138-0.811,0.302-0.646-0.28%20c0.029-0.06,0.051-0.116,0.097-0.185c0.498-0.755,0.957-1.424,1.224-2.101c0.111-0.251,0.204-0.503,0.255-0.759%20c0.039-0.195-0.506-0.577-0.822-0.532c-0.153,0.045-0.135-0.054-0.12-0.123c0.033-0.059,0.076-0.124,0.132-0.196%20c0.47-0.596,0.913-0.62,1.122-0.451c0.111,0.089,0.27,0.085,0.379-0.006c0.431-0.36,0.651-0.709,0.751-0.995%20c0.234-0.475,0.142-0.823-0.015-0.815l-0.638-0.223c0,0-2.076,1.529-3.225,2.127C10.48,8.274,10.139,8.322,9.82,8.346%20C9.422,8.742,9.043,9.157,8.678,9.584c-0.711,0.921-1.299,1.942-1.743,3.036c-0.763,1.804-1.129,3.816-0.97,5.934%20c0.48,6.413,5.86,11.589,12.286,11.832c5.519,0.208,10.294-3.077,12.301-7.818C31.249,20.987,31.638,19.242,31.638,17.404z'/%3e%3cpath%20fill='%23bebebe'%20d='M44.895,20.915h-0.01c-0.031-0.306-0.079-0.606-0.122-0.908c-0.034-0.237-0.066-0.474-0.108-0.707%20c-0.066-0.366-0.14-0.729-0.224-1.089c-0.038-0.162-0.082-0.32-0.124-0.481c-0.206-0.792-0.45-1.569-0.744-2.322%20c-0.006-0.016-0.012-0.033-0.018-0.05c-0.163-0.416-0.341-0.824-0.529-1.227c-0.022-0.047-0.045-0.093-0.067-0.14%20c-0.589-1.234-1.293-2.403-2.101-3.491l-0.733,0.273c-0.39-0.526-0.906-1.126-1.46-1.724c0.099-0.39-0.14-0.931-0.648-1.334%20c-0.365-0.289-0.764-0.418-1.099-0.41c-0.822-0.756-1.564-1.348-1.963-1.509c-0.219,0.027-0.698,0.123-1.298,0.259%20c1.258,0.754,0.609,1.473,0.412,1.52c-0.232,0.055-1.053,0.112-1.695-1.211c-1.295,0.328-2.698,0.732-3.331,1.036%20c-0.827,0.397-1.851,0.597-2.545,0.692C27.441,9.672,28,11.519,28,13.5C28,19.299,23.299,24,17.5,24S7,19.299,7,13.5%20c0-1.3,0.247-2.54,0.68-3.69c-0.087,0.113-0.175,0.225-0.263,0.338c-0.228,0.293-0.455,0.587-0.667,0.892%20c-0.163,0.235-0.314,0.478-0.468,0.72c-0.188,0.295-0.372,0.592-0.545,0.897c-0.147,0.258-0.285,0.522-0.421,0.787%20C5.16,13.748,5.011,14.057,4.87,14.37c-0.125,0.276-0.246,0.555-0.359,0.837c-0.127,0.318-0.242,0.642-0.354,0.968%20c-0.099,0.288-0.2,0.576-0.287,0.87c-0.1,0.34-0.182,0.687-0.266,1.034c-0.07,0.29-0.148,0.578-0.205,0.872%20c-0.079,0.403-0.132,0.815-0.187,1.226c-0.033,0.246-0.081,0.488-0.106,0.737l0,0C3.038,21.601,3,22.296,3,23%20c0,11.598,9.402,21,21,21s21-9.402,21-21C45,22.296,44.962,21.601,44.895,20.915z'/%3e%3cpath%20fill='%23e1e1e1'%20d='M33.811,6.018c-0.056,0.012-0.106,0.023-0.164,0.036c1.258,0.754,0.609,1.473,0.412,1.52%20c-0.232,0.055-1.053,0.112-1.695-1.211c-1.295,0.328-2.698,0.732-3.331,1.036c-0.827,0.397-1.851,0.597-2.545,0.692%20C27.441,9.672,28,11.519,28,13.5C28,19.299,23.299,24,17.5,24S7,19.299,7,13.5c0-1.294,0.245-2.529,0.674-3.674%20c-3.017,3.808-4.637,8.773-4.04,14.13c0.984,8.827,8.123,15.959,16.953,16.924C32.186,42.149,42,33.098,42,21.755%20C42,15.245,38.758,9.501,33.811,6.018z'/%3e%3cpath%20fill='%23efefef'%20d='M30.713,6.812c-0.166,0.049-0.327,0.098-0.482,0.146c-0.015,0.005-0.03,0.009-0.045,0.014%20c-0.135,0.043-0.263,0.085-0.386,0.127c-0.026,0.009-0.053,0.018-0.079,0.027c-0.11,0.038-0.211,0.076-0.307,0.112%20c-0.026,0.01-0.055,0.02-0.079,0.03c-0.114,0.045-0.217,0.089-0.304,0.13c-0.827,0.397-1.851,0.597-2.545,0.692%20C27.441,9.672,28,11.519,28,13.5C28,19.299,23.299,24,17.5,24S7,19.299,7,13.5c0-1.289,0.243-2.518,0.668-3.658%20C7.604,9.92,7.544,9.993,7.492,10.056c-2.327,3.183-3.549,7.223-3.036,11.575c0.88,7.465,6.938,13.472,14.411,14.273%20C28.694,36.956,37,29.283,37,19.67C37,14.443,34.534,9.801,30.713,6.812z'/%3e%3cpath%20fill='%23f5f5f5'%20d='M27.107,7.991c-0.601,0.115-1.104,0.162-1.306,0.174c-0.407,0.024-0.862-0.407-0.814-0.694%20s-0.455-0.622-1.34-0.407c-0.886,0.215-1.029,0.838-1.029,0.838s1.197,0.192,0.287,0.814c-0.648,0.443-1.721,0.607-2.285,0.665%20c-0.24,0.025-0.413,0.223-0.421,0.464c-0.013,0.403,0.048,1.031,0.437,1.637c0.15,0.234,0.477,0.295,0.698,0.126%20c0.741-0.569,1.412-0.914,1.906-0.091c0.522,0.869,0.096,1.738-1.491,1.336c-0.292-0.074-0.596,0.125-0.622,0.425%20c-0.088,0.998,0.092,2.517,0.462,3.433c-1.143,0.233-4.067,0.634-5.306,1.287c-0.187,0.098-0.226,0.363-0.073,0.509%20c0.531,0.508,0.923,1.475-1.012,1.794c-1.813,0.299-1.481-0.73-0.952-1.355c0.164-0.194,0.041-0.494-0.21-0.528%20c-1.273-0.174-3.487-0.145-4.655,0.112c0,0-0.168-2.37,1.149-3.854c0.234-0.234,0.58,0.133,0.793,0.416%20c0.132,0.175,0.373,0.208,0.554,0.086c0.432-0.291,1.045-0.95,0.643-2.219c-0.066-0.207-0.294-0.301-0.504-0.246%20c-0.622,0.163-1.519,0.059-0.912-0.861c0.641-0.972,1.229-1.801,1.408-2.688c0.039-0.195-0.148-0.355-0.346-0.33%20c-0.465,0.058-0.874-0.079-0.392-0.692c0.47-0.597,0.913-0.62,1.122-0.451c0.111,0.089,0.27,0.085,0.379-0.007%20c1.004-0.84,0.903-1.65,0.662-1.638l-1.589,0.181c0,0-1.125,1.125-2.274,1.723c-0.232,0.1-0.573,0.149-0.892,0.173%20C8.784,8.519,8.405,8.933,8.039,9.36c-1.856,2.403-2.89,5.473-2.641,8.798c0.48,6.413,5.86,11.589,12.287,11.832%20C24.991,30.266,31,24.425,31,17.181C31,13.574,29.505,10.32,27.107,7.991z'/%3e%3cpath%20fill='%23404040'%20d='M32.814,34.471c0,0-0.335,0.646-0.144,0.934c0.622,0,1.436,0,1.436,0s0.311,1.293-0.191,2.705%20c0.311-0.239,0.551-0.574,0.551-0.574s0.359-1.915,0.263-2.992C34.178,34.566,32.814,34.471,32.814,34.471z'/%3e%3cpath%20fill='%23767676'%20d='M42.652,30.306c-0.455,0.383-1.077,1.34-1.077,1.34l1.34-0.886%20C42.915,30.761,43.106,29.923,42.652,30.306z'/%3e%3cpath%20fill='%23767676'%20d='M41.359,32.699c0,0,0.407-0.287,0.694-0.431c-0.168,0.933-0.886,1.316-0.886,1.316%20s0,0.144,0.024,0.742c1.317-0.957,1.46-2.992,1.46-2.992l-1.364,0.91L41.359,32.699z'/%3e%3cpath%20fill='%23404040'%20d='M35.579,28.748l-0.578,0.12c-0.117-0.603-0.519-2.628-0.781-3.488l0.581-0.401l-0.048-0.215%20l-2.035,0.79l0.036,0.156l0.771-0.093c0.027,0.102,0.06,0.226,0.097,0.372c-0.238,0.567-0.985,2.331-1.403,3.152%20c-0.176-0.866-0.441-2.115-0.633-2.743l0.581-0.401l-0.048-0.215l-2.035,0.79l0.036,0.156l0.771-0.093%20c0.171,0.647,0.596,2.294,0.793,3.469L31.119,30.4l0.064,0.202l1.852-0.677l-0.075-0.154l-0.595,0.103%20c-0.018-0.093-0.042-0.215-0.072-0.364c0.519-0.962,1.147-2.396,1.422-3.156c0.202,0.799,0.466,1.911,0.608,2.765l-0.564,0.319%20l0.071,0.2l1.828-0.738L35.579,28.748z'/%3e%3cpath%20fill='%23404040'%20d='M18.5,31.638l-0.638-0.447c0,0,0.048,0.941-0.782,1.867C17.638,32.755,18.5,31.638,18.5,31.638z'/%3e%3cpath%20fill='%23404040'%20d='M20.72,34.769l-1.124-0.012l-0.18-0.662l0.537-0.067c0.068-0.009,0.117-0.071,0.108-0.14%20s-0.063-0.127-0.14-0.108l-0.572,0.073l-0.158-0.578l0.613-0.06c0.069-0.006,0.119-0.067,0.112-0.136%20c-0.006-0.069-0.069-0.128-0.136-0.112l-0.656,0.064l-0.114-0.419l0.067-0.172l0.693-0.054c0.068-0.006,0.12-0.065,0.115-0.135%20c-0.007-0.068-0.074-0.122-0.135-0.115l-0.572,0.045l0.23-0.59l-0.223-0.239l-0.339,0.88l-1.017,0.425%20c-0.057,0.023-0.088,0.084-0.074,0.144l0.341,1.467c-0.001,0.013-0.008,0.025-0.005,0.039c0.002,0.007,0.013,0.006,0.016,0.012%20l0.189,0.811c0.014,0.058,0.065,0.097,0.122,0.097c0.008,0,0.017-0.001,0.025-0.003l1.058-0.22l1.213,0.016%20c0.001,0,0.001,0,0.002,0c0.068,0,0.124-0.055,0.125-0.123C20.844,34.826,20.788,34.77,20.72,34.769z%20M18.023,32.846l0.699-0.292%20l-0.047,0.122l0.124,0.448l-0.633,0.339L18.023,32.846z%20M18.318,34.112l-0.092-0.396l0.642-0.345l0.15,0.542L18.318,34.112z%20M18.374,34.355l0.71-0.202l0.179,0.647l-0.75,0.154L18.374,34.355z'/%3e%3cpath%20fill='%23404040'%20d='M16.694,34.131l-0.232-0.418l0.411-0.226l0.516,0.272c0.063,0.033,0.137,0.009,0.169-0.052%20c0.032-0.062,0.009-0.137-0.052-0.169l-0.575-0.304c-0.037-0.02-0.08-0.021-0.119,0.001l-0.497,0.273%20c-0.035-0.016-0.074-0.021-0.109-0.001c-0.036,0.02-0.052,0.055-0.057,0.093l-0.288,0.158l-0.088-0.013l1.201-1.651%20c0.041-0.056,0.028-0.134-0.027-0.174c-0.054-0.041-0.133-0.029-0.174,0.027l-0.69,0.947l-0.588-0.259l0.78-1.186%20c0.038-0.058,0.021-0.135-0.036-0.173c-0.056-0.038-0.135-0.022-0.173,0.036l-0.861,1.309c-0.021,0.03-0.025,0.068-0.016,0.104%20c0.011,0.035,0.036,0.064,0.069,0.079l0.674,0.297l-0.484,0.665c-0.026,0.035-0.031,0.081-0.015,0.122%20c0.018,0.04,0.054,0.068,0.098,0.075l0.335,0.048c0.006,0.001,0.012,0.001,0.018,0.001c0.021,0,0.042-0.005,0.061-0.016l0.3-0.165%20l0.223,0.4l0.172,1.001c0.011,0.061,0.063,0.104,0.123,0.104c0.007,0,0.014-0.001,0.021-0.002c0.067-0.012,0.113-0.076,0.102-0.145%20l-0.176-1.021C16.706,34.156,16.701,34.143,16.694,34.131z'/%3e%3cpath%20fill='%23404040'%20d='M17.121,34.201c-0.058-0.04-0.135-0.029-0.175,0.028c-0.04,0.056-0.027,0.134,0.028,0.175%20l0.75,0.543c0.022,0.016,0.048,0.023,0.073,0.023c0.039,0,0.077-0.018,0.102-0.052c0.04-0.056,0.027-0.134-0.028-0.175%20L17.121,34.201z'/%3e%3cpath%20fill='%23404040'%20d='M16.006,34.402c-0.003-0.001-0.007-0.001-0.011-0.001c-0.064,0-0.119,0.049-0.124,0.114%20l-0.064,0.719c-0.007,0.068,0.044,0.129,0.113,0.135c0.003,0.001,0.007,0.001,0.011,0.001c0.064,0,0.119-0.049,0.124-0.114%20l0.064-0.719C16.126,34.469,16.075,34.408,16.006,34.402z'/%3e%3cpath%20fill='%23404040'%20d='M22.869,41.015c0,0,0.001,0.013,0.002,0.021c-0.069-0.162-0.224-0.358-0.529-0.592%20c-0.89-0.686-2.033-1.064-3.306-1.095l-0.038-0.001c-0.013,0-0.026-0.001-0.039-0.001c-0.342,0-0.625,0.153-0.668,0.365%20c-0.021,0.106,0,0.306,0.387,0.452c0.367,0.14,0.637,0.149,0.807,0.032c0.156-0.107,0.161-0.274,0.161-0.293%20c0-0.068-0.043-0.129-0.125-0.123c-0.066,0-0.122,0.054-0.125,0.12c0,0.006-0.004,0.059-0.056,0.092%20c-0.044,0.029-0.192,0.084-0.573-0.063c-0.179-0.067-0.236-0.139-0.23-0.168c0.012-0.061,0.186-0.16,0.453-0.164l0.04,0.001%20c1.202,0.028,2.324,0.398,3.16,1.042c0.372,0.286,0.542,0.539,0.455,0.676c-0.151,0.241-1.028,0.282-1.822-0.12%20c-0.042-0.021-0.091-0.017-0.13,0.01c-0.038,0.027-0.057,0.073-0.05,0.12c0.015,0.1-0.042,0.2-0.155,0.273%20c-0.242,0.158-0.761,0.194-1.428-0.223c-0.086-0.053-0.129-0.122-0.122-0.194c0.008-0.073,0.065-0.138,0.15-0.169%20c0.186-0.063,0.439,0.035,0.681,0.271c0.049,0.05,0.128,0.048,0.177-0.001c0.048-0.05,0.047-0.129-0.002-0.177%20c-0.451-0.442-0.808-0.378-0.94-0.328c-0.176,0.063-0.296,0.208-0.313,0.378c-0.015,0.147,0.063,0.282,0.19,0.383%20c-0.004-0.001-0.008-0.002-0.012-0.003c0.007,0.005,0.013,0.007,0.02,0.012c0.016,0.012,0.022,0.03,0.04,0.04%20c0.124,0.078,0.243,0.138,0.358,0.19c1.174,0.607,1.965,0.203,1.592-0.281c0.122,0.052,0.247,0.094,0.371,0.13%20C22.626,42.182,23.356,41.686,22.869,41.015z'/%3e%3cpath%20fill='%23404040'%20d='M17.607,24.522l-0.282,0.603l-1.038,0.205l-0.023-0.313c0.606-0.367,1.02-0.98,0.99-1.664%20c-0.045-1.044-1.006-1.754-2.169-1.704s-2.088,1.03-2.043,2.074c0.036,0.842,0.652,1.42,1.497,1.588l0.077,0.295l-1.048,0.143%20l-0.463-0.479l-0.112,0.128l0.399,0.941L15,26.111l-0.167-0.935c-0.678-0.098-1.191-0.648-1.226-1.465%20c-0.04-0.929,0.602-1.794,1.419-1.829c0.817-0.035,1.498,0.604,1.538,1.533c0.026,0.59-0.234,1.131-0.636,1.457l0.018,0.119h-0.001%20l0.145,0.939l1.594-0.304l0.072-1.02L17.607,24.522z'/%3e%3cpath%20fill='%23404040'%20d='M7.943,32.859c-0.174-0.253-0.333-0.581-0.471-0.923c0.002-0.012,0.012-0.019,0.013-0.032%20c0.005-0.053-0.029-0.093-0.075-0.115c-0.056-0.149-0.099-0.295-0.143-0.444c0.029-0.001,0.058-0.008,0.082-0.028%20c0.051-0.046,0.055-0.125,0.009-0.177c-0.047-0.052-0.113-0.11-0.19-0.166c-0.032-0.149-0.055-0.292-0.068-0.425%20c0.092,0.017,0.183,0.038,0.278,0.049c0.005,0.001,0.01,0.001,0.015,0.001c0.063,0,0.116-0.047,0.124-0.11%20c0.009-0.068-0.04-0.131-0.109-0.139c-0.12-0.014-0.236-0.039-0.353-0.063c-0.15-0.731-0.87-1.334-1.424-1.734%20c-0.304-0.219-0.476-0.162-0.566-0.077c-0.189,0.175-0.134,0.622,0.001,0.987c-0.044-0.028-0.074-0.048-0.076-0.049%20c-0.057-0.041-0.135-0.026-0.174,0.031c-0.039,0.057-0.025,0.135,0.031,0.174c0.016,0.011,0.169,0.114,0.408,0.247%20c0.292,0.594,0.75,2.561,0.754,2.583c0.017,0.066,0.078,0.108,0.15,0.094c0.067-0.016,0.109-0.083,0.094-0.15%20c-0.018-0.075-0.36-1.548-0.654-2.346c0.338,0.164,0.765,0.337,1.239,0.452c0.007,0.097,0.033,0.211,0.051,0.318%20c-0.18-0.079-0.37-0.116-0.511-0.039C6.262,30.842,6.144,31,6.25,31.386c0.015,0.056,0.065,0.092,0.12,0.092%20c0.011,0,0.021-0.001,0.033-0.005c0.066-0.018,0.105-0.087,0.087-0.153c-0.046-0.171-0.043-0.294,0.008-0.322%20c0.081-0.039,0.271,0.027,0.444,0.133c0.063,0.263,0.153,0.533,0.256,0.8c-0.004,0.001-0.003,0.009-0.008,0.01%20c-0.143,0.021-0.446-0.131-0.549-0.326c-0.031-0.062-0.107-0.084-0.168-0.053c-0.062,0.031-0.085,0.107-0.053,0.168%20c0.133,0.255,0.476,0.464,0.736,0.464c0.028,0,0.056-0.003,0.082-0.008c0.022-0.004,0.034-0.022,0.054-0.03%20c0.134,0.314,0.282,0.613,0.444,0.848c0.024,0.035,0.063,0.054,0.103,0.054c0.024,0,0.05-0.007,0.071-0.022%20C7.969,32.994,7.982,32.916,7.943,32.859z%20M5.426,29.642c-0.21-0.343-0.295-0.887-0.19-0.983c0.018-0.013,0.09-0.019,0.25,0.098%20c0.731,0.527,1.143,1.007,1.285,1.462c-0.531-0.145-1.002-0.361-1.325-0.535C5.439,29.672,5.432,29.652,5.426,29.642z'/%3e%3cpath%20fill='%23404040'%20d='M6.555,21.737v-0.299l-0.41-0.131c-0.018-0.175-0.116-0.903-0.549-1.052%20c-0.422-0.145-0.632,0.106-0.611-0.625c-0.058,0-0.16-0.015-0.16-0.015c-0.077,0.363-0.095,0.757,0.187,0.961%20c0.247,0.179,0.783-0.103,0.883,0.651l-1.181-0.376L4.569,20.66l-0.016,0.479l0.601,0.18c-0.077,0.436-0.183,1.278,0.06,1.652%20c0.144,0.112,0.179,0.159,0.371-0.108c0.215-0.299,0.245-0.191,0.261-0.032c0.016,0.16-0.016,0.878-0.463,0.782%20s-0.638-0.415-0.734-2.186c-0.048,1.612-0.016,2.505,0.702,2.697c0.718,0.192,0.83-0.846,0.638-1.771%20c-0.192-0.926-0.456,0.164-0.584,0.211c-0.107,0.04-0.106-0.69-0.075-1.192L6.555,21.737z'/%3e%3cpath%20fill='%23404040'%20d='M7.186,15.228c-0.072-0.153,0.342-0.514,0.342-0.514l0.009-0.82l-0.559,0.559%20c0,0-0.442,0.009-0.676,0.036c0.37-0.387,0.342-0.91-0.081-0.505c-0.424,0.406-0.55,0.946-0.55,0.946l1.162-0.099l0.568-0.604%20v0.261c0,0-0.18,0.207-0.351,0.397c-0.189,0.73,0.37,0.694,0.37,0.694l0.487-0.46l0.045-0.306L7.52,15.291%20C7.519,15.291,7.258,15.381,7.186,15.228z%20M5.96,14.507c0,0,0.171-0.351,0.315-0.378s0.162,0.117-0.099,0.36%20C6.095,14.498,5.96,14.507,5.96,14.507z'/%3e%3cpath%20fill='%23404040'%20d='M8.42,12.948l-0.73,1.874c0,0,0.892-0.577,1.09-1.28C8.979,12.84,8.42,12.948,8.42,12.948z%20M8.555,13.588C8.429,13.957,8.051,14.3,8.051,14.3l0.414-1.009C8.465,13.291,8.682,13.219,8.555,13.588z'/%3e%3cpath%20fill='%23404040'%20d='M11.34,7.185c-0.053-0.045-0.132-0.039-0.176,0.014c-0.041,0.047-0.648,0.76-1.148,1.411%20C9.939,8.626,9.795,8.656,9.643,8.691c0.11-0.15,0.245-0.296,0.308-0.359C10,8.283,10,8.204,9.952,8.155%20c-0.049-0.049-0.128-0.049-0.177,0C9.758,8.171,9.384,8.547,9.269,8.838C9.251,8.882,9.26,8.933,9.292,8.968%20C9.315,8.995,9.35,9.009,9.385,9.009c0.011,0,0.022-0.001,0.033-0.004c0.106-0.029,0.244-0.061,0.371-0.089%20C9.588,9.19,9.427,9.433,9.375,9.57C9.358,9.616,9.369,9.667,9.403,9.702c0.034,0.034,0.087,0.045,0.132,0.03%20C9.6,9.708,9.678,9.691,9.751,9.681l-0.195,0.34c-0.034,0.06-0.014,0.136,0.046,0.17c0.02,0.011,0.041,0.017,0.063,0.017%20c0.043,0,0.085-0.022,0.108-0.063l0.315-0.55c0.022-0.039,0.022-0.087-0.001-0.126c-0.023-0.039-0.068-0.07-0.111-0.061%20c-0.008,0-0.113,0.004-0.242,0.022c0.107-0.169,0.271-0.392,0.453-0.63c0.007-0.008,0.012-0.013,0.017-0.022%20c0.402-0.524,0.897-1.12,1.151-1.417C11.398,7.309,11.393,7.23,11.34,7.185z'/%3e%3cpath%20fill='%23404040'%20d='M30.723,16.252l-1.087,0.294l0.066,0.132l0.163-0.008c0.176,0.036,0.292,0.099,0.287,0.219%20l-0.219,2.669l-1.087-1.187l0.273-1.242c0.031-0.156,0.128-0.255,0.269-0.316l0.175-0.075l-0.072-0.156l-1.153,0.294l0.078,0.144%20l0.239-0.015c0.149,0.082,0.232,0.184,0.194,0.321l-0.17,0.862l-0.701-0.765c-0.081-0.095-0.061-0.177,0.016-0.251l0.235-0.115%20l-0.084-0.144l-1.305,0.323l0.108,0.144l0.304-0.016c0.052,0.021,0.104,0.051,0.155,0.101l1.157,1.307l-0.245,1.242l-1.88-2.242%20c-0.022-0.033-0.017-0.071-0.002-0.112l0.355-0.197L26.68,17.31l-1.503,0.406l0.072,0.108l0.283,0.004%20c0.156,0.021,0.291,0.071,0.389,0.176l2.316,2.761l0.09-0.03l0.393-1.786l1.199,1.354l0.096-0.054l0.402-3.418%20c0.013-0.175,0.124-0.293,0.283-0.384l0.083-0.042L30.723,16.252z'/%3e%3cpath%20fill='%23404040'%20d='M40.64,13.838c-0.455-0.539-0.73,0.012-0.634,0.718s1.065,1.58,1.065,1.58%20c-0.215,1.496-1.879,0.132-2.442-0.862c0.491,1.604,2.082,2.729,2.561,1.843C41.669,16.231,41.094,14.376,40.64,13.838z%20M40.4,14.747c-0.203-0.443,0.12-0.467,0.299-0.156s0.239,0.407,0.335,0.814C41.035,15.406,40.604,15.19,40.4,14.747z'/%3e%3cpath%20fill='%23404040'%20d='M37.6,8.895c-0.275-0.18-0.73-0.778-0.73-0.778l-0.44,0.377c-0.324-0.3-0.672-0.574-0.864-0.677%20c-0.215-0.096-0.778,0.12-0.73,0.12c0,0-0.694,0.227-0.371,1.089c0.323,0.862,1.017,1.484,1.017,1.484s0.706,0.694,1.221-0.335%20c0.467-0.251,0.658-0.491,0.395-0.934C37,9.076,36.811,8.862,36.595,8.649c0.048-0.054,0.113-0.127,0.18-0.21%20C37.085,8.955,37.384,9.063,37.6,8.895z%20M35.972,10.283c-0.347-0.299-1.041-1.424-1.245-1.699c-0.203-0.275,0.024-0.443,0.024-0.443%20s1.484,1.723,1.735,2.13C36.427,10.367,36.319,10.582,35.972,10.283z%20M36.81,9.457c0.168,0.287,0.156,0.395-0.072,0.503%20c-0.239-0.515-1.699-1.987-1.699-1.987s0.144-0.156,0.407,0.048C35.709,8.225,36.642,9.17,36.81,9.457z'/%3e%3cpath%20fill='%23404040'%20d='M25.911,9.389c-0.054,0.153-0.369,0.234-0.369,0.234l-0.394,0.112l-0.165-0.274l0.081-0.171%20l-0.523-0.045l-0.189,0.189l0.279,0.045l0.137,0.364l-0.746,0.212c-0.209-0.124-0.499,0.001-0.499,0.001s-0.018,0.108,0.054,0.099%20s0.216,0.126,0.216,0.126s0.144,0.261,0.297,0.595c0.153,0.333,0.523,0.189,0.523,0.189s-0.251-0.539-0.438-0.857l1.727-0.522%20c0.261,1.289-0.27,1.874-0.667,2.577c1.541-1.081,1.198-2.46,1.198-2.46s0.009-0.099,0.054-0.189%20C26.407,9.524,26.19,9.461,25.911,9.389z'/%3e%3cpath%20fill='%23404040'%20d='M28.056,11.461l-0.351-0.703l0.054-0.216l-0.138,0.008c0.124-0.178,0.23-0.377,0.282-0.62%20c-0.126-0.108-0.541-0.117-0.541-0.117l0.09,0.117c0,0-0.081,0.856-0.793,1.433c0.201-0.108,0.495-0.291,0.755-0.558l0.381,0.693%20c0,0-0.036-0.009-0.054,0.144c0.144,0.153,0.351,0.135,0.351,0.135L28.056,11.461z'/%3e%3cg%3e%3cpath%20fill='%23404040'%20d='M42.592,23.709c0.01,0.001,0.021,0.001,0.03,0.001c0.269,0,0.501-0.338,0.546-0.805l0,0%20c0.047-0.485-0.131-0.872-0.413-0.899c-0.009-0.001-0.02,0.007-0.03,0.008l-0.017-0.109l-0.18-0.09l0.048,0.239%20c-0.08,0.039-0.157,0.1-0.22,0.198c-0.094,0.147-0.156,0.346-0.176,0.559C42.132,23.295,42.31,23.682,42.592,23.709z%20M42.566,22.386c0.052-0.082,0.112-0.131,0.158-0.131c0.002,0,0.005,0,0.007,0c0.1,0.01,0.223,0.259,0.188,0.626%20c-0.035,0.36-0.197,0.579-0.298,0.579c-0.002,0-0.004,0-0.007,0c-0.1-0.01-0.223-0.258-0.188-0.626%20C42.444,22.663,42.495,22.499,42.566,22.386z'/%3e%3cpath%20fill='%23404040'%20d='M43.672,24.429c0,0-0.036-2.289-0.216-3.109c-0.18-0.009-0.424-0.045-0.424-0.045v0.189l0.27,0.225%20c0,0,0.099,0.825,0.168,1.772c-0.191,0.2-0.778,0.811-0.988,0.976c-0.252,0.198-0.667,0.144-0.667,0.144%20c0.144,0.261,0.442,0.288,0.442,0.288s0.153-0.18,0.252-0.234c0.069-0.042,0.147-0.106,0.227-0.176%20c0.007,0.233,0.043,1.359,0.043,1.545c0.081-0.234,0.18-0.55,0.162-0.865c-0.013-0.226-0.017-0.638-0.018-0.856%20c0.23-0.228,0.449-0.482,0.561-0.617c0.05,0.754,0.076,1.552,0.016,2.058C43.609,25.249,43.672,24.429,43.672,24.429z'/%3e%3c/g%3e%3cpath%20fill='%23404040'%20d='M10.085,37.953c0,0-0.443-0.263-0.586-0.527c-0.144-0.263,0.203-0.359,0.61,0.084%20s0.73,0.766,0.395,0.766c0.108,0.084,0.191,0.191,0.191,0.191s0.515,0.096,0.778,0.371c0.263,0.275,0.79,0.778,0.79,0.778%20s0.18,0.275-0.275,0.132c0.072,0.096,0.144,0.191,0.144,0.191s0.91,0.227,0.251-0.467c-0.658-0.694-1.185-0.934-1.532-1.065%20c0,0,0.096-0.335-0.156-0.586c-0.251-0.251-0.574-0.586-1.173-0.826c-0.598-0.239-0.215,0.323-0.108,0.467%20c0.108,0.144,0.658,0.563,0.658,0.563L10.085,37.953z'/%3e%3cpath%20fill='%23767676'%20d='M31.364,41.83c-0.11,0-0.228-0.03-0.275-0.13c-0.084-0.178,0.133-0.35,0.332-0.48%20c0.597-0.391,1.106-0.464,1.3-0.332c0.051,0.033,0.079,0.087,0.077,0.146c0,0.005,0,0.01-0.001,0.015l0.221-0.082l0.447-0.55%20c0.043-0.054,0.121-0.063,0.176-0.018c0.054,0.043,0.062,0.122,0.018,0.176l-0.469,0.576c-0.014,0.017-0.032,0.03-0.053,0.038%20l-0.847,0.315c-0.063,0.021-0.129-0.006-0.157-0.064c-0.027-0.059-0.005-0.129,0.052-0.161c0.115-0.065,0.229-0.145,0.301-0.203%20c-0.13-0.006-0.354,0.041-0.642,0.187c0.112,0.016,0.139,0.064,0.152,0.09c0.016,0.029,0.043,0.106-0.037,0.192%20c-0.125,0.137-0.227,0.2-0.414,0.26C31.5,41.818,31.434,41.83,31.364,41.83z%20M31.361,41.58c0.021,0.002,0.074-0.003,0.108-0.014%20c0.05-0.017,0.091-0.031,0.125-0.049c-0.033-0.008-0.063-0.029-0.08-0.06C31.437,41.512,31.39,41.552,31.361,41.58z'/%3e%3cpath%20fill='%23767676'%20d='M33.651,40.954c-0.025,0-0.051-0.008-0.073-0.023c-0.056-0.04-0.068-0.118-0.028-0.175%20c0.085-0.118,0.276-0.397,0.402-0.618c-0.204,0.055-0.438,0.146-0.514,0.27c-0.024,0.041-0.028,0.08-0.011,0.128%20c0.022,0.065-0.012,0.137-0.076,0.16c-0.066,0.024-0.137-0.012-0.16-0.076c-0.042-0.119-0.03-0.237,0.033-0.342%20c0.204-0.334,0.903-0.434,0.934-0.438c0.035-0.007,0.086,0.011,0.113,0.045c0.027,0.033,0.036,0.079,0.021,0.12%20c-0.096,0.275-0.521,0.872-0.54,0.897C33.729,40.936,33.69,40.954,33.651,40.954z'/%3e%3cg%3e%3cpath%20fill='%23bebebe'%20d='M3.875,26.167c0.139,0.09,0.395,0.255,0.606,0.104c0.233-0.167,0.163-0.498-0.005-1.172%20c-0.052-0.208-0.031-0.317,0.003-0.348c0.063-0.058,0.291-0.041,0.496,0.035c0.132,0.051,0.5,0.308,0.614,0.579%20c0.051,0.119,0.03,0.192,0.011,0.236c-0.26,0.595-0.117,1.41,0.333,1.898c0.46,0.499,1.972,0.875,3.159,0.777%20c0.029-0.003,0.071-0.006,0.103-0.009c-0.024,0.457-0.059,0.894-0.103,1.266c-0.116,0.974,0.383,2.159,1.091,2.59%20c0.351,0.214,0.713,0.216,1.021,0.009c0.421-0.286,0.764-0.386,1.008-0.305c0.252,0.084,0.462,0.369,0.626,0.849%20c0.23,0.675,0.112,0.896,0.051,0.96c-0.094,0.097-0.307,0.107-0.572,0.028l-0.146-0.045c-0.521-0.164-1.307-0.409-1.754-0.028%20c-0.244,0.206-0.335,0.548-0.271,1.017c0.054,0.392,0.248,0.839,0.507,1.297c-0.966-0.297-1.612-0.818-1.649-1.005%20c-0.117-0.585-0.517-0.913-1.314-1.387c-0.347-0.207-0.609-0.22-0.777-0.041c-0.143,0.15-0.144,0.378-0.086,0.608%20c-0.468-0.396-1.033-0.972-1.402-1.381l-0.028,0.025c0.283,0.54,0.593,1.063,0.92,1.574c0.382,0.338,0.767,0.629,1.036,0.701%20c0.1,0.026,0.207-0.011,0.268-0.096c0.061-0.084,0.063-0.198,0.005-0.284c-0.211-0.315-0.312-0.601-0.333-0.747%20c0.034,0.014,0.081,0.036,0.141,0.071c0.765,0.454,1.006,0.69,1.079,1.055c0.097,0.484,1.134,1.249,2.521,1.519%20c0.591,0.867,1.348,1.714,1.903,2.263c-0.2,0.048-0.341,0.152-0.407,0.311c-0.098,0.229-0.057,0.61,0.691,1.117%20c0.943,0.638,1.642,0.882,2.077,0.737c0.093-0.031,0.174-0.08,0.24-0.145c0.123,0.086,0.254,0.18,0.391,0.277%20c0.69,0.492,1.54,1.099,2.258,1.402c0.193,0.475,1.196,0.886,2.356,1.212C21.67,43.879,22.82,44,24,44%20c0.141,0,0.278-0.018,0.419-0.021c-3.9-0.583-5.683-1.371-5.766-1.654c0.013-0.113-0.053-0.221-0.159-0.261%20c-0.684-0.259-1.565-0.889-2.274-1.395c-0.22-0.157-0.426-0.304-0.61-0.43c-0.065-0.044-0.146-0.057-0.221-0.029%20c-0.074,0.024-0.133,0.083-0.157,0.157c-0.021,0.066-0.053,0.089-0.094,0.103c-0.196,0.071-0.738-0.069-1.635-0.678%20c-0.42-0.284-0.511-0.475-0.519-0.499c0.021-0.021,0.178-0.085,0.551-0.006c0.111,0.02,0.225-0.032,0.275-0.135%20c0.05-0.103,0.024-0.227-0.063-0.301c-0.458-0.391-1.328-1.297-2.035-2.249c0.205,0.013,0.413,0.02,0.627,0.007%20c1.916-0.12,3.958,0.082,4.203,0.176c0.091,0.035,0.15,0.085,0.176,0.148c0.037,0.095,0.012,0.244-0.072,0.421%20c-0.131,0.274-0.104,0.584,0.075,0.849c0.289,0.429,0.92,0.665,1.753,0.665c0.091,0,0.184-0.003,0.279-0.008%20c0.761-0.046,2.063-0.213,2.231-0.818c0.038-0.137,0.046-0.405-0.333-0.667c-0.283-0.195-0.443-0.389-0.43-0.518%20c0.014-0.127,0.211-0.279,0.526-0.409c0.737-0.302,2.497-0.82,4.258-1.076c0.516,0.929,1.364,1.495,1.902,1.845%20c0.151,0.099,0.323,0.251,0.284,0.42c-0.061,0.258-0.55,0.582-1.182,0.654c-0.164,0.019-0.341,0.032-0.523,0.046%20c-0.985,0.077-2.336,0.184-2.259,1.297c0.028,0.407,0.227,0.723,0.572,0.91c0.582,0.316,1.538,0.212,2.383-0.254%20c1.143-0.632,1.491-0.473,1.842,0.123c0.393,0.667,0.118,1.221-0.081,1.42c-0.057,0.057-0.083,0.138-0.07,0.217%20c0.014,0.079,0.063,0.147,0.136,0.184c0.054,0.028,0.557,0.255,1.517-0.11c0.324-0.122,0.449-0.105,0.465-0.114%20c0.001,0.031-0.015,0.134-0.119,0.298c-0.206,0.329-1.041,0.607-1.643,0.315c-0.063-0.029-0.134-0.032-0.199-0.008%20c-0.064,0.025-0.115,0.076-0.142,0.141c-0.14,0.35-0.512,0.748-0.756,0.985c0.264-0.04,0.531-0.071,0.792-0.121%20c0.118-0.144,0.232-0.299,0.321-0.456c0.78,0.238,1.734-0.088,2.051-0.589c0.226-0.358,0.258-0.669,0.09-0.874%20c-0.271-0.333-0.848-0.117-1.037-0.044c-0.349,0.132-0.614,0.169-0.799,0.171c0.198-0.396,0.301-0.998-0.093-1.668%20c-0.626-1.063-1.458-0.892-2.516-0.307c-0.692,0.381-1.475,0.484-1.902,0.253c-0.193-0.105-0.296-0.271-0.313-0.507%20c-0.039-0.574,0.722-0.679,1.8-0.763c0.188-0.015,0.371-0.029,0.541-0.049c0.698-0.079,1.476-0.461,1.611-1.035%20c0.048-0.205,0.047-0.601-0.498-0.955c-0.602-0.391-1.231-0.848-1.645-1.492c0.353-0.04,0.702-0.071,1.038-0.082%20c2.5-0.08,4.501-0.497,5.49-1.142c0.332-0.217,0.548-0.411,0.521-0.66c-0.026-0.255-0.278-0.353-0.502-0.438%20c-0.15-0.059-0.339-0.131-0.399-0.227c-0.033-0.054-0.033-0.146,0.001-0.259c0.114-0.381,0.606-0.942,1.23-1.222%20c0.753-0.337,1.953-0.518,2.279-0.245c0.032,0.026,0.105,0.088,0.057,0.293c-0.155,0.649-0.2,1.104,0.055,1.362%20c0.236,0.239,0.618,0.189,0.962,0.113c0.506-0.116,2.103-1.028,3.694-2.278c0.071,0.36,0.076,0.767-0.036,1.251%20c-0.266,1.145-0.611,1.553-0.854,1.694c-0.193,0.111-0.364,0.085-0.522,0.038c-0.19-0.059-0.444-0.008-0.714,0.139%20c-0.473,0.259-0.848,0.735-1.002,1.276c-0.146,0.514-0.016,0.98,0.333,1.189c0.134,0.078,0.414,0.184,0.839,0.029%20c-1.165,1.85-2.506,3.654-4.693,5.388c-0.334,0.265-0.638,0.501-0.919,0.716c0.746-0.326,1.463-0.702,2.161-1.109%20c2.065-1.853,3.309-3.769,4.489-5.729c0.065-0.107,0.04-0.247-0.059-0.325c-0.1-0.078-0.238-0.071-0.33,0.018%20c-0.618,0.604-1.048,0.694-1.231,0.583c-0.146-0.087-0.19-0.338-0.109-0.623c0.176-0.614,0.627-0.901,0.762-0.975%20c0.192-0.105,0.306-0.104,0.331-0.099c0.219,0.065,0.552,0.127,0.916-0.084c0.484-0.282,0.841-0.94,1.09-2.014%20c0.159-0.683,0.117-1.235-0.019-1.711c0.774-0.64,1.524-1.351,2.121-2.08c-0.003,0.459,0.098,0.736,0.304,0.828%20c0.315,0.14,0.616-0.18,0.846-0.477c0.908-1.178,0.659-2.127,0.501-2.494c0.147-0.195,0.44-0.591,0.738-1.024%20c0.03-0.327,0.035-0.661,0.05-0.992c-0.48,0.79-1.269,1.823-1.279,1.836c-0.063,0.083-0.067,0.197-0.013,0.286%20c0.021,0.035,0.529,0.887-0.394,2.083c-0.106,0.138-0.184,0.217-0.234,0.261c-0.035-0.217-0.005-0.703,0.08-1.164%20c0.021-0.116-0.067-0.193-0.178-0.238c-0.108-0.045-0.262,0.033-0.327,0.132c-0.587,0.884-1.469,1.764-2.397,2.544%20c-0.145-0.318-0.322-0.604-0.493-0.875c-0.291-0.461-0.542-0.859-0.575-1.33c-0.032-0.472,0.079-0.819,0.333-1.035%20c0.26-0.22,0.619-0.26,0.86-0.204c0.254,0.059,0.489-0.001,0.672-0.169c0.309-0.283,0.434-0.85,0.335-1.516%20c-0.095-0.636-0.359-1.383-0.819-1.572c-0.206-0.085-0.431-0.049-0.631,0.1c-0.173,0.13-0.31,0.35-0.455,0.581%20c-0.18,0.289-0.384,0.615-0.59,0.627c-0.004,0-0.009,0-0.013,0c-0.153,0-0.368-0.163-0.607-0.462%20c-0.387-0.483-0.676-1.249-0.912-2.061c1.691-0.964,2.641-1.893,3.2-2.444c0.115-0.114,0.215-0.212,0.303-0.293%20c0.116-0.106,0.333-0.276,0.491-0.213c0.154,0.062,0.328,0.366,0.367,0.908c0.046,0.646,0.232,1.05,0.555,1.202%20c0.269,0.125,0.577,0.062,0.925-0.186c0.278-0.199,0.446-0.482,0.485-0.819c0.058-0.502-0.182-0.988-0.347-1.177%20c-0.137-0.155-0.543-0.703-0.066-1.232c0.24-0.266,0.597-0.381,0.898-0.43c-0.048-0.16-0.091-0.322-0.142-0.481%20c-0.373,0.069-0.81,0.225-1.127,0.577c-0.599,0.665-0.342,1.437,0.061,1.896c0.099,0.112,0.265,0.458,0.227,0.79%20c-0.023,0.198-0.114,0.352-0.279,0.47c-0.181,0.129-0.335,0.179-0.421,0.141c-0.106-0.05-0.233-0.283-0.27-0.785%20c-0.05-0.698-0.299-1.185-0.681-1.337c-0.215-0.085-0.566-0.1-1.014,0.309c-0.092,0.084-0.196,0.187-0.316,0.306%20c-0.529,0.522-1.417,1.395-2.985,2.306c-0.101-0.383-0.192-0.765-0.277-1.123c-0.231-0.98-0.415-1.754-0.678-2.12%20c-0.198-0.275-0.423-0.414-0.668-0.414h-0.001c-0.435,0-0.753,0.444-0.963,0.738c-0.04,0.055-0.075,0.105-0.107,0.145%20c-0.099,0.123-0.434,0.334-0.778,0.286c-0.352-0.047-0.645-0.339-0.871-0.867c-0.241-0.563-0.274-1.004-0.096-1.274%20c0.214-0.325,0.663-0.335,0.927-0.311c0.197,0.016,0.418,0.036,0.576-0.134c0.159-0.173,0.18-0.451,0.078-1.063%20c-0.077-0.459-0.438-1.003-0.904-1.575c0.979-0.376,1.978-0.842,2.675-1.366c0.289-0.186,0.582-0.229,0.825-0.119%20c0.215,0.096,0.366,0.298,0.405,0.54c0.063,0.392,0.351,0.657,0.788,0.728c0.533,0.088,1.28-0.143,1.531-0.624%20c0.154-0.295,0.087-0.626-0.186-0.909c-0.349-0.361-0.344-0.495-0.347-0.495c0.032-0.04,0.194-0.074,0.256-0.087%20c0.042-0.009,0.079-0.017,0.107-0.025l0.141-0.038c0.531-0.143,1.047-0.293,1.381-0.443c-0.051-0.07-0.096-0.146-0.148-0.215%20l-0.733,0.273c-0.052-0.07-0.122-0.15-0.178-0.223c-0.186,0.054-0.353,0.099-0.453,0.126l-0.222,0.057%20c-0.186,0.04-0.532,0.112-0.628,0.423c-0.082,0.267,0.065,0.583,0.463,0.995c0.178,0.185,0.123,0.29,0.103,0.329%20c-0.126,0.239-0.633,0.421-1.009,0.362c-0.332-0.054-0.364-0.25-0.374-0.314c-0.066-0.409-0.326-0.751-0.695-0.916%20c-0.4-0.18-0.861-0.124-1.314,0.165c-0.707,0.531-1.738,1.001-2.729,1.373c-0.226-0.259-0.465-0.521-0.702-0.781%20c-0.53-0.58-1.03-1.127-1.242-1.503c-0.068-0.122-0.173-0.345-0.098-0.466c0.099-0.158,0.515-0.241,1.047-0.215%20c0.409,0.026,0.601-0.144,0.697-0.287c0.175-0.261,0.149-0.65-0.075-1.123c-0.226-0.477-0.552-0.797-0.895-0.88%20c-0.235-0.056-0.463-0.003-0.664,0.15c-0.407,0.314-0.666,0.407-1.127,0.142c-0.291-0.169-0.509-0.592-0.644-0.934%20c-0.128,0.05-0.246,0.099-0.342,0.145c-0.04,0.019-0.083,0.034-0.123,0.052c0.155,0.39,0.432,0.922,0.86,1.17%20c0.765,0.443,1.27,0.14,1.682-0.178c0.08-0.062,0.158-0.083,0.242-0.061c0.189,0.045,0.404,0.278,0.561,0.607%20c0.163,0.345,0.161,0.555,0.11,0.631c-0.045,0.066-0.182,0.067-0.255,0.066c-0.782-0.042-1.287,0.11-1.498,0.45%20c-0.161,0.259-0.132,0.587,0.087,0.975c0.239,0.426,0.759,0.994,1.309,1.596c0.183,0.2,0.376,0.411,0.565,0.626%20c-1.03,0.358-1.946,0.596-2.31,0.666c-0.978,0.187-1.245,0.076-1.318-0.008c-0.06-0.069-0.021-0.221,0.007-0.306%20c0.161-0.485,0.098-0.897-0.181-1.162c-0.292-0.277-0.933-0.492-2.318,0.052c-0.918,0.361-1.407,0.808-1.454,1.329%20c-0.037,0.422,0.24,0.751,0.489,0.904c0.102,0.063,0.245,0.12,0.397,0.178c0.137,0.052,0.423,0.162,0.458,0.22%20c0,0.001-0.021,0.116-0.386,0.363c-0.904,0.611-3.541,0.748-4.492,0.779c0.039,0.126,0.079,0.251,0.123,0.362%20c-0.149,0.03-0.33,0.064-0.531,0.1c0.194,0.784,0.468,1.681,0.816,2.297c0.125,0.22,0.247,0.519,0.124,0.695%20c-0.163,0.235-0.766,0.318-1.471,0.204c-0.56-0.093-1.099,0.07-1.475,0.445c-0.389,0.387-0.558,0.948-0.464,1.541%20c0.121,0.758,0.534,1.619,1.186,1.834c0.294,0.097,0.758,0.1,1.295-0.426c0.344-0.336,0.739-0.444,1.146-0.307%20c0.56,0.188,1.038,0.812,1.138,1.481c0.056,0.38,0.029,0.95-0.003,1.558c-2.179,0.104-5.007,0.982-5.63,1.294%20c-0.448,0.224-0.69,0.498-0.721,0.815c-0.019,0.2,0.045,0.505,0.457,0.818c0.079,0.062,0.207,0.187,0.167,0.343%20c-0.056,0.222-0.427,0.509-1.3,0.648c-1.143,0.184-1.543,0.034-1.68-0.121c-0.106-0.122-0.113-0.339-0.021-0.645%20c0.125-0.413,0.1-0.769-0.077-1.055c-0.277-0.452-0.838-0.598-1.235-0.668c-0.438-0.075-1.908,0.021-3.591,0.16%20c0.037-1.121,0.01-2.296-0.136-2.879c-0.16-0.64-0.476-0.885-0.713-0.979c-0.303-0.12-0.661-0.065-1.006,0.159%20c-0.076,0.05-0.184,0.101-0.257,0.057c-0.139-0.077-0.27-0.433-0.251-1.052C7.376,22.309,7.634,22.059,7.713,22%20c0.074-0.057,0.125-0.058,0.134-0.056l0.085,0.036c0.306,0.134,0.941,0.409,1.369,0.095c0.267-0.195,0.373-0.563,0.318-1.093%20c-0.08-0.766,0.007-1.671,0.11-2.369c0.21-0.052,0.421-0.106,0.641-0.175c0.08-0.025,0.143-0.05,0.219-0.075%20c-0.456,0.037-0.878,0.09-1.21,0.163c0,0-0.024-0.427,0.039-1.02c-0.03,0.139-0.079,0.377-0.131,0.69%20c-0.639,0.13-1.259,0.186-1.951,0.167c-0.166-0.004-0.381-0.036-0.462-0.16c-0.13-0.2,0.047-0.632,0.145-0.87%20c0.116-0.291,0.145-0.734-0.069-1.021c-0.109-0.146-0.327-0.314-0.728-0.278c-0.973,0.089-1.035,0.911-1.121,2.05%20c-0.021,0.271-0.127,0.324-0.162,0.342C4.664,18.568,4,18.3,3.609,18.059c-0.041,0.169-0.093,0.333-0.13,0.503%20c0.256,0.143,0.79,0.405,1.266,0.405c0.149,0,0.293-0.026,0.42-0.09c0.18-0.091,0.4-0.295,0.435-0.751%20c0.105-1.388,0.229-1.549,0.668-1.589c0.211-0.016,0.264,0.055,0.281,0.078c0.086,0.116,0.073,0.371-0.014,0.587%20C6.421,17.48,6.183,18.06,6.456,18.48c0.159,0.245,0.451,0.375,0.867,0.387c0.67,0.02,1.274-0.031,1.886-0.143%20c-0.094,0.698-0.164,1.558-0.086,2.313c0.035,0.332-0.006,0.558-0.115,0.638c-0.198,0.146-0.69-0.069-0.874-0.15l-0.109-0.046%20c-0.174-0.064-0.382-0.031-0.57,0.096c-0.212,0.142-0.57,0.518-0.598,1.439c-0.023,0.784,0.151,1.303,0.505,1.502%20c0.134,0.075,0.411,0.163,0.774-0.072c0.119-0.077,0.35-0.191,0.552-0.114c0.183,0.072,0.325,0.292,0.411,0.635%20c0.129,0.518,0.158,1.669,0.119,2.8C9.145,27.771,9.073,27.777,9,27.783c-1.123,0.1-2.412-0.311-2.699-0.623%20c-0.318-0.345-0.424-0.941-0.241-1.358c0.085-0.196,0.082-0.414-0.009-0.631c-0.182-0.431-0.675-0.768-0.899-0.853%20c-0.156-0.058-0.686-0.227-1.005,0.06c-0.198,0.177-0.25,0.46-0.154,0.842c0.026,0.107,0.081,0.327,0.113,0.5%20c-0.232-0.159-0.642-0.517-1.016-0.945c0.023,0.272,0.053,0.542,0.086,0.811C3.454,25.853,3.713,26.063,3.875,26.167z%20M37.837,24.135c0.365,0.456,0.733,0.676,1.039,0.648c0.465-0.026,0.741-0.47,0.986-0.861c0.113-0.183,0.231-0.372,0.331-0.446%20c0.082-0.061,0.12-0.045,0.141-0.038c0.178,0.073,0.418,0.535,0.515,1.184c0.082,0.553-0.031,0.938-0.179,1.073%20c-0.061,0.057-0.13,0.072-0.219,0.051c-0.337-0.079-0.881-0.048-1.299,0.309c-0.263,0.224-0.563,0.656-0.508,1.452%20c0.041,0.596,0.337,1.065,0.649,1.562c0.187,0.297,0.374,0.601,0.512,0.94c-1.588,1.268-3.206,2.202-3.649,2.303%20c-0.406,0.093-0.487,0.032-0.495,0.023c-0.033-0.034-0.093-0.188,0.076-0.895c0.101-0.42-0.066-0.663-0.224-0.794%20c-0.599-0.497-2.122-0.132-2.804,0.173c-0.698,0.313-1.331,0.958-1.505,1.534c-0.098,0.326-0.023,0.545,0.056,0.671%20c0.148,0.234,0.423,0.34,0.643,0.426c0.034,0.013,0.077,0.029,0.116,0.046c-0.046,0.039-0.117,0.094-0.229,0.167%20c-0.915,0.597-2.822,0.983-5.232,1.061c-0.409,0.013-0.838,0.056-1.269,0.11c-0.12-0.29-0.199-0.612-0.22-0.976%20c-0.026-0.448,0.114-0.833,0.418-1.145c0.512-0.523,1.392-0.747,1.837-0.721c0.456,0.018,0.919-0.021,1.239-0.377%20c0.304-0.339,0.397-0.896,0.285-1.702c-0.093-0.668-0.341-1.07-0.737-1.195c-0.694-0.218-1.489,0.533-1.8,0.867%20c-0.055,0.06-0.555,0.58-1.143,0.584c-0.002,0-0.005,0-0.007,0c-0.303,0-0.591-0.141-0.856-0.419%20c-0.558-0.584-0.541-1.934-0.482-3.128c0.011,0,0.022,0,0.034,0c2.147,0.022,4.552-0.612,5.336-1.089%20c0.554-0.337,0.82-0.682,0.817-1.052c-0.003-0.336-0.235-0.642-0.693-0.91c-0.299-0.175-0.294-0.34-0.292-0.395%20c0.01-0.357,0.546-0.87,1.334-1.273c0.799-0.409,1.729-0.516,2.075-0.234c0.046,0.037,0.184,0.149,0.09,0.487%20c-0.122,0.443-0.078,0.782,0.133,1.008c0.321,0.343,0.864,0.241,0.954,0.222c1.308-0.436,2.364-0.911,3.255-1.386%20C37.113,22.827,37.418,23.612,37.837,24.135z%20M22.374,22.619c-0.588-0.197-1.174-0.047-1.655,0.423%20c-0.288,0.283-0.554,0.387-0.788,0.309c-0.43-0.142-0.752-0.831-0.849-1.438c-0.068-0.432,0.049-0.835,0.322-1.107%20c0.266-0.265,0.635-0.372,1.042-0.307c0.351,0.058,1.536,0.2,1.961-0.411c0.219-0.313,0.185-0.726-0.099-1.227%20c-0.299-0.528-0.545-1.304-0.727-2.016c1.066-0.037,3.666-0.194,4.653-0.862c0.302-0.204,0.644-0.482,0.604-0.828%20c-0.041-0.355-0.432-0.504-0.777-0.636c-0.119-0.045-0.233-0.087-0.313-0.136c-0.103-0.063-0.271-0.226-0.253-0.434%20c0.027-0.303,0.442-0.634,1.14-0.907c1.28-0.505,1.693-0.246,1.79-0.155c0.175,0.166,0.107,0.473,0.051,0.641%20c-0.138,0.412-0.026,0.659,0.092,0.793c0.338,0.386,1.095,0.302,1.788,0.17c0.396-0.075,1.428-0.345,2.565-0.751%20c0.461,0.552,0.843,1.09,0.907,1.472c0.084,0.5,0.054,0.624,0.074,0.624h0.001c-0.026,0.009-0.122,0-0.192-0.006%20c-0.383-0.032-1.047,0.019-1.387,0.534c-0.279,0.424-0.262,1.011,0.054,1.747c0.373,0.873,0.893,1.115,1.263,1.166%20c0.569,0.081,1.059-0.248,1.236-0.47c0.036-0.045,0.077-0.103,0.123-0.166c0.132-0.185,0.379-0.529,0.558-0.529%20c0.099,0,0.207,0.129,0.262,0.206c0.206,0.286,0.396,1.09,0.598,1.943c0.094,0.398,0.197,0.824,0.311,1.251%20c-0.88,0.476-1.933,0.955-3.245,1.393c-0.085,0.017-0.351,0.038-0.46-0.082c-0.081-0.087-0.087-0.276-0.016-0.532%20c0.157-0.568-0.093-0.875-0.256-1.009c-0.578-0.471-1.754-0.267-2.62,0.176c-0.476,0.244-1.583,0.898-1.605,1.705%20c-0.007,0.235,0.081,0.572,0.539,0.84c0.287,0.168,0.445,0.339,0.446,0.482c0.002,0.17-0.209,0.396-0.577,0.62%20c-0.697,0.425-2.932,1.018-4.92,1.018c-0.055-0.001-0.109-0.001-0.164-0.001c0.033-0.62,0.058-1.202-0.004-1.622%20C23.719,23.642,23.113,22.868,22.374,22.619z%20M9.589,29.593c0.045-0.377,0.082-0.857,0.107-1.366%20c1.194-0.099,3.105-0.243,3.526-0.172c0.474,0.084,0.768,0.227,0.896,0.438c0.099,0.159,0.106,0.378,0.024,0.648%20c-0.146,0.48-0.104,0.857,0.122,1.117c0.221,0.252,0.598,0.376,1.162,0.376c0.278,0,0.602-0.029,0.973-0.089%20c1.314-0.21,1.634-0.729,1.707-1.021c0.078-0.313-0.052-0.635-0.35-0.862c-0.179-0.136-0.271-0.27-0.262-0.374%20c0.012-0.128,0.175-0.279,0.446-0.415c0.575-0.288,3.308-1.128,5.381-1.239c-0.065,1.328-0.073,2.735,0.621,3.462%20c0.367,0.384,0.759,0.563,1.229,0.573c0.78-0.006,1.391-0.621,1.505-0.744c0.489-0.525,1.009-0.816,1.283-0.73%20c0.244,0.077,0.348,0.471,0.392,0.787c0.09,0.644,0.036,1.08-0.161,1.299c-0.174,0.194-0.471,0.227-0.851,0.212%20c-0.523-0.003-1.561,0.203-2.211,0.871c-0.406,0.416-0.595,0.929-0.561,1.523c0.022,0.377,0.108,0.706,0.222,1.012%20c-1.761,0.271-3.494,0.785-4.231,1.088c-0.518,0.213-0.799,0.487-0.834,0.818c-0.036,0.334,0.181,0.664,0.644,0.983%20c0.107,0.074,0.13,0.122,0.134,0.122c-0.043,0.111-0.547,0.378-1.778,0.451c-1.16,0.072-1.507-0.316-1.588-0.437%20c-0.078-0.116-0.092-0.242-0.039-0.354c0.149-0.313,0.178-0.589,0.085-0.821c-0.077-0.195-0.236-0.344-0.46-0.43%20c-0.363-0.14-2.527-0.33-4.414-0.207c-0.345,0.021-0.667-0.007-0.976-0.055c-0.358-0.549-0.632-1.086-0.691-1.518%20c-0.027-0.197-0.032-0.457,0.098-0.566c0.24-0.201,0.918,0.011,1.282,0.123l0.151,0.047c0.464,0.14,0.845,0.08,1.076-0.16%20c0.276-0.287,0.297-0.78,0.062-1.469c-0.219-0.644-0.527-1.023-0.94-1.161c-0.412-0.137-0.885-0.018-1.447,0.365%20c-0.051,0.035-0.207,0.143-0.479-0.021C9.956,31.4,9.485,30.464,9.589,29.593z'/%3e%3cpath%20fill='%23bebebe'%20d='M21.213,15.091l-0.017,0.003c0.06,0.437,0.148,0.862,0.262,1.234%20C21.301,15.638,21.215,15.103,21.213,15.091z'/%3e%3c/g%3e%3cpath%20fill='%23767676'%20d='M25.116,43.687c-0.133,0-0.256-0.007-0.365-0.021c-0.306-0.042-0.464-0.135-0.481-0.286%20c-0.051-0.421,1.125-0.575,1.26-0.591c0.326-0.04,0.639-0.044,0.883-0.011c0.306,0.042,0.464,0.135,0.481,0.286%20c0.019,0.15-0.112,0.278-0.4,0.391c-0.228,0.09-0.532,0.161-0.86,0.2C25.453,43.676,25.278,43.687,25.116,43.687z%20M24.528,43.348%20c0.095,0.063,0.488,0.128,1.075,0.059c0.585-0.07,0.953-0.229,1.031-0.313c-0.095-0.063-0.488-0.128-1.076-0.058%20C24.974,43.107,24.605,43.265,24.528,43.348z%20M26.648,43.077L26.648,43.077L26.648,43.077L26.648,43.077z'/%3e%3c/svg%3e",Rn="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2048%2048'%20width='48px'%20height='48px'%3e%3cpath%20fill='%23FF3D00'%20d='M43.2,33.9c-0.4,2.1-2.1,3.7-4.2,4c-3.3,0.5-8.8,1.1-15,1.1c-6.1,0-11.6-0.6-15-1.1c-2.1-0.3-3.8-1.9-4.2-4C4.4,31.6,4,28.2,4,24c0-4.2,0.4-7.6,0.8-9.9c0.4-2.1,2.1-3.7,4.2-4C12.3,9.6,17.8,9,24,9c6.2,0,11.6,0.6,15,1.1c2.1,0.3,3.8,1.9,4.2,4c0.4,2.3,0.9,5.7,0.9,9.9C44,28.2,43.6,31.6,43.2,33.9z'/%3e%3cpath%20fill='%23FFF'%20d='M20%2031L20%2017%2032%2024z'/%3e%3c/svg%3e",zn="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3csvg%20fill='none'%20version='1.1'%20viewBox='0%200%2042%2042'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20transform='translate(-.20472%20.0012327)'%3e%3cpath%20d='m16.44%200.964%204.921%207.79c0.79%201.252-0.108%202.883-1.588%202.883h-2.013v11.663h-2.91v-23.212c0.61%200%201.22%200.292%201.59%200.876z'%20fill='%238fbcfa'/%3e%3cpath%20d='m8.342%208.755%204.921-7.791a1.864%201.864%200%200%201%201.59-0.876v23.212a4.87%204.87%200%200%200-0.252-6e-3c-0.99%200-1.907%200.311-2.658%200.842v-12.499h-2.013c-1.48%200-2.38-1.631-1.589-2.882z'%20fill='%23468bff'/%3e%3cpath%20d='m30.278%2031h-12.247a4.596%204.596%200%200%200%201.219-2.91h22.577c0%200.61-0.292%201.22-0.875%201.59l-7.792%204.92c-1.251%200.791-2.883-0.108-2.883-1.588v-2.012z'%20fill='%23fdbb11'/%3e%3cpath%20d='m33.16%2021.581%207.79%204.921c0.585%200.369%200.876%200.979%200.876%201.589h-22.576a4.619%204.619%200%200%200-0.858-2.91h11.887v-2.011c0-1.48%201.631-2.38%202.882-1.589z'%20fill='%23f6d785'/%3e%3cpath%20d='m8.24%2034.25-7.107%207.108a1.864%201.864%200%200%200%201.742%200.504l8.989-2.03c1.443-0.325%201.961-2.114%200.915-3.16l-1.423-1.423%205.356-5.356a2.805%202.805%200%200%200%200-3.966l-0.074-0.075z'%20fill='%23ff9a9d'/%3e%3cpath%20d='m7.243%2031.135%205.355-5.356a2.805%202.805%200%200%201%203.967%200l0.074%200.074-15.505%2015.505a1.864%201.864%200%200%201-0.504-1.742l2.029-8.989c0.325-1.444%202.115-1.961%203.161-0.915z'%20fill='%23fe363b'/%3e%3c/g%3e%3c/svg%3e",On="data:image/svg+xml,%3csvg%20width='400'%20height='400'%20viewBox='0%200%20400%20400'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M101.008%2042L190.99%20124.905L190.99%20124.886L190.99%2042.1913H208.506L208.506%20125.276L298.891%2042V136.524L336%20136.524V272.866H299.005V357.035L208.506%20277.525L208.506%20357.948H190.99L190.99%20278.836L101.11%20358V272.866H64V136.524H101.008V42ZM177.785%20153.826H81.5159V255.564H101.088V223.472L177.785%20153.826ZM118.625%20231.149V319.392L190.99%20255.655L190.99%20165.421L118.625%20231.149ZM209.01%20254.812V165.336L281.396%20231.068V272.866H281.489V318.491L209.01%20254.812ZM299.005%20255.564H318.484V153.826L222.932%20153.826L299.005%20222.751V255.564ZM281.375%20136.524V81.7983L221.977%20136.524L281.375%20136.524ZM177.921%20136.524H118.524V81.7983L177.921%20136.524Z'%20fill='black'/%3e%3c/svg%3e",Ln="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2048%2048'%20width='48px'%20height='48px'%3e%3cpath%20fill='%23ff3d00'%20d='M44,24c0,11-9,20-20,20S4,35,4,24S13,4,24,4S44,13,44,24z'/%3e%3cpath%20fill='%23fff'%20d='M26,16.2c-0.6-0.6-1.5-0.9-2.5-1.1c-0.4-0.5-1-1-1.9-1.5c-1.6-0.8-3.5-1.2-5.3-0.9h-0.4%20c-0.1,0-0.2,0.1-0.4,0.1c0.2,0,1,0.4,1.6,0.6c-0.3,0.2-0.8,0.2-1.1,0.4c0,0,0,0-0.1,0L15.7,14c-0.1,0.2-0.2,0.4-0.2,0.5%20c1.3-0.1,3.2,0,4.6,0.4C19,15,18,15.3,17.3,15.7c-0.5,0.3-1,0.6-1.3,1.1c-1.2,1.3-1.7,3.5-1.3,5.9c0.5,2.7,2.4,11.4,3.4,16.3%20l0.3,1.6c0,0,3.5,0.4,5.6,0.4c1.2,0,3.2,0.3,3.7-0.2c-0.1,0-0.6-0.6-0.8-1.1c-0.5-1-1-1.9-1.4-2.6c-1.2-2.5-2.5-5.9-1.9-8.1%20c0.1-0.4,0.1-2.1,0.4-2.3c2.6-1.7,2.4-0.1,3.5-0.8c0.5-0.4,1-0.9,1.2-1.5C29.4,22.1,27.8,18,26,16.2z'/%3e%3cpath%20fill='%23fff'%20d='M24,42c-9.9,0-18-8.1-18-18c0-9.9,8.1-18,18-18c9.9,0,18,8.1,18,18C42,33.9,33.9,42,24,42z%20M24,8%20C15.2,8,8,15.2,8,24s7.2,16,16,16s16-7.2,16-16S32.8,8,24,8z'/%3e%3cpath%20fill='%230277bd'%20d='M19,21.1c-0.6,0-1.2,0.5-1.2,1.2c0,0.6,0.5,1.2,1.2,1.2c0.6,0,1.2-0.5,1.2-1.2%20C20.1,21.7,19.6,21.1,19,21.1z%20M19.5,22.2c-0.2,0-0.3-0.1-0.3-0.3c0-0.2,0.1-0.3,0.3-0.3s0.3,0.1,0.3,0.3%20C19.8,22.1,19.6,22.2,19.5,22.2z%20M26.8,20.6c-0.6,0-1,0.5-1,1c0,0.6,0.5,1,1,1c0.6,0,1-0.5,1-1S27.3,20.6,26.8,20.6z%20M27.2,21.5%20c-0.1,0-0.3-0.1-0.3-0.3c0-0.1,0.1-0.3,0.3-0.3c0.1,0,0.3,0.1,0.3,0.3S27.4,21.5,27.2,21.5z%20M19.3,18.9c0,0-0.9-0.4-1.7,0.1%20c-0.9,0.5-0.8,1.1-0.8,1.1s-0.5-1,0.8-1.5C18.7,18.1,19.3,18.9,19.3,18.9%20M27.4,18.8c0,0-0.6-0.4-1.1-0.4c-1,0-1.3,0.5-1.3,0.5%20s0.2-1.1,1.5-0.9C27.1,18.2,27.4,18.8,27.4,18.8'/%3e%3cpath%20fill='%238bc34a'%20d='M23.3,35.7c0,0-4.3-2.3-4.4-1.4c-0.1,0.9,0,4.7,0.5,5s4.1-1.9,4.1-1.9L23.3,35.7z%20M25,35.6%20c0,0,2.9-2.2,3.6-2.1c0.6,0.1,0.8,4.7,0.2,4.9c-0.6,0.2-3.9-1.2-3.9-1.2L25,35.6z'/%3e%3cpath%20fill='%23689f38'%20d='M22.5,35.7c0,1.5-0.2,2.1,0.4,2.3c0.6,0.1,1.9,0,2.3-0.3c0.4-0.3,0.1-2.2-0.1-2.6%20C25,34.8,22.5,35.1,22.5,35.7'/%3e%3cpath%20fill='%23ffca28'%20d='M22.3,26.8c0.1-0.7,2-2.1,3.3-2.2c1.3-0.1,1.7-0.1,2.8-0.3c1.1-0.3,3.9-1,4.7-1.3%20c0.8-0.4,4.1,0.2,1.8,1.5c-1,0.6-3.7,1.6-5.7,2.2c-1.9,0.6-3.1-0.6-3.8,0.4c-0.5,0.8-0.1,1.8,2.2,2c3.1,0.3,6.2-1.4,6.5-0.5%20c0.3,0.9-2.7,2-4.6,2.1c-1.8,0-5.6-1.2-6.1-1.6C22.9,28.7,22.2,27.8,22.3,26.8'/%3e%3c/svg%3e",Pn="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='92mm'%20height='92mm'%20viewBox='0%200%2092%2092'%3e%3cg%20transform='translate(-40.921%20-17.417)'%3e%3ccircle%20cx='75.921'%20cy='53.903'%20r='30'%20style='fill:none;fill-opacity:1;stroke:%233050ff;stroke-width:10;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1'/%3e%3cpath%20d='M67.515%2037.915a18%2018%200%200%201%2021.051%203.313%2018%2018%200%200%201%203.138%2021.078'%20style='fill:none;fill-opacity:1;stroke:%233050ff;stroke-width:5;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1'/%3e%3crect%20width='18.846'%20height='39.963'%20x='3.706'%20y='122.09'%20ry='0'%20style='opacity:1;fill:%233050ff;fill-opacity:1;stroke:none;stroke-width:8;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1'%20transform='rotate(-46.235)'/%3e%3c/g%3e%3c/svg%3e";var Bn,Fn={exports:{}},Un={};function Hn(){if(Bn)return Un;Bn=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(t,n,a){var s=null;if(void 0!==a&&(s=""+a),void 0!==n.key&&(s=""+n.key),"key"in n)for(var r in a={},n)"key"!==r&&(a[r]=n[r]);else a=n;return n=a.ref,{$$typeof:e,type:t,key:s,ref:void 0!==n?n:null,props:a}}return Un.Fragment=t,Un.jsx=n,Un.jsxs=n,Un}var Wn,qn,Vn={};function Gn(){return Wn||(Wn=1,"production"!==process.env.NODE_ENV&&function(){function t(e){if(null==e)return null;if("function"==typeof e)return e.$$typeof===j?null:e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case p:return"Fragment";case g:return"Profiler";case m:return"StrictMode";case v:return"Suspense";case x:return"SuspenseList";case k:return"Activity"}if("object"==typeof e)switch(e.tag,e.$$typeof){case h:return"Portal";case y:return(e.displayName||"Context")+".Provider";case f:return(e._context.displayName||"Context")+".Consumer";case b:var n=e.render;return(e=e.displayName)||(e=""!==(e=n.displayName||n.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case w:return null!==(n=e.displayName||null)?n:t(e.type)||"Memo";case C:n=e._payload,e=e._init;try{return t(e(n))}catch(a){}}return null}function n(e){return""+e}function a(e){try{n(e);var t=!1}catch(r){t=!0}if(t){var a=(t=console).error,s="function"==typeof Symbol&&Symbol.toStringTag&&e[Symbol.toStringTag]||e.constructor.name||"Object";return a.call(t,"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.",s),n(e)}}function s(e){if(e===p)return"<>";if("object"==typeof e&&null!==e&&e.$$typeof===C)return"<...>";try{var n=t(e);return n?"<"+n+">":"<...>"}catch(a){return"<...>"}}function r(){return Error("react-stack-top-frame")}function o(){var e=t(this.type);return E[e]||(E[e]=!0),void 0!==(e=this.props.ref)?e:null}function i(e,n,s,r,i,d,h,p){var m,g=n.children;if(void 0!==g)if(r){if(N(g)){for(r=0;r<g.length;r++)l(g[r]);Object.freeze&&Object.freeze(g)}}else l(g);if(S.call(n,"key")){g=t(e);var f=Object.keys(n).filter(function(e){return"key"!==e});r=0<f.length?"{key: someKey, "+f.join(": ..., ")+": ...}":"{key: someKey}",I[g+r]||(f=0<f.length?"{"+f.join(": ..., ")+": ...}":"{}",I[g+r]=!0)}if(g=null,void 0!==s&&(a(s),g=""+s),function(e){if(S.call(e,"key")){var t=Object.getOwnPropertyDescriptor(e,"key").get;if(t&&t.isReactWarning)return!1}return void 0!==e.key}(n)&&(a(n.key),g=""+n.key),"key"in n)for(var y in s={},n)"key"!==y&&(s[y]=n[y]);else s=n;return g&&function(e){function t(){c||(c=!0)}t.isReactWarning=!0,Object.defineProperty(e,"key",{get:t,configurable:!0})}(s,"function"==typeof e&&(e.displayName||e.name)),function(e,t,n,a,s,r,i,l){return n=r.ref,e={$$typeof:u,type:e,key:t,props:r,_owner:s},null!==(void 0!==n?n:null)?Object.defineProperty(e,"ref",{enumerable:!1,get:o}):Object.defineProperty(e,"ref",{enumerable:!1,value:null}),e._store={},Object.defineProperty(e._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(e,"_debugInfo",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(e,"_debugStack",{configurable:!1,enumerable:!1,writable:!0,value:i}),Object.defineProperty(e,"_debugTask",{configurable:!1,enumerable:!1,writable:!0,value:l}),Object.freeze&&(Object.freeze(e.props),Object.freeze(e)),e}(e,g,d,0,null===(m=A.A)?null:m.getOwner(),s,h,p)}function l(e){"object"==typeof e&&null!==e&&e.$$typeof===u&&e._store&&(e._store.validated=1)}var c,d=e,u=Symbol.for("react.transitional.element"),h=Symbol.for("react.portal"),p=Symbol.for("react.fragment"),m=Symbol.for("react.strict_mode"),g=Symbol.for("react.profiler"),f=Symbol.for("react.consumer"),y=Symbol.for("react.context"),b=Symbol.for("react.forward_ref"),v=Symbol.for("react.suspense"),x=Symbol.for("react.suspense_list"),w=Symbol.for("react.memo"),C=Symbol.for("react.lazy"),k=Symbol.for("react.activity"),j=Symbol.for("react.client.reference"),A=d.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,S=Object.prototype.hasOwnProperty,N=Array.isArray,T=console.createTask?console.createTask:function(){return null},E={},_=(d={react_stack_bottom_frame:function(e){return e()}}).react_stack_bottom_frame.bind(d,r)(),M=T(s(r)),I={};Vn.Fragment=p,Vn.jsx=function(e,t,n,a,r){var o=1e4>A.recentlyCreatedOwnerStacks++;return i(e,t,n,!1,0,r,o?Error("react-stack-top-frame"):_,o?T(s(e)):M)},Vn.jsxs=function(e,t,n,a,r){var o=1e4>A.recentlyCreatedOwnerStacks++;return i(e,t,n,!0,0,r,o?Error("react-stack-top-frame"):_,o?T(s(e)):M)}}()),Vn}function Kn(){return qn||(qn=1,"production"===process.env.NODE_ENV?Fn.exports=Hn():Fn.exports=Gn()),Fn.exports}var $n=Kn();const Zn=e.createContext(void 0),Qn=()=>{const t=e.useContext(Zn);if(!t)throw new Error("useWaldiezTheme must be used within a WaldiezThemeProvider context");return t},Yn=()=>{if("undefined"==typeof window)return!1;if("localStorage"in window){if("dark"===localStorage.getItem("waldiez-theme"))return!0;if("light"===localStorage.getItem("waldiez-theme"))return!1}if(document.body.classList.contains("waldiez-dark"))return!0;if(document.body.classList.contains("waldiez-light"))return!1;return window.matchMedia("(prefers-color-scheme: dark)").matches},Xn=e=>{Jn(e),ea(e)},Jn=e=>{e?(document.body.classList.remove("waldiez-light"),document.body.classList.add("waldiez-dark")):(document.body.classList.remove("waldiez-dark"),document.body.classList.add("waldiez-light"))},ea=e=>{"undefined"!=typeof window&&"localStorage"in window&&localStorage.setItem("waldiez-theme",e?"dark":"light")},ta=({children:t,initialDark:n})=>{const[a,s]=e.useState(()=>"boolean"==typeof n?n:Yn());"boolean"==typeof n&&Xn(n);return e.useEffect(()=>{"boolean"==typeof n&&Xn(n);const e=new MutationObserver(e=>{e.forEach(e=>{if("attributes"===e.type&&"class"===e.attributeName){const e=document.body.classList,t=e.contains("waldiez-dark")||e.contains("dark-theme")||!e.contains("waldiez-light")&&!e.contains("light-theme")&&window.matchMedia("(prefers-color-scheme: dark)").matches;s(e=>e!==t?t:e)}})});return e.observe(document.body,{attributes:!0,attributeFilter:["class"]}),()=>e.disconnect()},[n]),$n.jsx(Zn.Provider,{value:{isDark:a,toggleTheme:()=>{s(e=>(Xn(!e),!e))},setTheme:e=>{Xn(e),s(e)}},children:t})},na={width:130},aa={width:490},sa={width:180},ra=(e,t)=>{if(!e||"object"!=typeof e)throw new Error("Invalid agent data");const n=e,a=((e,t)=>{let n;return n=t&&"string"==typeof t?t:Xe(e),n})(n,t),s=(e=>{let t="user_proxy",n=e;if(!("agentType"in e)||"string"!=typeof e.agentType){if(!("data"in e)||"object"!=typeof e.data||!("agentType"in e.data)||"string"!=typeof e.data.agentType)return t;n=e.data}return dt.includes(n.agentType)&&(t=n.agentType),t})(n),{name:r,description:o,tags:i,requirements:l,createdAt:c,updatedAt:d}=ut(n,s),u=n.data||n,h=ca(u,s),p=la(s);return((e,t,n,a,s,r,o,i,l,c)=>"user_proxy"===e?new He({id:t,agentType:e,name:n,description:a,tags:s,requirements:r,createdAt:o,updatedAt:i,data:l,rest:c}):"assistant"===e?new Ee({id:t,agentType:e,name:n,description:a,tags:s,requirements:r,createdAt:o,updatedAt:i,data:l,rest:c}):"rag_user_proxy"===e?new Pe({id:t,agentType:e,name:n,description:a,tags:s,requirements:r,createdAt:o,updatedAt:i,data:l,rest:c}):"reasoning"===e?new Ue({id:t,agentType:e,name:n,description:a,tags:s,requirements:r,createdAt:o,updatedAt:i,data:l,rest:c}):"captain"===e?new Me({id:t,agentType:e,name:n,description:a,tags:s,requirements:r,createdAt:o,updatedAt:i,data:l,rest:c}):"group_manager"===e?new ze({id:t,agentType:e,name:n,description:a,tags:s,requirements:r,createdAt:o,updatedAt:i,data:l,rest:c}):"doc_agent"===e?new De({id:t,agentType:e,name:n,description:a,tags:s,requirements:r,createdAt:o,updatedAt:i,data:l,rest:c}):new xe({id:t,agentType:e,name:n,description:a,tags:s,requirements:r,createdAt:o,updatedAt:i,data:l,rest:c}))(s,a,r,o,i,l,c,d,h,rt(n,p))},oa=(e,t)=>{const n=t?da(e):{...e},a={...n.data},s=n.data.label;delete n.data;const r=a.agentType,o={systemMessage:a.systemMessage,humanInputMode:a.humanInputMode,codeExecutionConfig:a.codeExecutionConfig,agentDefaultAutoReply:a.agentDefaultAutoReply,maxConsecutiveAutoReply:a.maxConsecutiveAutoReply,termination:a.termination,modelIds:a.modelIds,tools:a.tools,parentId:a.parentId,nestedChats:a.nestedChats,handoffs:a.handoffs,contextVariables:a.contextVariables,updateAgentStateBeforeReply:a.updateAgentStateBeforeReply,afterWork:a.afterWork};ua(r,o,a),(e=>{e.nestedChats&&0!==e.nestedChats.length||(e.nestedChats=[{messages:[],triggeredBy:[],condition:{conditionType:"string_llm",prompt:""},available:{type:"none",value:""}}])})(o);for(const i of["description","name","tags","requirements","createdAt","updatedAt","agentType","parentId"])delete n[i];return{type:"agent",agentType:r,name:s,description:a.description,tags:a.tags,requirements:a.requirements,createdAt:a.createdAt,updatedAt:a.updatedAt,data:o,...n}},ia=(e,t,n)=>{const a=ot(e,t),s={...e.data,agentType:e.agentType,label:e.name,description:e.description,tags:e.tags,requirements:e.requirements,createdAt:e.createdAt,updatedAt:e.updatedAt};delete s.name;const r={id:e.id,type:"agent",data:s,style:{width:"group_manager"===e.agentType?aa.width:"user_proxy"!==e.agentType?sa.width:na.width},...e.rest,parentId:null!==e.data.parentId?e.data.parentId:void 0,position:a};return!0===n?da(r):r},la=e=>{const t=["id","name","description","tags","requirements","createdAt","updatedAt","data"];return"rag_user_proxy"===e&&t.push("retrieveConfig"),"assistant"===e&&t.push("isMultimodal"),"reasoning"===e&&t.push("verbose","reasonConfig"),"captain"===e&&t.push("agentLib","toolLib","maxRound","maxTurns"),"group_manager"===e&&t.push("initialAgentId","maxRound","adminName","speakers","enableClearHistory","sendIntroductions","groupName"),"doc_agent"===e&&t.push("collectionName","resetCollection","parsedDocsPath","queryEngine"),t},ca=(e,t)=>{const n=mt(e,t);return"rag_user_proxy"===t?new Le({...n,retrieveConfig:qt(e)}):"assistant"===t?new Te({...n,isMultimodal:ht(e)}):"reasoning"===t?new Fe({...n,verbose:Rt(e),reasonConfig:zt(e)}):"captain"===t?new _e({...n,agentLib:qe(e),toolLib:Ve(e),maxRound:Ge(e),maxTurns:Ke(e)}):"group_manager"===t?new Re({...n,initialAgentId:At(e),maxRound:xt(e),adminName:wt(e),speakers:vt(e),enableClearHistory:Ct(e),sendIntroductions:kt(e),groupName:jt(e)}):"doc_agent"===t?new Ie({...n,collectionName:gt(e),resetCollection:ft(e),parsedDocsPath:bt(e),queryEngine:yt(e)}):n},da=e=>{const t={...e};return t.data.modelIds=[],t.data.tools=[],t.data.nestedChats=[],t.data.handoffs=[],t.data.codeExecutionConfig&&(t.data.codeExecutionConfig.functions=[]),"rag_user_proxy"===e.data.agentType&&(t.data.retrieveConfig={...t.data.retrieveConfig,model:null,docsPath:[]}),"group_manager"===e.data.agentType&&(t.data.speakers={...t.data.speakers,allowRepeat:[],allowedOrDisallowedTransitions:{},order:[]},t.data.initialAgentId=void 0),t},ua=(e,t,n)=>{"rag_user_proxy"===e&&ha(t,n),"reasoning"===e&&pa(t,n),"captain"===e&&ma(t,n),"assistant"===e&&(t.isMultimodal=ht(n)),"group_manager"===e&&ga(t,n),"doc_agent"===e&&fa(t,n)},ha=(e,t)=>{e.retrieveConfig=qt(t)},pa=(e,t)=>{e.verbose=Rt(t),e.reasonConfig=zt(t)},ma=(e,t)=>{e.agentLib=qe(t),e.toolLib=Ve(t),e.maxRound=Ge(t),e.maxTurns=Ke(t)},ga=(e,t)=>{e.maxRound=xt(t),e.adminName=wt(t),e.speakers=vt(t),e.enableClearHistory=Ct(t),e.sendIntroductions=kt(t),e.initialAgentId=At(t),e.groupName=jt(t)},fa=(e,t)=>{e.collectionName=gt(t),e.resetCollection=ft(t),e.queryEngine=yt(t),e.parsedDocsPath=bt(t)};class ya{sourceType;targetType;name;description;position;order;clearHistory;message;maxTurns;summary;nestedChat;prerequisites=[];realSource=null;realTarget=null;available={type:"none",value:""};condition={conditionType:"string_llm",prompt:""};afterWork=null;silent=!1;constructor(e={sourceType:"user_proxy",targetType:"assistant",name:"Chat",description:"New connection",clearHistory:!0,maxTurns:null,summary:{method:"lastMsg",prompt:"",args:{}},position:1,order:-1,message:{type:"none",useCarryover:!1,content:null,context:{}},nestedChat:{message:null,reply:null},prerequisites:[],condition:{conditionType:"string_llm",prompt:""},available:{type:"none",value:""},afterWork:null,realSource:null,realTarget:null,silent:!1}){const{sourceType:t,targetType:n,name:a,description:s,clearHistory:r,maxTurns:o,summary:i,message:l,position:c,order:d,nestedChat:u,prerequisites:h,condition:p,available:m,afterWork:g,realSource:f,realTarget:y,silent:b}=e;this.sourceType=t,this.targetType=n,this.name=a,this.description=s,this.clearHistory=r,this.maxTurns=o,this.summary=i,this.message=l,this.position=c,this.order=d,this.nestedChat=u,this.prerequisites=h,this.condition=p,this.available=m,this.afterWork=g,this.realSource=f,this.realTarget=y,this.silent=b}}class ba{id;type="chat";source;target;data;rest;constructor(e){this.id=e.id,this.source=e.source,this.target=e.target,this.type=e.type,this.data=e.data,this.rest=e.rest||{}}static create(e){const t=new ya;return new ba({id:`wc-${ee()}`,source:e.source,target:e.target,type:e.type,data:t})}}const va=["chat","nested","group","hidden"],xa=["string","method","rag_message_generator","none"],wa=e=>ka(e),Ca=e=>({type:e.type,content:e.content,context:e.context,useCarryover:e.useCarryover}),ka=e=>{const t={type:"none",useCarryover:!1,content:null,context:{}};return"message"in e&&e.message&&(t.type=ja(e.message),t.content=Aa(e.message),t.context=Sa(e.message),t.useCarryover=Na(e.message)),t},ja=e=>{let t="none";return"type"in e&&e.type&&"string"==typeof e.type&&xa.includes(e.type)&&(t=e.type),t},Aa=e=>{let t=null;return"content"in e&&e.content&&"string"==typeof e.content&&(t=e.content),t},Sa=e=>{let t={};return"context"in e&&e.context&&"object"==typeof e.context&&(t=Object.keys(e.context).reduce((t,n)=>(t[n.toString()]=e.context[n],t),{})),t},Na=e=>{let t=!1;return"useCarryover"in e&&"boolean"==typeof e.useCarryover&&(t=e.useCarryover),"useCarryover"in e&&"boolean"==typeof e.useCarryover&&(t=e.useCarryover),t},Ta=e=>"summary"in e?_a(e):{method:null,prompt:"",args:{}},Ea=e=>({method:e.method,prompt:e.prompt,args:e.args}),_a=e=>{const t={method:null,prompt:"",args:{}};return"summary"in e&&e.summary&&(t.method=Ma(e),t.prompt=Ia(e),t.args=Da(e)),t},Ma=e=>{let t=null;return"method"in e.summary&&e.summary.method&&("reflectionWithLlm"===e.summary.method||"reflectionWithLlm"===e.summary.method?t="reflectionWithLlm":"lastMsg"!==e.summary.method&&"lastMsg"!==e.summary.method||(t="lastMsg")),t},Ia=e=>{let t="";return"prompt"in e.summary&&"string"==typeof e.summary.prompt&&(t=e.summary.prompt),t},Da=e=>{let t={};return"args"in e.summary&&e.summary.args&&"object"==typeof e.summary.args&&(t=Object.keys(e.summary.args).reduce((t,n)=>(t[n.toString()]=e.summary.args[n],t),{})),t},Ra=e=>{let t=!0;return"clearHistory"in e&&"boolean"==typeof e.clearHistory&&(t=e.clearHistory),t},za=e=>{let t="Chat";return"label"in e&&e.label&&"string"==typeof e.label&&(t=e.label),t},Oa=e=>{let t="Chat Description";return"description"in e&&e.description&&"string"==typeof e.description&&(t=e.description),t},La=(e,t)=>{let n=t;return"position"in e&&"number"==typeof e.position&&(n=Math.floor(e.position)),n},Pa=e=>{let t=null;return"maxTurns"in e&&"number"==typeof e.maxTurns&&(t=Math.floor(e.maxTurns)),t},Ba=e=>{const t={message:null,reply:null};return"nestedChat"in e&&e.nestedChat&&("message"in e.nestedChat&&e.nestedChat.message&&(t.message=wa({message:e.nestedChat.message})),"reply"in e.nestedChat&&e.nestedChat.reply&&(t.reply=wa({message:e.nestedChat.reply}))),t},Fa=e=>{const t=[];return"prerequisites"in e&&Array.isArray(e.prerequisites)&&e.prerequisites.forEach(e=>{"string"==typeof e&&t.push(e)}),t},Ua=e=>{let t=-1;if("order"in e&&"number"==typeof e.order){const n=Math.floor(e.order);t=n>=0?n:-1}return t},Ha=(e,t,n,a,s,r)=>{const o=a.data.agentType;let i=((e,t)=>{let n="chat";"type"in t&&"string"==typeof t.type&&t.type&&va.includes(t.type)?n=t.type:"data"in t&&"object"==typeof t.data&&null!==t.data&&"type"in t.data&&"string"==typeof t.data.type&&t.data.type&&va.includes(t.data.type)&&(n=t.data.type);let a=e?.type??n;return va.includes(a)||(a="chat"),a})(e,n);"type"in r&&"string"==typeof r.type&&va.includes(r.type)&&(e.type=r.type,i=e.type),delete r.type,delete r.source,delete r.target;const l=Sn[o];e.type=i,"hidden"!==e.type&&(e.animated=qa(i)),Wa(e,i,l);const c=a.data.label,d=s.data.label;return c&&d&&(t.name=`${c} => ${d}`),e.data={...t,label:t.name,order:"nested"===i?-1:t.order},delete e.data.name,t.order="nested"===i?-1:t.order,Va(e,r),Ga(e,r),{...e,...r}},Wa=(e,n,a)=>{"hidden"!==e.type&&(e.markerEnd="nested"!==n?{type:t.MarkerType.ArrowClosed,color:a,width:10,height:10}:void 0,e.style={stroke:a,strokeWidth:1})},qa=(e,t,n)=>"nested"===e,Va=(e,t)=>{let n=null;if("sourceHandle"in t&&"string"==typeof t.sourceHandle&&(t.sourceHandle.includes("-source")||t.sourceHandle.includes("-target"))){const a=t.sourceHandle.includes("-source"),s=["top","left","right","bottom"].find(e=>t.sourceHandle.includes(e));s&&(n=`agent-handle-${s}-${a?"source":"target"}-${a?e.source:e.target}`)}t.sourceHandle=n,e.sourceHandle=n},Ga=(e,t)=>{let n=null;if("targetHandle"in t&&"string"==typeof t.targetHandle&&(t.targetHandle.includes("-source")||t.targetHandle.includes("-target"))){const a=t.targetHandle.includes("source"),s=["top","left","right","bottom"].find(e=>t.targetHandle.includes(e));s&&(n=`agent-handle-${s}-${a?"source":"target"}-${a?e.source:e.target}`)}t.targetHandle=n,e.targetHandle=n},Ka=e=>{if(!e||"object"!=typeof e)throw new Error("Invalid edge data");const t="id"in e&&"string"==typeof e.id&&"data"in e&&"object"==typeof e.data&&null!==e.data;if(e.source=(e=>{if("source"in e&&"string"==typeof e.source)return e.source;if("data"in e&&"object"==typeof e.data&&null!==e.data&&"source"in e.data&&"string"==typeof e.data.source)return e.data.source;throw new Error("Source not found in chat data")})(e),e.target=(e=>{if("target"in e&&"string"==typeof e.target)return e.target;if("data"in e&&"object"==typeof e.data&&null!==e.data&&"target"in e.data&&"string"==typeof e.data.target)return e.data.target;throw new Error("Target not found in chat data")})(e),!t)throw new Error((e=>{const t=[];return"id"in e&&"string"==typeof e.id||t.push("id must be a string"),"data"in e&&"object"==typeof e.data&&null!==e.data||t.push("data must be an object"),"source"in e&&"string"==typeof e.source||t.push("source must be a string"),"target"in e&&"string"==typeof e.target||t.push("target must be a string"),t.length>0?`Invalid edge data: ${t.join(", ")}`:"Invalid edge data ?"})(e))},$a=e=>{let t=!1;return"silent"in e&&"boolean"==typeof e.silent&&(t=e.silent),t},Za=(e,t,n)=>{Ka(e),(e=>{"type"in e&&"string"==typeof e.type&&va.includes(e.type)?e.type=e.type:"data"in e&&"object"==typeof e.data&&null!==e.data&&"type"in e.data&&"string"==typeof e.data.type&&va.includes(e.data.type)?e.type=e.data.type:e.type="chat"})(e);const a=t.find(t=>t.id===e.id);if(!a)throw new Error(`Edge not found: ${e.id}`);const s=n.find(t=>t.id===e.source);if(!s||"agent"!==s.type)throw new Error(`Source node not found: ${e.source}`);if(a.source!==e.source)throw new Error(`Source node does not match edge source: ${e.source}`);const r=n.find(t=>t.id===e.target);if(!r||"agent"!==r.type)throw new Error(`Target node not found: ${e.target}`);if(a.target!==e.target)throw new Error(`Target node does not match edge target: ${e.target}`);return{edge:a,sourceNode:s,targetNode:r}},Qa=e=>{let t="user_proxy";return"sourceType"in e&&"string"==typeof e.sourceType&&(t=e.sourceType),We.includes(t)?t:"assistant"},Ya=e=>{let t="assistant";return"targetType"in e&&"string"==typeof e.targetType&&(t=e.targetType),We.includes(t)?t:"user_proxy"},Xa=(e,t,n,a)=>{if(!e||"object"!=typeof e)throw new Error("Invalid edge data");const s=e;let r=null;try{r=Za(s,t,n)}catch(m){throw new Error(m.message)}const{edge:o,sourceNode:i,targetNode:l}=r,c=s.id,d=ts(o),u=ns(s.data,a),h=(e=>{const t={...e};return delete t.id,delete t.data,delete t.type,delete t.source,delete t.target,t})({...s,...o}),p=Ha(o,u,s,i,l,h);Object.entries(p).forEach(([e,t])=>{"data"!==e&&"source"!==e&&"target"!==e&&"id"!==e&&"type"!==e&&(h[e]=t)});return{chat:new ba({id:c,data:u,type:d,source:i.id,target:l.id,rest:h}),edge:p}},Ja=(e,t)=>{const n=e.data,a=e.type||ts(e),s={...n},r={sourceType:Qa(s),targetType:Ya(s),name:za(s),order:Ua(s),description:Oa(s),position:La(s,t),clearHistory:Ra(s),maxTurns:Pa(s),message:Ca(s.message),summary:Ea(s.summary),nestedChat:Ba(s),prerequisites:Fa(s),condition:lt(s),available:it(s),afterWork:ct(s),silent:$a(s),realSource:s.realSource,realTarget:s.realTarget},o={...e};"hidden"===o.type&&(o.hidden=!0),delete o.data,delete o.type,delete o.source,delete o.target,delete o.id;const i=new ba({id:e.id,data:r,type:a,source:e.source,target:e.target,rest:o}),l={...i,...i.rest};return delete l.rest,l},es=e=>{const t={label:e.data.name,sourceType:e.data.sourceType,targetType:e.data.targetType,description:e.data.description,position:e.data.position,order:e.data.order,clearHistory:e.data.clearHistory,message:e.data.message,nestedChat:e.data.nestedChat,prerequisites:e.data.prerequisites,summary:e.data.summary,maxTurns:e.data.maxTurns,condition:e.data.condition,available:e.data.available,afterWork:e.data.afterWork,realSource:e.data.realSource,realTarget:e.data.realTarget,silent:e.data.silent},n=e.rest?.style||{};return n.strokeWidth=1,{id:e.id,source:e.source,target:e.target,type:e.type,data:t,hidden:!0===e.rest?.hidden||"hidden"===e.type,...e.rest,style:n}},ts=e=>"data"in e&&"object"==typeof e.data&&"type"in e.data&&"string"==typeof e.data.type&&va.includes(e.data.type.toLocaleLowerCase())?e.data.type:"type"in e&&"string"==typeof e.type&&va.includes(e.type.toLocaleLowerCase())?e.type:"chat",ns=(e,t)=>{if(!e||"object"!=typeof e)throw new Error("Invalid chat data");const n=Je(e,"New connection"),a=et(e,"New connection"),s=Qa(e),r=Ya(e),o=Ra(e),i=Pa(e),l=La(e,t),c=Ua(e),d=wa(e),u=Ta(e),h=Ba(e),p=Fa(e),m=(e=>{let t=null;return"realSource"in e&&"string"==typeof e.realSource&&(t=e.realSource),t})(e),g=(e=>{let t=null;return"realTarget"in e&&"string"==typeof e.realTarget&&(t=e.realTarget),t})(e),f=lt(e),y=it(e),b=ct(e),v=$a(e);return new ya({sourceType:s,targetType:r,name:n,description:a,clearHistory:o,maxTurns:i,position:l,order:c,message:d,summary:u,nestedChat:h,prerequisites:p,condition:f,available:y,realSource:m,realTarget:g,afterWork:b,silent:v})};class as{baseUrl;apiKey;apiType;apiVersion;temperature;topP;maxTokens;aws;extras;defaultHeaders;price;constructor(e={baseUrl:null,apiKey:null,apiType:"openai",apiVersion:null,temperature:null,topP:null,maxTokens:null,aws:{accessKey:null,profileName:null,region:null,secretKey:null,sessionToken:null},extras:{},defaultHeaders:{},price:{promptPricePer1k:null,completionTokenPricePer1k:null}}){const{baseUrl:t,apiKey:n,apiType:a,apiVersion:s,temperature:r,topP:o,maxTokens:i,aws:l,extras:c,defaultHeaders:d,price:u}=e;this.baseUrl=t,this.apiKey=n,this.apiType=a,this.apiVersion=s,this.temperature=r,this.topP=o,this.maxTokens=i,this.aws=l||null,this.extras=c,this.defaultHeaders=d,this.price=u}}class ss{type="model";id;name;description;tags;requirements;createdAt;updatedAt;data;rest={};constructor(e){this.id=e.id,this.name=e.name,this.description=e.description,this.tags=e.tags,this.requirements=e.requirements,this.createdAt=e.createdAt,this.updatedAt=e.updatedAt,this.data=e.data,this.rest=e.rest}static create(){return new ss({id:`wm-${ee()}`,name:"Model",description:"A new model",tags:[],requirements:[],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),data:new as})}}const rs=["wikipedia_search","youtube_search","google_search","tavily_search","duckduckgo_search","perplexity_search","searxng_search"],os={wikipedia_search:"Search Wikipedia for a given query.",youtube_search:"Search YouTube for a given query.",google_search:"Search Google for a given query.",tavily_search:"Search Tavily for a given query.",duckduckgo_search:"Search DuckDuckGo for a given query.",perplexity_search:"Search Perplexity AI for a given query.",searxng_search:"Search SearxNG for a given query.",shared:"Shared code available to all agents.",custom:"A custom tool that you define."},is={wikipedia_search:"Wikipedia Search",youtube_search:"YouTube Search",google_search:"Google Search",tavily_search:"Tavily Search",duckduckgo_search:"DuckDuckGo Search",perplexity_search:"Perplexity AI Search",searxng_search:"SearxNG Search",shared:"waldiez_shared",custom:"new_tool"},ls={wikipedia_search:[],youtube_search:[{label:"YouTube API Key",key:"YOUTUBE_API_KEY"}],google_search:[{label:"Google Search API Key",key:"GOOGLE_SEARCH_API_KEY"},{label:"Google Search Engine ID",key:"GOOGLE_SEARCH_ENGINE_ID"}],tavily_search:[{label:"Tavily API Key",key:"TAVILY_API_KEY"}],duckduckgo_search:[],perplexity_search:[{label:"Perplexity API Key",key:"PERPLEXITY_API_KEY"}],searxng_search:[]},cs={wikipedia_search:[],youtube_search:[],google_search:[],tavily_search:[],duckduckgo_search:[],perplexity_search:[],searxng_search:[]};class ds{content;toolType;secrets;kwargs={};constructor(e={content:us,toolType:"shared",secrets:{},kwargs:{}}){const{content:t,toolType:n,secrets:a,kwargs:s}=e;this.toolType=n,this.content=t,this.secrets=a,this.kwargs=s||{}}}const us='\n"""Replace this with your code.\n\nAdd any code here that will be placed at the top of the whole flow.\n"""\n\n# Example:\n# global variable\n# DATABASE = {\n#     "users": [\n#         {"id": 1, "name": "Alice"},\n#         {"id": 2, "name": "Bob"},\n#     ],\n#     "posts": [\n#         {"id": 1, "title": "Hello, world!", "author_id": 1},\n#         {"id": 2, "title": "Another post", "author_id": 2},\n#     ],\n# }\n#\n# Add your code below\n\n',hs={shared:us,custom:'\n"""Replace this with your code.\n\nmake sure a function with the same name\nas the tool is defined in the code.\n"""\n\n# Example:\n# tool name: \'new_tool\'\n#\n# def new_tool() -> str:\n#     """Tool entry point."""\n#     return "Hello, world!"\n#\n# Add your code below\n\ndef new_tool() -> None:\n    """Tool entry point."""\n    ...\n',langchain:'\n"""Replace this with your code.\n\nYou can define any of the tools available in the langchain_community package.\nYou can explore the available tools in the LangChain Community Tools folder:\nhttps://github.com/langchain-ai/langchain/tree/master/libs/community/langchain_community/tools\n\nMake sure you have a variable named with the same name as the tool\n"""\n\n# Example:\n# # tool name: \'wiki_tool\'\n#\n# from langchain_community.tools import WikipediaQueryRun\n# from langchain_community.utilities import WikipediaAPIWrapper\n#\n# api_wrapper = WikipediaAPIWrapper(top_k_results=1, doc_content_chars_max=1000)\n# wiki_tool = WikipediaQueryRun(api_wrapper=api_wrapper)\n#\n# Add your code below\n\n',crewai:'\n"""Replace this with your code.\n\nYou can define any of the tools available in the crewai_tools package.\nYou can explore the full list of available tools in the CrewAI Tools repository:\nhttps://github.com/crewAIInc/crewAI-tools/tree/main\n\nMake sure you have a variable named with the same name as the tool.\n"""\n\n# Example:\n# # tool name: \'scrape_tool\'\n#\n# from crewai_tools import ScrapeWebsiteTool\n# scrape_tool = ScrapeWebsiteTool()\n#\n# Add your code below\n\n',predefined:""};class ps{type="tool";id;name;description;tags;requirements;createdAt;updatedAt;data;rest={};constructor(e){this.id=e.id,this.name=e.name,this.description=e.description,this.tags=e.tags,this.requirements=e.requirements,this.createdAt=e.createdAt,this.updatedAt=e.updatedAt,this.data=e.data,this.rest=e.rest}static create(){return new ps({id:`wt-${ee()}`,name:"waldiez_shared",description:"Shared code available to all agents.",tags:[],requirements:[],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),data:new ds})}}class ms{nodes;edges;viewport;agents;models;tools;chats;isAsync=!1;cacheSeed=42;silent=!1;constructor(e={nodes:[],edges:[],viewport:{x:0,y:0,zoom:1},agents:{userProxyAgents:[],assistantAgents:[],ragUserProxyAgents:[],reasoningAgents:[],captainAgents:[],groupManagerAgents:[],docAgents:[]},models:[],tools:[],chats:[],isAsync:!1,cacheSeed:42,silent:!1}){this.nodes=e.nodes,this.edges=e.edges,this.viewport=e.viewport,this.agents=e.agents,this.models=e.models,this.tools=e.tools,this.chats=e.chats,this.isAsync=e.isAsync,this.cacheSeed=e.cacheSeed,this.silent=e.silent}}class gs{type="flow";version="0.5.10";id;name;description;tags;requirements;data;storageId;createdAt;updatedAt;rest={};constructor(e){this.id=e.id,this.name=e.name,this.description=e.description,this.tags=e.tags,this.requirements=e.requirements,this.data=e.data,this.storageId=e.storageId,this.createdAt=e.createdAt,this.updatedAt=e.updatedAt,this.rest=e.rest||{}}}const fs=`wf-${(new Date).getTime()}${b()}`,ys={type:"flow",version:"0.5.10",id:fs,storageId:fs,name:"Waldiez Flow",description:"A waldiez flow",tags:[],requirements:[],data:{agents:{userProxyAgents:[],assistantAgents:[],ragUserProxyAgents:[],reasoningAgents:[],captainAgents:[],groupManagerAgents:[],docAgents:[]},models:[],tools:[],chats:[],isAsync:!1,cacheSeed:42,silent:!1,nodes:[],edges:[],viewport:{zoom:1,x:0,y:0}},createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),rest:{}},bs=(e,t,n,a)=>{const s=oa(e,a),r=t.find(t=>t.id===e.id);return r&&Object.keys(r).forEach(e=>{["id","type","parentId","data"].includes(e)||delete s[e]}),s.agentType=e.data.agentType,vs(s,t,n),s},vs=(e,t,n)=>{const a=t.filter(e=>"agent"===e.type),s=e.data.parentId,r=((e,t,n,a)=>{const s=a.filter(t=>t.source===e);return n?s.filter(e=>{const a=t.find(t=>t.id===e.source),s=t.find(t=>t.id===e.target);return a&&s&&a.data.parentId===n&&s.data.parentId!==n}):s.filter(e=>"nested"===e.type)})(e.id,a,s,n),o=e.data.nestedChats||[];0===r.length||o.length>0&&o[0]&&o[0].messages.length>0?e.data.nestedChats=o:e.data.nestedChats=[{triggeredBy:[e.id],messages:r.map(e=>({id:e.id,isReply:!1})),condition:{conditionType:"string_llm",prompt:""},available:{type:"none",value:""}}]},xs=e=>{if(!e||"object"!=typeof e)return new ss({id:"wm-"+ee(),name:"Model",description:"A new model",tags:[],requirements:[],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),data:new as});const t=e,n=Xe(t),{name:a,description:s,tags:r,requirements:o,createdAt:i,updatedAt:l}=As(t),c=t.data||t,d=Ss(c),u=rt(t,["id","type","name","description","tags","requirements","createdAt","updatedAt","data"]);return new ss({id:n,name:a,description:s,tags:r,requirements:o,createdAt:i,updatedAt:l,data:d,rest:u})},ws=(e,t)=>{const n=e.data.apiKey?t?"REPLACE_ME":e.data.apiKey:"REPLACE_ME",a=rt(e,["id","type","parentId","data"]),{defaultHeaders:s,extras:r,aws:o}=t?ks(e):e.data;return{id:e.id,type:"model",name:e.data.label,description:e.data.description,tags:e.data.tags,requirements:e.data.requirements,createdAt:e.data.createdAt,updatedAt:e.data.updatedAt,data:{apiKey:n,apiType:e.data.apiType,apiVersion:e.data.apiVersion,baseUrl:e.data.baseUrl,temperature:e.data.temperature,topP:e.data.topP,maxTokens:e.data.maxTokens,aws:o,extras:r,defaultHeaders:s,price:e.data.price},...a}},Cs=(e,t)=>{const n=ot(e,t),a={...e.data,label:e.name,description:e.description,tags:e.tags,requirements:e.requirements,createdAt:e.createdAt,updatedAt:e.updatedAt};a.label=e.name,e.rest&&"position"in e.rest&&delete e.rest.position;const s=a;return{id:e.id,type:"model",data:s,position:n,...e.rest}},ks=e=>{const t={...e.data.defaultHeaders},n={...e.data.extras},a={...e.data.aws||{region:null,accessKey:null,secretKey:null,sessionToken:null,profileName:null}};for(const s in t)"string"!=typeof t[s]&&t[s]||(t[s]="REPLACE_ME");for(const s in n)"string"!=typeof n[s]&&n[s]||(n[s]="REPLACE_ME");if("bedrock"===e.data.apiType)for(const s in a)"string"!=typeof a[s]&&a[s]||(a[s]="REPLACE_ME");else for(const s in a)"string"==typeof a[s]&&(a[s]="REPLACE_ME");return{defaultHeaders:t,extras:n,aws:a}},js=e=>{let t=null;return"region"in e&&"string"==typeof e.region&&(t=e.region),t},As=e=>{const t=((e,t)=>{let n=e??"Model";return"name"in t&&"string"==typeof t.name&&(n=t.name),n})(Je(e,null),e);return{name:t,description:et(e,"A new model"),tags:tt(e),requirements:nt(e),createdAt:at(e),updatedAt:st(e)}},Ss=e=>{const t=(e=>{let t=null;return"baseUrl"in e&&"string"==typeof e.baseUrl&&(t=e.baseUrl),t})(e),n=(e=>{let t=null;return"apiKey"in e&&"string"==typeof e.apiKey&&(t=e.apiKey),t})(e),a=(e=>{let t="openai";return"apiType"in e&&"string"==typeof e.apiType&&["openai","azure","bedrock","deepseek","google","anthropic","cohere","mistral","groq","together","nim","other"].includes(e.apiType)&&(t=e.apiType),t})(e),s=(e=>{let t=null;return"apiVersion"in e&&"string"==typeof e.apiVersion&&(t=e.apiVersion),t})(e),r=(e=>{let t=null;return"temperature"in e&&"number"==typeof e.temperature&&(t=e.temperature),t})(e),o=(e=>{let t=null;return"topP"in e&&"number"==typeof e.topP&&(t=e.topP),t})(e),i=(e=>{let t=null;return"maxTokens"in e&&"number"==typeof e.maxTokens&&(t=e.maxTokens),t})(e),l=(e=>{const t={region:null,accessKey:null,secretKey:null,sessionToken:null,profileName:null};return"aws"in e&&"object"==typeof e.aws&&e.aws&&(t.region=js(e.aws),t.accessKey=(e=>{let t=null;return"accessKey"in e&&"string"==typeof e.accessKey&&(t=e.accessKey),t})(e.aws),t.secretKey=(e=>{let t=null;return"secretKey"in e&&"string"==typeof e.secretKey&&(t=e.secretKey),t})(e.aws),t.sessionToken=(e=>{let t=null;return"sessionToken"in e&&"string"==typeof e.sessionToken&&(t=e.sessionToken),t})(e.aws),t.profileName=js(e.aws)),t})(e),c=(e=>{let t={};return"extras"in e&&"object"==typeof e.extras&&(t=e.extras),t})(e),d=(e=>{let t={};return"defaultHeaders"in e&&"object"==typeof e.defaultHeaders&&(t=e.defaultHeaders),t})(e),u=(e=>{const t={promptPricePer1k:null,completionTokenPricePer1k:null};return"price"in e&&"object"==typeof e.price&&e.price&&("promptPricePer1k"in e.price&&"number"==typeof e.price.promptPricePer1k&&(t.promptPricePer1k=e.price.promptPricePer1k),"completionTokenPricePer1k"in e.price&&"number"==typeof e.price.completionTokenPricePer1k&&(t.completionTokenPricePer1k=e.price.completionTokenPricePer1k)),t})(e);return new as({baseUrl:t,apiKey:n,apiType:a,apiVersion:s,temperature:r,topP:o,maxTokens:i,aws:l,extras:c,defaultHeaders:d,price:u})},Ns=e=>{if(!e||"object"!=typeof e)return new ps({id:"wt-"+ee(),name:"new_tool",description:"A new tool",tags:[],requirements:[],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),data:new ds});const t=e,n=Xe(t),{name:a,description:s,tags:r,requirements:o,createdAt:i,updatedAt:l}=Ds(t),c=rt(t,["id","type","name","description","tags","requirements","createdAt","updatedAt","data"]),d=Rs(t.data||t,a),u=_s(t.data||t),h=Ms(t.data||t),p=zs(t.data||t),m=new ds({toolType:d,content:u,secrets:h,kwargs:p});return new ps({id:n,name:a,description:s,tags:r,requirements:o,createdAt:i,updatedAt:l,data:m,rest:c})},Ts=(e,t)=>{let n={...e.data.secrets};t&&(n=Is(e));let a={...e.data.kwargs};if("predefined"===e.data.toolType){const t=cs[e.data.label]||{};a=Object.entries(t).reduce((e,[t,s])=>(e[t]=a[t]||n[t]||"REPLACE_ME",e),{})}const s=rt(e,["id","type","parentId","data"]),r=e.data.label,o="waldiez_shared"===r?"shared":e.data.toolType;return{id:e.id,type:"tool",name:r,description:e.data.description,tags:e.data.tags,requirements:e.data.requirements,createdAt:e.data.createdAt,updatedAt:e.data.updatedAt,data:{content:e.data.content,toolType:o,secrets:n,kwargs:a},...s}},Es=(e,t)=>{const n=ot(e,t),a=e.rest?.label||e.name,s={...e.data,label:a,name:e.name,description:e.description,tags:e.tags,requirements:e.requirements,createdAt:e.createdAt,updatedAt:e.updatedAt};e.rest&&"position"in e.rest&&delete e.rest.position;const r=s;return{id:e.id,type:"tool",data:r,position:n,...e.rest}},_s=e=>{let t=us;return"content"in e&&"string"==typeof e.content&&(t=e.content),t},Ms=e=>{let t={};return"secrets"in e&&"object"==typeof e.secrets&&null!==e.secrets&&(t=Object.entries(e.secrets).reduce((e,[t,n])=>(e[t]=n.toString(),e),{})),t},Is=e=>{const t={...e.data.secrets};if("predefined"===e.data.toolType){const n=ls[e.data.label]||[];for(const e of n)t[e.key]&&t[e.key],t[e.key]="REPLACE_ME"}for(const n in t)"string"!=typeof t[n]&&t[n]||(t[n]="REPLACE_ME");return t},Ds=e=>({name:Je(e,"new_tool"),description:et(e,"A new tool"),tags:tt(e),requirements:nt(e),createdAt:at(e),updatedAt:st(e)}),Rs=(e,t)=>{let n="shared";return"toolType"in e&&"string"==typeof e.toolType&&["shared","custom","langchain","crewai","predefined"].includes(e.toolType)&&(n=e.toolType),"waldiez_shared"===t&&(n="shared"),n},zs=e=>{let t={};return"kwargs"in e&&"object"==typeof e.kwargs&&null!==e.kwargs&&(t=Object.entries(e.kwargs).reduce((e,[t,n])=>(e[t]=n,e),{})),t},Os=(e,t)=>{let n=t;return"storageId"in e&&"string"==typeof e.storageId&&(n=e.storageId),n},Ls=(e,t,n,a,s,r)=>{let o=`${e}_agents`;if("doc_agent"===e&&(o="docAgents"),!(o in t&&Array.isArray(t[o])||(o=o.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/([0-9])([A-Z])/g,"$1 $2").replace(/_/g," ").replace(/-/g," ").trim().toLowerCase().split(" ").map(e=>ve(e)).join("").replace(/^[A-Z]/,e=>e.toLowerCase()),o in t&&Array.isArray(t[o]))))return[];const i=t[o],l=[],c=n.map(e=>e.id);return n.forEach(e=>{if("agent"===e.type){const t=i.find(t=>Xe(t)===e.id);if(t){const n={...e};delete n.id,delete n.data,delete n.type,delete n.parentId;const a=ra({...t,...n});l.push(a)}}}),Ps(e,l,a,s,r,c)},Ps=(e,t,n,a,s,r)=>{const o=t.map(e=>Bs(e,n)).map(e=>Fs(e,a)).map(e=>Us(e,r,s));return"rag_user_proxy"===e?Hs(o,n):o},Bs=(e,t)=>(e.data.modelIds&&(e.data.modelIds=e.data.modelIds.filter(e=>t.includes(e))),e),Fs=(e,t)=>{const n=t.filter(t=>e.data.tools.some(e=>e.id===t));return e.data.tools=e.data.tools.filter(e=>n.includes(e.id)),e},Us=(e,t,n)=>(e.data.nestedChats=e.data.nestedChats.filter(e=>e.triggeredBy.some(e=>n.includes(e)||t.includes(e))),e.data.nestedChats.forEach(e=>{e.messages=e.messages.filter(e=>n.includes(e.id)||t.includes(e.id))}),e),Hs=(e,t)=>e.map(e=>{if("data"in e&&"object"==typeof e.data&&"retrieveConfig"in e.data&&"object"==typeof e.data.retrieveConfig&&e.data.retrieveConfig&&"model"in e.data.retrieveConfig&&"string"==typeof e.data.retrieveConfig.model){const n=e.data.retrieveConfig.model;t.includes(n)||(e.data.retrieveConfig.model=null)}return e}),Ws=["model","tool","agent"],qs=["user_proxy","assistant","rag_user_proxy"],Vs=e=>{if(!("type"in e)||"string"!=typeof e.type||!Ws.includes(e.type))return null;let t=Gs(e);t&&"object"==typeof t||(t={x:20,y:20}),"x"in t&&"number"==typeof t.x||(t.x=20),"y"in t&&"number"==typeof t.y||(t.y=20);const n=Ks(e,e.type);return n?{type:e.type,position:t,data:n}:null},Gs=e=>{if(!("position"in e)||"object"!=typeof e.position)return null;const t=e.position;return"x"in t&&"number"==typeof t.x&&"y"in t&&"number"==typeof t.y?t:null},Ks=(e,t)=>{const n={};if("agent"===t){const t=e.data||{};if(!("agentType"in t)||"string"!=typeof t.agentType||!qs.includes(t.agentType))return n;n.agentType=t.agentType}return n},$s=(e,t)=>{if("data"in t&&"object"==typeof t.data&&t.data){const n=t.data;"label"in n&&"string"==typeof n.label&&(e.data.label=n.label)}},Zs=(e,t)=>{["models","tools"].forEach(n=>{if(!(n in e)||!Array.isArray(e[n]))return;const a=e[n];t.forEach(e=>{const t=a.find(t=>Xe(t)===e.id);t&&$s(e,t)})}),Qs(e,t)},Qs=(e,t)=>{if(!("agents"in e)||"object"!=typeof e.agents)return;const n=e.agents;t.forEach(e=>{"agent"===e.type&&qs.forEach(t=>{const a=`${t}s`;a in n&&Array.isArray(n[a])&&n[a].forEach(n=>{if(e.id===n.id&&(e.data.agentType=t,$s(e,n)),"data"in n&&"object"==typeof n.data&&n.data){const t=n.data;"parentId"in t&&"string"==typeof t.parentId&&(e.data.parentId=t.parentId)}})})})},Ys={importFlow:(e,t)=>{const n=ar(e);if(!n.type||"flow"!==n.type)return ys;const{id:a,storageId:s,name:r,description:o,tags:i,requirements:l,createdAt:c,updatedAt:d,rest:u}=(e=>{const t=Xe(e),n=Je(e,"Waldiez Flow"),a=et(e,"A waldiez flow"),s=tt(e),r=nt(e),o=at(e),i=st(e),l=rt(e,["id","storageId","name","description","tags","requirements","createdAt","updatedAt","data"]);return{id:t,storageId:Os(e,t),name:n,description:a,tags:s,requirements:r,createdAt:o,updatedAt:i,rest:l}})(n),h=n.data||n,p=t||a,m=Xs(h);let g=s;return s===a&&"string"==typeof t&&(g=t),new gs({id:p,storageId:g,name:r,description:o,tags:i,requirements:l,data:m,createdAt:c,updatedAt:d,rest:u})},toReactFlow(e){const t=tr(e),n=er(e);return{flowId:e.id,isAsync:e.data.isAsync??!1,cacheSeed:e.data.cacheSeed,storageId:e.storageId,name:e.name,description:e.description,tags:e.tags,requirements:e.requirements,createdAt:e.createdAt,updatedAt:e.updatedAt,edges:t,nodes:n,viewport:e.data.viewport||{zoom:1,position:{x:0,y:0}},...e.rest}},exportFlow:(e,t,n=!1)=>({id:e.flowId,type:"flow",version:"0.5.10",storageId:e.storageId,name:e.name,description:e.description,tags:e.tags,requirements:e.requirements,createdAt:e.createdAt||(new Date).toISOString(),updatedAt:e.updatedAt||(new Date).toISOString(),data:Js(e,t,n)})},Xs=e=>{const t=(e=>{let t=!1;return"isAsync"in e&&"boolean"==typeof e.isAsync&&(t=e.isAsync),t})(e),n=(e=>{let t=null;if("cacheSeed"in e)if("number"==typeof e.cacheSeed)t=parseInt(`${e.cacheSeed}`,10);else if(null===e.cacheSeed)t=null;else if("string"==typeof e.cacheSeed)try{const n=parseInt(e.cacheSeed,10);isNaN(n)||(t=n)}catch(n){}return t})(e),a=(e=>{let t={zoom:1,x:0,y:0};return"viewport"in e&&"object"==typeof e.viewport&&e.viewport&&"zoom"in e.viewport&&"x"in e.viewport&&"y"in e.viewport&&"number"==typeof e.viewport.zoom&&"number"==typeof e.viewport.x&&"number"==typeof e.viewport.y&&(t=e.viewport),t})(e),s=(e=>{const t=[];return"nodes"in e&&Array.isArray(e.nodes)?(e.nodes.forEach(e=>{const n=Vs(e);if(!n)return;const{type:a,position:s,data:r}=n;let o;"parentId"in e&&"string"==typeof e.parentId&&(o=e.parentId);const i=Xe(e),l=rt(e,["id","type","parentId","data"]);delete l.position,t.push({id:i,type:a,position:{x:s.x,y:s.y},parentId:o,data:r,...l})}),Zs(e,t),t):t})(e);let r=(e=>{if(!("edges"in e)||!Array.isArray(e.edges))return[];const t=[];return e.edges.forEach(e=>{if(!("id"in e)||"string"!=typeof e.id)return;if(!("type"in e)||"string"!=typeof e.type||!va.includes(e.type))return;if(!("source"in e)||"string"!=typeof e.source)return;if(!("target"in e)||"string"!=typeof e.target)return;const n=rt(e,["id","type","source","target","data","hidden"]);t.push({id:e.id,type:e.type,source:e.source,target:e.target,hidden:"hidden"===e.type,data:{},...n})}),t})(e);const o=((e,t,n)=>{if(!("chats"in e)||!Array.isArray(e.chats))return{chats:[],edges:n};const a=[],s=[];return e.chats.forEach((e,r)=>{try{const{chat:o,edge:i}=Xa(e,n,t,r);a.push(o),s.push(i)}catch(o){}}),{chats:a,edges:s}})(e,s,r);r=o.edges;const i=o.chats,l=((e,t)=>{const n=[];if(!("models"in e)||!Array.isArray(e.models))return n;const a=e.models;return t.forEach(e=>{if("model"===e.type){const t=a.find(t=>Xe(t)===e.id);if(t){const a={...e};delete a.id,delete a.data,delete a.type,delete a.parentId;const s=xs({...t,...a});n.push(s)}}}),n})(e,s),c=((e,t)=>{const n=[];if(!("tools"in e)||!Array.isArray(e.tools))return n;const a=e.tools;return t.forEach(e=>{if("tool"===e.type){const t=a.find(t=>Xe(t)===e.id);if(t){const a={...e};delete a.id,delete a.data,delete a.type,delete a.parentId;const s=Ns({...t,...a});n.push(s)}}}),n})(e,s),d=((e,t,n,a,s)=>{if(!("agents"in e)||"object"!=typeof e.agents)return{userProxyAgents:[],assistantAgents:[],ragUserProxyAgents:[],reasoningAgents:[],captainAgents:[],groupManagerAgents:[],docAgents:[]};const r=e.agents;return{userProxyAgents:Ls("user_proxy",r,t,n,a,s),assistantAgents:Ls("assistant",r,t,n,a,s),ragUserProxyAgents:Ls("rag_user_proxy",r,t,n,a,s),reasoningAgents:Ls("reasoning",r,t,n,a,s),captainAgents:Ls("captain",r,t,n,a,s),groupManagerAgents:Ls("group_manager",r,t,n,a,s),docAgents:Ls("doc_agent",r,t,n,a,s)}})(e,s,l.map(e=>e.id),c.map(e=>e.id),r.map(e=>e.id));return new ms({nodes:s,edges:r,agents:d,models:l,tools:c,chats:i,isAsync:t,cacheSeed:n,viewport:a})},Js=(e,t,n)=>{const a=e.nodes||[],s=e.edges||[],r=a.filter(e=>"model"===e.type),o=a.filter(e=>"tool"===e.type),{userAgentNodes:i,assistantAgentNodes:l,docAgentNodes:c,ragUserNodes:d,reasoningAgentNodes:u,captainAgentNodes:h,groupManagerAgentNodes:p}=(e=>{const t=e.filter(e=>"agent"===e.type),n=t.filter(e=>"data"in e&&"object"==typeof e.data&&e.data&&"agentType"in e.data&&"user_proxy"===e.data.agentType),a=t.filter(e=>"data"in e&&"object"==typeof e.data&&e.data&&"agentType"in e.data&&"assistant"===e.data.agentType),s=t.filter(e=>"data"in e&&"object"==typeof e.data&&e.data&&"agentType"in e.data&&"rag_user_proxy"===e.data.agentType),r=t.filter(e=>"data"in e&&"object"==typeof e.data&&e.data&&"agentType"in e.data&&"reasoning"===e.data.agentType),o=t.filter(e=>"data"in e&&"object"==typeof e.data&&e.data&&"agentType"in e.data&&"captain"===e.data.agentType),i=t.filter(e=>"data"in e&&"object"==typeof e.data&&e.data&&"agentType"in e.data&&"group_manager"===e.data.agentType),l=t.filter(e=>"data"in e&&"object"==typeof e.data&&e.data&&"agentType"in e.data&&"doc_agent"===e.data.agentType);return{agentNodes:t,userAgentNodes:n,assistantAgentNodes:a,ragUserNodes:s,docAgentNodes:l,reasoningAgentNodes:r,captainAgentNodes:o,groupManagerAgentNodes:i}})(a);return new ms({nodes:a.map(e=>{const t={...e};return delete t.data,delete t.agentType,t}),edges:s.map(e=>{const t={...e};return delete t.data,t}),agents:{groupManagerAgents:p.map(e=>bs(e,a,s,n)),userProxyAgents:i.map(e=>bs(e,a,s,n)),assistantAgents:l.map(e=>bs(e,a,s,n)),ragUserProxyAgents:d.map(e=>bs(e,a,s,n)),reasoningAgents:u.map(e=>bs(e,a,s,n)),captainAgents:h.map(e=>bs(e,a,s,n)),docAgents:c.map(e=>bs(e,a,s,n))},models:r.map(e=>((e,t,n)=>{const a=ws(e,n),s=t.find(t=>t.id===e.id);return s&&Object.keys(s).forEach(e=>{["id","type","data"].includes(e)||delete a[e]}),a})(e,a,t)),tools:o.map(e=>((e,t,n)=>{const a=Ts(e,n),s=t.find(t=>t.id===e.id);return s&&Object.keys(s).forEach(e=>{["id","type","data"].includes(e)||delete a[e]}),a})(e,a,t)),chats:s.map((e,t)=>((e,t,n)=>{const a=Ja(e,n),s=t.find(t=>t.id===e.id);return s&&Object.keys(s).forEach(e=>{["id","data","type","source","target"].includes(e)||delete a[e]}),a})(e,s,t)),isAsync:e.isAsync,cacheSeed:e.cacheSeed,viewport:e.viewport,silent:e.silent||!1})},er=e=>{const t=[];return e.data.models.forEach(e=>{t.push(Cs(e))}),e.data.tools.forEach(e=>{t.push(Es(e))}),e.data.agents.groupManagerAgents?.forEach(e=>{t.push(ia(e))}),e.data.agents.userProxyAgents?.forEach(e=>{t.push(ia(e))}),e.data.agents.assistantAgents?.forEach(e=>{t.push(ia(e))}),e.data.agents.ragUserProxyAgents?.forEach(e=>{t.push(ia(e))}),e.data.agents.reasoningAgents?.forEach(e=>{t.push(ia(e))}),e.data.agents.captainAgents?.forEach(e=>{t.push(ia(e))}),e.data.agents.docAgents?.forEach(e=>{t.push(ia(e))}),t},tr=e=>{const t=[];return e.data.chats.forEach(n=>{const a=es(n),{sourceHandle:s,targetHandle:r}=nr(e,n);a.sourceHandle=s,a.targetHandle=r,t.push(a)}),t},nr=(e,t)=>{let n,a;if(t.rest?.sourceHandle&&"string"==typeof t.rest.sourceHandle&&(n=t.rest.sourceHandle),t.rest?.targetHandle&&"string"==typeof t.rest.targetHandle&&(a=t.rest.targetHandle),!n||!a){const s=e.data.edges.find(e=>e.id===t.id);s&&(n=s.sourceHandle||n,a=s.targetHandle||a)}return n||(n=`agent-handle-right-source-${t.source}`),a||(a=`agent-handle-left-target-${t.target}`),{sourceHandle:n,targetHandle:a}},ar=e=>{let t={};if("string"==typeof e)try{t=JSON.parse(e)}catch(n){return{}}else"object"==typeof e&&(t=e);return t},sr=e.createContext(null),rr={didCatch:!1,error:null};class or extends e.Component{constructor(e){super(e),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=rr}static getDerivedStateFromError(e){return{didCatch:!0,error:e}}resetErrorBoundary(){const{error:e}=this.state;if(null!==e){for(var t,n,a=arguments.length,s=new Array(a),r=0;r<a;r++)s[r]=arguments[r];null===(t=(n=this.props).onReset)||void 0===t||t.call(n,{args:s,reason:"imperative-api"}),this.setState(rr)}}componentDidCatch(e,t){var n,a;null===(n=(a=this.props).onError)||void 0===n||n.call(a,e,t)}componentDidUpdate(e,t){const{didCatch:n}=this.state,{resetKeys:a}=this.props;var s,r;n&&null!==t.error&&function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.length!==t.length||e.some((e,n)=>!Object.is(e,t[n]))}(e.resetKeys,a)&&(null===(s=(r=this.props).onReset)||void 0===s||s.call(r,{next:a,prev:e.resetKeys,reason:"keys"}),this.setState(rr))}render(){const{children:t,fallbackRender:n,FallbackComponent:a,fallback:s}=this.props,{didCatch:r,error:o}=this.state;let i=t;if(r){const t={error:o,resetErrorBoundary:this.resetErrorBoundary};if("function"==typeof n)i=n(t);else if(a)i=e.createElement(a,t);else{if(void 0===s)throw o;i=s}}return e.createElement(sr.Provider,{value:{didCatch:r,error:o,resetErrorBoundary:this.resetErrorBoundary}},i)}}const ir=["shift","alt","meta","mod","ctrl","control"],lr={esc:"escape",return:"enter",left:"arrowleft",right:"arrowright",up:"arrowup",down:"arrowdown",ShiftLeft:"shift",ShiftRight:"shift",AltLeft:"alt",AltRight:"alt",MetaLeft:"meta",MetaRight:"meta",OSLeft:"meta",OSRight:"meta",ControlLeft:"ctrl",ControlRight:"ctrl"};function cr(e){return(lr[e.trim()]||e.trim()).toLowerCase().replace(/key|digit|numpad/,"")}function dr(e){return ir.includes(e)}function ur(e,t=","){return e.toLowerCase().split(t)}function hr(e,t="+",n=">",a=!1,s){let r=[],o=!1;e.includes(n)?(o=!0,r=e.toLocaleLowerCase().split(n).map(e=>cr(e))):r=e.toLocaleLowerCase().split(t).map(e=>cr(e));return{...{alt:r.includes("alt"),ctrl:r.includes("ctrl")||r.includes("control"),shift:r.includes("shift"),meta:r.includes("meta"),mod:r.includes("mod"),useKey:a},keys:r.filter(e=>!ir.includes(e)),description:s,isSequence:o}}typeof document<"u"&&(document.addEventListener("keydown",e=>{void 0!==e.code&&gr([cr(e.code)])}),document.addEventListener("keyup",e=>{void 0!==e.code&&fr([cr(e.code)])})),typeof window<"u"&&(window.addEventListener("blur",()=>{pr.clear()}),window.addEventListener("contextmenu",()=>{setTimeout(()=>{pr.clear()},0)}));const pr=new Set;function mr(e){return Array.isArray(e)}function gr(e){const t=Array.isArray(e)?e:[e];pr.has("meta")&&pr.forEach(e=>!dr(e)&&pr.delete(e.toLowerCase())),t.forEach(e=>pr.add(e.toLowerCase()))}function fr(e){const t=Array.isArray(e)?e:[e];"meta"===e?pr.clear():t.forEach(e=>pr.delete(e.toLowerCase()))}function yr(e,t=!1){const{target:n,composed:a}=e;let s;return s=function(e){return!!e.tagName&&!e.tagName.startsWith("-")&&e.tagName.includes("-")}(n)&&a?e.composedPath()[0]&&e.composedPath()[0].tagName:n&&n.tagName,mr(t)?!!(s&&t&&t.some(e=>e.toLowerCase()===s.toLowerCase())):!!(s&&t&&t)}const br=(e,t,n=!1)=>{const{alt:a,meta:s,mod:r,shift:o,ctrl:i,keys:l,useKey:c}=t,{code:d,key:u,ctrlKey:h,metaKey:p,shiftKey:m,altKey:g}=e,f=cr(d);if(c&&1===(null==l?void 0:l.length)&&l.includes(u))return!0;if(!(null!=l&&l.includes(f)||["ctrl","control","unknown","meta","alt","shift","os"].includes(f)))return!1;if(!n){if(a!==g&&"alt"!==f||o!==m&&"shift"!==f)return!1;if(r){if(!p&&!h)return!1}else if(s!==p&&"meta"!==f&&"os"!==f||i!==h&&"ctrl"!==f&&"control"!==f)return!1}return!(!l||1!==l.length||!l.includes(f))||(l?function(e,t=","){return(mr(e)?e:e.split(t)).every(e=>pr.has(e.trim().toLowerCase()))}(l):!l)},vr=e.createContext(void 0);function xr({addHotkey:e,removeHotkey:t,children:n}){return $n.jsx(vr.Provider,{value:{addHotkey:e,removeHotkey:t},children:n})}function wr(e,t){return e&&t&&"object"==typeof e&&"object"==typeof t?Object.keys(e).length===Object.keys(t).length&&Object.keys(e).reduce((n,a)=>n&&wr(e[a],t[a]),!0):e===t}const Cr=e.createContext({hotkeys:[],activeScopes:[],toggleScope:()=>{},enableScope:()=>{},disableScope:()=>{}}),kr=({initiallyActiveScopes:t=["*"],children:n})=>{const[a,s]=e.useState(t),[r,o]=e.useState([]),i=e.useCallback(e=>{s(t=>t.includes("*")?[e]:Array.from(new Set([...t,e])))},[]),l=e.useCallback(e=>{s(t=>t.filter(t=>t!==e))},[]),c=e.useCallback(e=>{s(t=>t.includes(e)?t.filter(t=>t!==e):t.includes("*")?[e]:Array.from(new Set([...t,e])))},[]),d=e.useCallback(e=>{o(t=>[...t,e])},[]),u=e.useCallback(e=>{o(t=>t.filter(t=>!wr(t,e)))},[]);return $n.jsx(Cr.Provider,{value:{activeScopes:a,hotkeys:r,enableScope:i,disableScope:l,toggleScope:c},children:$n.jsx(xr,{addHotkey:d,removeHotkey:u,children:n})})};const jr=e=>{e.stopPropagation(),e.preventDefault(),e.stopImmediatePropagation()},Ar=typeof window<"u"?e.useLayoutEffect:e.useEffect;function Sr(t,n,a,s){const r=e.useRef(null),o=e.useRef(!1),i=a instanceof Array?s instanceof Array?void 0:s:a,l=mr(t)?t.join(null==i?void 0:i.delimiter):t,c=a instanceof Array?a:s instanceof Array?s:void 0,d=e.useCallback(n,c??[]),u=e.useRef(d);u.current=c?d:n;const h=function(t){const n=e.useRef(void 0);return wr(n.current,t)||(n.current=t),n.current}(i),{activeScopes:p}=e.useContext(Cr),m=e.useContext(vr);return Ar(()=>{if(!1===(null==h?void 0:h.enabled)||!function(e,t){return!(0!==e.length||!t)||!t||e.some(e=>t.includes(e))||e.includes("*")}(p,null==h?void 0:h.scopes))return;let e,t=[];const n=(n,a=!1)=>{var s;if(!function(e){return yr(e,["input","textarea","select"])}(n)||yr(n,null==h?void 0:h.enableOnFormTags)){if(null!==r.current){const e=r.current.getRootNode();if((e instanceof Document||e instanceof ShadowRoot)&&e.activeElement!==r.current&&!r.current.contains(e.activeElement))return void jr(n)}null!=(s=n.target)&&s.isContentEditable&&(null==h||!h.enableOnContentEditable)||ur(l,null==h?void 0:h.delimiter).forEach(s=>{var r,i,l,c;if(s.includes((null==h?void 0:h.splitKey)??"+")&&s.includes((null==h?void 0:h.sequenceSplitKey)??">"))return;const d=hr(s,null==h?void 0:h.splitKey,null==h?void 0:h.sequenceSplitKey,null==h?void 0:h.useKey,null==h?void 0:h.description);if(d.isSequence){e=setTimeout(()=>{t=[]},(null==h?void 0:h.sequenceTimeoutMs)??1e3);const a=d.useKey?n.key:cr(n.code);if(dr(a.toLowerCase()))return;t.push(a);if(a!==(null==(r=d.keys)?void 0:r[t.length-1]))return t=[],void(e&&clearTimeout(e));t.length===(null==(i=d.keys)?void 0:i.length)&&(u.current(n,d),e&&clearTimeout(e),t=[])}else if(br(n,d,null==h?void 0:h.ignoreModifiers)||null!=(l=d.keys)&&l.includes("*")){if(null!=(c=null==h?void 0:h.ignoreEventWhen)&&c.call(h,n)||a&&o.current)return;if(function(e,t,n){("function"==typeof n&&n(e,t)||!0===n)&&e.preventDefault()}(n,d,null==h?void 0:h.preventDefault),!function(e,t,n){return"function"==typeof n?n(e,t):!0===n||void 0===n}(n,d,null==h?void 0:h.enabled))return void jr(n);u.current(n,d),a||(o.current=!0)}})}},a=e=>{void 0!==e.code&&(gr(cr(e.code)),(void 0===(null==h?void 0:h.keydown)&&!0!==(null==h?void 0:h.keyup)||null!=h&&h.keydown)&&n(e))},s=e=>{void 0!==e.code&&(fr(cr(e.code)),o.current=!1,null!=h&&h.keyup&&n(e,!0))},c=r.current||(null==i?void 0:i.document)||document;return c.addEventListener("keyup",s,null==i?void 0:i.eventListenerOptions),c.addEventListener("keydown",a,null==i?void 0:i.eventListenerOptions),m&&ur(l,null==h?void 0:h.delimiter).forEach(e=>m.addHotkey(hr(e,null==h?void 0:h.splitKey,null==h?void 0:h.sequenceSplitKey,null==h?void 0:h.useKey,null==h?void 0:h.description))),()=>{c.removeEventListener("keyup",s,null==i?void 0:i.eventListenerOptions),c.removeEventListener("keydown",a,null==i?void 0:i.eventListenerOptions),m&&ur(l,null==h?void 0:h.delimiter).forEach(e=>m.removeHotkey(hr(e,null==h?void 0:h.splitKey,null==h?void 0:h.sequenceSplitKey,null==h?void 0:h.useKey,null==h?void 0:h.description))),t=[],e&&clearTimeout(e)}},[l,h,p]),r}const Nr=[{animate:{rotate:[0,-10,10,0]},transition:{repeat:1/0,duration:2.2}},{animate:{y:[0,-10,0]},transition:{repeat:1/0,duration:2.5,delay:.3}},{animate:{rotate:[0,6,-6,0]},transition:{repeat:1/0,duration:2.8,delay:.6}},{animate:{y:[0,8,0]},transition:{repeat:1/0,duration:2,delay:.9}},{animate:{rotate:[0,-8,8,0]},transition:{repeat:1/0,duration:3,delay:1.2}},{animate:{x:[0,7,-7,0]},transition:{repeat:1/0,duration:2.6,delay:1.5}}],Tr=[{src:Mn.assistant,alt:"Assistant Waldiez"},{src:Mn.rag_user_proxy,alt:"RAG Waldiez"},{src:Mn.group_manager,alt:"Manager Waldiez"},{src:Mn.reasoning,alt:"Reasoning Waldiez"},{src:Mn.captain,alt:"Captain Waldiez"},{src:Mn.user_proxy,alt:"User Waldiez"}],Er=({error:e})=>$n.jsxs("div",{className:"waldiez-error-container","data-testid":"error-boundary",children:[$n.jsx("div",{className:"waldiez-bots-row",children:Tr.map((e,t)=>$n.jsx(c.motion.img,{src:e.src,alt:e.alt,className:"waldiez-bot-img",animate:Nr[t]?.animate,transition:Nr[t]?.transition,style:{zIndex:10+t}},e.alt))}),$n.jsx(c.motion.div,{className:"waldiez-error-sign",initial:{opacity:0,scale:.9},animate:{opacity:[0,1,.7,1],scale:[.9,1.1,1]},transition:{repeat:1/0,repeatType:"reverse",duration:1.2,delay:.5},children:$n.jsx("span",{children:"🚨 ERROR"})}),$n.jsxs(c.motion.div,{className:"waldiez-error-message",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1.3},children:[$n.jsx("div",{className:"waldiez-error-title",children:"Oops, something went wrong!"}),$n.jsx("div",{className:"waldiez-error-desc",children:"The Waldiez team is on the case. Please wait while we investigate..."}),$n.jsx("div",{className:"waldiez-refresh-btn-container",children:$n.jsx("button",{onClick:()=>window.location.reload(),className:"waldiez-refresh-btn",onMouseDown:e=>e.currentTarget.style.transform="scale(0.97)",onMouseUp:e=>e.currentTarget.style.transform="scale(1)",onMouseLeave:e=>e.currentTarget.style.transform="scale(1)",children:"Refresh Page"})}),e&&$n.jsxs("div",{className:"waldiez-error-details",children:[$n.jsx("strong",{children:"Error:"})," ",e.message,e.stack&&$n.jsx("pre",{children:e.stack})]})]})]});let _r=null;const Mr=e=>{if(!e.flowId){const t=document.querySelectorAll("[data-flow-id]");1===t.length&&(e.flowId=t[0]?.getAttribute("data-flow-id")||void 0)}_r&&_r(e)},Ir=e.createContext(void 0),Dr=({flowId:t,message:n,level:s="info",details:r,withCloseButton:o,onClose:i})=>{const[l,c]=e.useState(null);if(e.useLayoutEffect(()=>{c((e=>{const t=document.getElementById(`rf-root-${e}`)??document.getElementById(`${e}-modal`)??document.body,n=document.querySelector(`#${e}-modal .modal .modal-content`);return n&&n.getBoundingClientRect().height>0?n:t})(t))},[t]),!l)return null;const d=r&&!("string"==typeof r&&r.length<=50);return a.createPortal($n.jsxs("div",{className:`snackbar show ${s} ${r?"with-details":""}`,role:"alert","aria-live":"error"===s?"assertive":"polite",id:`${t}-snackbar`,"data-testid":"snackbar",children:[$n.jsx("div",{className:"message","data-testid":"snackbar-message",children:n}),r&&(d?$n.jsxs("details",{children:[$n.jsx("summary",{children:"Details"}),$n.jsx("div",{className:"details-content","data-testid":"snackbar-details",children:(e=>{if(e instanceof Error)return e.message;if("string"==typeof e)return e;if("object"==typeof e&&null!==e){if("detail"in e&&"string"==typeof e.detail)return e.detail;if("message"in e&&"string"==typeof e.message)return e.message;if("statusText"in e&&"string"==typeof e.statusText)return`Error: ${e.statusText}`;try{return JSON.stringify(e,null,2)}catch{return String(e)}}return"An unexpected error occurred."})(r)})]}):$n.jsx("span",{className:"details-content","data-testid":"snackbar-details",children:r})),o&&$n.jsx("button",{className:"close","aria-label":"Close notification",type:"button",onClick:i,"data-testid":"snackbar-close",children:"×"})]}),l)},Rr=({children:t})=>{const[n,a]=e.useState({}),[s,r]=e.useState({}),o=e.useRef({}),i=e.useCallback(e=>{a(t=>{const n=Math.random().toString(36).slice(2),a=e.flowId||"default";return{...t,[a]:[...t[a]??[],{...e,id:n}]}})},[]);e.useEffect(()=>(_r=i,()=>{_r=null}),[i]),e.useEffect(()=>{Object.keys(n).forEach(e=>{!s[e]&&n[e]&&n[e].length>0&&(r(t=>({...t,[e]:n[e]?.[0]??null})),a(t=>({...t,[e]:t[e]?.slice(1)??[]})))})},[n,s]);const l=e.useCallback(e=>{r(t=>({...t,[e]:null}))},[]);return e.useEffect(()=>(Object.entries(s).forEach(([e,t])=>{if(!t)return;const{duration:n,withCloseButton:a}=t;a&&void 0===n||(o.current[e]&&clearTimeout(o.current[e]),o.current[e]=window.setTimeout(()=>{l(e)},n??3e3))}),()=>{Object.values(o.current).forEach(clearTimeout),o.current={}}),[s,l]),$n.jsxs(Ir.Provider,{value:{enqueueSnackbar:i},children:[t,Object.entries(s).map(([e,t])=>t?$n.jsx(Dr,{...t,onClose:()=>l(e)},t.id):null)]})};function zr(e,t,{checkForDefaultPrevented:n=!0}={}){return function(a){if(e?.(a),!1===n||!a.defaultPrevented)return t?.(a)}}function Or(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function Lr(...e){return t=>{let n=!1;const a=e.map(e=>{const a=Or(e,t);return n||"function"!=typeof a||(n=!0),a});if(n)return()=>{for(let t=0;t<a.length;t++){const n=a[t];"function"==typeof n?n():Or(e[t],null)}}}}function Pr(...e){return u.useCallback(Lr(...e),e)}function Br(e,t=[]){let n=[];const a=()=>{const t=n.map(e=>u.createContext(e));return function(n){const a=n?.[e]||t;return u.useMemo(()=>({[`__scope${e}`]:{...n,[e]:a}}),[n,a])}};return a.scopeName=e,[function(t,a){const s=u.createContext(a),r=n.length;n=[...n,a];const o=t=>{const{scope:n,children:a,...o}=t,i=n?.[e]?.[r]||s,l=u.useMemo(()=>o,Object.values(o));return $n.jsx(i.Provider,{value:l,children:a})};return o.displayName=t+"Provider",[o,function(n,o){const i=o?.[e]?.[r]||s,l=u.useContext(i);if(l)return l;if(void 0!==a)return a;throw new Error(`\`${n}\` must be used within \`${t}\``)}]},Fr(a,...t)]}function Fr(...e){const t=e[0];if(1===e.length)return t;const n=()=>{const n=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){const a=n.reduce((t,{useScope:n,scopeName:a})=>({...t,...n(e)[`__scope${a}`]}),{});return u.useMemo(()=>({[`__scope${t.scopeName}`]:a}),[a])}};return n.scopeName=t.scopeName,n}function Ur(e){const t=Hr(e),n=u.forwardRef((e,n)=>{const{children:a,...s}=e,r=u.Children.toArray(a),o=r.find(Vr);if(o){const e=o.props.children,a=r.map(t=>t===o?u.Children.count(e)>1?u.Children.only(null):u.isValidElement(e)?e.props.children:null:t);return $n.jsx(t,{...s,ref:n,children:u.isValidElement(e)?u.cloneElement(e,void 0,a):null})}return $n.jsx(t,{...s,ref:n,children:a})});return n.displayName=`${e}.Slot`,n}function Hr(e){const t=u.forwardRef((e,t)=>{const{children:n,...a}=e;if(u.isValidElement(n)){const e=function(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,n=t&&"isReactWarning"in t&&t.isReactWarning;if(n)return e.ref;if(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n)return e.props.ref;return e.props.ref||e.ref}(n),s=function(e,t){const n={...t};for(const a in t){const s=e[a],r=t[a];/^on[A-Z]/.test(a)?s&&r?n[a]=(...e)=>{const t=r(...e);return s(...e),t}:s&&(n[a]=s):"style"===a?n[a]={...s,...r}:"className"===a&&(n[a]=[s,r].filter(Boolean).join(" "))}return{...e,...n}}(a,n.props);return n.type!==u.Fragment&&(s.ref=t?Lr(t,e):e),u.cloneElement(n,s)}return u.Children.count(n)>1?u.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var Wr=Symbol("radix.slottable");function qr(e){const t=({children:e})=>$n.jsx($n.Fragment,{children:e});return t.displayName=`${e}.Slottable`,t.__radixId=Wr,t}function Vr(e){return u.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===Wr}var Gr=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{const n=Ur(`Primitive.${t}`),a=u.forwardRef((e,a)=>{const{asChild:s,...r}=e,o=s?n:t;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),$n.jsx(o,{...r,ref:a})});return a.displayName=`Primitive.${t}`,{...e,[t]:a}},{});function Kr(e){const t=u.useRef(e);return u.useEffect(()=>{t.current=e}),u.useMemo(()=>(...e)=>t.current?.(...e),[])}var $r,Zr="dismissableLayer.update",Qr="dismissableLayer.pointerDownOutside",Yr="dismissableLayer.focusOutside",Xr=u.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Jr=u.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:a,onPointerDownOutside:s,onFocusOutside:r,onInteractOutside:o,onDismiss:i,...l}=e,c=u.useContext(Xr),[d,h]=u.useState(null),p=d?.ownerDocument??globalThis?.document,[,m]=u.useState({}),g=Pr(t,e=>h(e)),f=Array.from(c.layers),[y]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),b=f.indexOf(y),v=d?f.indexOf(d):-1,x=c.layersWithOutsidePointerEventsDisabled.size>0,w=v>=b,C=function(e,t=globalThis?.document){const n=Kr(e),a=u.useRef(!1),s=u.useRef(()=>{});return u.useEffect(()=>{const e=e=>{if(e.target&&!a.current){let a=function(){to(Qr,n,r,{discrete:!0})};const r={originalEvent:e};"touch"===e.pointerType?(t.removeEventListener("click",s.current),s.current=a,t.addEventListener("click",s.current,{once:!0})):a()}else t.removeEventListener("click",s.current);a.current=!1},r=window.setTimeout(()=>{t.addEventListener("pointerdown",e)},0);return()=>{window.clearTimeout(r),t.removeEventListener("pointerdown",e),t.removeEventListener("click",s.current)}},[t,n]),{onPointerDownCapture:()=>a.current=!0}}(e=>{const t=e.target,n=[...c.branches].some(e=>e.contains(t));w&&!n&&(s?.(e),o?.(e),e.defaultPrevented||i?.())},p),k=function(e,t=globalThis?.document){const n=Kr(e),a=u.useRef(!1);return u.useEffect(()=>{const e=e=>{if(e.target&&!a.current){to(Yr,n,{originalEvent:e},{discrete:!1})}};return t.addEventListener("focusin",e),()=>t.removeEventListener("focusin",e)},[t,n]),{onFocusCapture:()=>a.current=!0,onBlurCapture:()=>a.current=!1}}(e=>{const t=e.target;[...c.branches].some(e=>e.contains(t))||(r?.(e),o?.(e),e.defaultPrevented||i?.())},p);return function(e,t=globalThis?.document){const n=Kr(e);u.useEffect(()=>{const e=e=>{"Escape"===e.key&&n(e)};return t.addEventListener("keydown",e,{capture:!0}),()=>t.removeEventListener("keydown",e,{capture:!0})},[n,t])}(e=>{v===c.layers.size-1&&(a?.(e),!e.defaultPrevented&&i&&(e.preventDefault(),i()))},p),u.useEffect(()=>{if(d)return n&&(0===c.layersWithOutsidePointerEventsDisabled.size&&($r=p.body.style.pointerEvents,p.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(d)),c.layers.add(d),eo(),()=>{n&&1===c.layersWithOutsidePointerEventsDisabled.size&&(p.body.style.pointerEvents=$r)}},[d,p,n,c]),u.useEffect(()=>()=>{d&&(c.layers.delete(d),c.layersWithOutsidePointerEventsDisabled.delete(d),eo())},[d,c]),u.useEffect(()=>{const e=()=>m({});return document.addEventListener(Zr,e),()=>document.removeEventListener(Zr,e)},[]),$n.jsx(Gr.div,{...l,ref:g,style:{pointerEvents:x?w?"auto":"none":void 0,...e.style},onFocusCapture:zr(e.onFocusCapture,k.onFocusCapture),onBlurCapture:zr(e.onBlurCapture,k.onBlurCapture),onPointerDownCapture:zr(e.onPointerDownCapture,C.onPointerDownCapture)})});Jr.displayName="DismissableLayer";function eo(){const e=new CustomEvent(Zr);document.dispatchEvent(e)}function to(e,t,n,{discrete:a}){const s=n.originalEvent.target,r=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&s.addEventListener(e,t,{once:!0}),a?function(e,t){e&&h.flushSync(()=>e.dispatchEvent(t))}(s,r):s.dispatchEvent(r)}u.forwardRef((e,t)=>{const n=u.useContext(Xr),a=u.useRef(null),s=Pr(t,a);return u.useEffect(()=>{const e=a.current;if(e)return n.branches.add(e),()=>{n.branches.delete(e)}},[n.branches]),$n.jsx(Gr.div,{...e,ref:s})}).displayName="DismissableLayerBranch";var no=globalThis?.document?u.useLayoutEffect:()=>{},ao=u[" useId ".trim().toString()]||(()=>{}),so=0;const ro=["top","right","bottom","left"],oo=Math.min,io=Math.max,lo=Math.round,co=Math.floor,uo=e=>({x:e,y:e}),ho={left:"right",right:"left",bottom:"top",top:"bottom"},po={start:"end",end:"start"};function mo(e,t,n){return io(e,oo(t,n))}function go(e,t){return"function"==typeof e?e(t):e}function fo(e){return e.split("-")[0]}function yo(e){return e.split("-")[1]}function bo(e){return"x"===e?"y":"x"}function vo(e){return"y"===e?"height":"width"}const xo=new Set(["top","bottom"]);function wo(e){return xo.has(fo(e))?"y":"x"}function Co(e){return bo(wo(e))}function ko(e){return e.replace(/start|end/g,e=>po[e])}const jo=["left","right"],Ao=["right","left"],So=["top","bottom"],No=["bottom","top"];function To(e,t,n,a){const s=yo(e);let r=function(e,t,n){switch(e){case"top":case"bottom":return n?t?Ao:jo:t?jo:Ao;case"left":case"right":return t?So:No;default:return[]}}(fo(e),"start"===n,a);return s&&(r=r.map(e=>e+"-"+s),t&&(r=r.concat(r.map(ko)))),r}function Eo(e){return e.replace(/left|right|bottom|top/g,e=>ho[e])}function _o(e){return"number"!=typeof e?function(e){return{top:0,right:0,bottom:0,left:0,...e}}(e):{top:e,right:e,bottom:e,left:e}}function Mo(e){const{x:t,y:n,width:a,height:s}=e;return{width:a,height:s,top:n,left:t,right:t+a,bottom:n+s,x:t,y:n}}function Io(e,t,n){let{reference:a,floating:s}=e;const r=wo(t),o=Co(t),i=vo(o),l=fo(t),c="y"===r,d=a.x+a.width/2-s.width/2,u=a.y+a.height/2-s.height/2,h=a[i]/2-s[i]/2;let p;switch(l){case"top":p={x:d,y:a.y-s.height};break;case"bottom":p={x:d,y:a.y+a.height};break;case"right":p={x:a.x+a.width,y:u};break;case"left":p={x:a.x-s.width,y:u};break;default:p={x:a.x,y:a.y}}switch(yo(t)){case"start":p[o]-=h*(n&&c?-1:1);break;case"end":p[o]+=h*(n&&c?-1:1)}return p}async function Do(e,t){var n;void 0===t&&(t={});const{x:a,y:s,platform:r,rects:o,elements:i,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:d="viewport",elementContext:u="floating",altBoundary:h=!1,padding:p=0}=go(t,e),m=_o(p),g=i[h?"floating"===u?"reference":"floating":u],f=Mo(await r.getClippingRect({element:null==(n=await(null==r.isElement?void 0:r.isElement(g)))||n?g:g.contextElement||await(null==r.getDocumentElement?void 0:r.getDocumentElement(i.floating)),boundary:c,rootBoundary:d,strategy:l})),y="floating"===u?{x:a,y:s,width:o.floating.width,height:o.floating.height}:o.reference,b=await(null==r.getOffsetParent?void 0:r.getOffsetParent(i.floating)),v=await(null==r.isElement?void 0:r.isElement(b))&&await(null==r.getScale?void 0:r.getScale(b))||{x:1,y:1},x=Mo(r.convertOffsetParentRelativeRectToViewportRelativeRect?await r.convertOffsetParentRelativeRectToViewportRelativeRect({elements:i,rect:y,offsetParent:b,strategy:l}):y);return{top:(f.top-x.top+m.top)/v.y,bottom:(x.bottom-f.bottom+m.bottom)/v.y,left:(f.left-x.left+m.left)/v.x,right:(x.right-f.right+m.right)/v.x}}function Ro(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function zo(e){return ro.some(t=>e[t]>=0)}const Oo=new Set(["left","top"]);function Lo(){return"undefined"!=typeof window}function Po(e){return Uo(e)?(e.nodeName||"").toLowerCase():"#document"}function Bo(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function Fo(e){var t;return null==(t=(Uo(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function Uo(e){return!!Lo()&&(e instanceof Node||e instanceof Bo(e).Node)}function Ho(e){return!!Lo()&&(e instanceof Element||e instanceof Bo(e).Element)}function Wo(e){return!!Lo()&&(e instanceof HTMLElement||e instanceof Bo(e).HTMLElement)}function qo(e){return!(!Lo()||"undefined"==typeof ShadowRoot)&&(e instanceof ShadowRoot||e instanceof Bo(e).ShadowRoot)}const Vo=new Set(["inline","contents"]);function Go(e){const{overflow:t,overflowX:n,overflowY:a,display:s}=si(e);return/auto|scroll|overlay|hidden|clip/.test(t+a+n)&&!Vo.has(s)}const Ko=new Set(["table","td","th"]);function $o(e){return Ko.has(Po(e))}const Zo=[":popover-open",":modal"];function Qo(e){return Zo.some(t=>{try{return e.matches(t)}catch(n){return!1}})}const Yo=["transform","translate","scale","rotate","perspective"],Xo=["transform","translate","scale","rotate","perspective","filter"],Jo=["paint","layout","strict","content"];function ei(e){const t=ti(),n=Ho(e)?si(e):e;return Yo.some(e=>!!n[e]&&"none"!==n[e])||!!n.containerType&&"normal"!==n.containerType||!t&&!!n.backdropFilter&&"none"!==n.backdropFilter||!t&&!!n.filter&&"none"!==n.filter||Xo.some(e=>(n.willChange||"").includes(e))||Jo.some(e=>(n.contain||"").includes(e))}function ti(){return!("undefined"==typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}const ni=new Set(["html","body","#document"]);function ai(e){return ni.has(Po(e))}function si(e){return Bo(e).getComputedStyle(e)}function ri(e){return Ho(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function oi(e){if("html"===Po(e))return e;const t=e.assignedSlot||e.parentNode||qo(e)&&e.host||Fo(e);return qo(t)?t.host:t}function ii(e){const t=oi(e);return ai(t)?e.ownerDocument?e.ownerDocument.body:e.body:Wo(t)&&Go(t)?t:ii(t)}function li(e,t,n){var a;void 0===t&&(t=[]),void 0===n&&(n=!0);const s=ii(e),r=s===(null==(a=e.ownerDocument)?void 0:a.body),o=Bo(s);if(r){const e=ci(o);return t.concat(o,o.visualViewport||[],Go(s)?s:[],e&&n?li(e):[])}return t.concat(s,li(s,[],n))}function ci(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function di(e){const t=si(e);let n=parseFloat(t.width)||0,a=parseFloat(t.height)||0;const s=Wo(e),r=s?e.offsetWidth:n,o=s?e.offsetHeight:a,i=lo(n)!==r||lo(a)!==o;return i&&(n=r,a=o),{width:n,height:a,$:i}}function ui(e){return Ho(e)?e:e.contextElement}function hi(e){const t=ui(e);if(!Wo(t))return uo(1);const n=t.getBoundingClientRect(),{width:a,height:s,$:r}=di(t);let o=(r?lo(n.width):n.width)/a,i=(r?lo(n.height):n.height)/s;return o&&Number.isFinite(o)||(o=1),i&&Number.isFinite(i)||(i=1),{x:o,y:i}}const pi=uo(0);function mi(e){const t=Bo(e);return ti()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:pi}function gi(e,t,n,a){void 0===t&&(t=!1),void 0===n&&(n=!1);const s=e.getBoundingClientRect(),r=ui(e);let o=uo(1);t&&(a?Ho(a)&&(o=hi(a)):o=hi(e));const i=function(e,t,n){return void 0===t&&(t=!1),!(!n||t&&n!==Bo(e))&&t}(r,n,a)?mi(r):uo(0);let l=(s.left+i.x)/o.x,c=(s.top+i.y)/o.y,d=s.width/o.x,u=s.height/o.y;if(r){const e=Bo(r),t=a&&Ho(a)?Bo(a):a;let n=e,s=ci(n);for(;s&&a&&t!==n;){const e=hi(s),t=s.getBoundingClientRect(),a=si(s),r=t.left+(s.clientLeft+parseFloat(a.paddingLeft))*e.x,o=t.top+(s.clientTop+parseFloat(a.paddingTop))*e.y;l*=e.x,c*=e.y,d*=e.x,u*=e.y,l+=r,c+=o,n=Bo(s),s=ci(n)}}return Mo({width:d,height:u,x:l,y:c})}function fi(e,t){const n=ri(e).scrollLeft;return t?t.left+n:gi(Fo(e)).left+n}function yi(e,t){const n=e.getBoundingClientRect();return{x:n.left+t.scrollLeft-fi(e,n),y:n.top+t.scrollTop}}const bi=new Set(["absolute","fixed"]);function vi(e,t,n){let a;if("viewport"===t)a=function(e,t){const n=Bo(e),a=Fo(e),s=n.visualViewport;let r=a.clientWidth,o=a.clientHeight,i=0,l=0;if(s){r=s.width,o=s.height;const e=ti();(!e||e&&"fixed"===t)&&(i=s.offsetLeft,l=s.offsetTop)}const c=fi(a);if(c<=0){const e=a.ownerDocument,t=e.body,n=getComputedStyle(t),s="CSS1Compat"===e.compatMode&&parseFloat(n.marginLeft)+parseFloat(n.marginRight)||0,o=Math.abs(a.clientWidth-t.clientWidth-s);o<=25&&(r-=o)}else c<=25&&(r+=c);return{width:r,height:o,x:i,y:l}}(e,n);else if("document"===t)a=function(e){const t=Fo(e),n=ri(e),a=e.ownerDocument.body,s=io(t.scrollWidth,t.clientWidth,a.scrollWidth,a.clientWidth),r=io(t.scrollHeight,t.clientHeight,a.scrollHeight,a.clientHeight);let o=-n.scrollLeft+fi(e);const i=-n.scrollTop;return"rtl"===si(a).direction&&(o+=io(t.clientWidth,a.clientWidth)-s),{width:s,height:r,x:o,y:i}}(Fo(e));else if(Ho(t))a=function(e,t){const n=gi(e,!0,"fixed"===t),a=n.top+e.clientTop,s=n.left+e.clientLeft,r=Wo(e)?hi(e):uo(1);return{width:e.clientWidth*r.x,height:e.clientHeight*r.y,x:s*r.x,y:a*r.y}}(t,n);else{const n=mi(e);a={x:t.x-n.x,y:t.y-n.y,width:t.width,height:t.height}}return Mo(a)}function xi(e,t){const n=oi(e);return!(n===t||!Ho(n)||ai(n))&&("fixed"===si(n).position||xi(n,t))}function wi(e,t,n){const a=Wo(t),s=Fo(t),r="fixed"===n,o=gi(e,!0,r,t);let i={scrollLeft:0,scrollTop:0};const l=uo(0);function c(){l.x=fi(s)}if(a||!a&&!r)if(("body"!==Po(t)||Go(s))&&(i=ri(t)),a){const e=gi(t,!0,r,t);l.x=e.x+t.clientLeft,l.y=e.y+t.clientTop}else s&&c();r&&!a&&s&&c();const d=!s||a||r?uo(0):yi(s,i);return{x:o.left+i.scrollLeft-l.x-d.x,y:o.top+i.scrollTop-l.y-d.y,width:o.width,height:o.height}}function Ci(e){return"static"===si(e).position}function ki(e,t){if(!Wo(e)||"fixed"===si(e).position)return null;if(t)return t(e);let n=e.offsetParent;return Fo(e)===n&&(n=n.ownerDocument.body),n}function ji(e,t){const n=Bo(e);if(Qo(e))return n;if(!Wo(e)){let t=oi(e);for(;t&&!ai(t);){if(Ho(t)&&!Ci(t))return t;t=oi(t)}return n}let a=ki(e,t);for(;a&&$o(a)&&Ci(a);)a=ki(a,t);return a&&ai(a)&&Ci(a)&&!ei(a)?n:a||function(e){let t=oi(e);for(;Wo(t)&&!ai(t);){if(ei(t))return t;if(Qo(t))return null;t=oi(t)}return null}(e)||n}const Ai={convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{elements:t,rect:n,offsetParent:a,strategy:s}=e;const r="fixed"===s,o=Fo(a),i=!!t&&Qo(t.floating);if(a===o||i&&r)return n;let l={scrollLeft:0,scrollTop:0},c=uo(1);const d=uo(0),u=Wo(a);if((u||!u&&!r)&&(("body"!==Po(a)||Go(o))&&(l=ri(a)),Wo(a))){const e=gi(a);c=hi(a),d.x=e.x+a.clientLeft,d.y=e.y+a.clientTop}const h=!o||u||r?uo(0):yi(o,l);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+d.x+h.x,y:n.y*c.y-l.scrollTop*c.y+d.y+h.y}},getDocumentElement:Fo,getClippingRect:function(e){let{element:t,boundary:n,rootBoundary:a,strategy:s}=e;const r=[..."clippingAncestors"===n?Qo(t)?[]:function(e,t){const n=t.get(e);if(n)return n;let a=li(e,[],!1).filter(e=>Ho(e)&&"body"!==Po(e)),s=null;const r="fixed"===si(e).position;let o=r?oi(e):e;for(;Ho(o)&&!ai(o);){const t=si(o),n=ei(o);n||"fixed"!==t.position||(s=null),(r?!n&&!s:!n&&"static"===t.position&&s&&bi.has(s.position)||Go(o)&&!n&&xi(e,o))?a=a.filter(e=>e!==o):s=t,o=oi(o)}return t.set(e,a),a}(t,this._c):[].concat(n),a],o=r[0],i=r.reduce((e,n)=>{const a=vi(t,n,s);return e.top=io(a.top,e.top),e.right=oo(a.right,e.right),e.bottom=oo(a.bottom,e.bottom),e.left=io(a.left,e.left),e},vi(t,o,s));return{width:i.right-i.left,height:i.bottom-i.top,x:i.left,y:i.top}},getOffsetParent:ji,getElementRects:async function(e){const t=this.getOffsetParent||ji,n=this.getDimensions,a=await n(e.floating);return{reference:wi(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:a.width,height:a.height}}},getClientRects:function(e){return Array.from(e.getClientRects())},getDimensions:function(e){const{width:t,height:n}=di(e);return{width:t,height:n}},getScale:hi,isElement:Ho,isRTL:function(e){return"rtl"===si(e).direction}};function Si(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function Ni(e,t,n,a){void 0===a&&(a={});const{ancestorScroll:s=!0,ancestorResize:r=!0,elementResize:o="function"==typeof ResizeObserver,layoutShift:i="function"==typeof IntersectionObserver,animationFrame:l=!1}=a,c=ui(e),d=s||r?[...c?li(c):[],...li(t)]:[];d.forEach(e=>{s&&e.addEventListener("scroll",n,{passive:!0}),r&&e.addEventListener("resize",n)});const u=c&&i?function(e,t){let n,a=null;const s=Fo(e);function r(){var e;clearTimeout(n),null==(e=a)||e.disconnect(),a=null}return function o(i,l){void 0===i&&(i=!1),void 0===l&&(l=1),r();const c=e.getBoundingClientRect(),{left:d,top:u,width:h,height:p}=c;if(i||t(),!h||!p)return;const m={rootMargin:-co(u)+"px "+-co(s.clientWidth-(d+h))+"px "+-co(s.clientHeight-(u+p))+"px "+-co(d)+"px",threshold:io(0,oo(1,l))||1};let g=!0;function f(t){const a=t[0].intersectionRatio;if(a!==l){if(!g)return o();a?o(!1,a):n=setTimeout(()=>{o(!1,1e-7)},1e3)}1!==a||Si(c,e.getBoundingClientRect())||o(),g=!1}try{a=new IntersectionObserver(f,{...m,root:s.ownerDocument})}catch(y){a=new IntersectionObserver(f,m)}a.observe(e)}(!0),r}(c,n):null;let h,p=-1,m=null;o&&(m=new ResizeObserver(e=>{let[a]=e;a&&a.target===c&&m&&(m.unobserve(t),cancelAnimationFrame(p),p=requestAnimationFrame(()=>{var e;null==(e=m)||e.observe(t)})),n()}),c&&!l&&m.observe(c),m.observe(t));let g=l?gi(e):null;return l&&function t(){const a=gi(e);g&&!Si(g,a)&&n();g=a,h=requestAnimationFrame(t)}(),n(),()=>{var e;d.forEach(e=>{s&&e.removeEventListener("scroll",n),r&&e.removeEventListener("resize",n)}),null==u||u(),null==(e=m)||e.disconnect(),m=null,l&&cancelAnimationFrame(h)}}const Ti=function(e){return void 0===e&&(e=0),{name:"offset",options:e,async fn(t){var n,a;const{x:s,y:r,placement:o,middlewareData:i}=t,l=await async function(e,t){const{placement:n,platform:a,elements:s}=e,r=await(null==a.isRTL?void 0:a.isRTL(s.floating)),o=fo(n),i=yo(n),l="y"===wo(n),c=Oo.has(o)?-1:1,d=r&&l?-1:1,u=go(t,e);let{mainAxis:h,crossAxis:p,alignmentAxis:m}="number"==typeof u?{mainAxis:u,crossAxis:0,alignmentAxis:null}:{mainAxis:u.mainAxis||0,crossAxis:u.crossAxis||0,alignmentAxis:u.alignmentAxis};return i&&"number"==typeof m&&(p="end"===i?-1*m:m),l?{x:p*d,y:h*c}:{x:h*c,y:p*d}}(t,e);return o===(null==(n=i.offset)?void 0:n.placement)&&null!=(a=i.arrow)&&a.alignmentOffset?{}:{x:s+l.x,y:r+l.y,data:{...l,placement:o}}}}},Ei=function(e){return void 0===e&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:a,placement:s}=t,{mainAxis:r=!0,crossAxis:o=!1,limiter:i={fn:e=>{let{x:t,y:n}=e;return{x:t,y:n}}},...l}=go(e,t),c={x:n,y:a},d=await Do(t,l),u=wo(fo(s)),h=bo(u);let p=c[h],m=c[u];if(r){const e="y"===h?"bottom":"right";p=mo(p+d["y"===h?"top":"left"],p,p-d[e])}if(o){const e="y"===u?"bottom":"right";m=mo(m+d["y"===u?"top":"left"],m,m-d[e])}const g=i.fn({...t,[h]:p,[u]:m});return{...g,data:{x:g.x-n,y:g.y-a,enabled:{[h]:r,[u]:o}}}}}},_i=function(e){return void 0===e&&(e={}),{name:"flip",options:e,async fn(t){var n,a;const{placement:s,middlewareData:r,rects:o,initialPlacement:i,platform:l,elements:c}=t,{mainAxis:d=!0,crossAxis:u=!0,fallbackPlacements:h,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:m="none",flipAlignment:g=!0,...f}=go(e,t);if(null!=(n=r.arrow)&&n.alignmentOffset)return{};const y=fo(s),b=wo(i),v=fo(i)===i,x=await(null==l.isRTL?void 0:l.isRTL(c.floating)),w=h||(v||!g?[Eo(i)]:function(e){const t=Eo(e);return[ko(e),t,ko(t)]}(i)),C="none"!==m;!h&&C&&w.push(...To(i,g,m,x));const k=[i,...w],j=await Do(t,f),A=[];let S=(null==(a=r.flip)?void 0:a.overflows)||[];if(d&&A.push(j[y]),u){const e=function(e,t,n){void 0===n&&(n=!1);const a=yo(e),s=Co(e),r=vo(s);let o="x"===s?a===(n?"end":"start")?"right":"left":"start"===a?"bottom":"top";return t.reference[r]>t.floating[r]&&(o=Eo(o)),[o,Eo(o)]}(s,o,x);A.push(j[e[0]],j[e[1]])}if(S=[...S,{placement:s,overflows:A}],!A.every(e=>e<=0)){var N,T;const e=((null==(N=r.flip)?void 0:N.index)||0)+1,t=k[e];if(t){if(!("alignment"===u&&b!==wo(t))||S.every(e=>wo(e.placement)!==b||e.overflows[0]>0))return{data:{index:e,overflows:S},reset:{placement:t}}}let n=null==(T=S.filter(e=>e.overflows[0]<=0).sort((e,t)=>e.overflows[1]-t.overflows[1])[0])?void 0:T.placement;if(!n)switch(p){case"bestFit":{var E;const e=null==(E=S.filter(e=>{if(C){const t=wo(e.placement);return t===b||"y"===t}return!0}).map(e=>[e.placement,e.overflows.filter(e=>e>0).reduce((e,t)=>e+t,0)]).sort((e,t)=>e[1]-t[1])[0])?void 0:E[0];e&&(n=e);break}case"initialPlacement":n=i}if(s!==n)return{reset:{placement:n}}}return{}}}},Mi=function(e){return void 0===e&&(e={}),{name:"size",options:e,async fn(t){var n,a;const{placement:s,rects:r,platform:o,elements:i}=t,{apply:l=()=>{},...c}=go(e,t),d=await Do(t,c),u=fo(s),h=yo(s),p="y"===wo(s),{width:m,height:g}=r.floating;let f,y;"top"===u||"bottom"===u?(f=u,y=h===(await(null==o.isRTL?void 0:o.isRTL(i.floating))?"start":"end")?"left":"right"):(y=u,f="end"===h?"top":"bottom");const b=g-d.top-d.bottom,v=m-d.left-d.right,x=oo(g-d[f],b),w=oo(m-d[y],v),C=!t.middlewareData.shift;let k=x,j=w;if(null!=(n=t.middlewareData.shift)&&n.enabled.x&&(j=v),null!=(a=t.middlewareData.shift)&&a.enabled.y&&(k=b),C&&!h){const e=io(d.left,0),t=io(d.right,0),n=io(d.top,0),a=io(d.bottom,0);p?j=m-2*(0!==e||0!==t?e+t:io(d.left,d.right)):k=g-2*(0!==n||0!==a?n+a:io(d.top,d.bottom))}await l({...t,availableWidth:j,availableHeight:k});const A=await o.getDimensions(i.floating);return m!==A.width||g!==A.height?{reset:{rects:!0}}:{}}}},Ii=function(e){return void 0===e&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:a="referenceHidden",...s}=go(e,t);switch(a){case"referenceHidden":{const e=Ro(await Do(t,{...s,elementContext:"reference"}),n.reference);return{data:{referenceHiddenOffsets:e,referenceHidden:zo(e)}}}case"escaped":{const e=Ro(await Do(t,{...s,altBoundary:!0}),n.floating);return{data:{escapedOffsets:e,escaped:zo(e)}}}default:return{}}}}},Di=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:a,placement:s,rects:r,platform:o,elements:i,middlewareData:l}=t,{element:c,padding:d=0}=go(e,t)||{};if(null==c)return{};const u=_o(d),h={x:n,y:a},p=Co(s),m=vo(p),g=await o.getDimensions(c),f="y"===p,y=f?"top":"left",b=f?"bottom":"right",v=f?"clientHeight":"clientWidth",x=r.reference[m]+r.reference[p]-h[p]-r.floating[m],w=h[p]-r.reference[p],C=await(null==o.getOffsetParent?void 0:o.getOffsetParent(c));let k=C?C[v]:0;k&&await(null==o.isElement?void 0:o.isElement(C))||(k=i.floating[v]||r.floating[m]);const j=x/2-w/2,A=k/2-g[m]/2-1,S=oo(u[y],A),N=oo(u[b],A),T=S,E=k-g[m]-N,_=k/2-g[m]/2+j,M=mo(T,_,E),I=!l.arrow&&null!=yo(s)&&_!==M&&r.reference[m]/2-(_<T?S:N)-g[m]/2<0,D=I?_<T?_-T:_-E:0;return{[p]:h[p]+D,data:{[p]:M,centerOffset:_-M-D,...I&&{alignmentOffset:D}},reset:I}}}),Ri=function(e){return void 0===e&&(e={}),{options:e,fn(t){const{x:n,y:a,placement:s,rects:r,middlewareData:o}=t,{offset:i=0,mainAxis:l=!0,crossAxis:c=!0}=go(e,t),d={x:n,y:a},u=wo(s),h=bo(u);let p=d[h],m=d[u];const g=go(i,t),f="number"==typeof g?{mainAxis:g,crossAxis:0}:{mainAxis:0,crossAxis:0,...g};if(l){const e="y"===h?"height":"width",t=r.reference[h]-r.floating[e]+f.mainAxis,n=r.reference[h]+r.reference[e]-f.mainAxis;p<t?p=t:p>n&&(p=n)}if(c){var y,b;const e="y"===h?"width":"height",t=Oo.has(fo(s)),n=r.reference[u]-r.floating[e]+(t&&(null==(y=o.offset)?void 0:y[u])||0)+(t?0:f.crossAxis),a=r.reference[u]+r.reference[e]+(t?0:(null==(b=o.offset)?void 0:b[u])||0)-(t?f.crossAxis:0);m<n?m=n:m>a&&(m=a)}return{[h]:p,[u]:m}}}},zi=(e,t,n)=>{const a=new Map,s={platform:Ai,...n},r={...s.platform,_c:a};return(async(e,t,n)=>{const{placement:a="bottom",strategy:s="absolute",middleware:r=[],platform:o}=n,i=r.filter(Boolean),l=await(null==o.isRTL?void 0:o.isRTL(t));let c=await o.getElementRects({reference:e,floating:t,strategy:s}),{x:d,y:u}=Io(c,a,l),h=a,p={},m=0;for(let g=0;g<i.length;g++){const{name:n,fn:r}=i[g],{x:f,y:y,data:b,reset:v}=await r({x:d,y:u,initialPlacement:a,placement:h,strategy:s,middlewareData:p,rects:c,platform:o,elements:{reference:e,floating:t}});d=null!=f?f:d,u=null!=y?y:u,p={...p,[n]:{...p[n],...b}},v&&m<=50&&(m++,"object"==typeof v&&(v.placement&&(h=v.placement),v.rects&&(c=!0===v.rects?await o.getElementRects({reference:e,floating:t,strategy:s}):v.rects),({x:d,y:u}=Io(c,h,l))),g=-1)}return{x:d,y:u,placement:h,strategy:s,middlewareData:p}})(e,t,{...s,platform:r})};var Oi="undefined"!=typeof document?e.useLayoutEffect:function(){};function Li(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if("function"==typeof e&&e.toString()===t.toString())return!0;let n,a,s;if(e&&t&&"object"==typeof e){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(a=n;0!==a--;)if(!Li(e[a],t[a]))return!1;return!0}if(s=Object.keys(e),n=s.length,n!==Object.keys(t).length)return!1;for(a=n;0!==a--;)if(!{}.hasOwnProperty.call(t,s[a]))return!1;for(a=n;0!==a--;){const n=s[a];if(("_owner"!==n||!e.$$typeof)&&!Li(e[n],t[n]))return!1}return!0}return e!=e&&t!=t}function Pi(e){if("undefined"==typeof window)return 1;return(e.ownerDocument.defaultView||window).devicePixelRatio||1}function Bi(e,t){const n=Pi(e);return Math.round(t*n)/n}function Fi(e){const t=u.useRef(e);return Oi(()=>{t.current=e}),t}const Ui=e=>({name:"arrow",options:e,fn(t){const{element:n,padding:a}="function"==typeof e?e(t):e;return n&&(s=n,{}.hasOwnProperty.call(s,"current"))?null!=n.current?Di({element:n.current,padding:a}).fn(t):{}:n?Di({element:n,padding:a}).fn(t):{};var s}}),Hi=(e,t)=>({...Ei(e),options:[e,t]}),Wi=(e,t)=>({...Ri(e),options:[e,t]}),qi=(e,t)=>({..._i(e),options:[e,t]}),Vi=(e,t)=>({...Mi(e),options:[e,t]}),Gi=(e,t)=>({...Ii(e),options:[e,t]}),Ki=(e,t)=>({...Ui(e),options:[e,t]});var $i=u.forwardRef((e,t)=>{const{children:n,width:a=10,height:s=5,...r}=e;return $n.jsx(Gr.svg,{...r,ref:t,width:a,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:$n.jsx("polygon",{points:"0,0 30,0 15,10"})})});$i.displayName="Arrow";var Zi=$i;function Qi(e){const[t,n]=u.useState(void 0);return no(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const t=new ResizeObserver(t=>{if(!Array.isArray(t))return;if(!t.length)return;const a=t[0];let s,r;if("borderBoxSize"in a){const e=a.borderBoxSize,t=Array.isArray(e)?e[0]:e;s=t.inlineSize,r=t.blockSize}else s=e.offsetWidth,r=e.offsetHeight;n({width:s,height:r})});return t.observe(e,{box:"border-box"}),()=>t.unobserve(e)}n(void 0)},[e]),t}var Yi="Popper",[Xi,Ji]=Br(Yi),[el,tl]=Xi(Yi),nl=e=>{const{__scopePopper:t,children:n}=e,[a,s]=u.useState(null);return $n.jsx(el,{scope:t,anchor:a,onAnchorChange:s,children:n})};nl.displayName=Yi;var al="PopperAnchor",sl=u.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:a,...s}=e,r=tl(al,n),o=u.useRef(null),i=Pr(t,o),l=u.useRef(null);return u.useEffect(()=>{const e=l.current;l.current=a?.current||o.current,e!==l.current&&r.onAnchorChange(l.current)}),a?null:$n.jsx(Gr.div,{...s,ref:i})});sl.displayName=al;var rl="PopperContent",[ol,il]=Xi(rl),ll=u.forwardRef((e,t)=>{const{__scopePopper:n,side:a="bottom",sideOffset:s=0,align:r="center",alignOffset:o=0,arrowPadding:i=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:d=0,sticky:p="partial",hideWhenDetached:m=!1,updatePositionStrategy:g="optimized",onPlaced:f,...y}=e,b=tl(rl,n),[v,x]=u.useState(null),w=Pr(t,e=>x(e)),[C,k]=u.useState(null),j=Qi(C),A=j?.width??0,S=j?.height??0,N=a+("center"!==r?"-"+r:""),T="number"==typeof d?d:{top:0,right:0,bottom:0,left:0,...d},E=Array.isArray(c)?c:[c],_=E.length>0,M={padding:T,boundary:E.filter(hl),altBoundary:_},{refs:I,floatingStyles:D,placement:R,isPositioned:z,middlewareData:O}=function(e){void 0===e&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:a=[],platform:s,elements:{reference:r,floating:o}={},transform:i=!0,whileElementsMounted:l,open:c}=e,[d,p]=u.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[m,g]=u.useState(a);Li(m,a)||g(a);const[f,y]=u.useState(null),[b,v]=u.useState(null),x=u.useCallback(e=>{e!==j.current&&(j.current=e,y(e))},[]),w=u.useCallback(e=>{e!==A.current&&(A.current=e,v(e))},[]),C=r||f,k=o||b,j=u.useRef(null),A=u.useRef(null),S=u.useRef(d),N=null!=l,T=Fi(l),E=Fi(s),_=Fi(c),M=u.useCallback(()=>{if(!j.current||!A.current)return;const e={placement:t,strategy:n,middleware:m};E.current&&(e.platform=E.current),zi(j.current,A.current,e).then(e=>{const t={...e,isPositioned:!1!==_.current};I.current&&!Li(S.current,t)&&(S.current=t,h.flushSync(()=>{p(t)}))})},[m,t,n,E,_]);Oi(()=>{!1===c&&S.current.isPositioned&&(S.current.isPositioned=!1,p(e=>({...e,isPositioned:!1})))},[c]);const I=u.useRef(!1);Oi(()=>(I.current=!0,()=>{I.current=!1}),[]),Oi(()=>{if(C&&(j.current=C),k&&(A.current=k),C&&k){if(T.current)return T.current(C,k,M);M()}},[C,k,M,T,N]);const D=u.useMemo(()=>({reference:j,floating:A,setReference:x,setFloating:w}),[x,w]),R=u.useMemo(()=>({reference:C,floating:k}),[C,k]),z=u.useMemo(()=>{const e={position:n,left:0,top:0};if(!R.floating)return e;const t=Bi(R.floating,d.x),a=Bi(R.floating,d.y);return i?{...e,transform:"translate("+t+"px, "+a+"px)",...Pi(R.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:t,top:a}},[n,i,R.floating,d.x,d.y]);return u.useMemo(()=>({...d,update:M,refs:D,elements:R,floatingStyles:z}),[d,M,D,R,z])}({strategy:"fixed",placement:N,whileElementsMounted:(...e)=>Ni(...e,{animationFrame:"always"===g}),elements:{reference:b.anchor},middleware:[(L={mainAxis:s+S,alignmentAxis:o},{...Ti(L),options:[L,P]}),l&&Hi({mainAxis:!0,crossAxis:!1,limiter:"partial"===p?Wi():void 0,...M}),l&&qi({...M}),Vi({...M,apply:({elements:e,rects:t,availableWidth:n,availableHeight:a})=>{const{width:s,height:r}=t.reference,o=e.floating.style;o.setProperty("--radix-popper-available-width",`${n}px`),o.setProperty("--radix-popper-available-height",`${a}px`),o.setProperty("--radix-popper-anchor-width",`${s}px`),o.setProperty("--radix-popper-anchor-height",`${r}px`)}}),C&&Ki({element:C,padding:i}),pl({arrowWidth:A,arrowHeight:S}),m&&Gi({strategy:"referenceHidden",...M})]});var L,P;const[B,F]=ml(R),U=Kr(f);no(()=>{z&&U?.()},[z,U]);const H=O.arrow?.x,W=O.arrow?.y,q=0!==O.arrow?.centerOffset,[V,G]=u.useState();return no(()=>{v&&G(window.getComputedStyle(v).zIndex)},[v]),$n.jsx("div",{ref:I.setFloating,"data-radix-popper-content-wrapper":"",style:{...D,transform:z?D.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:V,"--radix-popper-transform-origin":[O.transformOrigin?.x,O.transformOrigin?.y].join(" "),...O.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:$n.jsx(ol,{scope:n,placedSide:B,onArrowChange:k,arrowX:H,arrowY:W,shouldHideArrow:q,children:$n.jsx(Gr.div,{"data-side":B,"data-align":F,...y,ref:w,style:{...y.style,animation:z?void 0:"none"}})})})});ll.displayName=rl;var cl="PopperArrow",dl={top:"bottom",right:"left",bottom:"top",left:"right"},ul=u.forwardRef(function(e,t){const{__scopePopper:n,...a}=e,s=il(cl,n),r=dl[s.placedSide];return $n.jsx("span",{ref:s.onArrowChange,style:{position:"absolute",left:s.arrowX,top:s.arrowY,[r]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[s.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[s.placedSide],visibility:s.shouldHideArrow?"hidden":void 0},children:$n.jsx(Zi,{...a,ref:t,style:{...a.style,display:"block"}})})});function hl(e){return null!==e}ul.displayName=cl;var pl=e=>({name:"transformOrigin",options:e,fn(t){const{placement:n,rects:a,middlewareData:s}=t,r=0!==s.arrow?.centerOffset,o=r?0:e.arrowWidth,i=r?0:e.arrowHeight,[l,c]=ml(n),d={start:"0%",center:"50%",end:"100%"}[c],u=(s.arrow?.x??0)+o/2,h=(s.arrow?.y??0)+i/2;let p="",m="";return"bottom"===l?(p=r?d:`${u}px`,m=-i+"px"):"top"===l?(p=r?d:`${u}px`,m=`${a.floating.height+i}px`):"right"===l?(p=-i+"px",m=r?d:`${h}px`):"left"===l&&(p=`${a.floating.width+i}px`,m=r?d:`${h}px`),{data:{x:p,y:m}}}});function ml(e){const[t,n="center"]=e.split("-");return[t,n]}var gl=nl,fl=sl,yl=ll,bl=ul,vl=u.forwardRef((e,t)=>{const{container:n,...s}=e,[r,o]=u.useState(!1);no(()=>o(!0),[]);const i=n||r&&globalThis?.document?.body;return i?a.createPortal($n.jsx(Gr.div,{...s,ref:t}),i):null});vl.displayName="Portal";var xl=e=>{const{present:t,children:n}=e,a=function(e){const[t,n]=u.useState(),a=u.useRef(null),s=u.useRef(e),r=u.useRef("none"),o=e?"mounted":"unmounted",[i,l]=function(e,t){return u.useReducer((e,n)=>t[e][n]??e,e)}(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return u.useEffect(()=>{const e=wl(a.current);r.current="mounted"===i?e:"none"},[i]),no(()=>{const t=a.current,n=s.current;if(n!==e){const a=r.current,o=wl(t);if(e)l("MOUNT");else if("none"===o||"none"===t?.display)l("UNMOUNT");else{l(n&&a!==o?"ANIMATION_OUT":"UNMOUNT")}s.current=e}},[e,l]),no(()=>{if(t){let e;const n=t.ownerDocument.defaultView??window,o=r=>{const o=wl(a.current).includes(CSS.escape(r.animationName));if(r.target===t&&o&&(l("ANIMATION_END"),!s.current)){const a=t.style.animationFillMode;t.style.animationFillMode="forwards",e=n.setTimeout(()=>{"forwards"===t.style.animationFillMode&&(t.style.animationFillMode=a)})}},i=e=>{e.target===t&&(r.current=wl(a.current))};return t.addEventListener("animationstart",i),t.addEventListener("animationcancel",o),t.addEventListener("animationend",o),()=>{n.clearTimeout(e),t.removeEventListener("animationstart",i),t.removeEventListener("animationcancel",o),t.removeEventListener("animationend",o)}}l("ANIMATION_END")},[t,l]),{isPresent:["mounted","unmountSuspended"].includes(i),ref:u.useCallback(e=>{a.current=e?getComputedStyle(e):null,n(e)},[])}}(t),s="function"==typeof n?n({present:a.isPresent}):u.Children.only(n),r=Pr(a.ref,function(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,n=t&&"isReactWarning"in t&&t.isReactWarning;if(n)return e.ref;if(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n)return e.props.ref;return e.props.ref||e.ref}(s));return"function"==typeof n||a.isPresent?u.cloneElement(s,{ref:r}):null};function wl(e){return e?.animationName||"none"}xl.displayName="Presence";var Cl=u[" useInsertionEffect ".trim().toString()]||no;function kl({prop:e,defaultProp:t,onChange:n=()=>{},caller:a}){const[s,r,o]=function({defaultProp:e,onChange:t}){const[n,a]=u.useState(e),s=u.useRef(n),r=u.useRef(t);return Cl(()=>{r.current=t},[t]),u.useEffect(()=>{s.current!==n&&(r.current?.(n),s.current=n)},[n,s]),[n,a,r]}({defaultProp:t,onChange:n}),i=void 0!==e,l=i?e:s;{const t=u.useRef(void 0!==e);u.useEffect(()=>{const e=t.current;if(e!==i){}t.current=i},[i,a])}const c=u.useCallback(t=>{if(i){const n=function(e){return"function"==typeof e}(t)?t(e):t;n!==e&&o.current?.(n)}else r(t)},[i,e,r,o]);return[l,c]}var jl=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),Al=u.forwardRef((e,t)=>$n.jsx(Gr.span,{...e,ref:t,style:{...jl,...e.style}}));Al.displayName="VisuallyHidden";var Sl=Al,[Nl,Tl]=Br("Tooltip",[Ji]),El=Ji(),_l="TooltipProvider",Ml=700,Il="tooltip.open",[Dl,Rl]=Nl(_l),zl=e=>{const{__scopeTooltip:t,delayDuration:n=Ml,skipDelayDuration:a=300,disableHoverableContent:s=!1,children:r}=e,o=u.useRef(!0),i=u.useRef(!1),l=u.useRef(0);return u.useEffect(()=>{const e=l.current;return()=>window.clearTimeout(e)},[]),$n.jsx(Dl,{scope:t,isOpenDelayedRef:o,delayDuration:n,onOpen:u.useCallback(()=>{window.clearTimeout(l.current),o.current=!1},[]),onClose:u.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>o.current=!0,a)},[a]),isPointerInTransitRef:i,onPointerInTransitChange:u.useCallback(e=>{i.current=e},[]),disableHoverableContent:s,children:r})};zl.displayName=_l;var Ol="Tooltip",[Ll,Pl]=Nl(Ol),Bl=e=>{const{__scopeTooltip:t,children:n,open:a,defaultOpen:s,onOpenChange:r,disableHoverableContent:o,delayDuration:i}=e,l=Rl(Ol,e.__scopeTooltip),c=El(t),[d,h]=u.useState(null),p=function(e){const[t,n]=u.useState(ao());return no(()=>{n(e=>e??String(so++))},[e]),t?`radix-${t}`:""}(),m=u.useRef(0),g=o??l.disableHoverableContent,f=i??l.delayDuration,y=u.useRef(!1),[b,v]=kl({prop:a,defaultProp:s??!1,onChange:e=>{e?(l.onOpen(),document.dispatchEvent(new CustomEvent(Il))):l.onClose(),r?.(e)},caller:Ol}),x=u.useMemo(()=>b?y.current?"delayed-open":"instant-open":"closed",[b]),w=u.useCallback(()=>{window.clearTimeout(m.current),m.current=0,y.current=!1,v(!0)},[v]),C=u.useCallback(()=>{window.clearTimeout(m.current),m.current=0,v(!1)},[v]),k=u.useCallback(()=>{window.clearTimeout(m.current),m.current=window.setTimeout(()=>{y.current=!0,v(!0),m.current=0},f)},[f,v]);return u.useEffect(()=>()=>{m.current&&(window.clearTimeout(m.current),m.current=0)},[]),$n.jsx(gl,{...c,children:$n.jsx(Ll,{scope:t,contentId:p,open:b,stateAttribute:x,trigger:d,onTriggerChange:h,onTriggerEnter:u.useCallback(()=>{l.isOpenDelayedRef.current?k():w()},[l.isOpenDelayedRef,k,w]),onTriggerLeave:u.useCallback(()=>{g?C():(window.clearTimeout(m.current),m.current=0)},[C,g]),onOpen:w,onClose:C,disableHoverableContent:g,children:n})})};Bl.displayName=Ol;var Fl="TooltipTrigger",Ul=u.forwardRef((e,t)=>{const{__scopeTooltip:n,...a}=e,s=Pl(Fl,n),r=Rl(Fl,n),o=El(n),i=Pr(t,u.useRef(null),s.onTriggerChange),l=u.useRef(!1),c=u.useRef(!1),d=u.useCallback(()=>l.current=!1,[]);return u.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),$n.jsx(fl,{asChild:!0,...o,children:$n.jsx(Gr.button,{"aria-describedby":s.open?s.contentId:void 0,"data-state":s.stateAttribute,...a,ref:i,onPointerMove:zr(e.onPointerMove,e=>{"touch"!==e.pointerType&&(c.current||r.isPointerInTransitRef.current||(s.onTriggerEnter(),c.current=!0))}),onPointerLeave:zr(e.onPointerLeave,()=>{s.onTriggerLeave(),c.current=!1}),onPointerDown:zr(e.onPointerDown,()=>{s.open&&s.onClose(),l.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:zr(e.onFocus,()=>{l.current||s.onOpen()}),onBlur:zr(e.onBlur,s.onClose),onClick:zr(e.onClick,s.onClose)})})});Ul.displayName=Fl;var Hl="TooltipPortal",[Wl,ql]=Nl(Hl,{forceMount:void 0}),Vl=e=>{const{__scopeTooltip:t,forceMount:n,children:a,container:s}=e,r=Pl(Hl,t);return $n.jsx(Wl,{scope:t,forceMount:n,children:$n.jsx(xl,{present:n||r.open,children:$n.jsx(vl,{asChild:!0,container:s,children:a})})})};Vl.displayName=Hl;var Gl="TooltipContent",Kl=u.forwardRef((e,t)=>{const n=ql(Gl,e.__scopeTooltip),{forceMount:a=n.forceMount,side:s="top",...r}=e,o=Pl(Gl,e.__scopeTooltip);return $n.jsx(xl,{present:a||o.open,children:o.disableHoverableContent?$n.jsx(Xl,{side:s,...r,ref:t}):$n.jsx($l,{side:s,...r,ref:t})})}),$l=u.forwardRef((e,t)=>{const n=Pl(Gl,e.__scopeTooltip),a=Rl(Gl,e.__scopeTooltip),s=u.useRef(null),r=Pr(t,s),[o,i]=u.useState(null),{trigger:l,onClose:c}=n,d=s.current,{onPointerInTransitChange:h}=a,p=u.useCallback(()=>{i(null),h(!1)},[h]),m=u.useCallback((e,t)=>{const n=e.currentTarget,a={x:e.clientX,y:e.clientY},s=function(e,t,n=5){const a=[];switch(t){case"top":a.push({x:e.x-n,y:e.y+n},{x:e.x+n,y:e.y+n});break;case"bottom":a.push({x:e.x-n,y:e.y-n},{x:e.x+n,y:e.y-n});break;case"left":a.push({x:e.x+n,y:e.y-n},{x:e.x+n,y:e.y+n});break;case"right":a.push({x:e.x-n,y:e.y-n},{x:e.x-n,y:e.y+n})}return a}(a,function(e,t){const n=Math.abs(t.top-e.y),a=Math.abs(t.bottom-e.y),s=Math.abs(t.right-e.x),r=Math.abs(t.left-e.x);switch(Math.min(n,a,s,r)){case r:return"left";case s:return"right";case n:return"top";case a:return"bottom";default:throw new Error("unreachable")}}(a,n.getBoundingClientRect())),r=function(e){const t=e.slice();return t.sort((e,t)=>e.x<t.x?-1:e.x>t.x?1:e.y<t.y?-1:e.y>t.y?1:0),function(e){if(e.length<=1)return e.slice();const t=[];for(let a=0;a<e.length;a++){const n=e[a];for(;t.length>=2;){const e=t[t.length-1],a=t[t.length-2];if(!((e.x-a.x)*(n.y-a.y)>=(e.y-a.y)*(n.x-a.x)))break;t.pop()}t.push(n)}t.pop();const n=[];for(let a=e.length-1;a>=0;a--){const t=e[a];for(;n.length>=2;){const e=n[n.length-1],a=n[n.length-2];if(!((e.x-a.x)*(t.y-a.y)>=(e.y-a.y)*(t.x-a.x)))break;n.pop()}n.push(t)}return n.pop(),1===t.length&&1===n.length&&t[0].x===n[0].x&&t[0].y===n[0].y?t:t.concat(n)}(t)}([...s,...function(e){const{top:t,right:n,bottom:a,left:s}=e;return[{x:s,y:t},{x:n,y:t},{x:n,y:a},{x:s,y:a}]}(t.getBoundingClientRect())]);i(r),h(!0)},[h]);return u.useEffect(()=>()=>p(),[p]),u.useEffect(()=>{if(l&&d){const e=e=>m(e,d),t=e=>m(e,l);return l.addEventListener("pointerleave",e),d.addEventListener("pointerleave",t),()=>{l.removeEventListener("pointerleave",e),d.removeEventListener("pointerleave",t)}}},[l,d,m,p]),u.useEffect(()=>{if(o){const e=e=>{const t=e.target,n={x:e.clientX,y:e.clientY},a=l?.contains(t)||d?.contains(t),s=!function(e,t){const{x:n,y:a}=e;let s=!1;for(let r=0,o=t.length-1;r<t.length;o=r++){const e=t[r],i=t[o],l=e.x,c=e.y,d=i.x,u=i.y;c>a!=u>a&&n<(d-l)*(a-c)/(u-c)+l&&(s=!s)}return s}(n,o);a?p():s&&(p(),c())};return document.addEventListener("pointermove",e),()=>document.removeEventListener("pointermove",e)}},[l,d,o,c,p]),$n.jsx(Xl,{...e,ref:r})}),[Zl,Ql]=Nl(Ol,{isInside:!1}),Yl=qr("TooltipContent"),Xl=u.forwardRef((e,t)=>{const{__scopeTooltip:n,children:a,"aria-label":s,onEscapeKeyDown:r,onPointerDownOutside:o,...i}=e,l=Pl(Gl,n),c=El(n),{onClose:d}=l;return u.useEffect(()=>(document.addEventListener(Il,d),()=>document.removeEventListener(Il,d)),[d]),u.useEffect(()=>{if(l.trigger){const e=e=>{const t=e.target;t?.contains(l.trigger)&&d()};return window.addEventListener("scroll",e,{capture:!0}),()=>window.removeEventListener("scroll",e,{capture:!0})}},[l.trigger,d]),$n.jsx(Jr,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:r,onPointerDownOutside:o,onFocusOutside:e=>e.preventDefault(),onDismiss:d,children:$n.jsxs(yl,{"data-state":l.stateAttribute,...c,...i,ref:t,style:{...i.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[$n.jsx(Yl,{children:a}),$n.jsx(Zl,{scope:n,isInside:!0,children:$n.jsx(Sl,{id:l.contentId,role:"tooltip",children:s||a})})]})})});Kl.displayName=Gl;var Jl="TooltipArrow",ec=u.forwardRef((e,t)=>{const{__scopeTooltip:n,...a}=e,s=El(n);return Ql(Jl,n).isInside?null:$n.jsx(bl,{...s,...a,ref:t})});ec.displayName=Jl;var tc=zl,nc=Bl,ac=Ul,sc=Vl,rc=Kl,oc=ec,ic={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},lc=e.createContext&&e.createContext(ic),cc=["attr","size","title"];function dc(e,t){if(null==e)return{};var n,a,s=function(e,t){if(null==e)return{};var n={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;n[a]=e[a]}return n}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}function uc(){return uc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},uc.apply(this,arguments)}function hc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function pc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hc(Object(n),!0).forEach(function(t){mc(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hc(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function mc(e,t,n){var a;return(t="symbol"==typeof(a=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t);if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?a:a+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gc(t){return t&&t.map((t,n)=>e.createElement(t.tag,pc({key:n},t.attr),gc(t.child)))}function fc(t){return n=>e.createElement(yc,uc({attr:pc({},t.attr)},n),gc(t.child))}function yc(t){var n=n=>{var a,{attr:s,size:r,title:o}=t,i=dc(t,cc),l=r||n.size||"1em";return n.className&&(a=n.className),t.className&&(a=(a?a+" ":"")+t.className),e.createElement("svg",uc({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,s,i,{className:a,style:pc(pc({color:t.color||n.color},n.style),t.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),o&&e.createElement("title",null,o),t.children)};return void 0!==lc?e.createElement(lc.Consumer,null,e=>n(e)):n(ic)}function bc(e){return fc({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8z"},child:[]}]})(e)}function vc(e){return fc({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M537.6 226.6c4.1-10.7 6.4-22.4 6.4-34.6 0-53-43-96-96-96-19.7 0-38.1 6-53.3 16.2C367 64.2 315.3 32 256 32c-88.4 0-160 71.6-160 160 0 2.7.1 5.4.2 8.1C40.2 219.8 0 273.2 0 336c0 79.5 64.5 144 144 144h368c70.7 0 128-57.3 128-128 0-61.9-44-113.6-102.4-125.4zM393.4 288H328v112c0 8.8-7.2 16-16 16h-48c-8.8 0-16-7.2-16-16V288h-65.4c-14.3 0-21.4-17.2-11.3-27.3l105.4-105.4c6.2-6.2 16.4-6.2 22.6 0l105.4 105.4c10.1 10.1 2.9 27.3-11.3 27.3z"},child:[]}]})(e)}function xc(e){return fc({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"},child:[]}]})(e)}function wc(e){return fc({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 32C114.6 32 0 125.1 0 240c0 49.6 21.4 95 57 130.7C44.5 421.1 2.7 466 2.2 466.5c-2.2 2.3-2.8 5.7-1.5 8.7S4.8 480 8 480c66.3 0 116-31.8 140.6-51.4 32.7 12.3 69 19.4 107.4 19.4 141.4 0 256-93.1 256-208S397.4 32 256 32zM128 272c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128 0c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128 0c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32z"},child:[]}]})(e)}function Cc(e){return fc({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"},child:[]}]})(e)}function kc(e){return fc({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z"},child:[]}]})(e)}function jc(e){return fc({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M320 400c-75.85 0-137.25-58.71-142.9-133.11L72.2 185.82c-13.79 17.3-26.48 35.59-36.72 55.59a32.35 32.35 0 0 0 0 29.19C89.71 376.41 197.07 448 320 448c26.91 0 52.87-4 77.89-10.46L346 397.39a144.13 144.13 0 0 1-26 2.61zm313.82 58.1l-110.55-85.44a331.25 331.25 0 0 0 81.25-102.07 32.35 32.35 0 0 0 0-29.19C550.29 135.59 442.93 64 320 64a308.15 308.15 0 0 0-147.32 37.7L45.46 3.37A16 16 0 0 0 23 6.18L3.37 31.45A16 16 0 0 0 6.18 53.9l588.36 454.73a16 16 0 0 0 22.46-2.81l19.64-25.27a16 16 0 0 0-2.82-22.45zm-183.72-142l-39.3-30.38A94.75 94.75 0 0 0 416 256a94.76 94.76 0 0 0-121.31-92.21A47.65 47.65 0 0 1 304 192a46.64 46.64 0 0 1-1.54 10l-73.61-56.89A142.31 142.31 0 0 1 320 112a143.92 143.92 0 0 1 144 144c0 21.63-5.29 41.79-13.9 60.11z"},child:[]}]})(e)}function Ac(e){return fc({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"},child:[]}]})(e)}function Sc(e){return fc({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M384 121.9c0-6.3-2.5-12.4-7-16.9L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128zM571 308l-95.7-96.4c-10.1-10.1-27.4-3-27.4 11.3V288h-64v64h64v65.2c0 14.3 17.3 21.4 27.4 11.3L571 332c6.6-6.6 6.6-17.4 0-24zm-379 28v-32c0-8.8 7.2-16 16-16h176V160H248c-13.2 0-24-10.8-24-24V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V352H208c-8.8 0-16-7.2-16-16z"},child:[]}]})(e)}function Nc(e){return fc({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M16 288c-8.8 0-16 7.2-16 16v32c0 8.8 7.2 16 16 16h112v-64zm489-183L407.1 7c-4.5-4.5-10.6-7-17-7H384v128h128v-6.1c0-6.3-2.5-12.4-7-16.9zm-153 31V0H152c-13.3 0-24 10.7-24 24v264h128v-65.2c0-14.3 17.3-21.4 27.4-11.3L379 308c6.6 6.7 6.6 17.4 0 24l-95.7 96.4c-10.1 10.1-27.4 3-27.4-11.3V352H128v136c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H376c-13.2 0-24-10.8-24-24z"},child:[]}]})(e)}function Tc(e){return fc({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M360 0H24C10.745 0 0 10.745 0 24v16c0 13.255 10.745 24 24 24 0 90.965 51.016 167.734 120.842 192C75.016 280.266 24 357.035 24 448c-13.255 0-24 10.745-24 24v16c0 13.255 10.745 24 24 24h336c13.255 0 24-10.745 24-24v-16c0-13.255-10.745-24-24-24 0-90.965-51.016-167.734-120.842-192C308.984 231.734 360 154.965 360 64c13.255 0 24-10.745 24-24V24c0-13.255-10.745-24-24-24zm-75.078 384H99.08c17.059-46.797 52.096-80 92.92-80 40.821 0 75.862 33.196 92.922 80zm.019-256H99.078C91.988 108.548 88 86.748 88 64h208c0 22.805-3.987 44.587-11.059 64z"},child:[]}]})(e)}function Ec(e){return fc({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"},child:[]}]})(e)}function _c(e){return fc({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm144 276c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6 0-12-5.4-12-12v-92h-92c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6 0 12 5.4 12 12v92h92c6.6 0 12 5.4 12 12v56z"},child:[]}]})(e)}function Mc(e){return fc({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"},child:[]}]})(e)}function Ic(e){return fc({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"},child:[]}]})(e)}function Dc(e){return fc({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M384 44v424c0 6.6-5.4 12-12 12h-48c-6.6 0-12-5.4-12-12V291.6l-195.5 181C95.9 489.7 64 475.4 64 448V64c0-27.4 31.9-41.7 52.5-24.6L312 219.3V44c0-6.6 5.4-12 12-12h48c6.6 0 12 5.4 12 12z"},child:[]}]})(e)}function Rc(e){return fc({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48z"},child:[]}]})(e)}function zc(e){return fc({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M501.1 395.7L384 278.6c-23.1-23.1-57.6-27.6-85.4-13.9L192 158.1V96L64 0 0 64l96 128h62.1l106.6 106.6c-13.6 27.8-9.2 62.3 13.9 85.4l117.1 117.1c14.6 14.6 38.2 14.6 52.7 0l52.7-52.7c14.5-14.6 14.5-38.2 0-52.7zM331.7 225c28.3 0 54.9 11 74.9 31l19.4 19.4c15.8-6.9 30.8-16.5 43.8-29.5 37.1-37.1 49.7-89.3 37.9-136.7-2.2-9-13.5-12.1-20.1-5.5l-74.4 74.4-67.9-11.3L334 98.9l74.4-74.4c6.6-6.6 3.4-17.9-5.7-20.2-47.4-11.7-99.6.9-136.6 37.9-28.5 28.5-41.9 66.1-41.2 103.6l82.1 82.1c8.1-1.9 16.5-2.9 24.7-2.9zm-103.9 82l-56.7-56.7L18.7 402.8c-25 25-25 65.5 0 90.5s65.5 25 90.5 0l123.6-123.6c-7.6-19.9-9.9-41.6-5-62.7zM64 472c-13.2 0-24-10.8-24-24 0-13.3 10.7-24 24-24s24 10.7 24 24c0 13.2-10.7 24-24 24z"},child:[]}]})(e)}function Oc(e){return fc({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"},child:[]}]})(e)}function Lc(e){const t=u.useRef({value:e,previous:e});return u.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var Pc="Checkbox",[Bc,Fc]=Br(Pc),[Uc,Hc]=Bc(Pc);function Wc(e){const{__scopeCheckbox:t,checked:n,children:a,defaultChecked:s,disabled:r,form:o,name:i,onCheckedChange:l,required:c,value:d="on",internal_do_not_use_render:h}=e,[p,m]=kl({prop:n,defaultProp:s??!1,onChange:l,caller:Pc}),[g,f]=u.useState(null),[y,b]=u.useState(null),v=u.useRef(!1),x=!g||(!!o||!!g.closest("form")),w={checked:p,disabled:r,setChecked:m,control:g,setControl:f,name:i,form:o,value:d,hasConsumerStoppedPropagationRef:v,required:c,defaultChecked:!Xc(s)&&s,isFormControl:x,bubbleInput:y,setBubbleInput:b};return $n.jsx(Uc,{scope:t,...w,children:Yc(h)?h(w):a})}var qc="CheckboxTrigger",Vc=u.forwardRef(({__scopeCheckbox:e,onKeyDown:t,onClick:n,...a},s)=>{const{control:r,value:o,disabled:i,checked:l,required:c,setControl:d,setChecked:h,hasConsumerStoppedPropagationRef:p,isFormControl:m,bubbleInput:g}=Hc(qc,e),f=Pr(s,d),y=u.useRef(l);return u.useEffect(()=>{const e=r?.form;if(e){const t=()=>h(y.current);return e.addEventListener("reset",t),()=>e.removeEventListener("reset",t)}},[r,h]),$n.jsx(Gr.button,{type:"button",role:"checkbox","aria-checked":Xc(l)?"mixed":l,"aria-required":c,"data-state":Jc(l),"data-disabled":i?"":void 0,disabled:i,value:o,...a,ref:f,onKeyDown:zr(t,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:zr(n,e=>{h(e=>!!Xc(e)||!e),g&&m&&(p.current=e.isPropagationStopped(),p.current||e.stopPropagation())})})});Vc.displayName=qc;var Gc=u.forwardRef((e,t)=>{const{__scopeCheckbox:n,name:a,checked:s,defaultChecked:r,required:o,disabled:i,value:l,onCheckedChange:c,form:d,...u}=e;return $n.jsx(Wc,{__scopeCheckbox:n,checked:s,defaultChecked:r,disabled:i,required:o,onCheckedChange:c,name:a,form:d,value:l,internal_do_not_use_render:({isFormControl:e})=>$n.jsxs($n.Fragment,{children:[$n.jsx(Vc,{...u,ref:t,__scopeCheckbox:n}),e&&$n.jsx(Qc,{__scopeCheckbox:n})]})})});Gc.displayName=Pc;var Kc="CheckboxIndicator",$c=u.forwardRef((e,t)=>{const{__scopeCheckbox:n,forceMount:a,...s}=e,r=Hc(Kc,n);return $n.jsx(xl,{present:a||Xc(r.checked)||!0===r.checked,children:$n.jsx(Gr.span,{"data-state":Jc(r.checked),"data-disabled":r.disabled?"":void 0,...s,ref:t,style:{pointerEvents:"none",...e.style}})})});$c.displayName=Kc;var Zc="CheckboxBubbleInput",Qc=u.forwardRef(({__scopeCheckbox:e,...t},n)=>{const{control:a,hasConsumerStoppedPropagationRef:s,checked:r,defaultChecked:o,required:i,disabled:l,name:c,value:d,form:h,bubbleInput:p,setBubbleInput:m}=Hc(Zc,e),g=Pr(n,m),f=Lc(r),y=Qi(a);u.useEffect(()=>{const e=p;if(!e)return;const t=window.HTMLInputElement.prototype,n=Object.getOwnPropertyDescriptor(t,"checked").set,a=!s.current;if(f!==r&&n){const t=new Event("click",{bubbles:a});e.indeterminate=Xc(r),n.call(e,!Xc(r)&&r),e.dispatchEvent(t)}},[p,f,r,s]);const b=u.useRef(!Xc(r)&&r);return $n.jsx(Gr.input,{type:"checkbox","aria-hidden":!0,defaultChecked:o??b.current,required:i,disabled:l,name:c,value:d,form:h,...t,tabIndex:-1,ref:g,style:{...t.style,...y,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});function Yc(e){return"function"==typeof e}function Xc(e){return"indeterminate"===e}function Jc(e){return Xc(e)?"indeterminate":e?"checked":"unchecked"}Qc.displayName=Zc;const ed=e.memo(({id:e,label:t,isChecked:n,onCheckedChange:a})=>{const s="string"==typeof t?t:"Label for checkbox";return $n.jsxs("div",{className:"flex-align-center margin-bottom-10 margin-top-5","data-testid":`checkbox-input-container-${e}`,children:[$n.jsx(Gc,{className:"checkbox-root",id:`checkbox-input-${e}`,checked:n,onCheckedChange:a,"data-testid":e,"aria-label":s,children:$n.jsx($c,{className:"checkbox-indicator",children:"✓"})}),$n.jsx("label",{className:"clickable no-padding padding-10 margin-top--5",style:{width:"max-content"},htmlFor:`checkbox-input-${e}`,children:t})]})}),td=e.memo(e=>{const{id:t,label:n,info:a,checked:s,onChange:r}=e,o="function"==typeof n?n():n,i="function"==typeof a?a():a;return $n.jsx("div",{className:"info-checkbox-container",children:$n.jsxs("div",{className:"info-checkbox-wrapper",children:[$n.jsx(ed,{id:t,label:o,isChecked:s,onCheckedChange:r}),$n.jsx(tc,{delayDuration:100,children:$n.jsxs(nc,{children:[$n.jsx(ac,{asChild:!0,children:$n.jsx("button",{type:"button","aria-label":"More info",className:"tooltip-button inline-flex items-center justify-center cursor-help",children:$n.jsx(Ec,{})})}),$n.jsx(sc,{children:$n.jsxs(rc,{side:"top",align:"center",sideOffset:6,collisionPadding:8,className:"tooltip-content",children:[i,$n.jsx(oc,{className:"fill-[var(--info-tooltip-bg)]"})]})})]})})]})})});td.displayName="InfoCheckbox";const nd=e.forwardRef((e,t)=>$n.jsx(s,{ref:t,...e,className:"select "+(e.className?` ${e.className}`:""),classNamePrefix:"w-select",menuPortalTarget:document.body,styles:{menuPortal:e=>({...e,zIndex:10001}),menu:e=>({...e,zIndex:10001,width:"max-content",minWidth:"100%"}),...e.styles}})),ad=["GroupChatTarget","NestedChatTarget"],sd=[...ad,"AgentTarget","RandomAgentTarget","GroupManagerTarget","StayTarget"],rd={AgentTarget:"Pass the floor to another agent",RevertToUserTarget:"Revert to the user agent",RandomAgentTarget:"Choose a random agent",AskUserTarget:"Ask the user",TerminateTarget:"Terminate the flow",GroupChatTarget:"Group Chat",NestedChatTarget:"Trigger a nested chat",GroupManagerTarget:"Return to the group chat manager",StayTarget:"Do Nothing"},od=e.memo(({target:t,agents:n,onChange:a,isForGroupChat:s=!0})=>{const[r,o]=e.useState(!!t),[i,l]=e.useState(t?.targetType),[c,d]=e.useState("AgentTarget"===t?.targetType?t.value[0]:void 0),[u,h]=e.useState("RandomAgentTarget"===t?.targetType?t.value:[]),p=e.useMemo(()=>s?sd:ad,[s]),m=e.useMemo(()=>Se.filter(e=>!p.includes(e)).map(e=>({value:e,label:rd[e]})),[p]),g=e.useMemo(()=>n.map(e=>({value:e.id,label:e.data.label})),[n]),f=e.useMemo(()=>i?{label:rd[i],value:i}:null,[i]),y=e.useMemo(()=>({label:g.find(e=>e.value===c)?.label,value:c}),[g,c]),b=e.useCallback(e=>{o(e),e||(l(void 0),a(null))},[a]),v=e.useCallback(e=>{if(!e?.value)return;const t=e.value;switch(l(t),t){case"AgentTarget":c&&a({targetType:t,value:[c]});break;case"TerminateTarget":case"RevertToUserTarget":case"AskUserTarget":case"GroupManagerTarget":case"StayTarget":a({targetType:t,value:[]});break;case"RandomAgentTarget":u.length>0&&a({targetType:t,value:u})}},[a,c,u]),x=e.useCallback(e=>{e?.value&&"AgentTarget"===i&&(d(e.value),a({targetType:"AgentTarget",value:[e.value]}))},[a,i]),w=e.useCallback(e=>{if(!e||"RandomAgentTarget"!==i)return;const t=e.map(e=>e.value);h(t),a({targetType:"RandomAgentTarget",value:t})},[a,i]),C=s?"the chat ends":"the Agent has no more work to do";return $n.jsxs("div",{className:"waldiez-after-work",children:[$n.jsx(td,{label:`Include an action to perform after ${C}?`,info:"Check this to handle conversation continuation when no further options are available. If no agent is selected and no tool calls have output, we will use this property to determine the next action.",checked:r,id:"afterWork",onChange:b}),r&&$n.jsxs("div",{className:"flex-align-center flex-column margin-bottom-10",children:[$n.jsxs("div",{className:"full-width margin-bottom-10",children:[$n.jsx("label",{htmlFor:"afterWorkTargetType",children:"Action to perform after work:"}),$n.jsx("div",{className:"margin-top-10"}),$n.jsx(nd,{inputId:"afterWorkTargetType",options:m,value:f,onChange:v,isMulti:!1})]}),"AgentTarget"===i&&$n.jsxs("div",{className:"full-width margin-bottom-10",children:[$n.jsx("label",{htmlFor:"afterWorkTargetId",children:"Agent to pass the floor to:"}),$n.jsx("div",{className:"margin-top-10"}),$n.jsx(nd,{inputId:"afterWorkTargetId",options:g,value:y,onChange:x,isClearable:!0,isSearchable:!0,isMulti:!1})]}),"RandomAgentTarget"===i&&$n.jsxs("div",{className:"full-width",children:[$n.jsx("label",{htmlFor:"afterWorkTargetIds",children:"Agents to choose from:"}),$n.jsx("div",{className:"margin-top-10"}),$n.jsx(nd,{inputId:"afterWorkTargetIds",options:g,value:u.map(e=>({label:g.find(t=>t.value===e)?.label,value:e})),onChange:w,isClearable:!0,isSearchable:!0,isMulti:!0})]})]})]})});function id(e){return fc({attr:{viewBox:"0 0 496 512"},child:[{tag:"path",attr:{d:"M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"},child:[]}]})(e)}function ld(e){return fc({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"},child:[]}]})(e)}function cd(e){return fc({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M0 96C0 78.3 14.3 64 32 64l384 0c17.7 0 32 14.3 32 32s-14.3 32-32 32L32 128C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32l384 0c17.7 0 32 14.3 32 32s-14.3 32-32 32L32 288c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32L32 448c-17.7 0-32-14.3-32-32s14.3-32 32-32l384 0c17.7 0 32 14.3 32 32z"},child:[]}]})(e)}function dd(e){return fc({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 0c53 0 96 43 96 96l0 3.6c0 15.7-12.7 28.4-28.4 28.4l-135.1 0c-15.7 0-28.4-12.7-28.4-28.4l0-3.6c0-53 43-96 96-96zM41.4 105.4c12.5-12.5 32.8-12.5 45.3 0l64 64c.7 .7 1.3 1.4 1.9 2.1c14.2-7.3 30.4-11.4 47.5-11.4l112 0c17.1 0 33.2 4.1 47.5 11.4c.6-.7 1.2-1.4 1.9-2.1l64-64c12.5-12.5 32.8-12.5 45.3 0s12.5 32.8 0 45.3l-64 64c-.7 .7-1.4 1.3-2.1 1.9c6.2 12 10.1 25.3 11.1 39.5l64.3 0c17.7 0 32 14.3 32 32s-14.3 32-32 32l-64 0c0 24.6-5.5 47.8-15.4 68.6c2.2 1.3 4.2 2.9 6 4.8l64 64c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0l-63.1-63.1c-24.5 21.8-55.8 36.2-90.3 39.6L272 240c0-8.8-7.2-16-16-16s-16 7.2-16 16l0 239.2c-34.5-3.4-65.8-17.8-90.3-39.6L86.6 502.6c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3l64-64c1.9-1.9 3.9-3.4 6-4.8C101.5 367.8 96 344.6 96 320l-64 0c-17.7 0-32-14.3-32-32s14.3-32 32-32l64.3 0c1.1-14.1 5-27.5 11.1-39.5c-.7-.6-1.4-1.2-2.1-1.9l-64-64c-12.5-12.5-12.5-32.8 0-45.3z"},child:[]}]})(e)}function ud(e){return fc({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z"},child:[]}]})(e)}function hd(e){return fc({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M233.4 105.4c12.5-12.5 32.8-12.5 45.3 0l192 192c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L256 173.3 86.6 342.6c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3l192-192z"},child:[]}]})(e)}function pd(e){return fc({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zM188.3 147.1c-7.6 4.2-12.3 12.3-12.3 20.9l0 176c0 8.7 4.7 16.7 12.3 20.9s16.8 4.1 24.3-.5l144-88c7.1-4.4 11.5-12.1 11.5-20.5s-4.4-16.1-11.5-20.5l-144-88c-7.4-4.5-16.7-4.7-24.3-.5z"},child:[]}]})(e)}function md(e){return fc({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM175 175c9.4-9.4 24.6-9.4 33.9 0l47 47 47-47c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9l-47 47 47 47c9.4 9.4 9.4 24.6 0 33.9s-24.6 9.4-33.9 0l-47-47-47 47c-9.4 9.4-24.6 9.4-33.9 0s-9.4-24.6 0-33.9l47-47-47-47c-9.4-9.4-9.4-24.6 0-33.9z"},child:[]}]})(e)}function gd(e){return fc({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M392.8 1.2c-17-4.9-34.7 5-39.6 22l-128 448c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l128-448c4.9-17-5-34.7-22-39.6zm80.6 120.1c-12.5 12.5-12.5 32.8 0 45.3L562.7 256l-89.4 89.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l112-112c12.5-12.5 12.5-32.8 0-45.3l-112-112c-12.5-12.5-32.8-12.5-45.3 0zm-306.7 0c-12.5-12.5-32.8-12.5-45.3 0l-112 112c-12.5 12.5-12.5 32.8 0 45.3l112 112c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l89.4-89.4c12.5-12.5 12.5-32.8 0-45.3z"},child:[]}]})(e)}function fd(e){return fc({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M160 64c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 64-64 0c-17.7 0-32 14.3-32 32s14.3 32 32 32l96 0c17.7 0 32-14.3 32-32l0-96zM32 320c-17.7 0-32 14.3-32 32s14.3 32 32 32l64 0 0 64c0 17.7 14.3 32 32 32s32-14.3 32-32l0-96c0-17.7-14.3-32-32-32l-96 0zM352 64c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 96c0 17.7 14.3 32 32 32l96 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-64 0 0-64zM320 320c-17.7 0-32 14.3-32 32l0 96c0 17.7 14.3 32 32 32s32-14.3 32-32l0-64 64 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-96 0z"},child:[]}]})(e)}function yd(e){return fc({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M208 0L332.1 0c12.7 0 24.9 5.1 33.9 14.1l67.9 67.9c9 9 14.1 21.2 14.1 33.9L448 336c0 26.5-21.5 48-48 48l-192 0c-26.5 0-48-21.5-48-48l0-288c0-26.5 21.5-48 48-48zM48 128l80 0 0 64-64 0 0 256 192 0 0-32 64 0 0 48c0 26.5-21.5 48-48 48L48 512c-26.5 0-48-21.5-48-48L0 176c0-26.5 21.5-48 48-48z"},child:[]}]})(e)}function bd(e){return fc({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M32 32C14.3 32 0 46.3 0 64l0 96c0 17.7 14.3 32 32 32s32-14.3 32-32l0-64 64 0c17.7 0 32-14.3 32-32s-14.3-32-32-32L32 32zM64 352c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 96c0 17.7 14.3 32 32 32l96 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-64 0 0-64zM320 32c-17.7 0-32 14.3-32 32s14.3 32 32 32l64 0 0 64c0 17.7 14.3 32 32 32s32-14.3 32-32l0-96c0-17.7-14.3-32-32-32l-96 0zM448 352c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 64-64 0c-17.7 0-32 14.3-32 32s14.3 32 32 32l96 0c17.7 0 32-14.3 32-32l0-96z"},child:[]}]})(e)}function vd(e){return fc({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M128 64c0-35.3 28.7-64 64-64L352 0l0 128c0 17.7 14.3 32 32 32l128 0 0 288c0 35.3-28.7 64-64 64l-256 0c-35.3 0-64-28.7-64-64l0-112 174.1 0-39 39c-9.4 9.4-9.4 24.6 0 33.9s24.6 9.4 33.9 0l80-80c9.4-9.4 9.4-24.6 0-33.9l-80-80c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9l39 39L128 288l0-224zm0 224l0 48L24 336c-13.3 0-24-10.7-24-24s10.7-24 24-24l104 0zM512 128l-128 0L384 0 512 128z"},child:[]}]})(e)}function xd(e){return fc({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M495.9 166.6c3.2 8.7 .5 18.4-6.4 24.6l-43.3 39.4c1.1 8.3 1.7 16.8 1.7 25.4s-.6 17.1-1.7 25.4l43.3 39.4c6.9 6.2 9.6 15.9 6.4 24.6c-4.4 11.9-9.7 23.3-15.8 34.3l-4.7 8.1c-6.6 11-14 21.4-22.1 31.2c-5.9 7.2-15.7 9.6-24.5 6.8l-55.7-17.7c-13.4 10.3-28.2 18.9-44 25.4l-12.5 57.1c-2 9.1-9 16.3-18.2 17.8c-13.8 2.3-28 3.5-42.5 3.5s-28.7-1.2-42.5-3.5c-9.2-1.5-16.2-8.7-18.2-17.8l-12.5-57.1c-15.8-6.5-30.6-15.1-44-25.4L83.1 425.9c-8.8 2.8-18.6 .3-24.5-6.8c-8.1-9.8-15.5-20.2-22.1-31.2l-4.7-8.1c-6.1-11-11.4-22.4-15.8-34.3c-3.2-8.7-.5-18.4 6.4-24.6l43.3-39.4C64.6 273.1 64 264.6 64 256s.6-17.1 1.7-25.4L22.4 191.2c-6.9-6.2-9.6-15.9-6.4-24.6c4.4-11.9 9.7-23.3 15.8-34.3l4.7-8.1c6.6-11 14-21.4 22.1-31.2c5.9-7.2 15.7-9.6 24.5-6.8l55.7 17.7c13.4-10.3 28.2-18.9 44-25.4l12.5-57.1c2-9.1 9-16.3 18.2-17.8C227.3 1.2 241.5 0 256 0s28.7 1.2 42.5 3.5c9.2 1.5 16.2 8.7 18.2 17.8l12.5 57.1c15.8 6.5 30.6 15.1 44 25.4l55.7-17.7c8.8-2.8 18.6-.3 24.5 6.8c8.1 9.8 15.5 20.2 22.1 31.2l4.7 8.1c6.1 11 11.4 22.4 15.8 34.3zM256 336a80 80 0 1 0 0-160 80 80 0 1 0 0 160z"},child:[]}]})(e)}function wd(e){return fc({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M144 144l0 48 160 0 0-48c0-44.2-35.8-80-80-80s-80 35.8-80 80zM80 192l0-48C80 64.5 144.5 0 224 0s144 64.5 144 144l0 48 16 0c35.3 0 64 28.7 64 64l0 192c0 35.3-28.7 64-64 64L64 512c-35.3 0-64-28.7-64-64L0 256c0-35.3 28.7-64 64-64l16 0z"},child:[]}]})(e)}function Cd(e){return fc({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M223.5 32C100 32 0 132.3 0 256S100 480 223.5 480c60.6 0 115.5-24.2 155.8-63.4c5-4.9 6.3-12.5 3.1-18.7s-10.1-9.7-17-8.5c-9.8 1.7-19.8 2.6-30.1 2.6c-96.9 0-175.5-78.8-175.5-176c0-65.8 36-123.1 89.3-153.3c6.1-3.5 9.2-10.5 7.7-17.3s-7.3-11.9-14.3-12.5c-6.3-.5-12.6-.8-19-.8z"},child:[]}]})(e)}function kd(e){return fc({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80L0 432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"},child:[]}]})(e)}function jd(e){return fc({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M320 0c17.7 0 32 14.3 32 32l0 64 120 0c39.8 0 72 32.2 72 72l0 272c0 39.8-32.2 72-72 72l-304 0c-39.8 0-72-32.2-72-72l0-272c0-39.8 32.2-72 72-72l120 0 0-64c0-17.7 14.3-32 32-32zM208 384c-8.8 0-16 7.2-16 16s7.2 16 16 16l32 0c8.8 0 16-7.2 16-16s-7.2-16-16-16l-32 0zm96 0c-8.8 0-16 7.2-16 16s7.2 16 16 16l32 0c8.8 0 16-7.2 16-16s-7.2-16-16-16l-32 0zm96 0c-8.8 0-16 7.2-16 16s7.2 16 16 16l32 0c8.8 0 16-7.2 16-16s-7.2-16-16-16l-32 0zM264 256a40 40 0 1 0 -80 0 40 40 0 1 0 80 0zm152 40a40 40 0 1 0 0-80 40 40 0 1 0 0 80zM48 224l16 0 0 192-16 0c-26.5 0-48-21.5-48-48l0-96c0-26.5 21.5-48 48-48zm544 0c26.5 0 48 21.5 48 48l0 96c0 26.5-21.5 48-48 48l-16 0 0-192 16 0z"},child:[]}]})(e)}function Ad(e){return fc({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M0 128C0 92.7 28.7 64 64 64H320c35.3 0 64 28.7 64 64V384c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V128z"},child:[]}]})(e)}function Sd(e){return fc({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M361.5 1.2c5 2.1 8.6 6.6 9.6 11.9L391 121l107.9 19.8c5.3 1 9.8 4.6 11.9 9.6s1.5 10.7-1.6 15.2L446.9 256l62.3 90.3c3.1 4.5 3.7 10.2 1.6 15.2s-6.6 8.6-11.9 9.6L391 391 371.1 498.9c-1 5.3-4.6 9.8-9.6 11.9s-10.7 1.5-15.2-1.6L256 446.9l-90.3 62.3c-4.5 3.1-10.2 3.7-15.2 1.6s-8.6-6.6-9.6-11.9L121 391 13.1 371.1c-5.3-1-9.8-4.6-11.9-9.6s-1.5-10.7 1.6-15.2L65.1 256 2.8 165.7c-3.1-4.5-3.7-10.2-1.6-15.2s6.6-8.6 11.9-9.6L121 121 140.9 13.1c1-5.3 4.6-9.8 9.6-11.9s10.7-1.5 15.2 1.6L256 65.1 346.3 2.8c4.5-3.1 10.2-3.7 15.2-1.6zM160 256a96 96 0 1 1 192 0 96 96 0 1 1 -192 0zm224 0a128 128 0 1 0 -256 0 128 128 0 1 0 256 0z"},child:[]}]})(e)}function Nd(e){return fc({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M135.2 17.7C140.6 6.8 151.7 0 163.8 0L284.2 0c12.1 0 23.2 6.8 28.6 17.7L320 32l96 0c17.7 0 32 14.3 32 32s-14.3 32-32 32L32 96C14.3 96 0 81.7 0 64S14.3 32 32 32l96 0 7.2-14.3zM32 128l384 0 0 320c0 35.3-28.7 64-64 64L96 512c-35.3 0-64-28.7-64-64l0-320zm96 64c-8.8 0-16 7.2-16 16l0 224c0 8.8 7.2 16 16 16s16-7.2 16-16l0-224c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16l0 224c0 8.8 7.2 16 16 16s16-7.2 16-16l0-224c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16l0 224c0 8.8 7.2 16 16 16s16-7.2 16-16l0-224c0-8.8-7.2-16-16-16z"},child:[]}]})(e)}function Td(e){return fc({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M135.2 17.7L128 32 32 32C14.3 32 0 46.3 0 64S14.3 96 32 96l384 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-96 0-7.2-14.3C307.4 6.8 296.3 0 284.2 0L163.8 0c-12.1 0-23.2 6.8-28.6 17.7zM416 128L32 128 53.2 467c1.6 25.3 22.6 45 47.9 45l245.8 0c25.3 0 46.3-19.7 47.9-45L416 128z"},child:[]}]})(e)}function Ed(e){return fc({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M376.6 84.5c11.3-13.6 9.5-33.8-4.1-45.1s-33.8-9.5-45.1 4.1L192 206 56.6 43.5C45.3 29.9 25.1 28.1 11.5 39.4S-3.9 70.9 7.4 84.5L150.3 256 7.4 427.5c-11.3 13.6-9.5 33.8 4.1 45.1s33.8 9.5 45.1-4.1L192 306 327.4 468.5c11.3 13.6 31.5 15.4 45.1 4.1s15.4-31.5 4.1-45.1L233.7 256 376.6 84.5z"},child:[]}]})(e)}function _d(e){return fc({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"},child:[]}]})(e)}function Md(e){return fc({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M64 464c-8.8 0-16-7.2-16-16L48 64c0-8.8 7.2-16 16-16l160 0 0 80c0 17.7 14.3 32 32 32l80 0 0 288c0 8.8-7.2 16-16 16L64 464zM64 0C28.7 0 0 28.7 0 64L0 448c0 35.3 28.7 64 64 64l256 0c35.3 0 64-28.7 64-64l0-293.5c0-17-6.7-33.3-18.7-45.3L274.7 18.7C262.7 6.7 246.5 0 229.5 0L64 0zm97 289c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0L79 303c-9.4 9.4-9.4 24.6 0 33.9l48 48c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-31-31 31-31zM257 255c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9l31 31-31 31c-9.4 9.4-9.4 24.6 0 33.9s24.6 9.4 33.9 0l48-48c9.4-9.4 9.4-24.6 0-33.9l-48-48z"},child:[]}]})(e)}function Id(e){return fc({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M304 128a80 80 0 1 0 -160 0 80 80 0 1 0 160 0zM96 128a128 128 0 1 1 256 0A128 128 0 1 1 96 128zM49.3 464l349.5 0c-8.9-63.3-63.3-112-129-112l-91.4 0c-65.7 0-120.1 48.7-129 112zM0 482.3C0 383.8 79.8 304 178.3 304l91.4 0C368.2 304 448 383.8 448 482.3c0 16.4-13.3 29.7-29.7 29.7L29.7 512C13.3 512 0 498.7 0 482.3z"},child:[]}]})(e)}od.displayName="AfterWork";const Dd=({isOpen:t,imageUrl:n,onClose:a})=>{const[s,r]=e.useState(!1);if(e.useEffect(()=>{r(!1)},[n]),e.useEffect(()=>{const e=e=>{"Escape"===e.key&&t&&a()};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[t,a]),!t||!n)return null;return $n.jsxs("div",{className:"image-modal "+(t?"open":""),onClick:a,"data-testid":"modal-overlay",children:[s?$n.jsxs("div",{className:"modal-error-message",children:[$n.jsx("p",{children:"The image could not be displayed in full size."}),$n.jsx("p",{children:"It may still be available in the chat or might have been removed."})]}):$n.jsx("img",{src:n,alt:"Fullscreen preview",className:"modal-image",onClick:e=>{e.stopPropagation()},onError:()=>{r(!0)}}),$n.jsx("button",{type:"button",title:"Close preview",className:"modal-close",onClick:a,"data-testid":"modal-close",children:$n.jsx(Ed,{size:12})})]})},Rd=(t=3,n=1e3)=>{const a=e.useRef(new Map);return{registerImage:e.useCallback((e,s)=>{e.onload=()=>{e.classList.remove("loading","failed"),e.style.opacity="1",a.current.delete(s)},e.onerror=()=>{const r=a.current.get(s)||0;r<t?(a.current.set(s,r+1),setTimeout(()=>{e.src=`${s}${s.includes("?")?"&":"?"}retry=${r+1}`},n)):(e.classList.remove("loading"),e.classList.add("failed"),e.style.opacity="0.8")}},[t,n]),resetRetries:e.useCallback(()=>{a.current.clear()},[])}},zd=({src:t,alt:n="Chat image",className:a,onClick:s})=>{const r=e.useRef(null),{registerImage:o}=Rd();return e.useEffect(()=>{r.current&&o(r.current,t)},[t,o]),$n.jsx("img",{ref:r,src:t,alt:n,className:`loading ${a}`,loading:"lazy",onClick:s})},Od=t=>{if(n=t,e.isValidElement(n)&&"object"==typeof n.props&&null!==n.props&&t.props.className)return(e=>{const t=/language-(\w+)/.exec(e);return t&&"md"!==t[1]&&t[1]||null})(t.props.className);var n;if(Array.isArray(t))for(const e of t){const t=Od(e);if(t)return t}return null},Ld=({content:t,isDarkMode:n=!1,onImageClick:a})=>{const s=e.useMemo(()=>{return t.length>5&&(e=t,[/\*\*(.*?)\*\*/,/__(.*?)__/,/\[(.*?)\]\((.*?)\)/,/```([\s\S]*?)```/,/#+\s+.*/,/>\s+.*/,/\d+\.\s+.*/,/[\*\-\+]\s+.*/,/\|(.*?)\|/,/!\[(.*?)\]\((.*?)\)/].some(t=>t.test(e)));var e},[t]),r=e.useMemo(()=>(e=>{let t=e;return t=t.replace(/```md\n([\s\S]*?)```/g,(e,t)=>t),t=t.replace(/```([a-z]*)\n([\s\S]*?)```/g,(e,t,n)=>t&&"md"!==t?`\`\`\`${t}\n${n}\`\`\``:`\`\`\`\n${n}\`\`\``),t})(t),[t]);if(!s)return $n.jsx("span",{children:t});const c=n?"markdown-dark":"markdown-light";return $n.jsx("div",{className:`markdown-renderer ${c}`,children:$n.jsx(l,{remarkPlugins:[i],rehypePlugins:[o],components:{a:({children:e,...t})=>$n.jsx("a",{...t,target:"_blank",rel:"noopener noreferrer",className:"markdown-link",children:e}),img:({src:e,alt:t,...n})=>$n.jsx("img",{src:e,alt:t||"Image",className:"chat-image markdown-image",onClick:()=>e&&a&&a(e),...n}),h1:({children:e,...t})=>$n.jsx("h1",{className:"markdown-h1",...t,children:e}),h2:({children:e,...t})=>$n.jsx("h2",{className:"markdown-h2",...t,children:e}),h3:({children:e,...t})=>$n.jsx("h3",{className:"markdown-h3",...t,children:e}),h4:({children:e,...t})=>$n.jsx("h4",{className:"markdown-h4",...t,children:e}),h5:({children:e,...t})=>$n.jsx("h5",{className:"markdown-h5",...t,children:e}),h6:({children:e,...t})=>$n.jsx("h6",{className:"markdown-h6",...t,children:e}),ul:({children:e,...t})=>$n.jsx("ul",{className:"markdown-ul",...t,children:e}),ol:({children:e,...t})=>$n.jsx("ol",{className:"markdown-ol",...t,children:e}),li:({children:e,...t})=>$n.jsx("li",{className:"markdown-li",...t,children:e}),blockquote:({children:e,...t})=>$n.jsx("blockquote",{className:"markdown-blockquote",...t,children:e}),table:({children:e,...t})=>$n.jsx("table",{className:"markdown-table",...t,children:e}),thead:({children:e,...t})=>$n.jsx("thead",{className:"markdown-thead",...t,children:e}),tbody:({children:e,...t})=>$n.jsx("tbody",{className:"markdown-tbody",...t,children:e}),tr:({children:e,...t})=>$n.jsx("tr",{className:"markdown-tr",...t,children:e}),th:({children:e,...t})=>$n.jsx("th",{className:"markdown-th",...t,children:e}),td:({children:e,...t})=>$n.jsx("td",{className:"markdown-td",...t,children:e}),code:({children:e,className:t,...n})=>!t?$n.jsx("code",{className:"markdown-inline-code",...n,children:e}):$n.jsx("code",{className:`markdown-code ${t||""}`,...n,children:e}),pre:({children:e,...t})=>{const n=Od(e);return n?$n.jsxs("div",{className:"markdown-code-block-wrapper",children:[$n.jsx("div",{className:"markdown-code-block-header",children:$n.jsx("span",{className:"markdown-code-language",children:n})}),$n.jsx("pre",{className:"markdown-pre",...t,children:e})]}):$n.jsx("pre",{className:"markdown-pre",...t,children:e})},p:({children:e,...t})=>$n.jsx("p",{className:"markdown-p",...t,children:e}),hr:e=>$n.jsx("hr",{className:"markdown-hr",...e})},children:r})})};Ld.displayName="Markdown";const Pd=(e,t,n)=>{const a=e.map((e,a)=>e&&e.type?"text"===e.type&&e.text.trim().length>0?$n.jsx(Ld,{content:e.text,isDarkMode:t,onImageClick:n},`text-${a}`):"image_url"===e.type&&e.image_url?.url?$n.jsx(zd,{src:e.image_url.url,className:"chat-image",onClick:()=>n(e.image_url.url)},`img-${a}`):"image"===e.type&&e.image?.url?$n.jsx(zd,{src:e.image.url,className:"chat-image",onClick:()=>n(e.image.url)},`img-${a}`):null:null).filter(Boolean);return 0===a.length?null:$n.jsx("div",{className:"structured-content",children:a})},Bd=(e,t,n)=>{const a=/\[Image:\s*(.+?)\]/g,s=[];let r,o=0;for(;r=a.exec(e);){const[i,l]=r,c=e.slice(o,r.index);c&&s.push($n.jsx(Ld,{content:c,isDarkMode:t,onImageClick:n},`text-${o}`)),l&&(s.push($n.jsx(zd,{src:l,className:"chat-image",onClick:()=>n(l)},`img-${r.index}`)),o=a.lastIndex)}const i=e.slice(o);return i&&s.push($n.jsx("span",{children:i},"text-end")),$n.jsx("div",{className:"content-with-images",children:s})},Fd=({messages:t,isDarkMode:n,userParticipants:a})=>{const[s,r]=e.useState(null),o=e.useRef(null),{resetRetries:i}=Rd(),l=e.useRef(0),c=a.map(e=>"string"==typeof e?e:e.isUser?e.name:void 0).filter(e=>"string"==typeof e),d=e.useCallback(e=>r(e),[]),u=e.useCallback(()=>r(null),[]);e.useEffect(()=>{i()},[t.length,i]);const h=e.useCallback(e=>{const{id:t,timestamp:a,type:s,content:r,sender:o,recipient:i}=e;try{const e=((e,t,n)=>{if("string"==typeof e)try{const a=JSON.parse(e);return Array.isArray(a)?Pd(a,t,n):Bd(e,t,n)}catch{return Bd(e,t,n)}else{if("content"in e&&e.content)return Array.isArray(e.content)?Pd(e.content,t,n):Bd(String(e.content),t,n);if(Array.isArray(e))return Pd(e,t,n)}return Bd(String(e.content),t,n)})(r,n,d);return{id:t,timestamp:a,type:s,sender:o,recipient:i,node:e}}catch(l){return{id:t,timestamp:a,type:s,sender:o,recipient:i,node:null}}},[d,n]),p=e.useCallback(e=>e.sender&&c.includes(e.sender)?"user-message":"error"===e.type?"error-message":"input_request"===e.type?"request-message":S.isSystemMessage(e)?"system-message":"assistant-message",[c]),m=e.useCallback((e,t)=>`msg-${t}-${e.id}-${e.timestamp}`,[]);return e.useEffect(()=>{const e=t.length>l.current;if(l.current=t.length,!e)return;const n=()=>{const e=o.current;if(e)e.scrollTop=e.scrollHeight;else{document.querySelectorAll(".chat-container").forEach(e=>{e.scrollTop=e.scrollHeight})}};setTimeout(n,10),setTimeout(n,100),setTimeout(n,300)},[t.length]),$n.jsxs($n.Fragment,{children:[$n.jsx("div",{className:"chat-container",ref:o,children:t.map((e,t)=>{const n=h(e);if(!n.node)return null;const a=p(n),s="user-message"===a||"assistant-message"===a;return $n.jsxs("div",{className:`message-bubble ${p(n)}`,"data-testid":"rf-chat-message",children:[$n.jsx("div",{className:`message-header ${s&&a}`,children:"assistant-message"===a?$n.jsxs($n.Fragment,{children:[s&&$n.jsx("div",{className:"avatar-container",children:$n.jsx("div",{className:"avatar assistant-avatar",children:$n.jsx("img",{src:"data:image/webp;base64,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",alt:"Assistant Avatar",className:"avatar-image"})})}),n.sender&&$n.jsx("span",{className:"message-sender",children:n.sender}),$n.jsx("span",{className:"message-timestamp",children:new Date(e.timestamp).toLocaleTimeString()})]}):"user-message"===a?$n.jsxs($n.Fragment,{children:[$n.jsx("span",{className:"message-timestamp",children:new Date(e.timestamp).toLocaleTimeString()}),n.sender&&$n.jsx("span",{className:"message-sender",children:n.sender}),s&&$n.jsx("div",{className:"avatar-container",children:$n.jsx("div",{className:"avatar user-avatar",children:$n.jsx(Id,{size:24})})})]}):$n.jsxs($n.Fragment,{children:[n.sender&&$n.jsx("span",{className:"message-sender",children:n.sender}),$n.jsx("span",{className:"message-timestamp",children:new Date(e.timestamp).toLocaleTimeString()})]})}),$n.jsx("div",{className:"message-content",children:n.node})]},m(e,t))})}),$n.jsx(Dd,{isOpen:Boolean(s),imageUrl:s,onClose:u})]})};Fd.displayName="ChatUI";const Ud=e.memo(t=>{const{title:n,children:a,dataTestId:s,fullWidth:r=!1,expanded:o=!1,className:i="",contentClassName:l=""}=t,[c,d]=e.useState(o);e.useEffect(()=>{d(o)},[o]);const u=e.useCallback(()=>{d(e=>!e)},[]),h=`collapsible ${r?"full-width":""} ${i}`.trim(),p=`collapsible-header ${i}`.trim();return $n.jsxs("div",{className:h,"data-testid":s,children:[$n.jsxs("div",{className:p,onClick:u,children:[$n.jsx("span",{children:n}),$n.jsx("span",{className:"margin-left-5","aria-hidden":"true",children:c?"▲":"▼"})]}),c&&$n.jsx("div",{className:`collapsible-content ${l||""}`,children:a})]})});Ud.displayName="Collapsible";const Hd=({htmlFor:e,label:t,info:n,children:a})=>{const s="function"==typeof t?t():t,r="function"==typeof n?n():n;return $n.jsxs("div",{className:"flex-align-center flex-row gap-1",children:[$n.jsxs("div",{className:"flex-align-center items-center gap-2",children:[$n.jsx("label",{htmlFor:e,className:"text-sm info-label",children:s}),$n.jsx(tc,{delayDuration:100,children:$n.jsxs(nc,{children:[$n.jsx(ac,{asChild:!0,children:$n.jsx("button",{type:"button","aria-label":"More info",className:"tooltip-button inline-flex items-center justify-center cursor-help",children:$n.jsx(Ec,{})})}),$n.jsx(sc,{children:$n.jsxs(rc,{side:"top",align:"center",className:"tooltip-content",children:[r,$n.jsx(oc,{className:"fill-[var(--background-color)]"})]})})]})})]}),a&&$n.jsx("div",{children:a})]})};Hd.displayName="InfoLabel";const Wd=t=>{const{viewLabel:n,viewLabelInfo:a,items:s,itemsType:r,areValuesSecret:o=!1}=t,{visible:i,newEntry:l,onAddEntry:c,onDeleteEntry:d,onSaveEntry:u,onKeyChange:h,onValueChange:p,onVisibilityChange:m,onNewEntryKeyChange:g,onNewEntryValueChange:f,isDirty:y}=(t=>{const{items:n,onUpdate:a,onDelete:s,onAdd:r,allowEmptyValues:o=!0}=t,[i,l]=e.useState({}),[c,d]=e.useState(Object.entries(n)),[u,h]=e.useState({key:"",value:""});e.useEffect(()=>{d(Object.entries(n))},[n]);const p=e.useCallback((e,t)=>{const n=t.target.value;d(t=>t.map(([t,a],s)=>s===e?[n,a]:[t,a]))},[]),m=e.useCallback((e,t)=>{const n=t.target.value;d(t=>t.map(([t,a],s)=>s===e?[t,n]:[t,a]))},[]),g=e.useCallback(e=>{l(t=>({...t,[e]:!t[e]}))},[]),f=e.useCallback(()=>{u.key&&(o||u.value)&&(r(u.key,u.value),d(e=>[...e,[u.key,u.value]]),h({key:"",value:""}))},[u,o,r]),y=e.useCallback(e=>{const t=e.target.value;h(e=>({...e,key:t}))},[]),b=e.useCallback(e=>{const t=e.target.value;h(e=>({...e,value:t}))},[]),v=e.useCallback(e=>{s(e),d(t=>t.filter(([t])=>t!==e))},[s]),x=e.useCallback(()=>{const e=c.reduce((e,[t,n])=>(e[t]=n,e),{});a(e)},[c,a]),w=e.useCallback(e=>{if(e>=c.length||!c[e])return!0;const[t,a]=c[e];return!(t in n)||n[t]!==a},[c,n]);return{stateItems:c,newEntry:u,visible:i,onKeyChange:p,onValueChange:m,onVisibilityChange:g,onAddEntry:f,onNewEntryKeyChange:y,onNewEntryValueChange:b,onDeleteEntry:v,onSaveEntry:x,isDirty:w}})(t);return $n.jsxs("div",{className:"dict-entries-view",children:[a?$n.jsx(Hd,{htmlFor:`dict-entry-${r}`,label:n,info:a}):$n.jsx("label",{className:"margin-bottom-5",children:n}),$n.jsx("div",{className:"dict-entries-list",children:Object.entries(s).map(([e,t],n)=>$n.jsxs("div",{className:"dict-entry",children:[$n.jsx("input",{type:"text",defaultValue:e,onChange:h.bind(null,n),"data-testid":`key-input-${r}-${n}`,placeholder:"Key"},`${e}-${t}-${n}`),$n.jsx("input",{type:o?i[e]?"text":"password":"text",defaultValue:String(t),onChange:p.bind(null,n),"data-testid":`value-input-${r}-${n}`,id:`dict-value-input-${r}-${n}`,placeholder:"Value"},`${t}-${n}-${e}`),o&&$n.jsx("button",{type:"button",className:"toggle-visibility-btn",onClick:m.bind(null,e),title:"Toggle visibility",id:`visibility-${r}-${n}`,"data-testid":`visibility-${r}-${n}`,children:i[e]?$n.jsx(jc,{}):$n.jsx(Ac,{})}),$n.jsx("button",{type:"button",onClick:d.bind(null,e),title:"Delete",className:"trash-button",id:`delete-dict-item-${r}-${n}`,"data-testid":`delete-dict-item-${r}-${n}`,children:$n.jsx(Oc,{})}),y(n)&&$n.jsx("button",{onClick:u,title:"Save",id:`save-dict-item-${r}-${n}`,"data-testid":`save-dict-item-${r}-${n}`,type:"button",className:"save-button",children:$n.jsx(Ic,{})})]},e))}),$n.jsxs("div",{className:"add-dict-entry-view",children:[$n.jsx("input",{type:"text",placeholder:"Key","data-testid":`new-dict-${r}-key`,id:`new-dict-${r}-key`,value:l.key,onChange:g}),$n.jsx("input",{placeholder:"Value","data-testid":`new-dict-${r}-value`,id:`new-dict-${r}-value`,type:o?i._NEW?"text":"password":"text",value:l.value,onChange:f}),o&&$n.jsx("button",{type:"button",className:"toggle-visibility-btn",onClick:m.bind(null,"_NEW"),title:"Toggle visibility",id:`visibility-${r}-new`,"data-testid":`visibility-${r}-new`,children:i._NEW?$n.jsx(jc,{}):$n.jsx(Ac,{})}),$n.jsx("button",{onClick:c,title:"Add",className:"plus-button",id:`add-new-dict-${r}-item`,"data-testid":`add-new-dict-${r}-item`,disabled:""===l.key,type:"button",children:$n.jsx(Mc,{})})]})]})};Wd.displayName="Dict";const qd=t=>{const{flowId:n,multiple:a=!1}=t,{onFileDragOver:s,onFileDragLeave:r,onOpenUploadDialog:o,onFileDrop:i}=(t=>{const{flowId:n,onUpload:a,allowedFileExtensions:s,multiple:r=!1}=t,o=e.useCallback(e=>{const t=e.name.split(".").pop()?.toLowerCase();return t&&s.some(e=>e.toLowerCase()===`.${t}`)?!(e.size>10485760&&(Mr({flowId:n,message:"File size limit exceeded. Maximum file size is 10MB.",level:"error"}),1)):(Mr({flowId:n,message:"Invalid file extension. Please upload a valid file.",level:"error"}),!1)},[n,s]),i=e.useCallback(e=>{const t=e.filter(o);t.length&&a(t)},[o,a]),l=e.useCallback(e=>Array.from(e).filter(e=>s.some(t=>e.name.toLowerCase().endsWith(t.toLowerCase()))),[s]);return{onFileDragOver:e.useCallback(e=>{e.preventDefault(),e.stopPropagation(),e.currentTarget.classList.add("drag-over")},[]),onFileDragLeave:e.useCallback(e=>{e.preventDefault(),e.stopPropagation(),e.currentTarget.classList.remove("drag-over")},[]),onFileDrop:e.useCallback(e=>{if(e.preventDefault(),e.stopPropagation(),e.currentTarget.classList.remove("drag-over"),e.dataTransfer.files.length>0){const t=l(e.dataTransfer.files);t.length&&i(t)}},[l,i]),onOpenUploadDialog:e.useCallback(()=>{const e=document.createElement("input");e.type="file",e.multiple=r,e.style.display="none",e.setAttribute("data-testid","drop-zone-file-input"),e.accept=s.join(","),e.onchange=t=>{if(t.target instanceof HTMLInputElement&&t.target.files&&t.target.files.length){const e=l(t.target.files);e.length&&i(e)}e.remove()},document.body.appendChild(e),e.click()},[r,s,l,i])}})(t),l=a?"Drop files here or click to upload":"Drop a file here or click to upload";return $n.jsx("div",{className:"drop_zone clickable",onDrop:i,onDragOver:s,onClick:o,onDragLeave:r,"data-testid":`drop-zone-${n}`,children:$n.jsxs("div",{className:"drop_zone_content",children:[$n.jsx("div",{className:"drop_zone_icon",children:$n.jsx(vc,{})}),$n.jsx("div",{className:"drop_zone_text",children:l})]})})};qd.displayName="DropZone";const Vd=e=>{const{value:t,onChange:a,darkMode:s}=e,r=s?"vs-dark":"vs-light";return $n.jsx("div",{className:"code-editor",children:$n.jsx(n,{defaultLanguage:"python",theme:r,value:t,className:r,options:{wordWrap:"on",automaticLayout:!0,fontSize:13,fontLigatures:!0,formatOnType:!0,smoothScrolling:!0,autoClosingBrackets:"always",tabSize:4,minimap:{enabled:!1},renderWhitespace:"none",cursorBlinking:"smooth"},onChange:a})})};Vd.displayName="Editor";const Gd=({value:t,onChange:n,autoFocus:a=!1,...s})=>{const r=e.useRef(null),o=e.useRef({selectionStart:t?.length||0,selectionEnd:t?.length||0}),i=e.useRef(!0),l=e.useCallback(e=>{const{selectionStart:t,selectionEnd:a}=e.target;o.current={selectionStart:t,selectionEnd:a},n(e)},[n]);return e.useEffect(()=>{a&&r.current&&r.current.focus()},[a]),e.useEffect(()=>{i.current?i.current=!1:r.current&&document.activeElement===r.current&&requestAnimationFrame(()=>{r.current&&r.current.setSelectionRange(o.current.selectionStart,o.current.selectionEnd)})},[t]),$n.jsx("textarea",{ref:r,value:t,onChange:l,...s})};Gd.displayName="TextareaInput";const Kd=[{value:"string",label:"Check a variable"},{value:"expression",label:"Use an expression"}],$d=t=>{const{available:n,onDataChange:a}=t,[s,r]=e.useState(n);e.useEffect(()=>{r(n)},[n]);const o=e.useMemo(()=>"expression"===s.type,[s]),i=e.useMemo(()=>"string"===s.type,[s]),l=e.useMemo(()=>Kd.find(e=>e.value===s.type),[s.type]),c=e.useCallback(e=>{const t=e?"string":"none",n={...s,type:t,value:s.value};r(n),a(n)},[s,a]),d=e.useCallback(e=>{if(e){const t={...s,type:e.value,value:""};r(t),a(t)}},[s,a]),u=e.useCallback(e=>{const t={...s,value:e.target.value};r(t),a(t)},[s,a]);return $n.jsxs("div",{className:"flex-column",children:[$n.jsxs("div",{className:"info margin-bottom-5",children:["You can optionally handle the availability of this transition by checking a variable or using an expression.",$n.jsxs("ul",{children:[$n.jsxs("li",{children:[$n.jsx("strong",{children:"Check a variable"}),": Confirm if a certain variable (like"," ",$n.jsx("code",{children:"order_is_found"}),") is set and is truthy."]}),$n.jsxs("li",{children:[$n.jsx("strong",{children:"Use Expression"}),": Write a short logic rule using variables, like:",$n.jsx("br",{}),$n.jsxs("code",{children:["$","{","is_logged_in","}"," and not $","{","is_banned","}"]})]})]})]}),$n.jsx("div",{children:$n.jsx(ed,{label:"Enable Availability Check",isChecked:"none"!==s.type,onCheckedChange:c,id:"availability-enabled-checkbox","data-testid":"availability-enabled-checkbox","aria-label":"Enable availability check"})}),"none"!==n.type&&$n.jsxs("div",{className:"flex-column margin-top-10",children:[$n.jsx("label",{className:"hidden",htmlFor:"select-availability-type",children:"Availability Type"}),$n.jsx(nd,{options:Kd,value:l,onChange:d,inputId:"select-availability-type",className:"flex-1 margin-right-10",isClearable:!0,"data-testid":"availability-type-select"}),o&&$n.jsxs("div",{className:"flex-column margin-top-10",children:[$n.jsx("label",{className:"hidden",htmlFor:"expression-input",children:"Expression"}),$n.jsx(Gd,{rows:2,className:"margin-top-5",title:"Expression",placeholder:"Enter the expression to evaluate",value:s.value||"",onChange:u,"data-testid":"expression-input"})]}),i&&$n.jsxs("div",{className:"flex-column margin-top-10",children:[$n.jsx("label",{className:"hidden",htmlFor:"string-input",children:"Variable Name"}),$n.jsx("input",{type:"text",id:"string-input",value:s.value,onChange:u,className:"flex-1",placeholder:"Enter variable name","data-testid":"string-input"})]})]})]})};$d.displayName="HandoffAvailability";const Zd=e.memo(t=>{const{name:n,label:a,value:s,onChange:r,onNull:o="",disabled:i=!1,labelInfo:l=null,dataTestId:c="text-input",placeholder:d="...",style:u={},className:h="",isPassword:p=!1,fullWidth:m=!1,labelClassName:g="",inputClassName:f=""}=t,[y,b]=e.useState(!1),v=e.useCallback(e=>{i||r(e)},[i,r]),x=e.useCallback(()=>{b(e=>!e)},[]),w=e.useMemo(()=>p?y?"text":"password":"text",[p,y]),C=e.useMemo(()=>m?{flex:"1",...u}:{...u},[m,u]);return $n.jsxs($n.Fragment,{children:[l?$n.jsx(Hd,{label:a,info:l,htmlFor:`id-${n}`}):"string"==typeof a?$n.jsx("label",{htmlFor:`id-${n}`,className:g,children:a}):a,$n.jsxs("div",{className:`text-input-container flex-align-center ${h}`,children:[$n.jsx("input",{className:f,placeholder:d,type:w,value:null!==s?s:o,onChange:v,disabled:i,"data-testid":c,id:`id-${n}`,name:n,style:C,"aria-label":"string"==typeof a?a:void 0,autoCapitalize:"off",autoCorrect:"off",autoComplete:"off"}),p&&$n.jsx("button",{type:"button",className:"toggle-visibility-btn margin-left-5",onClick:x,title:y?"Hide password":"Show password","aria-label":y?"Hide password":"Show password","data-testid":`visibility-${c}`,children:y?$n.jsx(jc,{}):$n.jsx(Ac,{})})]})]})});Zd.displayName="TextInput";const Qd={string_llm:"Static LLM prompt",string_context:"Variable check",context_str_llm:"Dynamic LLM Prompt",expression_context:"Expression check"},Yd=[{value:"string_llm",label:Qd.string_llm},{value:"context_str_llm",label:Qd.context_str_llm},{value:"string_context",label:Qd.string_context},{value:"expression_context",label:Qd.expression_context}],Xd=t=>{const{condition:n,onDataChange:a}=t,[s,r]=e.useState(n);e.useEffect(()=>{r(n)},[n]);const o=e.useCallback((e,t)=>{if(!s)return;const n={...s,[e]:t};r(n),a(n)},[s,a]),i=e.useCallback(e=>{if(e){const t={conditionType:e.value};r(t),a(t)}},[a]),l=e.useMemo(()=>({string_llm:{field:"prompt",handler:e=>o("prompt",e.target.value)},context_str_llm:{field:"context_str",handler:e=>o("context_str",e.target.value)},string_context:{field:"variable_name",handler:e=>o("variable_name",e.target.value)},expression_context:{field:"expression",handler:e=>o("expression",e.target.value)}}),[o]),c=e.useMemo(()=>s?.conditionType?{label:Qd[s.conditionType],value:s.conditionType}:null,[s?.conditionType]),d=e.useCallback(()=>{if(!s?.conditionType)return null;const e=s.conditionType,t=l[e];switch(e){case"string_llm":return $n.jsxs("div",{className:"margin-top-10",children:[$n.jsx("label",{children:"LLM Prompt:"}),$n.jsx("div",{className:"margin-top-5"}),$n.jsx(Gd,{rows:2,title:"LLM Prompt",placeholder:"Enter the LLM prompt",value:s.prompt||"",onChange:t.handler,"data-testid":"llm-prompt-input"})]});case"context_str_llm":return $n.jsxs("div",{className:"margin-top-10",children:[$n.jsx("label",{children:"Prompt:"}),$n.jsx(Gd,{rows:2,className:"margin-top-5",title:"Prompt",placeholder:"Enter the prompt to evaluate",value:s.context_str||"",onChange:t.handler,"data-testid":"context-llm-prompt-input"})]});case"string_context":return $n.jsx("div",{className:"margin-top-10",children:$n.jsx(Zd,{name:"variable-name",label:"Variable Name:",className:"margin-top-5",placeholder:"Enter the variable name to check",value:s.variable_name||"",onChange:t.handler,dataTestId:"variable-name-input"})});case"expression_context":return $n.jsxs("div",{className:"margin-top-10",children:[$n.jsx("label",{children:"Expression:"}),$n.jsx(Gd,{rows:2,className:"margin-top-5",title:"Expression",placeholder:"Enter the expression to evaluate",value:s.expression||"",onChange:t.handler,"data-testid":"expression-input"})]});default:return null}},[s,l]);return $n.jsxs("div",{className:"flex-column",children:[$n.jsxs("div",{className:"info margin-bottom-5",children:["You can control when this transition happens. Conditions allow you to check values or evaluate logic based on the current context. There are four types of conditions you can choose from:",$n.jsxs("ul",{className:"no-margin",children:[$n.jsxs("li",{children:[$n.jsx("strong",{children:"Static LLM prompt"}),": A fixed message sent to a language model (LLM) to decide whether the transition should happen."]}),$n.jsxs("li",{children:[$n.jsx("strong",{children:"Dynamic LLM prompt"}),": A message that includes context variables, like the user's name or order count. It's sent to the LLM for evaluation.",$n.jsx("br",{}),$n.jsx("em",{children:"Example:"}),$n.jsx("ul",{children:$n.jsx("li",{children:$n.jsxs("code",{children:['"User is ',"{","user_name","}"," and has ","{","num_orders","}",' orders."']})})})]}),$n.jsxs("li",{children:[$n.jsx("strong",{children:"Variable check"}),": Simply checks if a specific variable exists and is truthy."]}),$n.jsxs("li",{children:[$n.jsx("strong",{children:"Expression check"}),": Allows you to write a small logic expression using context variables. You can use operators like ",$n.jsx("code",{children:"and"}),", ",$n.jsx("code",{children:"or"}),","," ",$n.jsx("code",{children:"not"}),", as well as comparison signs like ",$n.jsx("code",{children:">"}),", ",$n.jsx("code",{children:"=="}),", etc.",$n.jsx("br",{}),$n.jsx("em",{children:"Examples:"}),$n.jsxs("ul",{children:[$n.jsx("li",{children:$n.jsxs("code",{children:["not $","{","logged_in","}"," and $","{","is_admin","}"," or $","{","guest_checkout","}"]})}),$n.jsx("li",{children:$n.jsxs("code",{children:["len($","{","orders","}",") > 0 and $","{","user_active","}"]})})]})]})]})]}),$n.jsxs("div",{className:"flex-column margin-top-10",children:[$n.jsx("label",{className:"hidden",htmlFor:"select-condition-type",children:"Condition Type"}),$n.jsx(nd,{options:Yd,value:c,onChange:i,inputId:"select-condition-type",className:"flex-1 margin-right-10",isClearable:!0}),d()]})]})};Xd.displayName="HandoffCondition";const Jd=(t,n,a,s,r)=>{const{groupEdges:o,nestedChats:i}=((t,n,a,s)=>{const r=e.useMemo(()=>n.parentId,[n.parentId]),o=e.useMemo(()=>r?a.filter(e=>e.data.parentId===r&&e.id!==t):[],[a,r,t]),i=e.useMemo(()=>s.filter(e=>e.source===t),[s,t]),l=e.useMemo(()=>{if(!r)return i;const e=o.map(e=>e.id);return i.filter(t=>e.includes(t.target))},[i,o,r]),c=e.useMemo(()=>i.filter(e=>{const n=a.find(t=>t.id===e.source),s=a.find(t=>t.id===e.target);return n&&s&&n.id===t&&n.data.parentId===r&&s.data.parentId!==r}),[t,i,a,r]),d=e.useMemo(()=>i.filter(e=>{const t=a.find(t=>t.id===e.target);return t&&t.data.parentId===r}),[i,a,r]),u=e.useMemo(()=>{const e=n.nestedChats||[];return 0===c.length||e.length>0&&e[0]&&e[0].messages.length>0?e:[{triggeredBy:[t],messages:c.map(e=>({id:e.id,isReply:!1})),condition:{conditionType:"string_llm",prompt:""},available:{type:"none",value:""}}]},[t,c,n.nestedChats]);return{parentGroupId:r,groupAgents:o,agentEdges:i,groupEdges:l,nestedEdges:c,nestedChats:u,agentGroupOnlyEdges:d}})(t,n,a,s),{getTransitionTargetName:l}=((t,n,a)=>{const s=e.useCallback(e=>{const n=t.find(t=>t.id===e);return n?.data.label||n?.data.name||e},[t]),r=e.useCallback((e=0)=>{if(0===a.length||e>=a.length||0===a[e]?.messages.length)return"Nested Chat";const t=a[e],r=t?.messages.map(e=>{const t=n.find(t=>t.id===e.id);return t?s(t.target):""}).filter(Boolean)||[];return 0===r.length?"Nested Chat":1===r.length?`Nested Chat: ${r[0]}`:`Nested Chat: ${r[0]} +${r.length-1} more`},[a,n,s]),o=e=>{switch(e.targetType){case"AgentTarget":return s(e.value[0]?e.value[0]:"");case"RandomAgentTarget":return`Random (${e.value.map(s).join(", ")})`;case"GroupChatTarget":return`Group Chat: ${s(e.value[0]?e.value[0]:"")}`;case"NestedChatTarget":return r(0);case"AskUserTarget":return"Ask User";case"GroupManagerTarget":return"Group Manager";case"RevertToUserTarget":return"Revert to User";case"StayTarget":return"Stay";case"TerminateTarget":return"Terminate";default:return"Unknown"}};return{getAgentName:s,getTransitionTargetName:o,getAfterWorkTargetName:e=>o(e),getNestedChatDisplayName:r}})(a,s,i),c=e.useMemo(()=>{const e=[],t=new Set,a="nested-chat",s=i.length>0&&i.some(e=>e.messages.length>0);if(n.handoffs.forEach((n,r)=>{if(n===a){if(s){const t={targetType:"NestedChatTarget",value:[a]};e.push({id:a,...t,value:[l(t)],order:r})}}else{const a=o.find(e=>e.id===n);if(a){t.add(a.id);const n={targetType:"AgentTarget",value:[a.target]};e.push({id:a.id,...n,value:[l(n)],order:r})}}}),o.forEach(n=>{if(!t.has(n.id)){const t={targetType:"AgentTarget",value:[n.target]};e.push({id:n.id,...t,value:[l(t)],order:e.length})}}),s&&!n.handoffs.includes(a)){const t={targetType:"NestedChatTarget",value:[]};e.push({id:a,...t,value:[l(t)],order:e.length})}return e.sort((e,t)=>e.order-t.order)},[n.handoffs,o,i,l]),d=e.useCallback(e=>{if(e<=0||!c[e-1]||!c[e])return;const t=[...c];[t[e],t[e-1]]=[t[e-1],t[e]];const n=t.map(e=>e.id);r({handoffs:n})},[c,r]),u=e.useCallback(e=>{if(e>=c.length-1)return;const t=[...c];[t[e],t[e+1]]=[t[e+1],t[e]];const n=t.map(e=>e.id);r({handoffs:n})},[c,r]);return{orderedTransitionTargets:c,getTransitionTargetName:l,onMoveTransitionTargetUp:d,onMoveTransitionTargetDown:u}},eu=e.memo(e=>{const{id:t,data:n,agents:a,edges:s,onDataChange:r}=e,{orderedTransitionTargets:o,getTransitionTargetName:i,onMoveTransitionTargetDown:l,onMoveTransitionTargetUp:c}=Jd(t,n,a,s,r),d=o.length>0||!!n.afterWork;return $n.jsxs("div",{className:"handoffs-container","data-testid":`handoffs-container-${t}`,children:[$n.jsx("div",{className:"info margin-left--5",children:"Handoffs control where the conversation flow goes from this agent. They include connections to other agents, nested chats, and what happens after the agent's work is done."}),$n.jsx("div",{className:"handoffs-list",children:d?$n.jsxs("div",{className:"handoffs-items",children:[o.length>0&&$n.jsxs("div",{className:"handoffs-section",children:[$n.jsx("h4",{className:"handoffs-section-title",children:"Handoffs"}),$n.jsxs("p",{className:"handoff-order-instructions",children:["If the group's speakers selection mode allows it (e.g. set to"," ",$n.jsx("em",{children:$n.jsx("b",{children:"default"})}),"), you can use the up and down arrows to reorder handoffs. The ordering will then determine the sequence in which handoffs are processed."]}),$n.jsx("div",{className:"ordered-items-list",children:o.map((e,t)=>$n.jsxs("div",{className:"ordered-item","data-testid":`handoff-item-${t}`,children:[$n.jsxs("div",{className:"reorder-buttons",children:[t>0&&$n.jsx("button",{type:"button",title:"Move up",className:"reorder-btn up-btn","data-testid":`move-handoff-up-button-${t}`,onClick:()=>c(t),"aria-label":"Move up",children:"↑"}),t<o.length-1&&$n.jsx("button",{type:"button",title:"Move down",className:"reorder-btn down-btn","data-testid":`move-handoff-down-button-${t}`,onClick:()=>l(t),"aria-label":"Move down",children:"↓"})]})," ",$n.jsxs("div",{className:"ordered-item-content",children:[$n.jsx("div",{className:"order-badge",children:t+1}),$n.jsx("div",{className:"handoff-type",children:"AgentTarget"===e.targetType?"Agent Connection":"NestedChatTarget"===e.targetType?"Nested Chat":e.targetType}),$n.jsxs("div",{className:"handoff-target",children:[$n.jsx("span",{className:"target-label",children:"Target:"})," ",e.value]})]})]},`handoff-${t}`))})]}),n.afterWork&&$n.jsxs("div",{className:"handoffs-section",children:[$n.jsx("h4",{className:"handoffs-section-title",children:"After Work"}),$n.jsx("div",{className:"ordered-item after-work-handoff","data-testid":"handoff-after-work-item",children:$n.jsxs("div",{className:"ordered-item-content",children:[$n.jsx("div",{className:"handoff-type",children:"AfterWork"}),$n.jsxs("div",{className:"handoff-target",children:[$n.jsx("span",{className:"target-label",children:"Target:"})," ",i(n.afterWork)]}),$n.jsx("div",{className:"handoff-info",children:$n.jsx("em",{children:"AfterWork handoff always executes last"})})]})})]})]}):$n.jsx("div",{className:"no-handoffs-message",children:'This agent has no handoffs configured. You can add connections to other agents in the flow editor, configure nested chats in the agent settings, or set what happens after the agent\'s work is done in the "Afterwards" tab.'})})]})});eu.displayName="Handoffs";const tu=t=>{const{current:n,darkMode:a,defaultContent:s,selectLabel:r,selectTestId:o,notNoneLabel:i,notNoneLabelInfo:l,includeContext:c,skipRagOption:d,skipCarryoverOption:u,skipNone:h,onTypeChange:p}=t,{onContentUpdate:m,onRagProblemUpdate:g,onMethodContentUpdate:f,onUseCarryoverChange:y,onAddContextEntry:b,onRemoveContextEntry:v,onUpdateContextEntries:x}=(t=>{const{current:n,onMessageChange:a,onAddContextEntry:s,onRemoveContextEntry:r,onUpdateContextEntries:o}=t,i=e.useCallback(e=>{a(e)},[a]),l=e.useCallback((e,t)=>{s?.(e,t)},[s]),c=e.useCallback(e=>{r?.(e)},[r]),d=e.useCallback(e=>{o?.(e)},[o]);return{onContentUpdate:e.useCallback(e=>{i({type:"string",useCarryover:n.useCarryover,content:e.target.value,context:n.context})},[n.useCarryover,n.context,i]),onRagProblemUpdate:e.useCallback(e=>{i({type:"rag_message_generator",content:null,useCarryover:n.useCarryover,context:{...n.context,problem:e.target.value}})},[n.useCarryover,n.context,i]),onMethodContentUpdate:e.useCallback(e=>{e&&i({type:"method",useCarryover:n.useCarryover,content:e,context:n.context})},[n.useCarryover,n.context,i]),onUseCarryoverChange:e.useCallback(e=>{i({type:n.type,useCarryover:e,content:n.content,context:n.context})},[n.type,n.content,n.context,i]),onAddContextEntry:l,onRemoveContextEntry:c,onUpdateContextEntries:d}})(t),w="none"!==n.type&&"rag_message_generator"!==n.type&&i&&(l?$n.jsx(Hd,{label:i,info:l,htmlFor:"message-input"}):$n.jsx("label",{htmlFor:"message-input",children:i})),C=c&&"rag_message_generator"!==n.type&&"none"!==n.type;let k=d?au.filter(e=>"rag_message_generator"!==e.value):au;return!0===h&&(k=k.filter(e=>"none"!==e.value)),$n.jsxs($n.Fragment,{children:[$n.jsx("label",{htmlFor:`message-select-test-${o}`,children:r}),$n.jsx("div",{className:"margin-bottom-5"}),$n.jsx(nd,{options:k,value:{label:su[n.type],value:n.type},onChange:e=>{p(e?e.value:"none")},inputId:`message-select-test-${o}`}),w,"string"===n.type&&$n.jsx("div",{className:"full-width",children:$n.jsx(Gd,{placeholder:"Enter the message",className:"fill-available-width",rows:3,value:n.content??"",onChange:m,"data-testid":"message-text"})}),"rag_message_generator"===n.type&&$n.jsxs("div",{children:[$n.jsx("div",{className:"info margin-bottom-20",children:"Use the RAG user's `sender.message_generator` method to generate a message."}),$n.jsx("label",{children:"Problem:"}),$n.jsx("div",{className:"full-width",children:$n.jsx(Gd,{placeholder:"Enter the problem",rows:3,className:"fill-available-width margin-top-5",value:String(n.context.problem??""),onChange:g,"data-testid":"rag-message-generator-problem"})})]}),"method"===n.type&&$n.jsx(Vd,{value:n.content??s,onChange:f,darkMode:a}),C&&$n.jsx(Wd,{items:n.context,itemsType:"message-context",viewLabel:"Message Context",viewLabelInfo:"Additional context to be included.",onAdd:b,onDelete:v,onUpdate:x}),!u&&("string"===n.type||"rag_message_generator"===n.type)&&$n.jsx(td,{label:"Carryover ",info:nu,checked:n.useCarryover??!1,id:"message-use-carryover",onChange:y})]})},nu=$n.jsxs("div",{children:[$n.jsx("div",{children:"This should not be checked if this is the first message in the flow."}),$n.jsx("br",{}),"Append the context's last carryover to the message.",$n.jsx("br",{}),"Example final message:",$n.jsx("br",{}),$n.jsx("pre",{children:'"Write a blogpost.\\nContext:\\n" + carryover'})]}),au=[{label:"None",value:"none"},{label:"Text",value:"string"},{label:"Use RAG Message Generator",value:"rag_message_generator"},{label:"Custom method",value:"method"}],su={none:"None",string:"Text",rag_message_generator:"Use RAG Message Generator",method:"Method"};tu.displayName="MessageInput";const ru=e=>{const{onSaveAndClose:t,hideConfirmation:n,handleSaveAndClose:a,handleCloseModal:s}=e;return $n.jsx("div",{className:"modal-confirmation padding-10",children:$n.jsxs("div",{className:"modal-confirmation-content",children:[$n.jsx("h4",{className:"warning",children:"Are you sure you want to close this modal? Any unsaved changes will be lost."}),$n.jsx("div",{className:"modal-actions",children:t?$n.jsxs($n.Fragment,{children:[$n.jsx("div",{className:"modal-actions flex-center margin-top--10 margin-bottom--10",children:$n.jsx("button",{className:"secondary","data-testid":"modal-action-confirm-cancel",onClick:n,type:"button",title:"Don't Close",children:"Don't Close"})}),$n.jsxs("div",{className:"modal-actions flex-center margin-top--10 margin-bottom--10",children:[$n.jsx("button",{className:"save margin-right-10","data-testid":"modal-action-confirm-save",onClick:a,type:"button",title:"Save & Close",children:"Save & Close"}),$n.jsx("button",{className:"primary","data-testid":"modal-action-confirm-close",onClick:s,type:"button",title:"Close",children:"Close"})]})]}):$n.jsxs($n.Fragment,{children:[$n.jsx("button",{className:"modal-action-cancel","data-testid":"modal-action-confirm-cancel",onClick:n,type:"button",title:"Don't Close",children:"Don't Close"}),$n.jsx("button",{className:"modal-action-submit","data-testid":"modal-action-confirm-close",onClick:s,type:"button",title:"Close",children:"Close"})]})})]})})},ou=e.forwardRef((t,n)=>{const[s,r]=e.useState(t.isOpen);e.useImperativeHandle(n,()=>({close:()=>{r(!1),t.onClose?.()},showModal:()=>{r(!0)}})),e.useEffect(()=>{t.isOpen&&r(!0)},[t.isOpen]);const{id:o,flowId:i,isOpen:l,dataTestId:c="modal-dialog",beforeTitle:d,title:u,hasCloseBtn:h=!0,hasMaximizeBtn:p=!0,hasMinimizeBtn:m=!0,children:g,className:f="",hasUnsavedChanges:y,onSaveAndClose:b,noBackdrop:v}=t,x=e.useRef(null),w=e.useRef(null),[C,k]=e.useState(void 0),[j,A]=e.useState(0),[S,N]=e.useState(null),{showConfirmation:T,isFullScreen:E,isMinimized:_,position:M,hideConfirmation:I,onToggleFullScreen:D,onToggleMinimize:R,handleCloseModal:z,handleSaveAndClose:O,handleCancel:L,onKeyDown:P,onMouseDown:B}=(t=>{const{isOpen:n,hasUnsavedChanges:a=!1,preventCloseIfUnsavedChanges:s=!1,onClose:r,onSaveAndClose:o,onCancel:i,modalRef:l}=t,[c,d]=e.useState(!1),[u,h]=e.useState(!1),[p,m]=e.useState(!1),[g,f]=e.useState({x:window.innerWidth/4,y:"20px"}),[y,b]=e.useState(!1),[v,x]=e.useState({x:0,y:0}),[w,C]=e.useState(""),[k,j]=e.useState(null),A=s&&a,S=!A,N=e.useCallback(()=>{f({x:window.innerWidth/4,y:"20px"}),h(!1),m(!1),d(!1),j(null),l.current&&(l.current.style.width="",l.current.style.height="")},[l]),T=e.useCallback(e=>{const t=l.current;t&&Object.prototype.hasOwnProperty.call(t,"showModal")&&(e?t.showModal():t.close())},[l]),E=e.useCallback(()=>{p&&(m(!1),l.current&&(l.current.style.height=w||""),k&&(f(k),j(null))),h(e=>!e)},[l,p,w,k]),_=e.useCallback(()=>{u&&!p&&h(!1),m(e=>(e?(l.current&&w&&(l.current.style.height=w),k&&f(k)):(l.current&&C(l.current.style.height||window.getComputedStyle(l.current).height),j({...g})),!e))},[l,p,u,w,g,k]),M=e.useCallback(()=>{d(!1)},[]),I=e.useCallback(()=>{if(A&&!c)return d(!0),void(p&&_());N(),r?.(),T(!1)},[p,A,c,_,N,r,T]),D=e.useCallback(()=>{N(),o?.(),T(!1)},[N,o,T]),R=e.useCallback(e=>{i?i(e):(e.preventDefault(),e.stopPropagation(),I())},[i,I]),z=e.useCallback(e=>{"Escape"===e.key&&S&&R(e)},[S,R]),O=e.useCallback(e=>{if(!l.current||u||p)return;b(!0);const t=l.current.getBoundingClientRect();x({x:e.clientX-t.left,y:e.clientY-t.top})},[u,p,l]),L=e.useCallback(e=>{if(!y||!l.current)return;const t=e.clientX-v.x,n=e.clientY-v.y,a=l.current.getBoundingClientRect(),s=window.innerWidth-a.width,r=window.innerHeight-a.height;f({x:`${Math.max(0,Math.min(t,s))}px`,y:`${Math.max(0,Math.min(n,r))}px`})},[y,v,l]),P=e.useCallback(()=>{b(!1)},[]);return e.useEffect(()=>(y?(document.addEventListener("mousemove",L,{passive:!0}),document.addEventListener("mouseup",P,{passive:!0})):(document.removeEventListener("mousemove",L),document.removeEventListener("mouseup",P)),()=>{document.removeEventListener("mousemove",L),document.removeEventListener("mouseup",P)}),[y,L,P]),e.useEffect(()=>{T(n)},[n,T]),{showConfirmation:c,isFullScreen:u,isMinimized:p,position:g,hideConfirmation:M,onToggleFullScreen:E,onToggleMinimize:_,handleCloseModal:I,handleSaveAndClose:D,handleCancel:R,onKeyDown:z,onMouseDown:O}})({...t,modalRef:x});e.useEffect(()=>{const e=document.getElementById("modal-root")||document.body;N(e)},[]),e.useEffect(()=>{if(!l||_)return;const e=e=>{"Escape"===e.key&&L(e)};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[l,_,L]),e.useLayoutEffect(()=>{if(l&&x.current&&!C){const e=()=>{if(x.current){const t=x.current.getBoundingClientRect().width;if(t>0){k(`${t}px`);const e=x.current.querySelectorAll(".tab-btn");A(e.length)}else requestAnimationFrame(e)}};requestAnimationFrame(e)}l||(k(void 0),A(0))},[l,C]);const F=e.useCallback(()=>{if(!x.current||!C)return;const e=x.current.querySelector(".tab-list");if(!e)return;const t=e.scrollWidth+40;t>parseFloat(C)&&k(`${t}px`)},[C]);e.useLayoutEffect(()=>{if(l&&x.current&&C){const e=x.current.querySelectorAll(".tab-btn").length;e!==j&&(A(e),F())}},[g,l,j,C,F]);const U=["modal",E?"modal-fullscreen":"no-wheel no-pan no-drag",_?"modal-minimized":"no-wheel no-pan no-drag",T?"confirmation no-wheel no-pan no-drag":"no-wheel no-pan no-drag",f].filter(Boolean).join(" ");if(!l||!S||!s)return null;const H={...C?{width:C}:{},...E?{}:_?{position:"fixed",bottom:"20px",right:"20px",top:"auto",left:"auto"}:{top:M.y,left:M.x}},W=$n.jsxs("div",{id:`${i}-modal`,className:"modal-root",children:[!v&&!_&&!E&&!f.includes("modal-fullscreen")&&$n.jsx("div",{className:"modal-backdrop",style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:999}}),$n.jsxs("div",{ref:x,id:o,"data-testid":c,onKeyDown:P,className:U,style:H,children:[!t.noHeader&&$n.jsxs("div",{className:"modal-header",ref:w,onMouseDown:B,children:[!_&&d&&$n.jsx("div",{children:d}),$n.jsxs("h3",{className:"modal-title font-semibold truncate",children:[u,y&&$n.jsx("span",{style:{color:"#f97316",marginLeft:"0.25rem"},children:"*"})]}),$n.jsxs("div",{className:"modal-header-actions",children:[m&&$n.jsx("div",{className:"modal-minimize-btn clickable",role:"button",title:_?"Restore":"Minimize",onClick:R,children:_?$n.jsx(hd,{}):$n.jsx(ud,{})}),p&&$n.jsx("div",{className:"modal-fullscreen-btn clickable",role:"button",title:E?"Restore":"Maximize",onClick:D,children:E?$n.jsx(fd,{}):$n.jsx(bd,{})}),h&&$n.jsx("div",{className:"modal-close-btn clickable",role:"button",title:"Close","data-testid":"modal-close-btn",onClick:z,children:$n.jsx(md,{})})]})]}),$n.jsx("div",{className:"modal-content "+(_?"hidden":""),children:T?ru({onSaveAndClose:b,hideConfirmation:I,handleSaveAndClose:O,handleCloseModal:z}):g})]})]});return a.createPortal(W,S)});function iu(e,[t,n]){return Math.min(n,Math.max(t,e))}ou.displayName="Modal";var lu=u.createContext(void 0);var cu=["PageUp","PageDown"],du=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],uu={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},hu="Slider",[pu,mu,gu]=function(t){const n=t+"CollectionProvider",[a,s]=Br(n),[r,o]=a(n,{collectionRef:{current:null},itemMap:new Map}),i=t=>{const{scope:n,children:a}=t,s=e.useRef(null),o=e.useRef(new Map).current;return $n.jsx(r,{scope:n,itemMap:o,collectionRef:s,children:a})};i.displayName=n;const l=t+"CollectionSlot",c=Ur(l),d=e.forwardRef((e,t)=>{const{scope:n,children:a}=e,s=Pr(t,o(l,n).collectionRef);return $n.jsx(c,{ref:s,children:a})});d.displayName=l;const u=t+"CollectionItemSlot",h="data-radix-collection-item",p=Ur(u),m=e.forwardRef((t,n)=>{const{scope:a,children:s,...r}=t,i=e.useRef(null),l=Pr(n,i),c=o(u,a);return e.useEffect(()=>(c.itemMap.set(i,{ref:i,...r}),()=>{c.itemMap.delete(i)})),$n.jsx(p,{[h]:"",ref:l,children:s})});return m.displayName=u,[{Provider:i,Slot:d,ItemSlot:m},function(n){const a=o(t+"CollectionConsumer",n);return e.useCallback(()=>{const e=a.collectionRef.current;if(!e)return[];const t=Array.from(e.querySelectorAll(`[${h}]`));return Array.from(a.itemMap.values()).sort((e,n)=>t.indexOf(e.ref.current)-t.indexOf(n.ref.current))},[a.collectionRef,a.itemMap])},s]}(hu),[fu,yu]=Br(hu,[gu]),[bu,vu]=fu(hu),xu=u.forwardRef((e,t)=>{const{name:n,min:a=0,max:s=100,step:r=1,orientation:o="horizontal",disabled:i=!1,minStepsBetweenThumbs:l=0,defaultValue:c=[a],value:d,onValueChange:h=()=>{},onValueCommit:p=()=>{},inverted:m=!1,form:g,...f}=e,y=u.useRef(new Set),b=u.useRef(0),v="horizontal"===o?ku:ju,[x=[],w]=kl({prop:d,defaultProp:c,onChange:e=>{const t=[...y.current];t[b.current]?.focus(),h(e)}}),C=u.useRef(x);function k(e,t,{commit:n}={commit:!1}){const o=function(e){return(String(e).split(".")[1]||"").length}(r),i=function(e,t){const n=Math.pow(10,t);return Math.round(e*n)/n}(Math.round((e-a)/r)*r+a,o),c=iu(i,[a,s]);w((e=[])=>{const a=function(e=[],t,n){const a=[...e];return a[n]=t,a.sort((e,t)=>e-t)}(e,c,t);if(function(e,t){if(t>0){const n=function(e){return e.slice(0,-1).map((t,n)=>e[n+1]-t)}(e);return Math.min(...n)>=t}return!0}(a,l*r)){b.current=a.indexOf(c);const t=String(a)!==String(e);return t&&n&&p(a),t?a:e}return e})}return $n.jsx(bu,{scope:e.__scopeSlider,name:n,disabled:i,min:a,max:s,valueIndexToChangeRef:b,thumbs:y.current,values:x,orientation:o,form:g,children:$n.jsx(pu.Provider,{scope:e.__scopeSlider,children:$n.jsx(pu.Slot,{scope:e.__scopeSlider,children:$n.jsx(v,{"aria-disabled":i,"data-disabled":i?"":void 0,...f,ref:t,onPointerDown:zr(f.onPointerDown,()=>{i||(C.current=x)}),min:a,max:s,inverted:m,onSlideStart:i?void 0:function(e){const t=function(e,t){if(1===e.length)return 0;const n=e.map(e=>Math.abs(e-t)),a=Math.min(...n);return n.indexOf(a)}(x,e);k(e,t)},onSlideMove:i?void 0:function(e){k(e,b.current)},onSlideEnd:i?void 0:function(){const e=C.current[b.current];x[b.current]!==e&&p(x)},onHomeKeyDown:()=>!i&&k(a,0,{commit:!0}),onEndKeyDown:()=>!i&&k(s,x.length-1,{commit:!0}),onStepKeyDown:({event:e,direction:t})=>{if(!i){const n=cu.includes(e.key)||e.shiftKey&&du.includes(e.key)?10:1,a=b.current;k(x[a]+r*n*t,a,{commit:!0})}}})})})})});xu.displayName=hu;var[wu,Cu]=fu(hu,{startEdge:"left",endEdge:"right",size:"width",direction:1}),ku=u.forwardRef((e,t)=>{const{min:n,max:a,dir:s,inverted:r,onSlideStart:o,onSlideMove:i,onSlideEnd:l,onStepKeyDown:c,...d}=e,[h,p]=u.useState(null),m=Pr(t,e=>p(e)),g=u.useRef(void 0),f=function(e){const t=u.useContext(lu);return e||t||"ltr"}(s),y="ltr"===f,b=y&&!r||!y&&r;function v(e){const t=g.current||h.getBoundingClientRect(),s=zu([0,t.width],b?[n,a]:[a,n]);return g.current=t,s(e-t.left)}return $n.jsx(wu,{scope:e.__scopeSlider,startEdge:b?"left":"right",endEdge:b?"right":"left",direction:b?1:-1,size:"width",children:$n.jsx(Au,{dir:f,"data-orientation":"horizontal",...d,ref:m,style:{...d.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:e=>{const t=v(e.clientX);o?.(t)},onSlideMove:e=>{const t=v(e.clientX);i?.(t)},onSlideEnd:()=>{g.current=void 0,l?.()},onStepKeyDown:e=>{const t=uu[b?"from-left":"from-right"].includes(e.key);c?.({event:e,direction:t?-1:1})}})})}),ju=u.forwardRef((e,t)=>{const{min:n,max:a,inverted:s,onSlideStart:r,onSlideMove:o,onSlideEnd:i,onStepKeyDown:l,...c}=e,d=u.useRef(null),h=Pr(t,d),p=u.useRef(void 0),m=!s;function g(e){const t=p.current||d.current.getBoundingClientRect(),s=zu([0,t.height],m?[a,n]:[n,a]);return p.current=t,s(e-t.top)}return $n.jsx(wu,{scope:e.__scopeSlider,startEdge:m?"bottom":"top",endEdge:m?"top":"bottom",size:"height",direction:m?1:-1,children:$n.jsx(Au,{"data-orientation":"vertical",...c,ref:h,style:{...c.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:e=>{const t=g(e.clientY);r?.(t)},onSlideMove:e=>{const t=g(e.clientY);o?.(t)},onSlideEnd:()=>{p.current=void 0,i?.()},onStepKeyDown:e=>{const t=uu[m?"from-bottom":"from-top"].includes(e.key);l?.({event:e,direction:t?-1:1})}})})}),Au=u.forwardRef((e,t)=>{const{__scopeSlider:n,onSlideStart:a,onSlideMove:s,onSlideEnd:r,onHomeKeyDown:o,onEndKeyDown:i,onStepKeyDown:l,...c}=e,d=vu(hu,n);return $n.jsx(Gr.span,{...c,ref:t,onKeyDown:zr(e.onKeyDown,e=>{"Home"===e.key?(o(e),e.preventDefault()):"End"===e.key?(i(e),e.preventDefault()):cu.concat(du).includes(e.key)&&(l(e),e.preventDefault())}),onPointerDown:zr(e.onPointerDown,e=>{const t=e.target;t.setPointerCapture(e.pointerId),e.preventDefault(),d.thumbs.has(t)?t.focus():a(e)}),onPointerMove:zr(e.onPointerMove,e=>{e.target.hasPointerCapture(e.pointerId)&&s(e)}),onPointerUp:zr(e.onPointerUp,e=>{const t=e.target;t.hasPointerCapture(e.pointerId)&&(t.releasePointerCapture(e.pointerId),r(e))})})}),Su="SliderTrack",Nu=u.forwardRef((e,t)=>{const{__scopeSlider:n,...a}=e,s=vu(Su,n);return $n.jsx(Gr.span,{"data-disabled":s.disabled?"":void 0,"data-orientation":s.orientation,...a,ref:t})});Nu.displayName=Su;var Tu="SliderRange",Eu=u.forwardRef((e,t)=>{const{__scopeSlider:n,...a}=e,s=vu(Tu,n),r=Cu(Tu,n),o=Pr(t,u.useRef(null)),i=s.values.length,l=s.values.map(e=>Ru(e,s.min,s.max)),c=i>1?Math.min(...l):0,d=100-Math.max(...l);return $n.jsx(Gr.span,{"data-orientation":s.orientation,"data-disabled":s.disabled?"":void 0,...a,ref:o,style:{...e.style,[r.startEdge]:c+"%",[r.endEdge]:d+"%"}})});Eu.displayName=Tu;var _u="SliderThumb",Mu=u.forwardRef((e,t)=>{const n=mu(e.__scopeSlider),[a,s]=u.useState(null),r=Pr(t,e=>s(e)),o=u.useMemo(()=>a?n().findIndex(e=>e.ref.current===a):-1,[n,a]);return $n.jsx(Iu,{...e,ref:r,index:o})}),Iu=u.forwardRef((e,t)=>{const{__scopeSlider:n,index:a,name:s,...r}=e,o=vu(_u,n),i=Cu(_u,n),[l,c]=u.useState(null),d=Pr(t,e=>c(e)),h=!l||(o.form||!!l.closest("form")),p=Qi(l),m=o.values[a],g=void 0===m?0:Ru(m,o.min,o.max),f=function(e,t){return t>2?`Value ${e+1} of ${t}`:2===t?["Minimum","Maximum"][e]:void 0}(a,o.values.length),y=p?.[i.size],b=y?function(e,t,n){const a=e/2,s=zu([0,50],[0,a]);return(a-s(t)*n)*n}(y,g,i.direction):0;return u.useEffect(()=>{if(l)return o.thumbs.add(l),()=>{o.thumbs.delete(l)}},[l,o.thumbs]),$n.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[i.startEdge]:`calc(${g}% + ${b}px)`},children:[$n.jsx(pu.ItemSlot,{scope:e.__scopeSlider,children:$n.jsx(Gr.span,{role:"slider","aria-label":e["aria-label"]||f,"aria-valuemin":o.min,"aria-valuenow":m,"aria-valuemax":o.max,"aria-orientation":o.orientation,"data-orientation":o.orientation,"data-disabled":o.disabled?"":void 0,tabIndex:o.disabled?void 0:0,...r,ref:d,style:void 0===m?{display:"none"}:e.style,onFocus:zr(e.onFocus,()=>{o.valueIndexToChangeRef.current=a})})}),h&&$n.jsx(Du,{name:s??(o.name?o.name+(o.values.length>1?"[]":""):void 0),form:o.form,value:m},a)]})});Mu.displayName=_u;var Du=u.forwardRef(({__scopeSlider:e,value:t,...n},a)=>{const s=u.useRef(null),r=Pr(s,a),o=Lc(t);return u.useEffect(()=>{const e=s.current;if(!e)return;const n=window.HTMLInputElement.prototype,a=Object.getOwnPropertyDescriptor(n,"value").set;if(o!==t&&a){const n=new Event("input",{bubbles:!0});a.call(e,t),e.dispatchEvent(n)}},[o,t]),$n.jsx(Gr.input,{style:{display:"none"},...n,ref:r,defaultValue:t})});function Ru(e,t,n){return iu(100/(n-t)*(e-t),[0,100])}function zu(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const a=(t[1]-t[0])/(e[1]-e[0]);return t[0]+a*(n-e[0])}}Du.displayName="RadioBubbleInput";var Ou=xu,Lu=Nu,Pu=Eu,Bu=Mu;const Fu=e.memo(t=>{const{name:n,value:a,label:s,onChange:r,onNull:o,onUpperLabel:i=null,onLowerLabel:l=null,setNullOnUpper:c=!1,setNullOnLower:d=!1,labelInfo:u=null,min:h=0,max:p=100,step:m=1,forceInt:g=!1,disabled:f=!1,dataTestId:y}=t,b=e.useMemo(()=>o??d?h:c?p:h,[o,d,c,h,p]),v=e.useMemo(()=>null!==a?a:b,[a,b]),x=e.useCallback(e=>{const t=e[0];"number"==typeof t&&r(t===p&&c||t===h&&d?null:g?Math.round(t):t)},[r,p,h,c,d,g]),w=e.useCallback(e=>{try{const t=g?parseInt(e.target.value,10):parseFloat(e.target.value);isNaN(t)||x([t])}catch(t){}},[g,x]),C=e.useCallback(()=>a!==p&&null!==a||!c&&null===i?a!==h&&null!==a||!d&&null===l?$n.jsx("span",{className:"margin-left-5 margin-bottom-5",children:$n.jsx("input",{id:`id-for-${n}`,name:n,placeholder:`${v}`,inputMode:"decimal",type:"number",min:h,max:p,step:m,value:v,onChange:w,"data-testid":y})}):$n.jsx("span",{className:"margin-left-5",children:l??"Not set"}):$n.jsx("span",{className:"margin-left-5",children:i??"No limit"}),[n,a,h,p,v,m,i,l,c,d,w,y]),k=e.useMemo(()=>u?$n.jsx("div",{className:"number-input-info-label-wrapper",children:$n.jsx(Hd,{htmlFor:`id-for-${n}`,label:s,info:u,children:C()})}):$n.jsx("div",{className:"number-input-label-wrapper",children:$n.jsxs("label",{htmlFor:`id-for-${n}`,children:[s," ",C()]})}),[n,s,C,u]);return $n.jsxs($n.Fragment,{children:[k,$n.jsxs(Ou,{className:"slider-root",value:[v],max:p,step:m,min:h,onValueChange:x,disabled:f,children:[$n.jsx(Lu,{className:"slider-track",children:$n.jsx(Pu,{className:"slider-range"})}),$n.jsx(Bu,{className:"slider-thumb"})]})]})});Fu.displayName="NumberInput";const Uu=(e,t,n,a)=>{if(void 0===e||"auto"===e)return;if("number"==typeof e)return e;const s=String(e).trim().toLowerCase(),r=parseFloat(s);return Number.isNaN(r)?void 0:s.endsWith("px")||/^[0-9.]+$/.test(s)?r:s.endsWith("vw")?r/100*n:s.endsWith("vh")?r/100*a:s.endsWith("%")?r/100*("w"===t?n:a):void 0},Hu=(e,t,n)=>Math.min(n??Number.POSITIVE_INFINITY,Math.max(t??Number.NEGATIVE_INFINITY,e)),Wu=({flowId:t,title:n="Panel",headerClassName:a="",headerLeft:s,headerRight:r,headerStyle:o={},minWidth:i=420,maxWidth:l=720,maxHeight:c=720,minHeight:d=50,rightOffset:u=10,bottomOffset:h=10,initialWidth:p="35vw",initialHeight:m=100,children:g})=>{const f=e.useCallback(()=>{const e=document.getElementById(`rf-root-${t}`);return e?e.getBoundingClientRect():new DOMRect(0,0,window.innerWidth,window.innerHeight)},[t]),y=e.useMemo(()=>{if("undefined"==typeof document||"undefined"==typeof window){const e=1200,t=800;return{w:Uu(p,"w",e,t)??Math.round(35*e/100),h:Uu(m,"h",e,t)??300}}const e=(document.getElementById(`rf-root-${t}`)||document.body).getBoundingClientRect(),n=e?.width??1200,a=e?.height??800,s=Uu(i,"w",n,a)??320,r=Uu(l,"w",n,a)??720,o=Uu(d,"h",n,a)??100,u=Uu(c,"h",n,a)??720,h=Uu(p,"w",n,a)??Math.round(35*n/100),g=Uu(m,"h",n,a)??300;return{w:Hu(h,Math.min(s,r),Math.max(s,r)),h:Hu(g,Math.min(o,u),Math.max(o,u))}},[t,i,l,d,c,p,m]),[b,v]=e.useState(0),[x,w]=e.useState(0),[C,k]=e.useState(y.w),[j,A]=e.useState(y.h),[S,N]=e.useState(!1),T=e.useRef(null),E=e.useRef(null),_=e.useRef(null),M=e.useCallback((e,t)=>{const n=f(),a=n.width,s=n.height,r=Uu(i,"w",a,s),o=Uu(l,"w",a,s),p=Uu(d,"h",a,s),m=Uu(c,"h",a,s),g=a-u-10,y=s-h-10,b=Math.max(r??0,120),v=Math.min(o??Number.POSITIVE_INFINITY,g),x=Math.max(p??0,80),w=Math.min(m??Number.POSITIVE_INFINITY,y);return{w:Hu(e,b,v),h:Hu(t,x,w)}},[f,i,l,d,c,u,h]),I=e.useCallback((e,t,n=C,a=j)=>{const s=f(),r=s.width,o=s.height,i=Math.max(10,r-n-10),l=Math.max(10,o-a-10);return{l:Math.min(Math.max(e,10),i),t:Math.min(Math.max(t,10),l)}},[C,j,f]);e.useEffect(()=>{const e=f(),t=e.width,n=e.height,a=M(y.w,y.h),s=t-a.w-u,r=n-a.h-h,{l:o,t:i}=I(s,r,a.w,a.h);k(a.w),A(a.h),v(o),w(i)},[y.w,y.h,u,h,M,I,f]),e.useEffect(()=>{const e=()=>{if(S)return;const e=M(C,j),t=I(b,x,e.w,e.h);k(e.w),A(e.h),v(t.l),w(t.t)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[S,b,x,C,j]);const D=e=>{if(!_.current)return;const t=e.clientX-_.current.startX,n=e.clientY-_.current.startY,{l:a,t:s}=I(_.current.startLeft+t,_.current.startTop+n);v(a),w(s)},R=()=>{_.current=null,window.removeEventListener("pointermove",D)},z={position:"absolute",left:b,top:x,width:C,height:j,maxWidth:l,maxHeight:c,minWidth:i,minHeight:d,zIndex:1e6,resize:"both"},O={position:"absolute",right:u,bottom:h,zIndex:1e6,minWidth:260};return $n.jsxs("div",{ref:E,className:"floating-panel "+(S?"is-collapsed":"is-expanded"),style:S?O:z,"aria-expanded":!S,children:[$n.jsxs("div",{className:`fp-header ${a}`,style:{display:"flex",alignItems:"center",justifyContent:"space-between",...o},onPointerDown:e=>{S||(e.target.setPointerCapture?.(e.pointerId),_.current={startX:e.clientX,startY:e.clientY,startLeft:b,startTop:x},window.addEventListener("pointermove",D),window.addEventListener("pointerup",R,{once:!0}))},role:"toolbar","aria-label":"Panel header",children:[s&&$n.jsx("div",{className:"fp-left",style:{display:"flex",alignItems:"center",gap:8},children:s}),$n.jsx("div",{className:"fp-title",title:"string"==typeof n?n:void 0,children:n}),$n.jsxs("div",{className:"fp-right",style:{display:"flex",alignItems:"center",gap:0},children:[$n.jsx("button",{title:S?"Expand":"Collapse",type:"button",onClick:()=>{if(S){const e=T.current??{left:b,top:x,width:C,height:j},t=M(e.width,e.height),n=I(e.left,e.top,t.w,t.h);k(t.w),A(t.h),v(n.l),w(n.t),N(!1)}else T.current={left:b,top:x,width:C,height:j},N(!0)},className:"fp-toggle","aria-label":S?"Expand panel":"Collapse panel",children:S?$n.jsx(hd,{size:14}):$n.jsx(ud,{size:14})}),r]})]}),!S&&$n.jsx("div",{className:"fp-content",children:g??$n.jsx("div",{style:{padding:12},children:"Your content here…"})})]})},qu=e=>{try{return null===e?"none":"string"==typeof e?e:JSON.stringify(e)}catch{return String(e)}},Vu=()=>{const[t,n]=e.useState("spin");return e.useEffect(()=>{const e=setTimeout(()=>n("done"),2e3);return()=>clearTimeout(e)},[]),"spin"===t?$n.jsxs("div",{className:"flex-align-center items-center gap-2",children:[$n.jsx("span",{className:"animate-spin inline-block",children:"⏳"}),$n.jsx("span",{children:"Resuming a previously stored state…"})]}):$n.jsx("div",{children:"✅ Resume complete!"})},Gu=e=>({sender:e.sender||e.content.sender,recipient:e.recipient||e.content.recipient}),Ku=e=>{if(!e.type){const t=e;if(t.event&&t.event.type)return Ku(t.event)}switch(e.type){case"empty":{const t=e;return $n.jsx("div",{className:"text-gray-700 font-large",children:t.content})}case"text":{const t=e.content,{sender:n,recipient:a}=Gu(e);return $n.jsxs("div",{children:[$n.jsxs("div",{className:"text-amber-500 font-semibold",children:[n," ",$n.jsx("span",{className:"text-gray-400",children:"→"})," ",a]}),"string"==typeof t.content?$n.jsx("pre",{className:"whitespace-pre-wrap break-words mt-1",children:t.content}):"object"==typeof t.content?$n.jsx("pre",{className:"whitespace-pre-wrap break-words mt-1",children:JSON.stringify(t.content)}):$n.jsx("pre",{className:"whitespace-pre-wrap break-words mt-1",children:String(t.content)})]})}case"post_carryover_processing":{const t=e.content,{sender:n,recipient:a}=Gu(e);return $n.jsxs("div",{children:[$n.jsxs("div",{className:"text-pink-500 font-semibold",children:[n," ",$n.jsx("span",{className:"text-gray-400",children:"→"})," ",a]}),$n.jsx("pre",{className:"whitespace-pre-wrap break-words mt-1",children:t.message})]})}case"group_chat_run_chat":{const t=e.content;return $n.jsxs("div",{className:"text-green-600 font-semibold",children:["Next speaker: ",e.speaker||t.speaker]})}case"using_auto_reply":{const{sender:t,recipient:n}=Gu(e);return $n.jsxs("div",{className:"text-gray-700",children:["sender=",t,", recipient=",n]})}case"tool_call":{const t=e.content,{sender:n,recipient:a}=Gu(e);return $n.jsxs("div",{children:[$n.jsxs("div",{className:"text-gray-700 mb-1",children:[$n.jsx("span",{className:"font-medium",children:n})," ",$n.jsx("span",{className:"text-gray-400",children:"→"})," ",$n.jsx("span",{className:"font-medium",children:a})]}),$n.jsx("div",{className:"space-y-1",children:t.tool_calls?.map((e,t)=>{const n=e.function.arguments&&"{}"!==e.function.arguments?e.function.arguments:"none";return $n.jsxs("div",{className:"flex-align-center items-start gap-2",children:[$n.jsx("span",{children:"🔧"}),$n.jsxs("div",{children:[$n.jsxs("div",{className:"font-semibold",children:["Calling: ",e.function.name]}),$n.jsxs("div",{className:"text-xs text-gray-600 break-words",children:["args: ",n]})]})]},t)})})]})}case"execute_function":{const t=e.content,{recipient:n}=Gu(e);return $n.jsxs("div",{children:[$n.jsxs("div",{className:"font-semibold",children:["⚡ Executing: ",t.func_name]}),$n.jsxs("div",{className:"text-sm text-gray-700",children:["→ Target: ",n]}),$n.jsxs("div",{className:"text-xs text-gray-600 break-words",children:["→ Args: ",qu(e.arguments||t.arguments)]})]})}case"executed_function":{const t=e.content?e.content:e,n=!!t.is_exec_success,a="object"==typeof t.content&&t.content&&"agent_name"in t.content?t.content.agent_name:void 0;return $n.jsxs("div",{children:[$n.jsxs("div",{className:n?"text-green-600 font-semibold":"text-red-600 font-semibold",children:[n?"✅ Success":"❌ Failed",": ",t.func_name]}),a&&$n.jsxs("div",{className:"text-sm",children:["→ Transferred to: ",a]})]})}case"input_request":case"debug_input_request":{const t=e.content?e.content:e;return $n.jsxs("div",{children:[$n.jsx("div",{className:"font-semibold",children:"👤 Provide your input:"}),t.prompt&&$n.jsx("div",{className:"text-sm",children:t.prompt})]})}case"tool_response":{const t=e.content?e.content:e,{sender:n,recipient:a}=Gu(e);return $n.jsxs("div",{children:[$n.jsx("div",{children:"🔄 Tool Response:"}),$n.jsx("pre",{className:"whitespace-pre-wrap break-words",children:t.content}),$n.jsxs("div",{className:"text-xs",children:["→ From: ",n," to ",a]})]})}case"termination":{const t=e.content?e.content:e;return $n.jsxs("div",{children:[$n.jsx("div",{className:"font-semibold",children:"Termination met"}),t.termination_reason&&$n.jsxs("div",{className:"text-sm",children:["→ Termination_reason: ",t.termination_reason]})]})}case"termination_and_human_reply_no_input":{const t=e.content?e.content:e;return $n.jsxs("div",{children:[$n.jsx("div",{className:"font-semibold",children:"No human input"}),t.no_human_input_msg&&$n.jsxs("div",{className:"text-sm",children:["→ Message: ",t.no_human_input_msg]})]})}case"run_completion":return $n.jsx("div",{className:"font-semibold",children:"🏁 Run completed"});case"generate_code_execution_reply":return $n.jsx("div",{className:"font-semibold",children:"💻 Code executed"});case"group_chat_resume":return $n.jsx(Vu,{});case"info":return $n.jsx("div",{className:"info",children:"string"==typeof e.content?e.content:JSON.stringify(e.content)});case"error":return!e.content&&e.error?$n.jsx("div",{className:"error",children:e.error}):$n.jsx("div",{className:"error",children:"string"==typeof e.content?e.content:JSON.stringify(e.content)});default:return $n.jsxs("div",{className:"text-amber-700",children:["⚠️ Unknown event type: ",$n.jsx("span",{className:"font-mono",children:e.type}),$n.jsxs("pre",{className:"text-xs text-blue-600/80 mb-2 break-words",children:["Raw event: ",JSON.stringify(e,null,2)]})]})}},$u=({events:t,printRaw:n,autoScroll:a,className:s})=>{const r=e.useRef(null);return e.useEffect(()=>{if(!a||!r.current)return;const e=r.current;"function"==typeof e.scrollTo?r.current.scrollTo({top:r.current.scrollHeight,behavior:"smooth"}):e.scrollTop=e.scrollHeight},[t,a]),$n.jsx("div",{className:["flex-align-center flex-column full-height json",s].filter(Boolean).join(" "),"data-testid":"events-console",children:$n.jsx("div",{ref:r,className:"flex-1 full-width overflow-auto p-3 space-y-3 text-sm font-mono leading-5",children:t.map((e,t)=>$n.jsxs("div",{className:"empty"===e.type?"center":"entry",children:[n&&$n.jsxs("div",{className:"text-xs text-blue-600/80 mb-2 break-words",children:["Raw event: ",JSON.stringify(e,null,2)]}),Ku(e)]},e.id??t))})})},Zu=e=>Symbol.iterator in e,Qu=e=>"entries"in e,Yu=(e,t)=>{const n=e instanceof Map?e:new Map(e.entries()),a=t instanceof Map?t:new Map(t.entries());if(n.size!==a.size)return!1;for(const[s,r]of n)if(!a.has(s)||!Object.is(r,a.get(s)))return!1;return!0};function Xu(e,t){return!!Object.is(e,t)||"object"==typeof e&&null!==e&&"object"==typeof t&&null!==t&&(Object.getPrototypeOf(e)===Object.getPrototypeOf(t)&&(Zu(e)&&Zu(t)?Qu(e)&&Qu(t)?Yu(e,t):((e,t)=>{const n=e[Symbol.iterator](),a=t[Symbol.iterator]();let s=n.next(),r=a.next();for(;!s.done&&!r.done;){if(!Object.is(s.value,r.value))return!1;s=n.next(),r=a.next()}return!!s.done&&!!r.done})(e,t):Yu({entries:()=>Object.entries(e)},{entries:()=>Object.entries(t)})))}var Ju,eh={exports:{}},th={},nh={exports:{}},ah={};function sh(){if(Ju)return ah;Ju=1;var t=e;var n="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},a=t.useState,s=t.useEffect,r=t.useLayoutEffect,o=t.useDebugValue;function i(e){var t=e.getSnapshot;e=e.value;try{var a=t();return!n(e,a)}catch(s){return!0}}var l="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),l=a({inst:{value:n,getSnapshot:t}}),c=l[0].inst,d=l[1];return r(function(){c.value=n,c.getSnapshot=t,i(c)&&d({inst:c})},[e,n,t]),s(function(){return i(c)&&d({inst:c}),e(function(){i(c)&&d({inst:c})})},[e]),o(n),n};return ah.useSyncExternalStore=void 0!==t.useSyncExternalStore?t.useSyncExternalStore:l,ah}var rh,oh,ih,lh={};function ch(){return rh||(rh=1,"production"!==process.env.NODE_ENV&&function(){function t(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!a(e,n)}catch(s){return!0}}"undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(Error());var n=e,a="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},s=n.useState,r=n.useEffect,o=n.useLayoutEffect,i=n.useDebugValue,l=!1,c=!1,d="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,d){l||void 0===n.startTransition||(l=!0);var u=d();if(!c){var h=d();a(u,h)||(c=!0)}var p=(h=s({inst:{value:u,getSnapshot:d}}))[0].inst,m=h[1];return o(function(){p.value=u,p.getSnapshot=d,t(p)&&m({inst:p})},[e,u,d]),r(function(){return t(p)&&m({inst:p}),e(function(){t(p)&&m({inst:p})})},[e]),i(u),u};lh.useSyncExternalStore=void 0!==n.useSyncExternalStore?n.useSyncExternalStore:d,"undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(Error())}()),lh}function dh(){return oh||(oh=1,"production"===process.env.NODE_ENV?nh.exports=sh():nh.exports=ch()),nh.exports}function uh(){if(ih)return th;ih=1;var t=e,n=dh();var a="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},s=n.useSyncExternalStore,r=t.useRef,o=t.useEffect,i=t.useMemo,l=t.useDebugValue;return th.useSyncExternalStoreWithSelector=function(e,t,n,c,d){var u=r(null);if(null===u.current){var h={hasValue:!1,value:null};u.current=h}else h=u.current;u=i(function(){function e(e){if(!o){if(o=!0,s=e,e=c(e),void 0!==d&&h.hasValue){var t=h.value;if(d(t,e))return r=t}return r=e}if(t=r,a(s,e))return t;var n=c(e);return void 0!==d&&d(t,n)?(s=e,t):(s=e,r=n)}var s,r,o=!1,i=void 0===n?null:n;return[function(){return e(t())},null===i?void 0:function(){return e(i())}]},[t,n,c,d]);var p=s(e,u[0],u[1]);return o(function(){h.hasValue=!0,h.value=p},[p]),l(p),p},th}var hh,ph,mh={};function gh(){return hh||(hh=1,"production"!==process.env.NODE_ENV&&function(){"undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(Error());var t=e,n=dh(),a="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},s=n.useSyncExternalStore,r=t.useRef,o=t.useEffect,i=t.useMemo,l=t.useDebugValue;mh.useSyncExternalStoreWithSelector=function(e,t,n,c,d){var u=r(null);if(null===u.current){var h={hasValue:!1,value:null};u.current=h}else h=u.current;u=i(function(){function e(e){if(!o){if(o=!0,s=e,e=c(e),void 0!==d&&h.hasValue){var t=h.value;if(d(t,e))return r=t}return r=e}if(t=r,a(s,e))return t;var n=c(e);return void 0!==d&&d(t,n)?(s=e,t):(s=e,r=n)}var s,r,o=!1,i=void 0===n?null:n;return[function(){return e(t())},null===i?void 0:function(){return e(i())}]},[t,n,c,d]);var p=s(e,u[0],u[1]);return o(function(){h.hasValue=!0,h.value=p},[p]),l(p),p},"undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(Error())}()),mh}function fh(){return ph||(ph=1,"production"===process.env.NODE_ENV?eh.exports=uh():eh.exports=gh()),eh.exports}const yh=V(fh()),bh=e=>{let t;const n=new Set,a=(e,a)=>{const s="function"==typeof e?e(t):e;if(!Object.is(s,t)){const e=t;t=(null!=a?a:"object"!=typeof s||null===s)?s:Object.assign({},t,s),n.forEach(n=>n(t,e))}},s=()=>t,r={setState:a,getState:s,getInitialState:()=>o,subscribe:e=>(n.add(e),()=>n.delete(e))},o=t=e(a,s,r);return r},vh=e=>e?bh(e):bh,{useSyncExternalStoreWithSelector:xh}=yh,wh=e=>e;function Ch(t,n=wh,a){const s=xh(t.subscribe,t.getState,t.getInitialState,n,a);return e.useDebugValue(s),s}const kh=e.createContext(null);function jh(t,n){const a=e.useContext(kh);if(!a)throw new Error("Missing WaldiezContext.Provider in the tree");return Ch(a,t,Xu)}const Ah={Date:!0,RegExp:!0,String:!0,Number:!0};function Sh(e,t,n={cyclesFix:!0},a=[]){let s=[];const r=Array.isArray(e);for(const i in e){const o=e[i],l=r?+i:i;if(!(i in t)){s.push({type:"REMOVE",path:[l],oldValue:e[i]});continue}const c=t[i],d="object"==typeof o&&"object"==typeof c&&Array.isArray(o)===Array.isArray(c);!(o&&c&&d)||Ah[Object.getPrototypeOf(o)?.constructor?.name]||n.cyclesFix&&a.includes(o)?o===c||Number.isNaN(o)&&Number.isNaN(c)||d&&(isNaN(o)?o+""==c+"":+o===+c)||s.push({path:[l],type:"CHANGE",value:c,oldValue:o}):s.push.apply(s,Sh(o,c,n,n.cyclesFix?a.concat([o]):[]).map(e=>(e.path.unshift(l),e)))}const o=Array.isArray(t);for(const i in t)i in e||s.push({type:"CREATE",path:[o?+i:i],value:t[i]});return s}var Nh=(e,t,n)=>(a,s)=>({pastStates:n?.pastStates||[],futureStates:n?.futureStates||[],undo:(r=1)=>{if(s().pastStates.length){const o=n?.partialize?.(t())||t(),i=s().pastStates.splice(-r,r),l=i.shift();e(l),a({pastStates:s().pastStates,futureStates:s().futureStates.concat(n?.diff?.(o,l)||o,i.reverse())})}},redo:(r=1)=>{if(s().futureStates.length){const o=n?.partialize?.(t())||t(),i=s().futureStates.splice(-r,r),l=i.shift();e(l),a({pastStates:s().pastStates.concat(n?.diff?.(o,l)||o,i.reverse()),futureStates:s().futureStates})}},clear:()=>a({pastStates:[],futureStates:[]}),isTracking:!0,pause:()=>a({isTracking:!1}),resume:()=>a({isTracking:!0}),setOnSave:e=>a({_onSave:e}),_onSave:n?.onSave,_handleSet:(e,t,r,o)=>{n?.limit&&s().pastStates.length>=n?.limit&&s().pastStates.shift(),s()._onSave?.(e,r),a({pastStates:s().pastStates.concat(o||e),futureStates:[]})}});const Th=(e,t,n,a)=>{let s,r;return t.target!==e||a.targetsOnly||(r=n.find(e=>e.id===t.source)),t.source!==e||a.sourcesOnly||(s=n.find(e=>e.id===t.target)),{sourceNode:r,targetNode:s}},Eh=(e,t,n,a={x:200,y:140})=>{const s=ne(t);if(!s)return{x:0,y:0};const r=s.querySelector(".react-flow-wrapper");return r?((e,t,n,a)=>{const s=e?.getZoom()??1,r=t.getBoundingClientRect().width/s,o=Math.floor(r/(1.1*a.x)),i=n%o*a.x;let l=Math.floor(n/o)*a.y;return 0===l?l+=10:l-=5,{x:i,y:l}})(n,r,e,a):{x:0,y:0}},_h=e=>{if(e){const t=e.getZoom();e.setViewport({zoom:t,x:20,y:40}).then(()=>{})}},Mh=(e,t,n,a)=>{let s=0;const r=[];return e.forEach(e=>{if(e.type===n){const n=Eh(s,t,a);r.push({...e,position:n}),s++}else r.push(e)}),r},Ih=(e,n)=>({markerEnd:"nested"!==e?{type:t.MarkerType.ArrowClosed,color:n,width:10,height:10}:void 0,style:{stroke:n,strokeWidth:1}}),Dh=(e,t)=>`${e.data.label.slice(0,15)} => ${t.data.label.slice(0,15)}`,Rh=e=>{const{flowId:t,hidden:n,positionGetter:a,sourceNode:s,targetNode:r,edges:o}=e;if(((e,t)=>void 0!==e.data.parentId||void 0!==t.data.parentId||"group_manager"===e.data.agentType||"group_manager"===t.data.agentType)(s,r)&&((e,t,n,a)=>{if("string"!=typeof e.data.agentType||"string"!=typeof t.data.agentType)return Mr({flowId:a,message:`Could not create a connection from ${e.data.label} to ${t.data.label}`,level:"warning",details:"Invalid agent type",withCloseButton:!0}),!0;if(!e.data.parentId&&!["user_proxy","rag_user_proxy","group_manager"].includes(e.data.agentType))return Mr({flowId:a,message:`Invalid source agent type: ${s=e.data.agentType,s.replace(/([A-Z])/g," $1").replace(/([0-9])/g," $1").replace(/_/g," ").replace(/-/g," ").trim().toLowerCase().split(" ").map(e=>ve(e)).join(" ")}`,level:"warning",details:void 0,withCloseButton:!0}),!0;var s;if(!e.data.parentId&&t.data.parentId)return Mr({flowId:a,message:"A connection from a non-group member to a group member is not allowed",level:"warning",details:void 0,withCloseButton:!0}),!0;if("group_manager"===t.data.agentType&&n.filter(e=>e.target===t.id).length>0)return Mr({flowId:a,message:"A connection to this group manager already exists",level:"warning",details:void 0,withCloseButton:!0}),!0;return!1})(s,r,o,t))return null;const i=s.data.agentType,{chat:l,chatType:c}=zh(s,r,n,a),d=es(l),u=Sn[i];return{...d,type:c,animated:!!s.data.parentId&&!r.data.parentId,selected:!0,...Ih(c,u)}},zh=(e,t,n,a)=>{const s=Dh(e,t),r=e.data.agentType,o=t.data.agentType,i=new ya;i.sourceType=r,i.targetType=o,i.description=`${e.data.label} to ${t.data.label}`,i.condition={conditionType:"string_llm",prompt:""},i.name=s,i.order=-1;const l=((e,t,n)=>n?"hidden":"group_manager"===e.data.agentType||"group_manager"===t.data.agentType||void 0!==e.data.parentId||void 0!==t.data.parentId?"group":"chat")(e,t,n);i.position=a(l);return{chat:new ba({id:`wc-${ee()}`,data:i,type:l,source:e.id,target:t.id,rest:{}}),chatType:l}},Oh=(e,t)=>{const n=e.filter(e=>e.type===t),a={};return n.forEach(e=>{a[e.source]||(a[e.source]=[]),a[e.source]?.push(e)}),n.map((e,t)=>({...e,data:{...e.data,position:t+1}}))},Lh=(e,t)=>{Fh(e,t),Bh(e,t)},Ph=(e,t,n)=>{const a=(new Date).toISOString(),s=new Map(e.map(e=>[e.id,e])),r=t=>t.data&&t.data.prerequisites&&0!==t.data.prerequisites.length?Math.max(...t.data.prerequisites.map(t=>{const n=e.find(e=>e.id===t);return n?.data?.order??0}))+1:0;let o=!0;for(;o;){o=!1;for(const t of e){const e=r(t);s.get(t.id).data?.order!==e&&(s.get(t.id).data.order=e,o=!0)}}const i=Array.from(s.values()),l=t().edges.filter(e=>!i.find(t=>t.id===e.id)).map(e=>({...e,data:{...e.data,order:-1,prerequisites:[]}}));n({edges:[...i,...l],updatedAt:a})},Bh=(e,t)=>{e().isAsync?((e,t)=>{const n=e().edges.filter(e=>void 0!==e.data?.order&&e.data.order>=0);Ph(n,e,t)})(e,t):((e,t)=>{const n=e().edges.slice().sort((e,t)=>(e.data?.order??-1)-(t.data?.order??-1)),a=new Set;t({edges:n.map(e=>{let t=e.data?.order;if(!t||t<0)return{...e,data:{...e.data,order:t}};for(;t>0&&a.has(t);)t++;return a.add(t),{...e,data:{...e.data,order:t}}}),updatedAt:(new Date).toISOString()})})(e,t)},Fh=(e,t)=>{const n=e().edges.map(e=>({...e,data:{...e.data,position:1}})),a=(e=>Oh(e,"chat"))(n),s=(e=>Oh(e,"nested"))(n),r=(e=>Oh(e,"hidden"))(n),o=(e=>Oh(e,"group"))(n),i=[...a,...s,...r,...o],l=i.map(e=>e.id),c=Array.from(new Set(l));t({edges:i.filter(e=>c.includes(e.id)),updatedAt:(new Date).toISOString()}),((e,t)=>{const n=e().nodes.filter(e=>"agent"===e.type),a=[],s=[];n.forEach(t=>{(t.data.nestedChats??[]).forEach(t=>{const n=t.messages;let r=0;n.forEach(t=>{const n=e().edges.find(e=>e.id===t.id);n&&"nested"===n.type&&!s.includes(n.id)&&(a.push({...n,data:{...n.data,position:r+1}}),s.push(n.id),r++)})})}),t({edges:[...e().edges.filter(e=>!s.includes(e.id)),...a],updatedAt:(new Date).toISOString()})})(e,t)},Uh=(e,t)=>Array.from(new Set([...e,...t])),Hh=(e,t)=>Array.from(new Set([...e,...t])),Wh=(e,t,n)=>{if(0===e.length&&0===t.length)return n.map(t=>{const n=Kh(t,e),a="hidden"===t.type;return{...t,animated:n,hidden:a}});const a=n.map(e=>({...e,data:{...e.data,order:-1}})).filter(e=>!t.find(t=>t.id===e.id));return[...t,...a].map(t=>{const n=Kh(t,e),a="hidden"===t.type;return{...t,animated:n,hidden:a}})},qh=(e,t,n)=>{const a=t.filter(t=>!e.find(e=>e.id===t.id));return[...e,...a].map(e=>e.type===n?{...e,hidden:!1}:{...e,hidden:!0})},Vh=(e,t,n,a)=>0===n.length&&0===a.length?t:e,Gh=(e,t,n,a,s)=>{e.name&&(s.name=n.name),e.description&&(s.description=n.description),e.tags&&(s.tags=Uh(t.tags,n.tags)),e.requirements&&(s.requirements=Hh(t.requirements,n.requirements)),e.isAsync&&(s.isAsync=n.isAsync??t.isAsync),e.cacheSeed&&(s.cacheSeed=n.cacheSeed??t.cacheSeed??42);const r=[...e.nodes.models,...e.nodes.tools,...e.nodes.agents].map(e=>e.id),o=n.nodes.filter(e=>r.includes(e.id)),i=e.override?o:qh(t.nodes,o,a);s.nodes=i,s.edges=e.override?n.edges:Wh(i,t.edges,n.edges)},Kh=(e,t)=>{if("nested"===e.type)return!0;t.find(t=>t.id===e.source),t.find(t=>t.id===e.target);return!1},$h=(e,t)=>{const n=Mh(e().nodes,e().flowId,"model",e().rfInstance);return t({nodes:n,updatedAt:(new Date).toISOString()}),n},Zh=(e,t)=>{const n=Mh(e().nodes,e().flowId,"tool",e().rfInstance);return t({nodes:n,updatedAt:(new Date).toISOString()}),n};class Qh{get;set;constructor(e,t){this.get=e,this.set=t}static create(e,t){return new Qh(e,t)}getAgents=()=>this.get().nodes.filter(e=>"agent"===e.type);getAgentById=e=>{const t=this.get().nodes.find(t=>t.id===e);return t&&"agent"===t.type?t:null};addAgent=(e,t,n)=>{const a=((e,t,n)=>{const a=xe.create(e),s=ia(a,t);if(s.data.parentId=n,"rag_user_proxy"===e){const e=new Le;s.data={...s.data,...e}}else if("reasoning"===e){const e=new Fe;s.data={...s.data,...e}}else if("captain"===e){const e=new _e;s.data={...s.data,...e}}else if("group_manager"===e){const e=new Re;e.groupName="Group",s.data={...s.data,...e}}return n&&(s.parentId=n,s.extent="parent"),s})(e,t,n);return a.style={width:"group_manager"===e?aa.width:"user_proxy"!==e?sa.width:na.width},"group_manager"===e?this.set({nodes:[a,...this.get().nodes],updatedAt:(new Date).toISOString()}):this.set({nodes:[...this.get().nodes,a],updatedAt:(new Date).toISOString()}),a};cloneAgent=e=>{const t=this.get().nodes.find(t=>t.id===e);if(t){const e=t.data.label+" (copy)",n={x:t.position.x+(t.width??100)+40,y:t.position.y+(t.height??100)+40},a={...t,position:n,id:ee(),data:{...t.data,label:e}};return this.set({nodes:[...this.get().nodes,a],updatedAt:(new Date).toISOString()}),setTimeout(()=>{this.set({nodes:this.get().nodes.map(e=>e.id===a.id?{...e,selected:!0}:{...e,selected:!1})})},10),a}return null};updateAgentData=(e,t)=>{this.set({nodes:this.get().nodes.map(n=>n.id===e?(t.parentId!==n.data.parentId&&(n.parentId=t.parentId??void 0,n.extent=t.parentId?"parent":void 0),{...n,data:{...n.data,...t}}):n),updatedAt:(new Date).toISOString()}),Lh(this.get,this.set)};deleteAgent=e=>{const t=this.get().nodes.find(t=>t.id===e);if(t){const n=[e],a=[];if("group_manager"===t.data.agentType){const t=this.getGroupMembers(e);a.push(...t.map(e=>e.id))}this.set({nodes:this.get().nodes.filter(e=>!n.includes(e.id)).map(e=>(a.includes(e.id)&&(e.parentId=void 0,e.data.parentId=void 0,e.extent=void 0),e)),edges:this.get().edges.filter(e=>!n.includes(e.source)&&!n.includes(e.target)).map(e=>a.includes(e.source)||a.includes(e.target)?{...e,animated:!1,type:"chat"}:e),updatedAt:(new Date).toISOString()})}else this.set({nodes:this.get().nodes.filter(t=>t.id!==e),edges:this.get().edges.filter(t=>t.source!==e&&t.target!==e),updatedAt:(new Date).toISOString()});Lh(this.get,this.set)};importAgent=(e,t,n,a,s=!0)=>{const r=ra(e,t),o=ia(r,a,n);return a&&(o.position=a),s&&this.set({nodes:[...this.get().nodes,{...o}],updatedAt:(new Date).toISOString()}),o};exportAgent=(e,t)=>{const n=this.get().nodes.find(t=>t.id===e);return n?oa(n,t):{}};getAgentConnections=(e,t)=>(t||(t={sourcesOnly:!1,targetsOnly:!1}),((e,t,n,a)=>{a||(a={sourcesOnly:!1,targetsOnly:!1});const s=[],r=[],o=[],i=[];for(const l of t){const{sourceNode:t,targetNode:c}=Th(n,l,e,a);t&&(s.push(t),r.push(l)),c&&(o.push(c),i.push(l))}return{sources:{nodes:s,edges:r},targets:{nodes:o,edges:i}}})(this.get().nodes,this.get().edges,e,t));setAgentGroup=(e,t,n)=>{this.set({nodes:this.get().nodes.map(a=>a.id===e?{...a,position:n??a.position,parentId:t,extent:"parent",data:{...a.data,parentId:t}}:a),updatedAt:(new Date).toISOString()})};getGroupMembers=e=>this.get().nodes.filter(t=>"agent"===t.type&&t.data.parentId===e);addGroupMember=(e,t,n)=>{this.set({nodes:this.get().nodes.map(a=>a.id===t?{...a,position:n||a.position,parentId:e,extent:"parent",data:{...a.data,parentId:e}}:a),updatedAt:(new Date).toISOString()}),Lh(this.get,this.set)};removeGroupMember=(e,t)=>{const n=[...this.get().nodes.map(n=>(n.id===t&&n.data.parentId===e&&(n.data.parentId=void 0,n.parentId=void 0,n.extent=void 0,n.position={x:n.position.x+50,y:n.position.y+50}),{...n}))];this.set({nodes:n,updatedAt:(new Date).toISOString()}),Lh(this.get,this.set)};getGroupManager=()=>{const e=this.get().nodes.filter(e=>"agent"===e.type).find(e=>"group_manager"===e.data.agentType);if(e)return e}}class Yh{get;set;constructor(e,t){this.get=e,this.set=t}static create(e,t){return new Yh(e,t)}setActiveParticipants=(e,t)=>{const{activeSenderId:n,activeRecipientId:a}=this.get();n===e&&a===t||this.set({activeSenderId:e,activeRecipientId:t})};resetActiveParticipants=()=>{const{activeSenderId:e,activeRecipientId:t}=this.get();null===e&&null===t||this.set({activeSenderId:null,activeRecipientId:null})};setActiveEventType=e=>{this.set({activeEventType:e})};resetActiveEventType=()=>{this.set({activeEventType:null})}}class Xh{get;set;constructor(e,t){this.get=e,this.set=t}static create(e,t){return new Xh(e,t)}getEdges=()=>this.get().edges;getEdgeById=e=>this.get().edges.find(t=>t.id===e);deleteEdge=e=>{const t=this.get().nodes.filter(e=>"agent"===e.type),n=[...this.get().nodes.filter(e=>"agent"!==e.type),...t.map(t=>{const n=t.data.nestedChats??[];return{...t,data:{...t.data,nestedChats:n.map(t=>({...t,messages:t.messages.filter(t=>t.id!==e),triggeredBy:t.triggeredBy}))}}})],a=this.get().edges.filter(t=>t.id!==e);this.set({nodes:n,edges:a.map((e,t)=>({...e,data:{...e.data,position:t+1}})),updatedAt:(new Date).toISOString()}),this.resetEdgeOrdersAndPositions()};updateEdgeData=(e,t)=>{const n=this.get().edges.find(t=>t.id===e);if(n){const a={...n,data:{...n.data,...t}},s=this.get().edges.map(t=>t.id===e?a:t);this.set({edges:s,updatedAt:(new Date).toISOString()}),this.resetEdgeOrdersAndPositions()}};updateEdgeType=(e,t)=>{this.set({edges:this.get().edges.map(n=>{if(n.id===e){const a=this.get().nodes.find(e=>e.id===n.source);if(!a)throw new Error(`Source node not found for edge ${e}`);const s=Sn[a.data.agentType];return{...n,type:t,hidden:!1,data:{...n.data,type:t,order:"nested"===t?-1:n.data?.order??-1,prerequisites:"nested"===t?[]:n.data?.prerequisites??[]},animated:"nested"===t,...Ih(t,s)}}return n}),updatedAt:(new Date).toISOString()}),this.resetEdgeOrdersAndPositions()};updateEdgePath=(e,t)=>{const n=this.get().edges.find(t=>t.id===e);if(!n)return;const a=n.type,s=Sn[t],{style:r,markerEnd:o}=Ih(a,s);this.set({edges:this.get().edges.map(t=>t.id===e?{...t,style:r,markerEnd:o}:{...t}),updatedAt:(new Date).toISOString()}),this.resetEdgeOrdersAndPositions()};addEdge=e=>{const{flowId:t,connection:n,hidden:a}=e,s=this.get().nodes,r=this.get().edges,{source:o,target:i,sourceHandle:l,targetHandle:c}=n,{sourceNode:d,targetNode:u}=((e,t,n)=>{const a=e.find(e=>e.id===t);if(!a)return{sourceNode:null,targetNode:null};const s=e.find(e=>e.id===n);return s?{sourceNode:a,targetNode:s}:{sourceNode:null,targetNode:null}})(s,o,i);if(!d||!u)return null;const h=Rh({flowId:t,hidden:a,sourceNode:d,targetNode:u,positionGetter:e=>r.filter(t=>t.type===e).length,edges:r});if(!h)return null;this.set({edges:[...this.get().edges,{...h,sourceHandle:l,targetHandle:c}],updatedAt:(new Date).toISOString()}),this.resetEdgeOrdersAndPositions();return this.get().edges.find(e=>e.id===h.id)??h};onEdgeDoubleClick=(e,t)=>{if(Array.from(document.querySelectorAll(".modal-root .modal")).filter(e=>null!==e.querySelector(".modal-content").offsetParent).length>0)return;const n=ne(this.get().flowId);if(n){const e=n.querySelector(`[data-edge-node-id="${t.source}"]`);if(e)e.setAttribute("data-edge-id",t.id),e.click();else{const e=n.querySelector(`[data-edge-node-id="${t.target}"]`);e&&(e.setAttribute("data-edge-id",t.id),e.click())}}};getEdgeSourceAgent=e=>{const t=this.get().nodes.find(t=>t.id===e.source);if(t&&"agent"===t.type)return t};getEdgeTargetAgent=e=>{const t=this.get().nodes.find(t=>t.id===e.target);if(t&&"agent"===t.type)return t};onReconnect=(e,t)=>{const n=this.get().nodes;if(!((e,t)=>{const n=t.find(t=>t.id===e.target);return!(!t.find(t=>t.id===e.source)||!n)})(t,n))return;const{oldSourceNode:a,oldTargetNode:s,newSourceNode:r,newTargetNode:o,color:i}=((e,t,n)=>{let a,s,r,o,i;for(const l of n)if(l.id===e.source&&(a=l),l.id===e.target&&(s=l),l.id===t.source&&(r=l,i=Sn[r.data.agentType]),l.id===t.target&&(o=l),a&&s&&r&&o)break;return{oldSourceNode:a,oldTargetNode:s,newSourceNode:r,newTargetNode:o,color:i}})(e,t,n);if(!(a&&s&&r&&o))return;if(!i)return!1;const l=e.data?.label;e.data&&l===`${a.data.agentType} => ${s.data.agentType}`&&(e.data.label=Dh(r,o)),this.set({edges:[...this.get().edges.map(n=>n.id!==e.id?n:{...e,source:t.source,target:t.target,sourceHandle:t.sourceHandle,targetHandle:t.targetHandle,...Ih(e.type,i),data:{...n.data,realSource:r.id,realTarget:o.id,sourceType:r.data.agentType,targetType:o.data.agentType}})],updatedAt:(new Date).toISOString()}),this.resetEdgeOrdersAndPositions()};onEdgesChange=e=>{const n=t.applyEdgeChanges(e,this.get().edges);this.set({edges:n,updatedAt:(new Date).toISOString()})};resetEdgeOrdersAndPositions=()=>{Lh(this.get,this.set)}}class Jh{get;set;constructor(e,t){this.get=e,this.set=t}static create(e,t){return new Jh(e,t)}getViewport=()=>this.get().viewport;getRfInstance=()=>this.get().rfInstance;setRfInstance=e=>{const t=this.get().rfInstance;this.set({rfInstance:e}),t||($h(this.get,this.set),Zh(this.get,this.set))};getFlowInfo=()=>{const{flowId:e,storageId:t,name:n,description:a,tags:s,requirements:r,createdAt:o,updatedAt:i,isAsync:l,cacheSeed:c}=this.get();return{flowId:e,storageId:t??e,name:n??"Untitled Flow",description:a??"A new Waldiez flow",tags:s??[],requirements:r??[],createdAt:o,updatedAt:i,isAsync:l??!1,cacheSeed:void 0!==c?c:42}};onFlowChanged=()=>{const{onChange:e}=this.get(),t=this.exportFlow(!1);return e&&e(JSON.stringify(t)),t};getFlowEdges=()=>{const e=this.get().edges.filter(e=>"chat"===e.type),t=[],n=[];e.forEach(e=>{let a;a="number"==typeof e.data?.order?e.data.order:-1,a>=0?t.push(e):n.push(e)});return{used:t.sort((e,t)=>(e.data?.order??0)-(t.data?.order??0)),remaining:n}};saveFlow=()=>{const{onSave:e}=this.get();if("function"==typeof e){const t=this.exportFlow(!1);e(JSON.stringify(t))}};onViewportChange=(e,t)=>{if("model"===t||"tool"===t){if(e.zoom!==this.get().viewport?.zoom){const{nodes:n,rfInstance:a,flowId:s}=this.get();this.set({nodes:Mh(n,s,t,a),updatedAt:(new Date).toISOString()}),setTimeout(()=>{_h(this.get().rfInstance),this.set({viewport:e})},100)}}else this.set({viewport:e})};importFlow=(e,t,n)=>{const{storageId:a,name:s,description:r,tags:o,requirements:i,nodes:l,edges:c,isAsync:d,rfInstance:u}=this.get(),h={name:s??"Untitled Flow",description:r??"A new Waldiez flow",tags:o??[],requirements:i??[],nodes:l,edges:c,isAsync:d??!1},{name:p,createdAt:m,description:g,tags:f,requirements:y,isAsync:b,nodes:v,edges:x}=((e,t,n,a)=>{let s=e.override?{...n,nodes:[],edges:[]}:{...t};if(e.everything){const c=e.override?n.nodes:qh(t.nodes,n.nodes,a);s=e.override?n:{...s,name:(r=t.name,o=n.name,i=t.nodes,l=t.edges,0===i.length&&0===l.length?o:r),description:Vh(t.description,n.description,t.nodes,t.edges),tags:Uh(t.tags,n.tags),requirements:Hh(t.requirements,n.requirements),isAsync:n.isAsync??t.isAsync,cacheSeed:n.cacheSeed??t.cacheSeed??42,nodes:c,edges:Wh(c,t.edges,n.edges)}}else Gh(e,t,n,a,s);var r,o,i,l;return s})(e,h,t,n);this.set({name:p,description:g,tags:f,requirements:y,isAsync:b,storageId:a??`wf-${ee()}`,createdAt:m??(new Date).toISOString(),updatedAt:(new Date).toISOString(),nodes:v,edges:x}),Lh(this.get,this.set),$h(this.get,this.set),Zh(this.get,this.set),setTimeout(()=>{u?.fitView({includeHiddenNodes:!1,padding:.2,duration:100})},200)};exportFlow=e=>{const{isAsync:t,cacheSeed:n,viewport:a,rfInstance:s,name:r,description:o,tags:i,requirements:l,createdAt:c,updatedAt:d,flowId:u,storageId:h}=this.get(),p={nodes:this.get().nodes,edges:this.get().edges,viewport:s?.getViewport()??a??{zoom:1,x:20,y:20},name:r??"Untitled Flow",description:o??"A new Waldiez flow",tags:i??[],requirements:l??[],createdAt:c??(new Date).toISOString(),updatedAt:d??(new Date).toISOString(),flowId:u,storageId:h??u,isAsync:t??!1,cacheSeed:n};return Ys.exportFlow(p,e,!1)};updateFlowOrder=e=>{const t=(new Date).toISOString();this.set({edges:this.get().edges.map(t=>{const n=e.find(e=>e.id===t.id)?.order??t.data?.order??-1;return{...t,data:{...t.data,order:n}}}),updatedAt:t})};updateFlowPrerequisites=e=>{Ph(e,this.get,this.set)};updateFlowInfo=e=>{this.set({name:e.name,description:e.description,tags:e.tags,requirements:e.requirements,updatedAt:(new Date).toISOString(),isAsync:e.isAsync,cacheSeed:e.cacheSeed})}}class ep{get;set;constructor(e,t){this.get=e,this.set=t}static create(e,t){return new ep(e,t)}getModels=()=>this.get().nodes.filter(e=>"model"===e.type);getModelById=e=>{const t=this.get().nodes.find(t=>t.id===e);return t&&"model"===t.type?t:null};addModel=()=>{const e=this.get().nodes.filter(e=>"model"===e.type).length,t=this.get().flowId,n=this.get().rfInstance,a=Eh(e,t,n),s=ss.create(),r=Cs(s,a);this.set({nodes:[...this.get().nodes,{...r,type:"model"}],updatedAt:(new Date).toISOString()}),$h(this.get,this.set),_h(n);return this.get().nodes.find(e=>e.id===r.id)};cloneModel=e=>{const t=this.get().nodes.find(t=>t.id===e);if(!t||"model"!==t.type)return null;const n=this.get().rfInstance;$h(this.get,this.set),_h(n);const a=t.data.label+" (copy)",s=this.getClonedModel(e,n);s.data.label=a,this.set({nodes:[...this.get().nodes.map(t=>t.id===e?{...t,selected:!1}:t),{...s,type:"model",selected:!0}],updatedAt:(new Date).toISOString()}),$h(this.get,this.set),_h(n);return this.get().nodes.find(e=>e.id===s.id)};updateModelData=(e,t)=>{const n=this.get().nodes.find(t=>t.id===e);if(!n||"model"!==n.type)return;const a=(new Date).toISOString();this.set({nodes:[...this.get().nodes.map(n=>n.id===e?{...n,data:{...n.data,...t,updatedAt:a}}:n)],updatedAt:a})};deleteModel=e=>{const t=this.get().rfInstance,n=this.getNodesAfterModelDeletion(e,t);this.set({nodes:n,updatedAt:(new Date).toISOString()}),$h(this.get,this.set),_h(t)};importModel=(e,t,n,a=!0)=>{const s=xs(e),r=Cs(s,n);return r.id=t,n&&(r.position=n),a&&this.set({nodes:this.get().nodes.map(e=>e.id===t?r:e)}),r};exportModel=(e,t)=>{const n=this.get().nodes.find(t=>t.id===e);if(!n||"model"!==n.type)throw new Error(`Model with id ${e} not found`);return ws(n,t)};getClonedModel=(e,t)=>{if(!this.get().nodes.find(t=>t.id===e))throw new Error(`Model with id ${e} not found`);const n=this.get().nodes.filter(e=>"model"===e.type).length,a=this.get().flowId,s=Eh(n,a,t),r=ss.create();return Cs(r,s)};getNodesAfterModelDeletion=(e,t)=>{const n=this.get().nodes.filter(t=>"model"===t.type&&t.id!==e),a=n.length,s=this.get().flowId;for(let i=0;i<a;i++){const e=n[i],a=Eh(i,s,t);n[i]={...e,id:e?.id||`wa-${ee()}`,data:e?.data||{},position:a}}const r=n.concat(this.get().nodes.filter(e=>"model"!==e.type)),o=[];return r.forEach(t=>{if("agent"===t.type){const n=t;n.data.modelIds.includes(e)?o.push({...n,data:{...n.data,modelIds:n.data.modelIds.filter(t=>t!==e)}}):o.push(n)}else o.push(t)}),o}}class tp{get;set;constructor(e,t){this.get=e,this.set=t}static create(e,t){return new tp(e,t)}showNodes=e=>{"agent"!==e?(this.isShowingAgents()&&this.storePreviousViewport(),_h(this.get().rfInstance)):this.restorePreviousViewport(),this.set({nodes:this.get().nodes.map(t=>t.type===e?{...t,hidden:!1}:{...t,hidden:!0})})};isShowingAgents=()=>this.get().nodes.some(e=>"agent"===e.type&&!1===e.hidden);storePreviousViewport=()=>{const e=this.get().rfInstance;let t;t=e?{x:e.getViewport().x,y:e.getViewport().y,zoom:e.getViewport().zoom}:this.get().viewport,this.set({previousViewport:t,updatedAt:(new Date).toISOString()})};restorePreviousViewport=()=>{const e=this.get().previousViewport;if(e){this.set({viewport:e,updatedAt:(new Date).toISOString()});const t=this.get().rfInstance;t&&t.setViewport(e)}};onNodesChange=e=>{const n=t.applyNodeChanges(e,this.get().nodes);this.set({nodes:n,updatedAt:(new Date).toISOString()})};onNodeDoubleClick=(e,t)=>{if(Array.from(document.querySelectorAll(".modal-root .modal")).filter(e=>null!==e.querySelector(".modal-content").offsetParent).length>0)return;const n=this.get().flowId,a=ne(n);if(a){const e=a.querySelector(`[data-node-id="${t.id}"]`);e&&e.click()}};reselectNode=e=>{const t=this.get().nodes.find(t=>t.id===e);t&&(t.selected&&this.set({nodes:this.get().nodes.map(t=>t.id===e?{...t,selected:!1}:t)}),this.set({nodes:this.get().nodes.map(t=>t.id===e?{...t,selected:!0}:{...t,selected:!1})}))};highlightNode=e=>{this.set({nodes:this.get().nodes.map(t=>({...t,className:t.id===e?"highlight":""}))})};clearNodeHighlight=()=>{this.set({nodes:this.get().nodes.map(e=>({...e,className:""}))})}}class np{get;set;constructor(e,t){this.get=e,this.set=t}static create(e,t){return new np(e,t)}getTools=()=>this.get().nodes.filter(e=>"tool"===e.type);getToolById=e=>{const t=this.get().nodes.find(t=>t.id===e);return t&&"tool"===t.type?t:null};addTool=()=>{const e=this.get().nodes.filter(e=>"tool"===e.type),t=this.get().flowId,n=this.get().rfInstance,a=e.length,s=Eh(a,t,n),r=ps.create(),o=Es(r,s);this.set({nodes:[...this.get().nodes,{...o,type:"tool"}],updatedAt:(new Date).toISOString()}),Zh(this.get,this.set),_h(n);return this.get().nodes.find(e=>e.id===o.id)};cloneTool=e=>{const t=this.get().nodes.find(t=>t.id===e);if(!t||"tool"!==t.type)return null;const n=this.get().rfInstance,a=this.getClonedTool(t,n);this.set({nodes:[...this.get().nodes.map(t=>t.id===e?{...t,selected:!1}:t),{...a,type:"tool",selected:!0}],updatedAt:(new Date).toISOString()}),Zh(this.get,this.set),_h(n);return this.get().nodes.find(e=>e.id===a.id)};updateToolData=(e,t)=>{const n=this.get().nodes.find(t=>t.id===e);if(!n||"tool"!==n.type)return;const a=(new Date).toISOString();this.set({nodes:[...this.get().nodes.map(s=>"tool"===s.type&&s.id===e?{...s,data:{...n.data,...t,updatedAt:a}}:s)],updatedAt:a})};deleteTool=e=>{const t=this.get().rfInstance,n=this.getAgentsAfterToolDeletion(e,t);this.set({nodes:n,updatedAt:(new Date).toISOString()}),Zh(this.get,this.set),_h(t)};importTool=(e,t,n,a)=>{const s=Ns(e),r=Es(s,n);return r.id=t,n&&(r.position=n),a&&this.set({nodes:this.get().nodes.map(e=>e.id===t?r:e)}),r};exportTool=(e,t)=>{const n=this.get().nodes.find(t=>t.id===e);return n&&"tool"===n.type?Ts(n,t):{}};getClonedTool=(e,t)=>{const n=(new Date).toISOString(),a=n,s=this.get().nodes.filter(e=>"tool"===e.type).length,r=this.get().flowId,o=Eh(s,r,t),i=e.data.label+" (copy)";return{...e,id:`wt-${ee()}`,data:{...e.data,label:i,createdAt:n,updatedAt:a},position:o}};getAgentAfterToolDeletion=(e,t)=>{const n=t.data.tools.filter(t=>t.id!==e),a=t.data.codeExecutionConfig;if("boolean"==typeof a)return{...t,data:{...t.data,tools:n}};const s=(a.functions??[]).filter(t=>t!==e);return{...t,data:{...t.data,tools:n,codeExecutionConfig:{...a,functions:s}}}};getAgentsAfterToolDeletion=(e,t)=>{const n=this.get().nodes.filter(t=>"tool"===t.type&&t.id!==e),a=n.length,s=this.get().flowId;for(let i=0;i<a;i++){const e=n[i],a=Eh(i,s,t);n[i]={...e,id:e?.id||`wa-${ee()}`,data:e?.data||{},position:a}}const r=n.concat(this.get().nodes.filter(e=>"tool"!==e.type)),o=[];return r.forEach(t=>{if("agent"===t.type){const n=this.getAgentAfterToolDeletion(e,t);o.push(n)}else o.push(t)}),o}}const ap=e=>{const{flowId:t=`wf-${ee()}`,isAsync:n=!1,isReadOnly:a=!1,skipExport:s=!1,skipImport:r=!1,edges:o=[],nodes:i=[],name:l="Untitled Flow",description:c="A new Waldiez flow",tags:d=[],requirements:u=[],createdAt:h=(new Date).toISOString(),updatedAt:p=(new Date).toISOString(),viewport:m={zoom:1,x:50,y:50},onUpload:g=null,onChange:f=null,onSave:y=null,onRun:b=null,onStepRun:v=null,onConvert:x=null}=e,w=e.storageId??t;return vh()((C=(C,k)=>({rfInstance:e?.rfInstance,flowId:t,isAsync:n,isReadOnly:a,skipExport:s,skipImport:r,storageId:w,name:l,description:c,tags:d,requirements:u,createdAt:h,updatedAt:p,viewport:m,nodes:i,edges:o,onUpload:g,onChange:f,onSave:y,onRun:b,onStepRun:v,onConvert:x,activeSenderId:null,activeRecipientId:null,activeEventType:null,...Yh.create(k,C),...Qh.create(k,C),...ep.create(k,C),...np.create(k,C),...tp.create(k,C),...Xh.create(k,C),...Jh.create(k,C)}),k={equality:sp,partialize:e=>{const{flowId:t,nodes:n,edges:a,name:s,description:r,requirements:o,tags:i}=e;return{flowId:t,nodes:n,edges:a,name:s,description:r,requirements:o,tags:i}}},(e,t,n)=>{n.temporal=vh(k?.wrapTemporal?.(Nh(e,t,k))||Nh(e,t,k));const a=k?.handleSet?.(n.temporal.getState()._handleSet)||n.temporal.getState()._handleSet,s=e=>{if(!n.temporal.getState().isTracking)return;const s=k?.partialize?.(t())||t(),r=k?.diff?.(e,s);null===r||k?.equality?.(e,s)||a(e,void 0,s,r)},r=n.setState;return n.setState=(...e)=>{const n=k?.partialize?.(t())||t();r(...e),s(n)},C((...n)=>{const a=k?.partialize?.(t())||t();e(...n),s(a)},t,n)}));var C,k},sp=(e,t)=>{const n=Sh(e,t);return 0===n.length||n.every(e=>("CREATE"!==e.type||2!==e.path.length)&&((1!==e.path.length||"string"!=typeof e.path[0]||!["name","description","tags","requirements"].includes(e.path[0]))&&((!e.path.includes("nodes")||!e.path.includes("data"))&&!(e.path.includes("edges")&&e.path.includes("data")&&!e.path.includes("position")))))};function rp({children:t,...n}){const a=e.useRef(void 0),s="boolean"==typeof n.isReadOnly&&n.isReadOnly,r=n.nodes,o=n.edges,i=n.flowId,l=n.name,c=n.description,d=n.tags,u=n.requirements,h=n.createdAt,p=n.updatedAt,m=n.storageId,g=n.onUpload??null,f=n.onChange??null,y=n.onSave??null,b=n.onRun??null,v=n.onStepRun??null,x=n.onConvert??null,w=n.rfInstance,C=n.isAsync??!1;n.cacheSeed;const k=e.useMemo(()=>(a.current=ap({flowId:i,isAsync:C,isReadOnly:s,name:l,description:c,tags:d,requirements:u,storageId:m,createdAt:h,updatedAt:p,nodes:r,edges:o,rfInstance:w,onUpload:g,onChange:f,onSave:y,onRun:b,onStepRun:v,onConvert:x}),a.current),[i]);return $n.jsx(kh.Provider,{value:k,children:t})}const op=({flowId:t,stepByStep:n})=>{(t=>{const n=jh(e=>e.setActiveParticipants),a=jh(e=>e.resetActiveParticipants),s=jh(e=>e.setActiveEventType),r=jh(e=>e.resetActiveEventType),o=jh(e=>e.getGroupManager),i=e.useRef(-1),l=e.useCallback((e,t)=>{const{sender:n,recipient:a}=be.extractEventParticipants(t);let s=e.find(e=>e.name===n)?.id??null,r=e.find(e=>e.name===a)?.id??null;if("_Group_Tool_Executor"===n||"_Group_Tool_Executor"===a){const e=o();e&&("_Group_Tool_Executor"===n?s=e.id:r=e.id)}return{senderId:s,recipientId:r}},[o]);e.useEffect(()=>{if(!t?.active)return a(),r(),void(i.current=-1);const e=t.eventHistory??[];if(0===e.length||!t.participants)return;const o=e.length-1;if(o===i.current)return;const c=e[0];if(!c||"object"!=typeof c)return;i.current=o;const{senderId:d,recipientId:u}=l(t.participants,c);if(null===d&&null===u)return;const h=(e=>{if(!e)return null;let t=e.type??e.debug_type??e.data?.type??"";return t?(t=t.toString(),t.includes("process")?"thinking":t.includes("code")||t.includes("function")||t.includes("tool")?"tool":"message"):null})(c);h&&s(h),n(d??null,u??null)},[t?.active,t?.eventHistory,t?.participants,n,a,s,r,o,l])})(n);const[a,s]=e.useState(""),r=n?.activeRequest?.request_id??null,o=!n?.active&&!!n?.handlers?.close&&(n?.eventHistory?.length??0)>0,i=e.useCallback(e=>{s(e.target.value)},[]),l=e.useCallback(()=>{r&&(n?.handlers?.respond?.({id:b(),timestamp:Date.now(),data:a,request_id:r,type:"input_response"}),s(""))},[r,a,n?.handlers]),c=e.useCallback(e=>{"Enter"===e.key&&(e.nativeEvent?.isComposing||r&&(n?.handlers?.respond?.({id:b(),timestamp:Date.now(),data:a,request_id:r,type:"input_response"}),s("")))},[r,a,n?.handlers]),d=e.useCallback(e=>{if(!n?.handlers?.sendControl)return;const t=r??"<unknown>";n.handlers.sendControl({data:oe({kind:e}),request_id:t})},[r,n?.handlers]),u=e.useMemo(()=>{const e=n?.eventHistory??[],t=Math.max(0,e.length-500);return e.slice(t).filter(e=>e&&!["debug","print","raw","timeline"].includes(String(e?.type))).map(e=>{const t=e,n=t.event??t.data??t.message??t;return Array.isArray(n)&&1===n.length?n[0]:n}).reverse()},[n?.eventHistory]),h=e.useMemo(()=>{if(!n)return null;const e=n.currentEvent?.type;if("string"==typeof e&&!["debug","print","raw"].includes(e))return e;const t=u[u.length-1],a=t?.event?.type??t?.type;return"string"!=typeof a||["debug","print","raw"].includes(a)?!n.active&&o?n.eventHistory?.length>0?"Finished":null:"Running":a},[n,u,o]);if(!n?.active&&!o)return null;const p=o||!!n?.handlers?.close&&"error"===h?.toLowerCase(),m=$n.jsxs("div",{className:"header",children:[$n.jsx(dd,{className:"icon-bug",size:18}),$n.jsx("div",{className:"title",children:"Step-by-step Run"}),h&&$n.jsx("div",{className:`badge ${h}`,children:h}),!h&&!n?.active&&$n.jsx("div",{className:"badge",children:"Finished"}),!h&&n?.active&&$n.jsx("div",{className:"badge",children:"Running"})]}),g=p?$n.jsx("button",{title:"Close",type:"button",onClick:n?.handlers?.close,className:"header-toggle","aria-label":"Close panel",children:$n.jsx(Ed,{size:14})}):void 0;return $n.jsx("div",{className:"waldiez-step-by-step-view","data-testid":`step-by-step-${t}`,children:$n.jsx(Wu,{flowId:t,title:"",headerLeft:m,headerRight:g,maxHeight:"80vh",minHeight:320,minWidth:420,maxWidth:"80vw",children:$n.jsxs("div",{className:"content",children:[n?.pendingControlInput&&$n.jsxs("div",{className:"controls",children:[$n.jsxs("button",{className:"btn btn-primary",type:"button",onClick:()=>d("continue"),disabled:!n?.pendingControlInput,children:[$n.jsx(Dc,{})," ",$n.jsx("span",{children:"Continue"})]}),$n.jsxs("button",{className:"btn btn-secondary",type:"button",onClick:()=>d("run"),disabled:!n?.pendingControlInput,children:[$n.jsx(kd,{})," ",$n.jsx("span",{children:"Run"})]}),$n.jsxs("button",{className:"btn btn-danger",type:"button",onClick:()=>d("quit"),disabled:!n?.pendingControlInput,children:[$n.jsx(Ad,{})," ",$n.jsx("span",{children:"Quit"})]})]}),n?.activeRequest&&$n.jsxs("div",{className:"card card--pending",children:[$n.jsx("div",{className:"card-title",children:"Waiting for input"}),$n.jsx("div",{className:"codeblock",children:n.activeRequest.prompt}),$n.jsxs("div",{className:"input-row",children:[$n.jsx("input",{className:"input",placeholder:"Type your response... (Enter to send)",value:a,type:!0===n.activeRequest.password?"password":"text",onChange:i,onKeyDown:c,autoCapitalize:"off",autoCorrect:"off",autoComplete:"off"}),$n.jsx("button",{className:"btn btn-primary",type:"button",onClick:l,children:"Send"})]})]}),u.length>0?$n.jsx("div",{className:"event-history",children:$n.jsx($u,{events:u,autoScroll:!0})}):$n.jsx("div",{className:"event-history",children:$n.jsx($u,{events:[{type:"empty",content:"No messages yet..."}]})})]})})})};op.displayName="WaldiezStepByStepView";const ip=e.memo(t=>{const{viewLabel:n,viewLabelInfo:a,items:s=[],itemsType:r="default",placeholder:o="..."}=t,{newEntry:i,onAddEntry:l,onDeleteEntry:c,onEntryChange:d,onNewEntryChange:u,onNewEntryKeyDown:h}=(t=>{const[n,a]=e.useState(""),{items:s,onItemAdded:r,onItemChange:o,onItemDeleted:i}=t,l=e.useCallback(()=>{r&&n.trim()&&(r(n),a(""))},[n,r]),c=e.useCallback(e=>{if(!i)return;const t=e.currentTarget.value;i(t)},[i]),d=e.useCallback(e=>{if(!o)return;const t=parseInt(e.currentTarget.getAttribute("data-index")||"0"),n=e.target.value,a=s[t];null!=a&&o(a,n)},[o,s]),u=e.useCallback(e=>{a(e.target.value)},[]),h=e.useCallback(e=>{"Enter"===e.key&&(e.preventDefault(),l())},[l]);return{newEntry:n,onAddEntry:l,onDeleteEntry:c,onEntryChange:d,onNewEntryChange:u,onNewEntryKeyDown:h}})(t),p=e.useMemo(()=>"function"==typeof n?n():n,[n]),m=e.useMemo(()=>s.map((e,t)=>$n.jsxs("div",{className:"list-entry",children:[$n.jsx("input",{placeholder:o,type:"text",value:e,"data-index":t,id:`list-entry-item-${r}-${t}`,onChange:d,"data-testid":`list-entry-item-${r}-${t}`}),$n.jsx("button",{type:"button",onClick:c,value:e,title:"Delete",className:"trash-button",id:`delete-list-entry-${r}-${t}`,"aria-label":`Delete item: ${e}`,"data-testid":`delete-list-entry-${r}-${t}`,children:$n.jsx(Oc,{})})]},`${r}-${t}`)),[s,r,o,d,c]),g=!i.trim();return $n.jsxs("div",{className:"list-entries-view",children:[a?$n.jsx(Hd,{label:n,info:a,htmlFor:"list-entries"}):$n.jsx("label",{className:"list-entries-label",htmlFor:"list-entries",children:p}),s.length>0&&$n.jsx("div",{className:"list-entries-list",children:m}),$n.jsx("div",{className:"list-entries-list",children:$n.jsxs("div",{className:"add-list-entry-view",children:[$n.jsx("input",{placeholder:o,type:"text",value:i,onChange:u,onKeyDown:h,"data-testid":`new-list-entry-${r}-item`,"aria-label":`New ${r} input`,id:`new-list-entry-${r}`}),$n.jsx("button",{type:"button",onClick:l,title:"Add",disabled:g,className:"plus-button","aria-label":"Add item",id:`add-list-entry-${r}-button`,"data-testid":`add-list-entry-${r}-button`,children:$n.jsx(Mc,{})})]})})]})});ip.displayName="StringList";const lp=e.memo(e=>{const{id:t,children:n}=e;return $n.jsx("div",{className:"tab-panel",role:"tabpanel","aria-labelledby":`tab-id-${t}`,"data-testid":`panel-${t}`,id:`panel-${t}`,children:n})}),cp=e.memo(t=>{const{activeTabIndex:n=0,children:a,onTabChange:s}=t,[r,o]=e.useState(n);e.useEffect(()=>{o(n)},[n]);const i=e.useCallback(e=>{o(e),s?.(e)},[s]),l=e.useMemo(()=>e.Children.toArray(a).filter(t=>e.isValidElement(t)&&t.type===lp),[a]),c=e.useMemo(()=>l.map((e,t)=>{const n=r===t,a=n?"tab-btn--active":"",s=e.props.id;return $n.jsx("li",{role:"tab","aria-selected":n,children:$n.jsx("div",{role:"button","data-testid":`tab-id-${s}`,id:`tab-id-${s}`,"aria-controls":`panel-${s}`,onClick:()=>i(t),className:`tab-btn ${a}`,tabIndex:n?0:-1,children:e.props.label})},`tab-li-${s}-${t}`)}),[l,r,i]),d=l[r]||null;return $n.jsxs("div",{className:"tabs",children:[$n.jsx("nav",{className:"tab-list-wrapper",children:$n.jsx("ul",{className:"tab-list",role:"tablist","aria-orientation":"horizontal",children:c})}),d]})});function dp(e){return fc({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"22 12 18 12 15 21 9 3 6 12 2 12"},child:[]}]})(e)}function up(e){return fc({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"polyline",attr:{points:"12 6 12 12 16 14"},child:[]}]})(e)}function hp(e){return fc({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"1",x2:"12",y2:"23"},child:[]},{tag:"path",attr:{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"},child:[]}]})(e)}function pp(e){return fc({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"},child:[]},{tag:"line",attr:{x1:"1",y1:"1",x2:"23",y2:"23"},child:[]}]})(e)}function mp(e){return fc({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"},child:[]},{tag:"circle",attr:{cx:"12",cy:"12",r:"3"},child:[]}]})(e)}function gp(e){return fc({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"},child:[]},{tag:"polyline",attr:{points:"14 2 14 8 20 8"},child:[]},{tag:"line",attr:{x1:"16",y1:"13",x2:"8",y2:"13"},child:[]},{tag:"line",attr:{x1:"16",y1:"17",x2:"8",y2:"17"},child:[]},{tag:"polyline",attr:{points:"10 9 9 9 8 9"},child:[]}]})(e)}function fp(e){return fc({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"},child:[]}]})(e)}function yp(e){return fc({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"12",cy:"7",r:"4"},child:[]}]})(e)}function bp(e){return fc({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"6",x2:"6",y2:"18"},child:[]},{tag:"line",attr:{x1:"6",y1:"6",x2:"18",y2:"18"},child:[]}]})(e)}lp.displayName="TabItem",cp.displayName="TabItems";const vp=({data:t,width:n,height:a,darkMode:s=!1})=>{const[r,o]=e.useState(null),[i,l]=e.useState({x:0,y:0}),c=40,d=80,u=n-d-140,h=a-c-60;if(!t||!t.timeline||0===t.timeline.length)return null;const p=t.metadata.time_range[1],m=Math.max(...t.cost_timeline.map(e=>e.cumulative_cost)),g=e=>e/p*u,f=e=>h-e/m*h,y=t.cost_timeline.map((e,t)=>`${0===t?"M":"L"} ${g(e.time)} ${f(e.cumulative_cost)}`).join(" "),b=s?"#374151":"#e2e8f0",v=s?"#9CA3AF":"#64748b",x="#8B5CF6",w=s?"#F3F4F6":"#333";return $n.jsxs("div",{className:"relative",children:[$n.jsx("svg",{width:n,height:a,onMouseMove:e=>{const t=e.currentTarget.getBoundingClientRect();l({x:e.clientX-t.left,y:e.clientY-t.top})},onMouseLeave:()=>o(null),children:$n.jsxs("g",{transform:`translate(${d}, ${c})`,children:[[0,.25,.5,.75,1].map(e=>$n.jsxs("g",{children:[$n.jsx("line",{x1:u*e,y1:0,x2:u*e,y2:h,stroke:b,strokeDasharray:"2,2",strokeWidth:1}),$n.jsx("line",{x1:0,y1:h*e,x2:u,y2:h*e,stroke:b,strokeDasharray:"2,2",strokeWidth:1})]},`grid-${e}`)),t.timeline.map((e,n)=>{let a;if("session"===e.type){const n=t.cost_timeline.find(t=>t.session_id===e.y_position);a=f(n?.cumulative_cost||0)-10}else{const e=t.timeline.slice(0,n).reverse().findIndex(e=>"session"===e.type);if(-1!==e){const s=t.timeline[n-1-e],r=t.cost_timeline.find(e=>e.session_id===s?.y_position);a=f(r?.cumulative_cost||0)-10}else a=f(0)-10}return $n.jsxs("g",{children:[$n.jsx("rect",{x:g(e.start),y:a,width:g(e.duration),height:20,fill:"session"===e.type?e.color:"#D1D5DB",stroke:"session"===e.type?e.color:"#9CA3AF",strokeWidth:2,rx:8,fillOpacity:.1,style:{cursor:"pointer"},onMouseEnter:()=>o({...e,index:n})}),"gap"===e.type&&$n.jsx("text",{x:g(e.start+e.duration/2),y:a+14,textAnchor:"middle",dominantBaseline:"middle",fontSize:"10",fontWeight:"bold",fill:s?"#F3F4F6":"white",pointerEvents:"none",children:"human_input_waiting"===e.gap_type?`👤 ${e.real_duration?.toFixed(0)}s`:`${e.label.split(" ")[0]} `})]},e.id)}),$n.jsx("path",{d:y,fill:"none",stroke:x,strokeWidth:2}),t.cost_timeline.map((e,t)=>$n.jsx("circle",{cx:g(e.time),cy:f(e.cumulative_cost),r:4,fill:x,stroke:s?"#1F2937":"white",strokeWidth:2,style:{cursor:"pointer"},onMouseEnter:()=>o({type:"cost_point",cost_data:e,index:t})},`dot-${t}`)),$n.jsxs("g",{transform:`translate(0, ${h})`,children:[$n.jsx("line",{x1:0,y1:0,x2:u,y2:0,stroke:v}),[0,.25,.5,.75,1].map(e=>$n.jsxs("g",{children:[$n.jsx("line",{x1:u*e,y1:0,x2:u*e,y2:6,stroke:v}),$n.jsxs("text",{x:u*e,y:20,textAnchor:"middle",fontSize:"12",fill:v,children:[(p*e).toFixed(1),"s"]})]},`x-tick-${e}`)),$n.jsx("text",{x:u/2,y:45,textAnchor:"middle",fontSize:"14",fontWeight:"500",fill:w,children:"Compressed Timeline (seconds)"})]}),$n.jsxs("g",{transform:`translate(${u}, 0)`,children:[$n.jsx("line",{x1:0,y1:0,x2:0,y2:h,stroke:x}),[0,.25,.5,.75,1].map(e=>$n.jsxs("g",{children:[$n.jsx("line",{x1:0,y1:h*e,x2:6,y2:h*e,stroke:x}),$n.jsxs("text",{x:20,y:h*e,textAnchor:"start",dominantBaseline:"middle",fontSize:"12",fill:x,children:["$",(m*(1-e)).toFixed(6)]})]},`y-tick-${e}`)),$n.jsx("text",{x:120,y:h/2,textAnchor:"middle",dominantBaseline:"middle",fontSize:"14",fontWeight:"500",fill:x,transform:`rotate(-90, 120, ${h/2})`,children:"Cumulative Cost ($)"})]})]})}),r&&$n.jsx("div",{className:"absolute pointer-events-none",style:{left:i.x+10,top:i.y-10,transform:i.x>n/2?"translateX(-100%)":void 0},children:$n.jsx("div",{className:"card",children:$n.jsxs("div",{className:"card-content padding-10",children:["session"===r.type&&$n.jsxs($n.Fragment,{children:[$n.jsx("div",{className:"font-semibold text-sm",children:r.agent.replace(/_/g," ")}),$n.jsxs("div",{className:"text-xs space-y-0_5",children:[$n.jsxs("div",{children:["LLM: ",$n.jsx("span",{className:"font-medium",children:r.llm_model})]}),$n.jsxs("div",{children:["Cost: $",r.cost.toFixed(6)]}),$n.jsxs("div",{children:["Duration: ",r.duration.toFixed(2),"s"]}),r.tokens>0&&$n.jsxs("div",{children:["Tokens: ",r.prompt_tokens.toLocaleString()," in +"," ",r.completion_tokens.toLocaleString()," out"]}),$n.jsxs("div",{children:["Cache: ",r.is_cached?"Cached":"Fresh"]}),r.real_start_time&&$n.jsxs("div",{children:["Started: ",r.real_start_time]})]})]}),"gap"===r.type&&$n.jsxs($n.Fragment,{children:[$n.jsx("div",{className:"font-semibold text-sm",children:r.label}),$n.jsxs("div",{className:"text-xs space-y-0_5",children:[$n.jsxs("div",{children:["Type: ",r.gap_type.replace(/_/g," ")]}),$n.jsxs("div",{children:["Original Duration: ",r.real_duration?.toFixed(1),"s"]}),r.compressed&&$n.jsxs("div",{children:["Compressed to: ",r.duration.toFixed(1),"s"]})]})]}),"cost_point"===r.type&&$n.jsxs($n.Fragment,{children:[$n.jsxs("div",{className:"font-semibold text-sm",children:["Cumulative Cost: $",r.cost_data.cumulative_cost.toFixed(6)]}),$n.jsxs("div",{className:"text-xs space-y-0_5",children:[$n.jsxs("div",{children:["Session Cost: $",r.cost_data.session_cost.toFixed(6)]}),$n.jsxs("div",{children:["Session: ",r.cost_data.session_id]})]})]})]})})})]})},xp=({data:t,height:n=400})=>{const{isDark:a}=Qn(),s=e.useRef(null),[o,i]=e.useState({width:0,height:0});return e.useLayoutEffect(()=>{if(s.current){const e=s.current.querySelector("svg");if(e){const t=parseInt(e.getAttribute("width")||"800"),n=parseInt(e.getAttribute("height")||"400");i({width:t,height:n})}}},[]),$n.jsxs("div",{className:"full-width padding-10",children:[$n.jsx("div",{className:"timeline-grid margin-bottom-10",children:[{label:"Sessions",value:t.summary.total_sessions,icon:dp},{label:"Total Cost",value:`$${t.summary.total_cost.toFixed(6)}`,icon:hp},{label:"Duration",value:`${t.summary.total_time.toFixed(1)}s`,icon:up},{label:"Agents",value:t.summary.total_agents,icon:yp},{label:"Tokens",value:t.summary.total_tokens?.toLocaleString()||"N/A",icon:gp},{label:"Avg Cost",value:`$${t.summary.avg_cost_per_session.toFixed(6)}`,icon:hp}].map(({label:e,value:t,icon:n})=>$n.jsx("div",{className:"card",children:$n.jsx("div",{className:"card-content",children:$n.jsxs("div",{className:"timeline-top",children:[$n.jsx(n,{className:"timeline-icon"}),$n.jsxs("div",{className:"timeline-top-content",children:[$n.jsx("p",{className:"timeline-label",children:e}),$n.jsx("p",{className:"timeline-value",children:t})]})]})})},e))}),$n.jsxs("div",{className:"card",children:[$n.jsxs("div",{className:"card-header",children:[$n.jsx("h3",{className:"card-title",children:"Session Activity Timeline with Cumulative Cost"}),$n.jsxs("p",{className:"card-description",children:["Interactive timeline showing agent sessions and cost accumulation (human input periods compressed)",t.summary.compression_info.gaps_compressed>0&&$n.jsxs("span",{className:"badge badge-secondary",style:{marginLeft:"0.5rem"},children:[t.summary.compression_info.gaps_compressed," gaps compressed,",t.summary.compression_info.time_saved.toFixed(1),"s saved"]})]})]}),$n.jsxs("div",{className:"card-content",children:[$n.jsx("div",{className:"full-width",children:$n.jsx(r.ResponsiveContainer,{width:"100%",height:n,children:$n.jsx(vp,{width:o.width,height:o.height,data:t,darkMode:a})})}),t.agents.length>0&&$n.jsx("div",{className:"timeline-agent-list",children:t.agents.map(e=>$n.jsxs("div",{className:"timeline-agent-item",children:[$n.jsx("div",{className:"timeline-agent-dot",style:{backgroundColor:e.color}}),$n.jsx("span",{className:"timeline-agent-name",children:e.name.replace(/_/g," ")}),$n.jsxs("span",{className:"timeline-agent-class",children:["(",e.class,")"]})]},e.name))})]})]})]})},wp=({flowId:e,isOpen:t,onClose:n,data:a})=>$n.jsxs(ou,{flowId:e,id:"timeline-modal",title:"Chat Timeline",isOpen:t,onClose:n,className:"modal-fullscreen",hasMaximizeBtn:!1,hasCloseBtn:!0,hasUnsavedChanges:!1,preventCloseIfUnsavedChanges:!1,noHeader:!0,children:[$n.jsx("div",{className:"timeline-modal fullscreen open no-backdrop",children:$n.jsx("div",{className:"modal-body",children:$n.jsx(xp,{data:a})})}),$n.jsx("button",{type:"button",title:"Close preview",className:"modal-close",onClick:n,"data-testid":"modal-close",children:$n.jsx(Ed,{size:12})})]}),Cp='"""Custom update system message function."""\n\n# provide the function to define the system message before replying\n# complete the `custom_update_system_message` below. Do not change the name or the arguments of the function.\n# only complete the function body and the docstring and return the final message.\n# the function should accept the agent and the messages as arguments.\n# example:\n# def custom_update_system_message(\n#     agent: ConversableAgent,\n#     messages: List[Dict[str, Any]]\n# ) -> str:\n#     return "Hello, I am a custom system message"\n\ndef custom_update_system_message(\n     agent: ConversableAgent,\n     messages: List[Dict[str, Any]]\n) -> str:\n    ...\n',kp=t=>{const{data:n,onDataChange:a,darkMode:s}=t,r=e.useMemo(()=>n.updateAgentStateBeforeReply.length>0,[n.updateAgentStateBeforeReply]),o=e.useMemo(()=>r?n.updateAgentStateBeforeReply[0]:{type:"string",content:""},[r,n.updateAgentStateBeforeReply]),[i,l]=e.useState(r),[c,d]=e.useState(o?.type||"string");e.useEffect(()=>{l(r),r&&d(o?.type||"string")},[r,o?.type]);const u=e.useMemo(()=>[{label:"Text",value:"string"},{label:"Function",value:"callable"}],[]),h=e.useMemo(()=>u.find(e=>e.value===c),[u,c]),p=e.useCallback(e=>{if(l(e),e){a({updateAgentStateBeforeReply:[{type:c,content:"string"===c?"":Cp}]})}else a({updateAgentStateBeforeReply:[]})},[a,c]),m=e.useCallback(e=>{if(!e)return void a({updateAgentStateBeforeReply:[]});const t=e.value;d(t);a({updateAgentStateBeforeReply:[{type:t,content:"string"===t?"":Cp}]})},[a]),g=e.useCallback(e=>{a({updateAgentStateBeforeReply:[{type:"string",content:e.target.value}]})},[a]),f=e.useCallback(e=>{a({updateAgentStateBeforeReply:[{type:"callable",content:e??Cp}]})},[a]),y=e.useMemo(()=>r&&"string"===o?.type?o.content:"",[r,o]),b=e.useMemo(()=>r&&"callable"===o?.type?o.content:Cp,[r,o]);return $n.jsxs("div",{className:"agent-panel agent-update-state-panel",children:[$n.jsx("div",{className:"info margin-bottom-10",children:"You can update the agent's system message before replying. This can be useful if you need to control the system message based on the current conversation context. If enabled, it can be a string or a function. If text, it will be used as a template and substitute the context variables. If a function, it should accept the agent and messages as arguments and return a string."}),$n.jsxs("div",{className:"flex-column",children:[$n.jsx(ed,{label:"Update system message before reply",isChecked:i,onCheckedChange:p,id:"enable-update-system-message","aria-label":"Enable update system message"}),i&&$n.jsxs($n.Fragment,{children:[$n.jsx("label",{htmlFor:"update-system-message-type-select-input",children:"Message update type"}),$n.jsx(nd,{options:u,value:h,onChange:m,inputId:"update-system-message-type-select-input"}),$n.jsx("label",{htmlFor:"update-system-message-string",children:"Message update"}),"string"===c?$n.jsx(Gd,{rows:4,value:y,placeholder:"Enter a string template with {variable}s",onChange:g,"data-testid":"update-system-message-string",id:"update-system-message-string"}):$n.jsx(Vd,{value:b,onChange:f,darkMode:s,"data-testid":"update-system-message-callable"})]})]})]})};kp.displayName="UpdateState";const jp=e.memo(e=>{const{children:t,id:n}=e;return $n.jsx("div",{className:"wizard-step-view","data-testid":`wizard-step-${n}`,children:t})}),Ap=e.memo(t=>{const{children:n,activeStep:a=0,canGoForward:s=!0,canGoBack:r=!0,firstBackTitle:o="Cancel",lastNextTitle:i="Finish",onBack:l,onForward:c}=t,[d,u]=e.useState(a);e.useEffect(()=>{u(a)},[a]);const h=e.useMemo(()=>e.Children.toArray(n).filter(t=>e.isValidElement(t)&&t.type===jp),[n]),p=e.useMemo(()=>"function"==typeof r?r(d):r,[r,d]),m=e.useMemo(()=>"function"==typeof s?s(d):s,[s,d]),g=e.useMemo(()=>0===d&&!l||!p,[d,l,p]),f=e.useMemo(()=>d===h.length-1&&!c||!m,[d,h.length,c,m]),y=e.useMemo(()=>0===d?o:"Back",[d,o]),b=e.useMemo(()=>d===h.length-1?i:"Next",[d,h.length,i]),v=e.useCallback(()=>{d>0&&u(e=>e-1),l&&l(d)},[d,l]),x=e.useCallback(()=>{d<h.length-1&&u(e=>e+1),c&&c(d)},[d,h.length,c]),w=e.useMemo(()=>h.map((e,t)=>{const n=d===t,a=n?"wizard-step--active":"";return $n.jsx("div",{role:"tab",className:`wizard-step ${a}`,"data-testid":`step-id-${e.props.id}`,"aria-selected":n,"aria-controls":`wizard-step-${e.props.id}`,children:e},`wizard-step-${t}`)}),[h,d]);return $n.jsxs("div",{className:"wizard",children:[$n.jsx("div",{className:"wizard-steps",role:"tablist",children:w}),$n.jsxs("div",{className:"modal-actions",children:[$n.jsx("button",{type:"button",title:y,onClick:v,"data-testid":"wizard-back-btn",disabled:g,className:"wizard-action-btn wizard-action-btn-prev","aria-label":y,children:y}),$n.jsx("button",{type:"button",title:b,onClick:x,disabled:f,"data-testid":"wizard-next-btn",className:"wizard-action-btn wizard-action-btn-next primary","aria-label":b,children:b})]})]})});jp.displayName="WizardStep",Ap.displayName="Wizard";const Sp=(t,n)=>{const{undo:a,redo:s,futureStates:r,pastStates:o}=(t=>{const n=e.useContext(kh);if(!n)throw new Error("Missing WaldiezContext.Provider in the tree");return Ch(n.temporal,t,Xu)})(e=>e),i=!0===jh(e=>e.isReadOnly),l=jh(e=>e.deleteAgent),c=jh(e=>e.deleteEdge),d=jh(e=>e.deleteModel),u=jh(e=>e.deleteTool),h=jh(e=>e.saveFlow),p="function"==typeof n&&!i,m=()=>{const e=ne(t);if(!e)return!1;const n=e.getBoundingClientRect();return n.width>0&&n.height>0};Sr("mod+z",()=>{o.length>0&&m()&&a()},{scopes:t}),Sr(["shift+mod+z","mod+y"],()=>{r.length>0&&m()&&s()},{scopes:t}),p&&Sr("mod+s",e=>{m()&&(e.preventDefault(),h())},{scopes:t});const g=e=>{const t=e.getAttribute("data-id");if(t){const n=e.classList.contains("react-flow__node-agent"),a=e.classList.contains("react-flow__node-model"),s=e.classList.contains("react-flow__node-tool");n?l(t):a?d(t):s&&u(t)}},f=e=>{const t=e.getAttribute("data-id");t&&c(t)};return{onKeyDown:e=>{i||"Delete"!==e?.key&&"Backspace"!==e?.key||m()&&(e=>{if(i)return;const t=e.target;t instanceof Element&&t.classList.contains("react-flow__node")?g(t):t instanceof Element&&(t.classList.contains("react-flow__edge")||t.classList.contains("edge-data-view"))&&f(t)})(e)}}};function Np(e){return fc({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M435.9 64.9l-367.1 160c-6.5 3.1-6.3 12.4.3 15.3l99.3 56.1c5.9 3.3 13.2 2.6 18.3-1.8l195.8-168.8c1.3-1.1 4.4-3.2 5.6-2 1.3 1.3-.7 4.3-1.8 5.6L216.9 320.1c-4.7 5.3-5.4 13.1-1.6 19.1l64.9 104.1c3.2 6.3 12.3 6.2 15.2-.2L447.2 76c3.3-7.2-4.2-14.5-11.3-11.1z"},child:[]}]})(e)}function Tp(e){return fc({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M23 8c0 1.1-.9 2-2 2a1.7 1.7 0 0 1-.51-.07l-3.56 3.55c.05.16.07.34.07.52 0 1.1-.9 2-2 2s-2-.9-2-2c0-.18.02-.36.07-.52l-2.55-2.55c-.16.05-.34.07-.52.07s-.36-.02-.52-.07l-4.55 4.56c.05.16.07.33.07.51 0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2c.18 0 .35.02.51.07l4.56-4.55C8.02 9.36 8 9.18 8 9c0-1.1.9-2 2-2s2 .9 2 2c0 .18-.02.36-.07.52l2.55 2.55c.16-.05.34-.07.52-.07s.36.02.52.07l3.55-3.56A1.7 1.7 0 0 1 19 8c0-1.1.9-2 2-2s2 .9 2 2z"},child:[]}]})(e)}function Ep(e){return fc({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"},child:[]}]})(e)}function _p(e){return fc({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"m16 5-1.42 1.42-1.59-1.59V16h-1.98V4.83L9.42 6.42 8 5l4-4 4 4zm4 5v11c0 1.1-.9 2-2 2H6a2 2 0 0 1-2-2V10c0-1.11.89-2 2-2h3v2H6v11h12V10h-3V8h3a2 2 0 0 1 2 2z"},child:[]}]})(e)}const Mp=e.memo(t=>{const{flowId:n,chat:a}=t,[s,r]=e.useState(""),[o,i]=e.useState(!1),[l,c]=e.useState(null),[d,u]=e.useState(!1),[h,p]=e.useState(!1),[m,g]=e.useState(!0),f=e.useRef(null);e.useEffect(()=>{a?.show&&(g(!0),r(""),c(null),requestAnimationFrame(()=>{a.activeRequest?.request_id?f.current?.focus():f.current?.blur()}))},[a?.show,a?.activeRequest?.request_id,a?.messages]);const y=e.useCallback((e=!0)=>{const t=[];return e&&(t.push({content:{type:"text",text:s.trim()}}),l&&t.push({content:{type:"image_url",image_url:{url:l}}})),{id:`${n}-${Date.now()}`,request_id:a?.activeRequest?.request_id||"",type:"input_response",timestamp:(new Date).toISOString(),data:t}},[n,a?.activeRequest,s,l]),b=e.useCallback(()=>{a?.handlers?.onUserInput?.(y()),setTimeout(()=>{r(""),c(null)},10)},[a?.handlers,y]),v=e.useCallback(e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),b())},[b]),x=e.useCallback(e=>{r(e.target.value)},[]),w=e.useCallback(e=>{const t=e.target.files?.[0];if(t){const e=new FileReader;e.onloadend=()=>{c(e.result)},e.readAsDataURL(t)}e.target.value="",i(!1)},[]),C=e.useCallback(()=>{c(null)},[]),k=e.useCallback(()=>{r(""),c(null),a?.handlers?.onClose?a.handlers.onClose():g(!1)},[a?.handlers]),j=e.useCallback(()=>{i(!0)},[]),A=e.useCallback(()=>{i(!1),setTimeout(()=>{f.current?.focus()},0)},[]),S=e.useCallback(e=>{e.preventDefault(),e.stopPropagation(),o?i(!1):k()},[o,k]),N=e.useCallback(()=>{u(!0)},[]),T=`rf-${n}-chat-modal-input`,E=`rf-${n}-chat-modal-image`,_=`rf-${n}-chat-modal`,M=m&&(!0===a?.show||void 0!==a&&a.messages.length>0),I=a?.timeline?$n.jsx("div",{role:"button",className:"chat-modal-action clickable",onClick:N,title:"View Timeline","data-testid":`rf-${n}-chat-modal-timeline`,children:$n.jsx(Tp,{size:18})}):a?.handlers?.onInterrupt&&!a.active?$n.jsx("div",{role:"button",className:"chat-modal-action clickable",onClick:()=>a?.handlers?.onInterrupt?.(),title:"Interrupt",children:$n.jsx(Rc,{size:18})}):void 0,D=!a||!a?.mediaConfig||a?.mediaConfig?.allowedTypes.includes("image");return d&&a?.timeline?$n.jsx(wp,{flowId:n,isOpen:d,onClose:()=>u(!1),data:a.timeline}):$n.jsx(ou,{flowId:n,id:_,title:"Chat",isOpen:M,onClose:k,onCancel:S,beforeTitle:I,className:"chat-modal",hasMaximizeBtn:!0,hasCloseBtn:!a?.active,dataTestId:_,hasUnsavedChanges:!1,preventCloseIfUnsavedChanges:!1,children:$n.jsxs("div",{className:"modal-body",children:[a?.messages&&a.messages.length>0&&$n.jsx("div",{className:"chat-wrapper","data-flow-id":n,children:$n.jsx(Fd,{isDarkMode:!1,messages:a.messages,userParticipants:a.userParticipants,activeRequest:a.activeRequest})}),$n.jsx("div",{className:"input-prompt",children:a?.activeRequest?.prompt}),void 0!==a?.activeRequest?.request_id&&$n.jsxs("div",{className:"chat-input-container",children:[l&&$n.jsx("div",{className:"chat-image-preview",children:$n.jsxs("div",{className:"chat-image-wrapper",children:[$n.jsx("img",{src:l,alt:"Preview",className:"chat-preview-image"}),$n.jsx("button",{type:"button",className:"chat-remove-image-button",onClick:C,title:"Remove Image","aria-label":"Remove uploaded image",children:$n.jsx(bp,{size:14})})]})}),$n.jsx("div",{className:"chat-input-field-container",children:!0===a?.activeRequest?.password?$n.jsxs("div",{className:"password-toggle-container",children:[$n.jsx("input",{type:h?"text":"password",ref:f,placeholder:"Enter your password",id:T,"data-testid":T,value:s,disabled:void 0===a?.activeRequest?.request_id,onKeyDown:v,onChange:x,className:"chat-text-input password-input",autoComplete:"off",autoCorrect:"off",autoCapitalize:"none","aria-label":"Password input"}),$n.jsx("button",{type:"button",className:"password-toggle-button",onClick:()=>p(!h),title:h?"Hide password":"Show password","aria-label":h?"Hide password":"Show password",disabled:void 0===a?.activeRequest?.request_id,children:h?$n.jsx(pp,{size:18}):$n.jsx(mp,{size:18})})]}):$n.jsx("input",{type:"text",ref:f,placeholder:"Enter your message here",id:T,"data-testid":T,value:s,disabled:void 0===a?.activeRequest?.request_id,onKeyDown:v,onChange:x,className:"chat-text-input",autoComplete:"off",autoCorrect:"off",autoCapitalize:"none","aria-label":"User input"})}),void 0!==a?.activeRequest?.request_id&&$n.jsxs("div",{className:"chat-input-actions",children:[D?$n.jsxs("label",{htmlFor:E,className:"chat-upload-button",children:[$n.jsx(fp,{size:18,"aria-hidden":"true"}),$n.jsx("span",{className:"hidden",children:"Upload an image"}),$n.jsx("input",{type:"file",disabled:void 0===a?.activeRequest?.request_id,"aria-label":"Upload an image",id:E,"data-testid":E,accept:"image/*",className:"chat-upload-input",onChange:w,onClick:j,onBlur:A})]}):$n.jsx("div",{className:"chat-upload-button"}),$n.jsx("button",{type:"button",title:"Send",disabled:void 0===a?.activeRequest?.request_id,onClick:b,className:"chat-send-button","data-testid":`rf-${n}-chat-modal-submit`,"aria-label":"Send message",children:$n.jsx(Np,{size:20,"aria-hidden":"true"})})]})]})]})})});Mp.displayName="ChatModal";const Ip="https://api.waldiez.io/api/files",Dp=e.memo(t=>{const{flowId:n,isOpen:a,onClose:s,onExport:r,onDownload:o}=t,[i,l]=e.useState(!1),[c,d]=e.useState(""),[u,h]=e.useState(null),[p,m]=e.useState(!1),g=e.useCallback(e=>{l(e)},[]),f=e.useCallback(e=>{d(e.target.value)},[]),y=e.useCallback(e=>{Mr({flowId:n,message:e,level:"error",details:null,duration:5e3})},[n]),b=e.useCallback(async e=>{if(!p)try{m(!0);const e=r();if(!e)return void y("Error exporting flow.");const t=new Blob([e],{type:"application/json"}),a=new FormData;a.append("file",t,`${n}.waldiez`);const s=await fetch(`${Ip}/upload`,{method:"POST",headers:{Authorization:`Bearer ${c}`,content_type:"application/waldiez"},body:a,signal:AbortSignal.timeout(1e4)});if(!s.ok)throw new Error(`Error uploading to hub: ${s.statusText}`);const o=await s.json();if(u){const e=new FormData;e.append("file",u,u.name);const t=await fetch(`${Ip}/${o.id}/example`,{method:"POST",headers:{Authorization:`Bearer ${c}`,content_type:"application/csv"},body:e,signal:AbortSignal.timeout(3e4)});if(!t.ok)throw new Error(`Error uploading additional file: ${t.statusText}`)}Mr({flowId:n,message:"Flow uploaded to hub.",level:"success",details:null,duration:5e3})}catch(t){y("Error uploading to hub.")}finally{m(!1)}},[n,r,c,u,p,y]),v=e.useCallback(e=>{if(0===e.length)return void h(null);const t=e[0];if(!t)return void y("No file selected.");if(t.size>5242880)return void y("File size exceeds 5MB.");const n=t.name.split(".").pop()?.toLowerCase();"csv"===n?h(t):y("File is not a CSV.")},[y]);return $n.jsxs(ou,{flowId:n,isOpen:a,onClose:s,title:"Export Flow",dataTestId:`export-flow-modal-${n}`,children:[$n.jsx("div",{className:"modal-body",children:$n.jsxs("div",{className:"padding-10",children:[$n.jsx(ed,{id:`export-flow-modal-upload-${n}`,label:$n.jsx("span",{className:"checkbox-label-view",children:$n.jsxs("div",{children:["Share this flow to"," ",$n.jsx("a",{href:"https://hub.waldiez.io",target:"_blank",rel:"noopener noreferrer",className:"link",children:"Waldiez hub"})]})}),isChecked:i,onCheckedChange:g,"data-testid":`export-flow-modal-upload-checkbox-${n}`}),i&&$n.jsxs("div",{className:"flex-align-center full-width flex-column",children:[$n.jsx("div",{className:"margin-top-10 full-width",children:$n.jsx(Zd,{label:$n.jsx("div",{className:"no-padding margin-bottom-5",children:"Hub API Token:"}),value:c,name:"hub-api-token",onChange:f,placeholder:"Enter your hub API token",dataTestId:`hub-api-token-${n}`,className:"full-width",isPassword:!0})}),$n.jsxs("div",{className:"margin-top-10 margin-bottom-20 full-width",children:[$n.jsx("div",{className:"margin-bottom-10 padding-10 center",children:"Additional CSV file (results.csv) to include:"}),$n.jsx(qd,{allowedFileExtensions:[".csv"],flowId:n,onUpload:v,multiple:!1})]})]})]})}),$n.jsxs("div",{className:"modal-actions",children:[$n.jsx("button",{type:"reset",className:"modal-action-cancel",onClick:s,children:"Cancel"}),$n.jsxs("div",{className:"flex-align-center flex-row",children:[i&&$n.jsx("button",{type:"button",className:"save margin-right-20",onClick:b,"data-testid":`upload-to-hub-${n}`,disabled:p||!c,children:p?"Uploading...":"Upload to Hub"}),$n.jsx("button",{type:"button",className:"primary",onClick:o,children:"Download"})]})]})]})});Dp.displayName="ExportFlowModal";const Rp={searchTerm:"",remoteUrl:"",loadedFlowData:null,loading:!1,searchResults:null,selectedProps:{everything:!0,override:!0,name:!1,description:!1,tags:!1,requirements:!1,isAsync:!1,nodes:{models:[],tools:[],agents:[]},edges:[]}},zp=3e4,Op=t=>{const{flowId:n,state:a}=t,{remoteUrl:s,loadedFlowData:r,loading:o}=a,{onUpload:i,onRemoteUrlChange:l,onRemoteUrlSubmit:c,onClearLoadedFlowData:d,onSearchChange:u,onSearchSubmit:h,onSelectResult:p}=(t=>{const{flowId:n,state:a,initialState:s,onStateChange:r}=t,o=e.useCallback(e=>{r({loadedFlowData:e})},[r]),i=e.useCallback(e=>{r({remoteUrl:e})},[r]),l=e.useCallback(e=>{try{const t=Ys.toReactFlow(Ys.importFlow(e,n));if(0===t.nodes.length&&0===t.edges.length)return o(null),void Mr({flowId:n,message:"Failed to load flow",level:"error",details:null,duration:3e3});o(t)}catch(t){o(null),Mr({flowId:n,message:"Failed to parse flow data",level:"error",details:null,duration:3e3})}},[n,o]),c=e.useCallback(e=>{if(!e.length)return;const t=e[0];if(t)try{const e=new FileReader;e.onload=()=>{const t=e.result;"string"==typeof t&&l(t)},e.onerror=()=>{o(null),Mr({flowId:n,message:"Failed to read file",level:"error",details:null,duration:3e3})},e.readAsText(t)}catch(a){o(null),Mr({flowId:n,message:"Failed to upload file",level:"error",details:null,duration:3e3})}},[n,l,o]),d=e.useCallback(e=>{i(e.target.value)},[i]),u=e.useCallback(()=>{const e=new AbortController,t=e.signal;o(null),r({loading:!0});const i=setTimeout(()=>{e.abort()},zp);fetch(a.remoteUrl,{signal:t,mode:"cors",redirect:"follow",headers:{Accept:"application/json"}}).then(e=>{if(!e.ok)throw new Error(`Server responded with ${e.status}: ${e.statusText}`);return e.json()}).then(e=>{l(e)}).catch(e=>{Mr({flowId:n,message:`Failed to load flow: ${e.message}`,level:"error",duration:5e3}),r(s)}).finally(()=>{clearTimeout(i),r({loading:!1,remoteUrl:a.remoteUrl,searchResults:null})})},[n,a.remoteUrl,l,o,r,s]),h=e.useCallback(e=>{r({selectedProps:{...a.selectedProps,...e}})},[a.selectedProps,r]),p=e.useCallback(()=>{o(null)},[o]),m=e.useCallback(e=>{const t=e.target.value.trim();r({searchTerm:t})},[r]),g=e.useCallback(e=>{i(e.url),o(null),r({loading:!0});const t=new AbortController,c=t.signal,d=setTimeout(()=>{t.abort()},zp);fetch(`${e.url}?count=false`,{signal:c,mode:"cors",redirect:"follow",headers:{Accept:"application/json"}}).then(e=>{if(!e.ok)throw new Error(`Server responded with ${e.status}: ${e.statusText}`);return e.json()}).then(e=>{l(e)}).catch(e=>{Mr({flowId:n,message:`Failed to load flow from selected result: ${e.message}`,level:"error",duration:5e3}),r(s)}).finally(()=>{clearTimeout(d),r({loading:!1,remoteUrl:a.remoteUrl})})},[i,o,r,l,n,s,a.remoteUrl]);return{onUpload:c,onRemoteUrlChange:d,onRemoteUrlSubmit:u,onSelectedPropsChange:h,onClearLoadedFlowData:p,onSearchChange:m,onSearchSubmit:e.useCallback(()=>{const{searchTerm:e}=a;if(!e)return void Mr({flowId:n,message:"Please enter a search term",level:"warning",duration:3e3});const t=new AbortController,o=t.signal,i=setTimeout(()=>{t.abort()},zp);r({loading:!0}),fetch(`https://api.waldiez.io/api/search/?query=${encodeURIComponent(e)}`,{signal:o,headers:{Accept:"application/json"}}).then(e=>{if(!e.ok)throw new Error(`Server responded with ${e.status}: ${e.statusText}`);return e.json()}).then(e=>{const t=e.files.map(e=>({id:e.id,name:e.name,description:e.description,tags:e.tags?e.tags.split(",").map(e=>e.trim()):[],url:e.url,upload_date:e.upload_date}));r({searchResults:t})}).catch(e=>{Mr({flowId:n,message:`Failed to fetch search results: ${e.message}`,level:"error",duration:5e3}),r(s)}).finally(()=>{clearTimeout(i),r({loading:!1,searchTerm:e,remoteUrl:a.remoteUrl})})},[n,a,r,s]),onSelectResult:g}})(t);return $n.jsxs($n.Fragment,{children:[$n.jsx(Ud,{title:"Search the hub",dataTestId:`import-flow-modal-collapsible-search-${n}`,expanded:!0,children:$n.jsxs("div",{className:"margin-top-10 margin-bottom-10 full-width flex-column",children:[$n.jsxs("div",{className:"full-width flex-align-center",children:[$n.jsx("input",{type:"text",className:"text-input full-width margin-right-10",placeholder:"Search",onChange:u,onKeyDown:e=>{"Enter"===e.key&&h()}}),$n.jsx("button",{type:"button",title:"Search",className:"modal-action-submit",onClick:h,"data-testid":`import-flow-modal-search-submit-${n}`,disabled:o,children:"Search"})]}),$n.jsx("div",{className:"margin-top-10",children:a.searchResults&&a.searchResults.length>0&&$n.jsx("ul",{className:"search-results-list",children:a.searchResults.map(e=>$n.jsxs("li",{className:"search-result-item clickable",role:"button",onClick:()=>p(e),children:[$n.jsx("span",{className:"search-result-title",children:e.name}),$n.jsx("span",{className:"search-result-tags",children:e.tags.map(e=>$n.jsx("span",{className:"search-result-tag",children:e},e))}),$n.jsx("div",{className:"search-result-description",children:e.description})]},e.id))})})]})}),$n.jsx(Ud,{title:"Upload a file",dataTestId:`import-flow-modal-collapsible-local-${n}`,children:$n.jsx("div",{className:"padding-10 margin-left--10 margin-right--10",children:$n.jsx(qd,{flowId:n,onUpload:i,allowedFileExtensions:[".waldiez",".json"]})})}),$n.jsx(Ud,{title:"Import from URL",dataTestId:`import-flow-modal-collapsible-url-${n}`,children:$n.jsxs("div",{className:"margin-top-10 full-width flex-column",children:[$n.jsx("div",{className:"warning margin-bottom-10",children:$n.jsx("span",{children:"Warning: Importing from an untrusted source can be harmful"})}),$n.jsxs("div",{className:"margin-top-10 full-width flex-align-center",children:[$n.jsx("input",{type:"text",className:"text-input full-width margin-right-10",placeholder:"Enter URL",onChange:l,value:a.remoteUrl,"data-testid":`import-flow-modal-url-input-${n}`}),$n.jsx("button",{type:"button",title:"Load flow from URL",className:"modal-action-submit",onClick:c,"data-testid":`import-flow-modal-url-submit-${n}`,disabled:!s.startsWith("https://")||o,children:"Load"})]})]})}),$n.jsx("div",{className:"margin-top-20 center",children:r?$n.jsxs("div",{className:"flex-center",children:["Loaded flow: ",$n.jsx("span",{className:"bold italic",children:r.name}),$n.jsx(_d,{className:"margin-left-10 clickable","data-testid":"clear-loaded-flow-data",onClick:d})]}):$n.jsx("div",{children:"No flow loaded"})})]})},Lp=t=>{const{flowId:n,state:a}=t,{selectedProps:s}=a,{agentNodes:r,onAgentsChange:o,onAllNoneAgentsChange:i}=(t=>{const{flowId:n,state:a,onStateChange:s}=t,{selectedProps:r,loadedFlowData:o}=a,i=e.useMemo(()=>o?.nodes.filter(e=>"agent"===e.type)||[],[o?.nodes]),l=e.useCallback(e=>{s({selectedProps:{...r,...e}})},[r,s]),c=e.useCallback(()=>{const e=document.getElementById(`import-flow-modal-agents-all-none-${n}`);if(e)if(r.nodes.agents.length>0){const t=r.nodes.agents.length===i.length;e.indeterminate=!t,e.checked=t}else e.indeterminate=!1,e.checked=!1},[n,r.nodes.agents.length,i.length]);e.useEffect(()=>{c()},[c]);const d=e.useCallback(e=>{const t=r.nodes.agents.some(t=>t.id===e.id);l({nodes:{models:r.nodes.models,tools:r.nodes.tools,agents:t?r.nodes.agents.filter(t=>t.id!==e.id):[...r.nodes.agents,e]}})},[r.nodes,l]),u=e.useCallback(e=>{l({nodes:{models:r.nodes.models,tools:r.nodes.tools,agents:e?i:[]}})},[i,r.nodes.models,r.nodes.tools,l]);return{agentNodes:i,onAgentsChange:d,onAllNoneAgentsChange:u}})(t);return $n.jsxs("div",{className:"flow-data-preview-body-section",children:[$n.jsx("h4",{children:"Agents"}),r&&r?.length>1&&$n.jsx("div",{className:"flow-data-preview-body-section-row",children:$n.jsx(ed,{label:$n.jsx("div",{className:"bold",children:"Select All | None"}),isChecked:s.nodes.agents.length===r.length,onCheckedChange:i,id:`import-flow-modal-agents-all-none-${n}`,"data-testid":`import-flow-modal-agent-all-none-${n}`})}),r?.map(e=>{const t=e;return $n.jsx("div",{className:"flow-data-preview-body-section-row",children:$n.jsx(ed,{label:$n.jsxs("div",{children:[t.data.label,": ",t.data.description]}),id:`import-flow-modal-agent-checkbox-${e.id}`,isChecked:s.nodes.agents.some(t=>t.id===e.id),onCheckedChange:o.bind(null,e),"data-testid":`import-flow-modal-agent-checkbox-${e.id}`})},e.id)}),0===r?.length&&$n.jsx("div",{children:"No agents in this flow"})]})},Pp=t=>{const{flowId:n,state:a}=t,{loadedFlowData:s,selectedProps:r}=a,o=s?.tags.length?s?.tags.join(", "):"None",i=s?.requirements.length?s?.requirements.join(", "):"None",{onOverrideChange:l,onAllNoneInfoChange:c,onNameChange:d,onDescriptionChange:u,onIsASyncChange:h,onTagsChange:p,onRequirementsChange:m,onImportEverythingChange:g}=(t=>{const{flowId:n,state:a,onStateChange:s}=t,{selectedProps:r}=a,o=e.useCallback(e=>{s({selectedProps:{...r,...e}})},[r,s]),i=e.useMemo(()=>{const e=[r.name,r.description,r.tags,r.requirements],t=e.filter(Boolean).length;return{anySelected:t>0,allSelected:t===e.length,partiallySelected:t>0&&t<e.length}},[r.name,r.description,r.tags,r.requirements]),l=e.useCallback(()=>{const e=document.getElementById(`import-flow-info-all-none-${n}`);e&&(i.anySelected?(e.indeterminate=i.partiallySelected,e.checked=i.allSelected):(e.indeterminate=!1,e.checked=!1))},[n,i]);e.useEffect(()=>{l()},[l]);const c=e.useCallback(e=>{o({name:e,description:e,tags:e,requirements:e,isAsync:e})},[o]),d=e.useCallback(e=>{o({everything:e})},[o]);return{onOverrideChange:e.useCallback(e=>{o({override:e})},[o]),onNameChange:e.useCallback(e=>{o({name:e})},[o]),onDescriptionChange:e.useCallback(e=>{o({description:e})},[o]),onTagsChange:e.useCallback(e=>{o({tags:e})},[o]),onRequirementsChange:e.useCallback(e=>{o({requirements:e})},[o]),onIsASyncChange:e.useCallback(e=>{o({isAsync:e})},[o]),onAllNoneInfoChange:c,onImportEverythingChange:d}})(t);return $n.jsx($n.Fragment,{children:$n.jsxs("div",{className:"flow-data-preview-body",children:[$n.jsxs("div",{className:"flow-data-preview-body-section",children:[$n.jsx("h4",{children:"Flow Override"}),$n.jsx("div",{className:"flow-data-preview-body-section-row",children:$n.jsx(ed,{label:"Override existing flow with imported flow",isChecked:r.override,onCheckedChange:l,id:`import-flow-modal-override-${n}`,"data-testid":"override-flow-checkbox"})})]}),$n.jsxs("div",{className:"flow-data-preview-body-section",style:{marginTop:0},children:[$n.jsx("h4",{children:"What to import"}),$n.jsx("div",{className:"flow-data-preview-body-section-row",children:$n.jsx(ed,{label:"Import Everything",isChecked:r.everything,onCheckedChange:g,id:`import-flow-modal-everything-${n}`,"data-testid":"import-everything-checkbox"})})]}),!r.everything&&$n.jsxs("div",{className:"flow-data-preview-body-section",children:[$n.jsx("h4",{children:"Flow Information"}),$n.jsx("div",{className:"flow-data-preview-body-section-row",children:$n.jsx(ed,{label:$n.jsx("div",{className:"bold",children:"Select All | None"}),isChecked:r.name&&r.description&&r.tags&&r.requirements&&r.isAsync,onCheckedChange:c,id:`import-flow-info-all-none-${n}`,"data-testid":"import-flow-info-all-none"})}),$n.jsx("div",{className:"flow-data-preview-body-section-row",children:$n.jsx(ed,{label:$n.jsxs("div",{"data-testid":"import-flow-info-name-preview",children:["Name: ",s?.name]}),isChecked:r.name,onCheckedChange:d,id:`import-flow-info-name-${n}`,"data-testid":"import-flow-info-name"})}),$n.jsx("div",{className:"flow-data-preview-body-section-row",children:$n.jsx(ed,{label:$n.jsxs("div",{"data-testid":"import-flow-info-description-preview",children:["Description: ",s?.description]}),isChecked:r.description,onCheckedChange:u,id:`import-flow-info-description-${n}`,"data-testid":"import-flow-info-description"})}),$n.jsx("div",{className:"flow-data-preview-body-section-row",children:$n.jsx(ed,{label:$n.jsxs("div",{"data-testid":"import-flow-info-tags-preview",children:["Tags: ",o]}),isChecked:r.tags,onCheckedChange:p,id:`import-flow-info-tags-${n}`,"data-testid":"import-flow-info-tags"})}),$n.jsx("div",{className:"flow-data-preview-body-section-row",children:$n.jsx(ed,{label:$n.jsxs("div",{"data-testid":"import-flow-info-requirements-preview",children:["Requirements: ",i]}),isChecked:r.requirements,onCheckedChange:m,id:`import-flow-info-requirements-${n}`,"data-testid":"import-flow-info-requirements"})}),$n.jsx("div",{className:"flow-data-preview-body-section-row",children:$n.jsx(ed,{label:"Is Async",isChecked:r.isAsync,onCheckedChange:h,id:`import-flow-info-is-async-${n}`,"data-testid":"import-flow-info-is-async"})})]})]})})},Bp=t=>{const{state:n}=t,{modelNodes:a,onModelsChange:s,onAllNoneModelsChange:r}=(t=>{const{flowId:n,state:a,onStateChange:s}=t,{selectedProps:r,loadedFlowData:o}=a,i=e.useMemo(()=>o?.nodes.filter(e=>"model"===e.type)||[],[o?.nodes]),l=e.useCallback(e=>{s({selectedProps:{...r,...e}})},[r,s]),c=e.useCallback(()=>{const e=document.getElementById(`import-flow-modal-models-all-none-${n}`);if(e)if(r.nodes.models.length>0){const t=r.nodes.models.length===i.length;e.indeterminate=!t,e.checked=t}else e.indeterminate=!1,e.checked=!1},[n,r.nodes.models.length,i.length]);e.useEffect(()=>{c()},[c]);const d=e.useCallback(e=>{const t=r.nodes.models.some(t=>t.id===e.id);l({nodes:{models:t?r.nodes.models.filter(t=>t.id!==e.id):[...r.nodes.models,e],tools:r.nodes.tools,agents:r.nodes.agents}})},[r.nodes,l]),u=e.useCallback(e=>{l({nodes:{models:e?i:[],tools:r.nodes.tools,agents:r.nodes.agents}})},[i,r.nodes.tools,r.nodes.agents,l]);return{modelNodes:i,onModelsChange:d,onAllNoneModelsChange:u}})(t),{selectedProps:o}=n;return $n.jsxs("div",{className:"flow-data-preview-body-section",children:[$n.jsx("h4",{children:"Models"}),a&&a?.length>1&&$n.jsx(ed,{id:`import-flow-modal-models-all-none-${t.flowId}`,label:"Select All | None",isChecked:o.nodes.models.length===a.length,onCheckedChange:r,"data-testid":`import-flow-modal-model-all-none-${t.flowId}`}),a?.map(e=>{const t=e;return $n.jsx("div",{className:"flow-data-preview-body-section-row",children:$n.jsx(ed,{label:$n.jsxs("div",{children:[t.data.label,": ",t.data.description]}),id:`import-flow-modal-model-checkbox-${e.id}`,isChecked:o.nodes.models.some(t=>t.id===e.id),onCheckedChange:s.bind(null,e),"data-testid":`import-flow-modal-model-checkbox-${e.id}`})},e.id)}),0===a?.length&&$n.jsx("div",{children:"No models in this flow"})]})},Fp=t=>{const{flowId:n,state:a}=t,{selectedProps:s}=a,{toolNodes:r,onToolsChange:o,onAllNoneToolsChange:i}=(t=>{const{flowId:n,state:a,onStateChange:s}=t,{selectedProps:r,loadedFlowData:o}=a,i=e.useMemo(()=>o?.nodes.filter(e=>"tool"===e.type)||[],[o?.nodes]),l=e.useCallback(e=>{s({selectedProps:{...r,...e}})},[r,s]),c=e.useCallback(()=>{const e=document.getElementById(`import-flow-modal-tools-all-none-${n}`);if(e)if(r.nodes.tools.length>0){const t=r.nodes.tools.length===i.length;e.indeterminate=!t,e.checked=t}else e.indeterminate=!1,e.checked=!1},[n,r.nodes.tools.length,i.length]);e.useEffect(()=>{c()},[c]);const d=e.useCallback(e=>{const t=r.nodes.tools.some(t=>t.id===e.id);l({nodes:{models:r.nodes.models,tools:t?r.nodes.tools.filter(t=>t.id!==e.id):[...r.nodes.tools,e],agents:r.nodes.agents}})},[r.nodes,l]),u=e.useCallback(e=>{l({nodes:{models:r.nodes.models,tools:e?i:[],agents:r.nodes.agents}})},[i,r.nodes.models,r.nodes.agents,l]);return{toolNodes:i,onToolsChange:d,onAllNoneToolsChange:u}})(t);return $n.jsxs("div",{className:"flow-data-preview-body-section",children:[$n.jsx("h4",{children:"Tools"}),r&&r?.length>1&&$n.jsx(ed,{id:`import-flow-modal-tools-all-none-${n}`,label:"Select All | None",isChecked:s.nodes.tools.length===r.length,onCheckedChange:i,"data-testid":`import-flow-modal-tool-all-none-${n}`}),r?.map(e=>{const t=e;return $n.jsx("div",{className:"flow-data-preview-body-section-row",children:$n.jsx(ed,{label:$n.jsxs("div",{children:[t.data.label,": ",t.data.description]}),id:`import-flow-modal-tool-checkbox-${e.id}`,isChecked:s.nodes.tools.some(t=>t.id===e.id),onCheckedChange:o.bind(null,e),"data-testid":`import-flow-modal-tool-checkbox-${e.id}`})},e.id)}),0===r?.length&&$n.jsx("div",{children:"No tools in this flow"})]})},Up=e=>{const{flowId:t,state:n,onStateChange:a}=e;return $n.jsxs("div",{className:"flow-data-preview","data-testid":`import-flow-modal-preview-step-${t}-view`,children:[$n.jsx(Pp,{flowId:t,state:n,onStateChange:a}),!n.selectedProps.everything&&$n.jsxs($n.Fragment,{children:[$n.jsx("div",{className:"flow-data-preview-header",children:$n.jsx("h3",{children:"Flow Nodes"})}),$n.jsxs("div",{className:"flow-data-preview-body",children:[$n.jsx(Bp,{flowId:t,state:n,onStateChange:a}),$n.jsx(Fp,{flowId:t,state:n,onStateChange:a}),$n.jsx(Lp,{flowId:t,state:n,onStateChange:a})]})]})]})},Hp=t=>{const{flowId:n,isOpen:a}=t,{state:s,initialState:r,onStateChange:o,onClose:i,onBack:l,onForward:c}=(t=>{const{onClose:n,typeShown:a,onTypeShownChange:s}=t,[r,o]=e.useState(Rp),i=jh(e=>e.importFlow),l=jh(e=>e.onFlowChanged),c=e.useCallback(()=>{const{loadedFlowData:e,selectedProps:t}=r;e&&(i(t,e,a),s("agent"),l())},[r,i,a,s,l]),d=e.useCallback(e=>{0===e&&n()},[n]),u=e.useCallback(e=>{1===e&&(c(),n())},[c,n]),h=e.useCallback(()=>{o(Rp),n()},[n]),p=e.useCallback(e=>{o(t=>({...t,...e}))},[]);return e.useMemo(()=>({state:r,initialState:Rp,onStateChange:p,onClose:h,onBack:d,onForward:u}),[r,p,h,d,u])})(t);return $n.jsx(ou,{flowId:n,isOpen:a,onClose:i,title:"Import Flow",dataTestId:`import-flow-modal-${n}`,children:$n.jsx("div",{className:"modal-body padding-10",children:$n.jsxs(Ap,{activeStep:0,canGoForward:!!s.loadedFlowData,firstBackTitle:"Cancel",lastNextTitle:"Import",onBack:l,onForward:c,children:[$n.jsx(jp,{id:`import-flow-modal-load-step-${n}`,title:"Load Flow",children:$n.jsx(Op,{initialState:r,flowId:n,state:s,onStateChange:o})}),$n.jsx(jp,{id:`import-flow-modal-preview-step-${n}`,title:"Preview Flow",children:s.loadedFlowData?$n.jsx(Up,{flowId:n,state:s,onStateChange:o}):null})]})})})};function Wp(e){return fc({attr:{role:"img",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M7.157 22.201A1.784 1.799 0 0 1 5.374 24a1.784 1.799 0 0 1-1.784-1.799 1.784 1.799 0 0 1 1.784-1.799 1.784 1.799 0 0 1 1.783 1.799zM20.582 1.427a1.415 1.427 0 0 1-1.415 1.428 1.415 1.427 0 0 1-1.416-1.428A1.415 1.427 0 0 1 19.167 0a1.415 1.427 0 0 1 1.415 1.427zM4.992 3.336A1.047 1.056 0 0 1 3.946 4.39a1.047 1.056 0 0 1-1.047-1.055A1.047 1.056 0 0 1 3.946 2.28a1.047 1.056 0 0 1 1.046 1.056zm7.336 1.517c3.769 0 7.06 1.38 8.768 3.424a9.363 9.363 0 0 0-3.393-4.547 9.238 9.238 0 0 0-5.377-1.728A9.238 9.238 0 0 0 6.95 3.73a9.363 9.363 0 0 0-3.394 4.547c1.713-2.04 5.004-3.424 8.772-3.424zm.001 13.295c-3.768 0-7.06-1.381-8.768-3.425a9.363 9.363 0 0 0 3.394 4.547A9.238 9.238 0 0 0 12.33 21a9.238 9.238 0 0 0 5.377-1.729 9.363 9.363 0 0 0 3.393-4.547c-1.712 2.044-5.003 3.425-8.772 3.425Z"},child:[]}]})(e)}function qp(e){return fc({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M10.94 13.5l-1.32 1.32a3.73 3.73 0 0 0-7.24 0L1.06 13.5 0 14.56l1.72 1.72-.22.22V18H0v1.5h1.5v.08c.077.489.214.966.41 1.42L0 22.94 1.06 24l1.65-1.65A4.308 4.308 0 0 0 6 24a4.31 4.31 0 0 0 3.29-1.65L10.94 24 12 22.94 10.09 21c.198-.464.336-.951.41-1.45v-.1H12V18h-1.5v-1.5l-.22-.22L12 14.56l-1.06-1.06zM6 13.5a2.25 2.25 0 0 1 2.25 2.25h-4.5A2.25 2.25 0 0 1 6 13.5zm3 6a3.33 3.33 0 0 1-3 3 3.33 3.33 0 0 1-3-3v-2.25h6v2.25zm14.76-9.9v1.26L13.5 17.37V15.6l8.5-5.37L9 2v9.46a5.07 5.07 0 0 0-1.5-.72V.63L8.64 0l15.12 9.6z"},child:[]}]})(e)}function Vp(e){return fc({attr:{viewBox:"0 0 16 16",fill:"currentColor"},child:[{tag:"path",attr:{d:"M6 9.5C6.93191 9.5 7.71496 10.1374 7.93699 11H13.5C13.7761 11 14 11.2239 14 11.5C14 11.7455 13.8231 11.9496 13.5899 11.9919L13.5 12L7.93673 12.001C7.71435 12.8631 6.93155 13.5 6 13.5C5.06845 13.5 4.28565 12.8631 4.06327 12.001L2.5 12C2.22386 12 2 11.7761 2 11.5C2 11.2545 2.17688 11.0504 2.41012 11.0081L2.5 11H4.06301C4.28504 10.1374 5.06809 9.5 6 9.5ZM6 10.5C5.44772 10.5 5 10.9477 5 11.5C5 12.0523 5.44772 12.5 6 12.5C6.55228 12.5 7 12.0523 7 11.5C7 10.9477 6.55228 10.5 6 10.5ZM10 2.5C10.9319 2.5 11.715 3.13738 11.937 3.99998L13.5 4C13.7761 4 14 4.22386 14 4.5C14 4.74546 13.8231 4.94961 13.5899 4.99194L13.5 5L11.9367 5.00102C11.7144 5.86312 10.9316 6.5 10 6.5C9.06845 6.5 8.28565 5.86312 8.06327 5.00102L2.5 5C2.22386 5 2 4.77614 2 4.5C2 4.25454 2.17688 4.05039 2.41012 4.00806L2.5 4L8.06301 3.99998C8.28504 3.13738 9.06809 2.5 10 2.5ZM10 3.5C9.44772 3.5 9 3.94772 9 4.5C9 5.05228 9.44772 5.5 10 5.5C10.5523 5.5 11 5.05228 11 4.5C11 3.94772 10.5523 3.5 10 3.5Z"},child:[]}]})(e)}const Gp=e=>{const{flowId:n,skipExport:a,skipImport:s,selectedNodeType:r,onAddNode:o,onRun:i,onStepRun:l,onConvertToPy:c,onConvertToIpynb:d,onOpenImportModal:u,onExport:h}=e,p=jh(e=>e.isReadOnly),m=jh(e=>e.onRun),g=jh(e=>e.onStepRun),f=jh(e=>e.onConvert),y="boolean"==typeof p&&p,b=!y&&("boolean"!=typeof s||!s),v=!y&&("boolean"!=typeof a||!a),x=!y&&"function"==typeof m,w=!y&&"function"==typeof f,C=!y&&"function"==typeof g,{isDark:k,toggleTheme:j}=Qn();return $n.jsxs($n.Fragment,{children:["agent"!==r&&!1===p&&$n.jsx(t.Panel,{position:"top-left",children:$n.jsxs("button",{type:"button",className:"editor-nav-action add-node currentColor",onClick:o,title:`Add ${r}`,"data-testid":`add-${r}-node`,children:[$n.jsx(_c,{}),"Add ",r]})}),$n.jsx(t.Panel,{position:"top-right",children:$n.jsxs("div",{className:"editor-nav-actions",children:[(x||w||C)&&$n.jsxs($n.Fragment,{children:[C&&$n.jsx("button",{type:"button",className:"editor-nav-action",onClick:l,title:"Run step-by-step","data-testid":`step-by-step-${n}`,children:$n.jsx(qp,{})}),x&&$n.jsx("button",{type:"button",className:"editor-nav-action",onClick:i,title:"Run flow","data-testid":`run-${n}`,children:$n.jsx(pd,{})}),w&&$n.jsx("button",{type:"button",className:"editor-nav-action to-python",onClick:c,title:"Convert to Python","data-testid":`convert-${n}-to-py`,children:$n.jsx(ld,{})}),w&&$n.jsx("button",{type:"button",className:"editor-nav-action to-jupyter",onClick:d,title:"Convert to Jupyter Notebook","data-testid":`convert-${n}-to-ipynb`,children:$n.jsx(Wp,{})})]}),b&&$n.jsx("button",{type:"button",className:"editor-nav-action",onClick:u,title:"Import flow","data-testid":`import-flow-${n}-button`,children:$n.jsx(vd,{})}),v&&$n.jsx("button",{type:"button",className:"editor-nav-action",onClick:h,title:"Export flow","data-testid":`export-flow-${n}-button`,children:$n.jsx(_p,{size:24})}),$n.jsx("button",{type:"button",className:"editor-nav-action",title:"Github repository","data-testid":`open-docs-${n}`,children:$n.jsx("a",{href:"https://github.com/waldiez/waldiez",target:"_blank",rel:"noopener noreferrer",children:$n.jsx(id,{})})}),$n.jsx("button",{type:"button",className:"editor-nav-action",onClick:j,title:"Toggle theme","data-testid":`toggle-theme-${n}`,children:k?$n.jsx(Sd,{}):$n.jsx(Cd,{})})]})})]})};function Kp(e){return fc({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M263.4 75.12c-13 0-24.4 6.3-34.8 17.96-10.3 11.62-18.9 28.52-24.6 47.62-8.6 28.5-10.4 61.8-4.8 88.8l65.8-9.4 62.9 7.4c5.2-26.6 3.3-59-5.1-86.8-5.7-19.1-14.3-36-24.6-47.62-10.4-11.66-21.8-17.96-34.8-17.96zm144 35.08c-11.6 0-21.9 5.7-31.3 16.5-9.3 10.8-17.2 26.6-22.4 44.4-1.9 6.6-3.5 13.4-4.7 20.3.4 12.5-.5 24.8-2.6 36.4 0 .6 0 1.2.1 1.9l29.9 3.5-61.9 10.9-49.3-5.8-168.44 24 83.54 30 109.2-18.6-106 54.1-115.68-61.3-28.93 4.1L47.3 302l-29.27-11.9 37.91 44.2 4.73 17.7 43.83 20.9 63.1-16.5-56.8 41.9-42.17-16.5 10.86 40.6 24.01 7-41.99 17.2 97.39.4-52.8 21.9 107.1-7.6c73.4 25.8 90.3 22.4 173.3 30.1l-68.2-25.5 24.3-12.6-57.9-39.6c77.9 24.1 107.9 16.5 183.6 2.3l-42.2-6.2 51.8-27 .4-12.7 27.5-57.6-26.3 18.6 1-29.4-63.2 51.5-113-34.4 116.2 7.9 60.1-28.9.5-14.1 16.1-40.9-30.6 19.1-37.1-4.3-77.4 8.7s22.1-6.9 42.9-13.2l21.6-15.2 50.5 5.9c3-23 .8-49.6-6-72.7-5.2-17.8-13.1-33.6-22.4-44.4-9.4-10.8-19.7-16.5-31.3-16.5zM139.6 121c-12.1 0-22.6 5.5-32.1 15.4-9.48 10-17.39 24.6-22.65 41-7.12 22.1-9.18 47.5-5.73 69.2l102.08-14.5c-5.3-25.4-4.3-54.1 1.5-80.9-3.3-5.6-7-10.6-11-14.8-9.5-9.9-20-15.4-32.1-15.4zm68.2 244.4l73.2 13.8 78-9-79.6 30.8z"},child:[]}]})(e)}function $p(e){return fc({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M494 61.363l-82.58 77.934 78.994 132.96 3.586-4.458V61.362zM18 62.5v225.893c4.48.582 9.863.903 15.295.96 11.87.125 21.654-.65 27.15-1.144L113.1 154.974 18 62.5zm389.154 104.86l-7.04 4.556c-.15.097-5.362 3.336-6.893 4.29l-10.605 6.42.15.09c-4.914 3.057-6.28 3.917-11.857 7.38-2.83 1.757-2.9 1.798-5.584 3.465-20.29-10.907-42.306-19.29-67.998-25.882-32.312 9.762-66.542 23.888-100.722 37.142 14.19 17.087 29.96 22.651 45.845 22.85 18.42.23 37.25-7.78 50.218-16.754l7.4-5.12 7.426 10.73 115.453 83.33 45.112-29.987-60.906-102.51zM126.477 170.1L81.11 284.887 97.76 297.69l30.795-34.905 2.467-2.795 3.72-.232c1.5-.094 2.98-.138 4.44-.13 10.212.066 19.342 2.716 26.19 8.76 5.072 4.472 8.444 10.426 10.4 17.32l2.28-.142c11.995-.75 22.802 1.725 30.63 8.63 7.827 6.907 11.63 17.323 12.38 29.32l.07 1.08c6.44 1.216 12.205 3.752 16.893 7.888 7.828 6.906 11.63 17.32 12.38 29.317l.197 3.12c.642.202 1.275.424 1.9.658l2.033-2.853 5.47-7.678 2.813-3.95 7.33 5.223 59.428 42.336c6.464-1.594 10.317-4.075 12.46-7.086 2.147-3.012 3.233-7.47 2.624-14.107l-71.258-51.03-7.318-5.24 5.19-7.246 6.67-9.365 7.33 5.223 80.335 57.226c6.464-1.593 10.32-4.074 12.463-7.085 2.144-3.01 3.23-7.457 2.625-14.082l-92.398-65.55-7.34-5.21 10.414-14.68 7.343 5.208 92.414 65.565c6.47-1.594 10.327-4.075 12.473-7.088 2.148-3.015 3.233-7.476 2.62-14.125l-110.44-79.71c-14.655 8.688-33.402 15.648-53.557 15.396-23.587-.295-48.817-11.566-67.377-40.05a9 9 0 0 1 4.343-13.327c13.014-4.945 26.163-10.17 39.343-15.354l-92.056-6.834zm12.902 107.62l-47.564 53.91c.927 6.746 3.04 10.942 5.887 13.454 2.847 2.512 7.275 4.085 14.084 4.164l47.563-53.908c-.927-6.747-3.04-10.945-5.887-13.457-2.847-2.512-7.274-4.084-14.084-4.162zm43.308 25.81l-53.713 60.88c.926 6.747 3.04 10.945 5.886 13.457 2.85 2.51 7.275 4.083 14.085 4.16l53.713-60.878c-.926-6.748-3.04-10.944-5.887-13.457-2.846-2.512-7.273-4.085-14.083-4.164zm29.34 38.286l-47.56 53.91c.927 6.746 3.04 10.943 5.887 13.456 2.848 2.512 7.275 4.083 14.084 4.162L232 359.44c-.927-6.75-3.04-10.947-5.887-13.46-2.847-2.512-7.274-4.083-14.084-4.162zm24.702 39.137l-38.794 44.28c.925 6.76 3.038 10.962 5.888 13.476 2.845 2.51 7.267 4.082 14.067 4.163l38.796-44.28c-.926-6.758-3.04-10.96-5.89-13.476-2.844-2.51-7.266-4.08-14.066-4.162zm35.342 4.79c1.694 4.62 2.673 9.74 3.014 15.192l.232 3.704-8.277 9.448 26.724 19.037c6.464-1.594 10.316-4.075 12.46-7.086 2.145-3.01 3.233-7.464 2.628-14.093l-36.78-26.2z"},child:[]}]})(e)}function Zp(e){return fc({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M13 17.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0Zm-.25-8.25a.75.75 0 0 0-1.5 0v4.5a.75.75 0 0 0 1.5 0v-4.5Z"},child:[]},{tag:"path",attr:{d:"M9.836 3.244c.963-1.665 3.365-1.665 4.328 0l8.967 15.504c.963 1.667-.24 3.752-2.165 3.752H3.034c-1.926 0-3.128-2.085-2.165-3.752Zm3.03.751a1.002 1.002 0 0 0-1.732 0L2.168 19.499A1.002 1.002 0 0 0 3.034 21h17.932a1.002 1.002 0 0 0 .866-1.5L12.866 3.994Z"},child:[]}]})(e)}function Qp(e){return fc({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M5.22 8.22a.749.749 0 0 0 0 1.06l6.25 6.25a.749.749 0 0 0 1.06 0l6.25-6.25a.749.749 0 1 0-1.06-1.06L12 13.939 6.28 8.22a.749.749 0 0 0-1.06 0Z"},child:[]}]})(e)}function Yp(e){return fc({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M18.78 15.78a.749.749 0 0 1-1.06 0L12 10.061 6.28 15.78a.749.749 0 1 1-1.06-1.06l6.25-6.25a.749.749 0 0 1 1.06 0l6.25 6.25a.749.749 0 0 1 0 1.06Z"},child:[]}]})(e)}const Xp=({edge:e,transform:t})=>{if(!e)return null;const n=e.data?.label??"";if(""===n)return null;const a=n.length>20?`${n.slice(0,20)}...`:n;return $n.jsx("div",{style:{position:"absolute",width:"max-content",color:"currentcolor",fontSize:12,fontWeight:600,left:"50%",top:"50%",zIndex:10001,transform:t},className:"nodrag nopan",children:a})},Jp=({edge:e,transform:t,edgeNumber:n,children:a})=>e?$n.jsx("div",{style:{position:"absolute",color:"currentcolor",width:"max-content",fontSize:12,fontWeight:600,zIndex:10001,transform:t},className:"nodrag nopan",children:a||n||""}):null;Jp.displayName="EdgePosition";const em=(e,n,a,s,r,o,i,l,c,d={})=>{const{leftOffset:u=60,rightOffset:h=60,topOffset:p=50,bottomOffset:m=50,perpOffset:g=20}=d;if("source"===c){let a=e,s=n;switch(i){case t.Position.Right:a+=h,s+=g;break;case t.Position.Left:a-=u,s+=g;break;case t.Position.Top:s-=p,a+=g;break;case t.Position.Bottom:s+=m,a+=g}return`translate(-50%, -50%) translate(${a-r}px, ${s-o}px)`}{let e=a,n=s;switch(l){case t.Position.Right:e+=h,n+=g;break;case t.Position.Left:e-=u,n+=g;break;case t.Position.Top:n-=p,e+=g;break;case t.Position.Bottom:n+=m,e+=g}let i=`translate(-50%, -50%) translate(${e-r}px, ${n-o}px)`;return l===t.Position.Left?i+=" rotate(-90deg)":l===t.Position.Right&&(i+=" rotate(90deg)"),i}},tm=e.memo(e=>$n.jsx(om,{...e,type:"chat"})),nm=e.memo(e=>$n.jsx(om,{...e,type:"nested"})),am=e.memo(e=>$n.jsx(om,{...e,type:"group"})),sm=e.memo(e=>$n.jsx(om,{...e,type:"hidden"})),rm=(e,t,n)=>{if("group"===e)return((e,t)=>{switch(e){case"handoff":return $n.jsx($p,{size:t});case"nested":return $n.jsx(Kp,{size:t});default:return $n.jsx(Ep,{size:t})}})(t,18);switch(e){case"chat":return $n.jsx(Ep,{color:n,size:18});case"nested":return $n.jsx(Kp,{color:n,size:18});default:return null}},om=e.memo(n=>{const{id:a,type:s,data:r,style:o={},sourceX:i,sourceY:l,targetX:c,targetY:d,markerEnd:u,sourcePosition:h,targetPosition:p}=n,{edgePath:m,labelX:g,labelY:f,sourceAgent:y,targetAgent:b,isReadOnly:v,onOpenModal:x,onDelete:w,getEdgeById:C,getEdgeColor:k,getEdgeNumber:j}=(n=>{const{id:a,source:s,target:r,type:o,data:i,sourceX:l,sourceY:c,targetX:d,targetY:u,sourcePosition:h,targetPosition:p}=n,m=jh(e=>e.isReadOnly),g=jh(e=>e.deleteEdge),f=jh(e=>e.getEdgeById),y=jh(e=>e.getAgentById),b=jh(e=>e.onEdgeDoubleClick),v=jh(e=>e.updateEdgeData),x=y(s),w=y(r),[C,k,j]=e.useMemo(()=>t.getSimpleBezierPath({sourceX:l,sourceY:c,sourcePosition:h,targetX:d,targetY:u,targetPosition:p}),[l,c,h,d,u,p]),A=e.useCallback(e=>{const t=f(a);t&&b(e,t)},[a,f,b]),S=e.useCallback(()=>{g(a)},[g,a]),N=e.useCallback(()=>{const e=y(s);if(!e)return;const t=e.data.agentType;return We.includes(t)?Nn[t]:void 0},[y,s]),T=e.useCallback(()=>{if(!x||!i)return"";if("chat"===o)return"number"==typeof i.order&&i.order>=0?`${i.order+1}`:"0";if("nested"===o){const e=x.data.label;return`${e?.charAt(0)?.toUpperCase()||""}.${i.position}`}return""},[x,i,o]),E=e.useCallback(e=>{const t=f(a);t&&v(a,{...t.data,description:e.target.value})},[a,f,v]);return{edgePath:C,labelX:k,labelY:j,sourceAgent:x,targetAgent:w,isReadOnly:m,getEdgeById:f,onOpenModal:A,onDelete:S,getEdgeColor:N,getEdgeNumber:T,onDescriptionChange:E}})(n),[A,S]=e.useState(!1);if("hidden"===s||!y||!b||!r)return null;const N=e.useMemo(()=>"group"===s?((e,t)=>"group_manager"===t.data.agentType?"toManager":"group_manager"===e.data.agentType?"fromManager":e.data.parentId&&t.data.parentId?"handoff":"nested")(y,b):"toManager",[s,y,b]),T=j(),E=C(a),_=k(),M=e.useMemo(()=>rm(s,N,_),[s,N,_]),I=e.useMemo(()=>({edgeStart:em(i,l,c,d,g,f,h,p,"source",{leftOffset:10,rightOffset:20,topOffset:10,bottomOffset:20,perpOffset:20}),edgeEnd:em(i,l,c,d,g,f,h,p,"target",{leftOffset:10,rightOffset:10,topOffset:10,bottomOffset:10,perpOffset:-10})}),[i,l,c,d,g,f,h,p]),D=e.useCallback(e=>{!0!==v&&(A?(e.target.blur(),S(!1)):(e.target.focus(),S(!0)))},[v,A]),R=e.useCallback(e=>{e.target.blur(),S(!1)},[]),z=e.useMemo(()=>""!==T?$n.jsxs("div",{className:"agent-edge-view clickable",children:[$n.jsx(Jp,{edge:E,transform:I.edgeStart,children:"0"===T?$n.jsx(Zp,{size:16,className:"edge-position-warning-icon"}):T}),M]}):"group"===s?$n.jsxs("div",{className:"agent-edge-view clickable",children:["fromManager"===N&&$n.jsx(Jp,{edge:E,transform:I.edgeStart,children:$n.jsx(Zp,{size:16,className:"edge-position-warning-icon"})}),"toManager"===N&&$n.jsx(Jp,{edge:E,transform:I.edgeStart,children:$n.jsx("div",{className:"edge-position",children:"1"})}),$n.jsx("div",{className:"edge-icon",children:M})]}):$n.jsx("div",{className:"agent-edge-view clickable",children:M}),[T,s,M,E,I,N]);return $n.jsxs($n.Fragment,{children:[$n.jsx(t.BaseEdge,{path:m,markerEnd:u,style:{...o,color:_}}),$n.jsx(t.EdgeLabelRenderer,{children:$n.jsxs("div",{style:{position:"absolute",transform:`translate(-50%, -50%) translate(${g}px,${f}px)`,pointerEvents:"all"},className:`nodrag nopan clickable agent-edge-box ${y.data.agentType}`,onClick:D,"data-testid":`edge-${a}-box`,tabIndex:0,onBlur:R,children:[A&&$n.jsxs("div",{className:"edge-actions",children:[$n.jsx("div",{title:"Delete",role:"button",onClick:w,className:"delete-edge clickable","data-testid":`delete-edge-${a}`,"aria-label":"Delete edge",children:$n.jsx(Oc,{size:12})}),$n.jsx("div",{title:"Edit",role:"button",onClick:x,className:"open-edge-modal clickable","data-testid":`open-edge-modal-${a}`,"aria-label":"Edit edge",children:$n.jsx(Vp,{size:12})})]}),z,$n.jsx(Xp,{edge:E,transform:I.edgeEnd})]})})]})});var im,lm;function cm(){if(lm)return im;lm=1;var e="undefined"!=typeof Element,t="function"==typeof Map,n="function"==typeof Set,a="function"==typeof ArrayBuffer&&!!ArrayBuffer.isView;function s(r,o){if(r===o)return!0;if(r&&o&&"object"==typeof r&&"object"==typeof o){if(r.constructor!==o.constructor)return!1;var i,l,c,d;if(Array.isArray(r)){if((i=r.length)!=o.length)return!1;for(l=i;0!==l--;)if(!s(r[l],o[l]))return!1;return!0}if(t&&r instanceof Map&&o instanceof Map){if(r.size!==o.size)return!1;for(d=r.entries();!(l=d.next()).done;)if(!o.has(l.value[0]))return!1;for(d=r.entries();!(l=d.next()).done;)if(!s(l.value[1],o.get(l.value[0])))return!1;return!0}if(n&&r instanceof Set&&o instanceof Set){if(r.size!==o.size)return!1;for(d=r.entries();!(l=d.next()).done;)if(!o.has(l.value[0]))return!1;return!0}if(a&&ArrayBuffer.isView(r)&&ArrayBuffer.isView(o)){if((i=r.length)!=o.length)return!1;for(l=i;0!==l--;)if(r[l]!==o[l])return!1;return!0}if(r.constructor===RegExp)return r.source===o.source&&r.flags===o.flags;if(r.valueOf!==Object.prototype.valueOf&&"function"==typeof r.valueOf&&"function"==typeof o.valueOf)return r.valueOf()===o.valueOf();if(r.toString!==Object.prototype.toString&&"function"==typeof r.toString&&"function"==typeof o.toString)return r.toString()===o.toString();if((i=(c=Object.keys(r)).length)!==Object.keys(o).length)return!1;for(l=i;0!==l--;)if(!Object.prototype.hasOwnProperty.call(o,c[l]))return!1;if(e&&r instanceof Element)return!1;for(l=i;0!==l--;)if(("_owner"!==c[l]&&"__v"!==c[l]&&"__o"!==c[l]||!r.$$typeof)&&!s(r[c[l]],o[c[l]]))return!1;return!0}return r!=r&&o!=o}return im=function(e,t){try{return s(e,t)}catch(n){if((n.message||"").match(/stack|recursion/i))return!1;throw n}}}tm.displayName="WaldiezEdgeChat",nm.displayName="WaldiezEdgeNested",am.displayName="WaldiezEdgeGroup",sm.displayName="WaldiezEdgeHidden",om.displayName="WaldiezEdgeCommon";const dm=V(cm()),um=[{label:"System",value:"system"},{label:"User",value:"user"},{label:"Assistant",value:"assistant"}],hm=[{label:"None",value:null},{label:"Reflection with LLM",value:"reflectionWithLlm"},{label:"Last Message",value:"lastMsg"}],pm=[{label:"Chat",value:"chat"},{label:"Nested Chat",value:"nested"}],mm={reflectionWithLlm:"Reflection with LLM",lastMsg:"Last Message",none:"None"},gm=t=>{const{data:n,edgeId:a,onTypeChange:s,skipDescription:r=!1}=t,{summaryRoleOptions:o,summaryOptions:i,edgeTypeOptions:l,summaryMethodLabel:c,summaryRoleValue:d,summaryRoleLabel:u,currentSelectedChatType:h,onLabelChange:p,onDescriptionChange:m,onClearHistoryChange:g,onMaxTurnsChange:f,onSummaryMethodChange:y,onLlmPromptChange:b,onLlmSummaryRoleChange:v}=(t=>{const{data:n,edgeType:a,onDataChange:s}=t,r=e.useCallback(e=>{s({description:e.target.value})},[s]),o=e.useCallback(e=>{s({label:e.target.value})},[s]),i=e.useCallback(e=>{n.clearHistory!==e&&"function"==typeof s&&s({clearHistory:e})},[s,n.clearHistory]),l=e.useCallback(e=>{s({maxTurns:e})},[s]),c=e.useCallback(e=>{e&&s({summary:{method:e.value,prompt:n.summary.prompt,args:n.summary.args}})},[s,n.summary.prompt,n.summary.args]),d=e.useCallback(e=>{s({summary:{method:n.summary.method,prompt:e.target.value,args:{...n.summary.args}}})},[s,n.summary.method,n.summary.args]),u=e.useCallback(e=>{e&&s({summary:{method:n.summary.method,prompt:n.summary.prompt,args:{...n.summary.args,summary_role:e.value}}})},[s,n.summary.method,n.summary.prompt,n.summary.args]),h=e.useCallback(()=>{const e=n.summary?.args||{};if("summary_role"in e&&["system","user","assistant"].includes(e.summary_role)){const t=e.summary_role;return t[0].toUpperCase()+t.slice(1)}return"System"},[n.summary?.args]),p=e.useMemo(()=>mm[n.summary?.method??"none"],[n.summary?.method]),m=e.useMemo(()=>n.summary?.args?.summary_role??"system",[n.summary?.args?.summary_role]),g=e.useMemo(()=>h(),[h]),f=e.useMemo(()=>({label:pm.find(e=>e.value===a)?.label||"Chat",value:a}),[a]);return{summaryRoleOptions:um,summaryOptions:hm,edgeTypeOptions:pm,summaryMethodLabel:p,summaryRoleValue:m,summaryRoleLabel:g,currentSelectedChatType:f,onLabelChange:o,onDescriptionChange:r,onClearHistoryChange:i,onMaxTurnsChange:l,onSummaryMethodChange:c,onLlmPromptChange:d,onLlmSummaryRoleChange:u}})(t);return $n.jsxs("div",{className:"flex-column",children:[$n.jsxs("div",{className:"margin-top--10",children:[$n.jsx(Hd,{htmlFor:`select-chat-type-${a}`,label:"Chat Type:",info:"The type of the chat. Could be Chat or Nested Chat. Chats are executed in a sequential order. Nested Chats are not always executed (i.e., triggered)."}),$n.jsx("label",{className:"hidden",htmlFor:`select-chat-type-${a}`,children:"Chat Type:"}),$n.jsx(nd,{options:l,value:h,onChange:s,inputId:`select-chat-type-${a}`})]}),$n.jsx(Zd,{label:"Label:",name:"edge-label",value:n.label,onChange:p,dataTestId:`edge-${a}-label-input`}),!r&&$n.jsxs("div",{className:"margin-top-10",children:[$n.jsx("label",{htmlFor:`edge-${a}-description-input`,children:"Description:"}),$n.jsx(Gd,{rows:2,value:n.description,placeholder:"Enter a description",onChange:m,"data-testid":`edge-${a}-description-input`})]}),$n.jsx("div",{className:"margin-top-10"}),$n.jsx(ed,{label:"Clear History",isChecked:n.clearHistory,onCheckedChange:g,id:`edge-${a}-clear-history-checkbox`}),$n.jsx(Fu,{name:"max-turns",label:"Max Turns:",min:0,max:100,value:n.maxTurns,onChange:f,onNull:0,setNullOnLower:!0,onLowerLabel:"No limit",labelInfo:"The maximum number of turns for the chat between the two agents. One turn means one conversation round trip. If set to 0, there is no limit.",dataTestId:`edge-${a}-max-turns-input`}),$n.jsx(Hd,{htmlFor:`select-summary-method-${a}`,label:"Summary Method:",info:()=>$n.jsxs("div",{children:["The method to be used to summarize the conversation. ",$n.jsx("br",{}),"Possible values are: ",$n.jsx("br",{}),$n.jsxs("ul",{children:[$n.jsxs("li",{children:[$n.jsx("b",{children:"Reflection with LLM:"})," the summary is generated by reflecting on the conversation and using the Language Model (LLM) to generate the summary."]}),$n.jsxs("li",{children:[$n.jsx("b",{children:"Last Message:"})," the last message of the conversation is used as the summary."]}),$n.jsxs("li",{children:[$n.jsx("b",{children:"None:"})," no summary is generated."]})]})]})}),$n.jsx("label",{className:"hidden",htmlFor:`select-summary-method-${a}`,children:"Summary Method:"}),$n.jsx(nd,{options:i,value:{label:c,value:n.summary.method},onChange:y,inputId:`select-summary-method-${a}`}),"reflectionWithLlm"===n.summary.method&&$n.jsxs($n.Fragment,{children:[$n.jsx(Hd,{htmlFor:`edge-${a}-llm-prompt-input`,label:"Summary Prompt:",info:"The prompt to be used for the summary generation."}),$n.jsx(Gd,{placeholder:"Enter the summary prompt",rows:2,value:n.summary.prompt,onChange:b,"data-testid":`edge-${a}-llm-prompt-input`}),$n.jsx("label",{htmlFor:`select-summary-role-${a}`,children:"Summary Role:"}),$n.jsx(nd,{options:o,value:{label:u,value:d},onChange:v,inputId:`select-summary-role-${a}`})]})]})},fm=t=>{const{edgeId:n,data:a,darkMode:s,skipRagOption:r,skipCarryoverOption:o,skipContextVarsOption:i}=t,{onMessageTypeChange:l,onMessageChange:c,onAddMessageContextEntry:d,onRemoveMessageContextEntry:u,onUpdateMessageContextEntries:h}=(t=>{const{data:n,onDataChange:a}=t;return{onMessageTypeChange:e.useCallback(e=>{a({message:{...n.message,type:e,useCarryover:!1,content:null,context:{}}})},[n.message,a]),onMessageChange:e.useCallback(e=>{a({message:e})},[a]),onAddMessageContextEntry:e.useCallback((e,t)=>{a({message:{...n.message,context:{...n.message.context,[e]:t}}})},[n.message,a]),onRemoveMessageContextEntry:e.useCallback(e=>{const{[e]:t,...s}=n.message.context;a({message:{...n.message,context:s}})},[n.message,a]),onUpdateMessageContextEntries:e.useCallback(e=>{a({message:{...n.message,context:e}})},[n.message,a])}})(t),p=()=>{},m=!0===i?p:d,g=!0===i?p:u,f=!0===i?p:h;return $n.jsx("div",{className:"margin-top-10",children:$n.jsx(tu,{darkMode:s,current:a.message,skipRagOption:!0===r,skipCarryoverOption:!0===o,selectLabel:"Message Type:",selectTestId:`select-message-type-${n}`,defaultContent:ym,notNoneLabel:"Message:",notNoneLabelInfo:"The message to be used when the chat is initiated.",includeContext:!0!==i,onTypeChange:l,onMessageChange:c,onAddContextEntry:m,onRemoveContextEntry:g,onUpdateContextEntries:f})})},ym='"""Custom message function."""\n# provide the message to be sent when the sender and the recipient are connected\n# complete the `callable_message` below. Do not change the name or the arguments of the function.\n# only complete the function body and the docstring and return the:\n# final message: (str) or a dictionary with the final message and additional data (dict)\n#\n# the recipient and the sender are \'autogen.ConversableAgent\' objects\n# the context is generated from the sender\'s initiate_chat additional keyword arguments\n# example:\n# def callable_message(sender, recipient, context):\n#   # type: (ConversableAgent, ConversableAgent, dict) -> Union[str, Dict]\n#   carryover = context.get("carryover", "")\n#    if isinstance(carryover, list):\n#        carryover = carryover[-1]\n#    final_msg = "Write a blogpost." + "\\nContext: \\n" + carryover\n#    return final_msg\n#\ndef callable_message(sender, recipient, context):\n    """Complete the message function"""\n    ...\n',bm=t=>{const{flowId:n,edgeId:a,darkMode:s,data:r}=t,{onNestedMessageTypeChange:o,onNestedMessageChange:i,onNestedReplyTypeChange:l,onNestedReplyChange:c}=(t=>{const{data:n,onDataChange:a}=t,s=e.useMemo(()=>n.nestedChat,[n.nestedChat]),r=e.useCallback(e=>({type:e,useCarryover:!1,content:null,context:{}}),[]);return{onNestedMessageTypeChange:e.useCallback(e=>{a({nestedChat:{reply:s.reply,message:r(e)}})},[s.reply,a,r]),onNestedReplyTypeChange:e.useCallback(e=>{a({nestedChat:{message:s.message,reply:r(e)}})},[s.message,a,r]),onNestedMessageChange:e.useCallback(e=>{a({nestedChat:{reply:s.reply,message:e}})},[s.reply,a]),onNestedReplyChange:e.useCallback(e=>{a({nestedChat:{message:s.message,reply:e}})},[s.message,a])}})(t),d=r.nestedChat?.message??{type:"none",useCarryover:!1,content:null,context:{}},u=r.nestedChat?.reply??{type:"none",useCarryover:!1,content:null,context:{}},h=()=>{};return $n.jsxs("div",{className:"flex-column margin-top-10",children:[$n.jsx("div",{className:"info margin-bottom-10",children:"When the connection is used in a nested chat, you can specify the messages to be sent and received, from the source and the target respectively."}),$n.jsxs(cp,{activeTabIndex:0,children:[$n.jsx(lp,{label:"Message",id:`wc-${n}-edge-nested-chat-${a}-message`,children:$n.jsx("div",{className:"flex-column",children:$n.jsx(tu,{darkMode:s,current:d,selectLabel:"Message Type:",selectTestId:`select-nested-message-type-${a}`,defaultContent:vm,notNoneLabel:"Message:",notNoneLabelInfo:"The message to be sent from the source.",includeContext:!1,skipCarryoverOption:!0,skipRagOption:!0,onTypeChange:o,onMessageChange:i,onAddContextEntry:h,onRemoveContextEntry:h,onUpdateContextEntries:h})})}),$n.jsx(lp,{label:"Reply",id:`wc-${n}-edge-nested-chat-${a}-reply`,children:$n.jsx("div",{className:"flex-column",children:$n.jsx(tu,{darkMode:s,current:u,selectLabel:"Reply Type:",selectTestId:`select-nested-reply-type-${a}`,defaultContent:xm,notNoneLabel:"Reply:",notNoneLabelInfo:"The message to be sent from the target.",skipCarryoverOption:!0,skipRagOption:!0,includeContext:!1,onTypeChange:l,onMessageChange:c,onAddContextEntry:h,onRemoveContextEntry:h,onUpdateContextEntries:h})})})]})]})},vm='"""Custom nested chat message function."""\n# provide the message to be sent from the sender to the recipient in a nested chat\n# complete the `nested_chat_message` below. Do not change the name or the arguments of the function.\n# only complete the function body and the docstring and return the final message.\n# example:\n# def nested_chat_message(recipient, messages, sender, config):\n#    # type: (ConversableAgent, Optional[list[dict]], Optional[ConversableAgent], Optional[dict]) -> str | dict\n#    return f"""Review the following content.\n#            \\n\\n {recipient.chat_messages_for_summary(sender)[-1][\'content\']}"""\n#\ndef nested_chat_message(recipient, messages, sender, config):\n    """Complete the nested chat message function"""\n    ...\n',xm='"""Custom nested chat reply function."""\n# provide the reply to be sent when the recipient replies to the sender in a nested chat\n# complete the `nested_chat_reply` below. Do not change the name or the arguments of the function.\n# only complete the function body and the docstring and return the agent\'s reply.\n# example:\n# def nested_chat_reply(recipient, messages, sender, config):\n#    # type: (ConversableAgent, Optional[list[dict]], Optional[ConversableAgent], Optional[dict]) -> str | dict\n#    last_message = messages[-1][\'content\']\n#    return f"Great! You said: {last_message}"\n#\ndef nested_chat_reply(recipient, messages, sender, config):\n    """Complete the nested chat reply function"""\n    ...\n',wm=e.memo(t=>{const{edgeId:n,isOpen:a,onClose:s}=t,{flowId:r,edge:o,edgeData:i,edgeType:l,isDark:c,isDirty:d,isRagUserProxy:u,sourceAgent:h,targetAgent:p,onDataChange:m,onTypeChange:g,onCancel:f,onDelete:y,onSubmit:b}=(t=>{const{edgeId:n,onClose:a}=t,s=jh(e=>e.getEdgeSourceAgent),r=jh(e=>e.getEdgeTargetAgent),o=jh(e=>e.updateEdgeData),i=jh(e=>e.updateEdgeType),l=jh(e=>e.getEdgeById),c=jh(e=>e.deleteEdge),d=jh(e=>e.flowId),{isDark:u}=Qn(),h=l(n),p=e.useMemo(()=>h?s(h):null,[h,s]),m=e.useMemo(()=>h?r(h):null,[h,r]),[g,f]=e.useState(h?.type??"chat"),[y,b]=e.useState(h?.data),[v,x]=e.useState(!1),w=e.useMemo(()=>"rag_user_proxy"===p?.data?.agentType,[p?.data?.agentType]),C=e.useCallback(e=>{if(!y)return;const t={...y,...e};b(t),x(!dm(t,h?.data))},[y,h?.data]),k=e.useCallback(e=>{if(!e||!h)return;const t=e.value;f(t),x(t!==h.type)},[h]),j=e.useCallback(()=>{h&&(b(h.data),h.type&&f(h.type)),x(!1),a()},[h,a]),A=e.useCallback(()=>{j(),c(n)},[j,c,n]),S=e.useCallback(()=>{y&&o(n,y),h&&g!==h.type&&i(n,g),x(!1)},[y,g,h,n,o,i]);return{flowId:d,edge:h,edgeData:y,edgeType:g,isDirty:v,isRagUserProxy:w,isDark:u,sourceAgent:p,targetAgent:m,onDataChange:C,onTypeChange:k,onCancel:j,onSubmit:S,onDelete:A}})(t),[v,x]=e.useState(0);if(e.useEffect(()=>{a&&x(0)},[a]),!(i&&o&&"hidden"!==l&&h&&p))return null;const w=e.useCallback(()=>{b(),s()},[b,s]),C=e.useCallback(e=>{m({condition:e})},[m]),k=e.useCallback(e=>{m({available:e})},[m]),j=e.useMemo(()=>$n.jsx(Nd,{className:"clickable",onClick:y,title:"Delete edge","aria-label":"Delete edge"}),[y]),A=e.useMemo(()=>"group"!==l?"none":"group_manager"===i.targetType?"toManager":"group_manager"===i.sourceType?"fromManager":p.parentId?"handoff":"nested",[l,i?.targetType,i?.sourceType,p?.parentId]),S=e.useMemo(()=>({properties:`wc-${r}-edge-properties-${n}`,message:`wc-${r}-edge-message-${n}`,nested:`wc-${r}-edge-nested-${n}`,condition:`wc-${r}-edge-condition-${n}`,availability:`wc-${r}-edge-availability-${n}`}),[r,n]),N=e.useMemo(()=>({modal:`edge-modal-${n}`,cancel:`modal-cancel-btn-${n}`,saveAndClose:`modal-submit-and-close-btn-${n}`,save:`modal-submit-btn-${n}`}),[n]),T=e.useMemo(()=>i.nestedChat.message||{type:"string",content:"",context:{}},[i.nestedChat.message]),E=e.useCallback(()=>{},[]),_=e.useCallback(e=>{const t={...i.nestedChat.message,content:i.nestedChat.message?.content||"",context:i.nestedChat.message?.context||{},type:e};m({nestedChat:{...i.nestedChat,message:t}})},[m,i.nestedChat]),M=e.useCallback(e=>{m({nestedChat:{...i.nestedChat,message:e}})},[m,i.nestedChat]);return $n.jsx(ou,{flowId:r,isOpen:a,onClose:s,onSaveAndClose:w,beforeTitle:j,title:i.label,dataTestId:N.modal,hasUnsavedChanges:d,preventCloseIfUnsavedChanges:!0,children:$n.jsxs("div",{className:"modal-body edge-modal",children:["group"===l?$n.jsxs(cp,{activeTabIndex:v,children:[$n.jsx(lp,{label:"Properties",id:S.properties,children:$n.jsx(gm,{edgeId:n,data:i,edgeType:l,onTypeChange:g,onDataChange:m,skipDescription:!0})}),"toManager"===A&&$n.jsx(lp,{label:"Message",id:S.message,children:$n.jsx(fm,{edgeId:n,data:i,darkMode:c,skipRagOption:!u,skipCarryoverOption:!u,skipContextVarsOption:!1,onDataChange:m})}),"nested"===A&&$n.jsx(lp,{label:"Message",id:`wc-${r}-edge-nested-chat-${n}-message`,children:$n.jsx("div",{className:"flex-column",children:$n.jsx(tu,{darkMode:c,current:T,selectLabel:"Message Type:",selectTestId:`select-nested-message-type-${n}`,defaultContent:vm,notNoneLabel:"Message:",notNoneLabelInfo:"The message to be sent from the source.",includeContext:!1,skipCarryoverOption:!0,skipRagOption:!0,skipNone:!0,onTypeChange:_,onMessageChange:M,onAddContextEntry:E,onRemoveContextEntry:E,onUpdateContextEntries:E})})}),"handoff"===A&&$n.jsx(lp,{label:"Condition",id:S.condition,children:$n.jsx(Xd,{condition:i.condition,onDataChange:C})}),"handoff"===A&&$n.jsx(lp,{label:"Availability",id:S.availability,children:$n.jsx($d,{available:i.available,onDataChange:k})})]}):$n.jsxs(cp,{activeTabIndex:v,children:[$n.jsx(lp,{label:"Properties",id:S.properties,children:$n.jsx(gm,{edgeId:n,data:i,edgeType:l,onTypeChange:g,onDataChange:m})}),"chat"===l&&$n.jsx(lp,{label:"Message",id:S.message,children:$n.jsx(fm,{edgeId:n,data:i,darkMode:c,skipRagOption:!u,onDataChange:m})}),"nested"===l&&$n.jsx(lp,{label:"Nested Chat",id:S.nested,children:$n.jsx(bm,{flowId:r,edgeId:n,darkMode:c,data:i,onDataChange:m})})]}),$n.jsxs("div",{className:"modal-actions",children:[$n.jsx("button",{type:"button",title:"Cancel",className:"secondary",onClick:f,id:N.cancel,"data-testid":N.cancel,children:"Cancel"}),$n.jsxs("div",{className:"flex-row",children:[$n.jsx("button",{title:"Save & Close",type:"button",className:"save margin-right-10 ",onClick:w,id:N.saveAndClose,"data-testid":N.saveAndClose,disabled:!d,"aria-disabled":!d,children:"Save & Close"}),$n.jsx("button",{type:"button",title:d?"Save changes":"No changes to save",className:"primary",onClick:b,id:N.save,"data-testid":N.save,disabled:!d,"aria-disabled":!d,children:"Save"})]})]})]})})});wm.displayName="WaldiezEdgeModal";const Cm=({activity:e,title:t,className:n})=>e?"thinking"===e?$n.jsxs("span",{className:`agent-activity-icon is-thinking ${n??""}`,title:t??"Thinking","data-activity":"thinking",children:[$n.jsx(Tc,{}),$n.jsxs("span",{className:"typing-dots","aria-label":"thinking",children:[$n.jsx("i",{}),$n.jsx("i",{}),$n.jsx("i",{})]})]}):"tool"===e?$n.jsx("span",{className:`agent-activity-icon is-tool ${n??""}`,title:t??"Running tool","data-activity":"tool",children:$n.jsx(xc,{className:"gear"})}):"message"===e?$n.jsxs("span",{className:`agent-activity-icon is-message ${n??""}`,title:t??"Composing","data-activity":"message",children:[$n.jsx(wc,{className:"bubble"}),$n.jsxs("span",{className:"typing-dots","aria-label":"typing",children:[$n.jsx("i",{}),$n.jsx("i",{}),$n.jsx("i",{})]})]}):$n.jsx("span",{className:`agent-activity-icon ${n??""}`,title:t??String(e),"data-activity":String(e),children:$n.jsx(bc,{className:"status-dot"})}):null,km={wikipedia_search:void 0,youtube_search:$n.jsxs("div",{className:"info",children:[$n.jsx("p",{children:"To use the YouTube Search tool, you need to set up a YouTube Data API key."}),$n.jsx("p",{children:" Follow these steps:"}),$n.jsxs("ol",{children:[$n.jsxs("li",{children:["Go to the"," ",$n.jsx("a",{href:"https://console.cloud.google.com/",target:"_blank",rel:"noopener noreferrer",children:"Google Cloud Console"}),"."]}),$n.jsx("li",{children:"Create a new project or select an existing one."}),$n.jsxs("li",{children:["Navigate to ",$n.jsx("strong",{children:"APIs & Services > Library"}),"."]}),$n.jsxs("li",{children:["Search for ",$n.jsx("strong",{children:"YouTube Data API v3"})," and enable it."]}),$n.jsxs("li",{children:["Go to ",$n.jsx("strong",{children:"APIs & Services > Credentials"}),"."]}),$n.jsxs("li",{children:["Click on ",$n.jsx("strong",{children:"Create Credentials > API key"})," and copy your API key."]})]})]}),google_search:$n.jsxs("div",{className:"info",children:[$n.jsx("p",{children:"To use the Google Search tool, you need to set up a Google Custom Search Engine (CSE) and obtain an API key."}),$n.jsx("p",{children:"Follow these steps:"}),$n.jsxs("ol",{children:[$n.jsxs("li",{children:["Go to"," ",$n.jsx("a",{href:"https://programmablesearchengine.google.com/about/",target:"_blank",rel:"noopener noreferrer",children:"Google Programmable Search Engine"}),"."]}),$n.jsxs("li",{children:["Click ",$n.jsx("strong",{children:"Get Started"})," and create a search engine."]}),$n.jsxs("li",{children:["Under ",$n.jsx("strong",{children:"Sites to Search"}),", select ",$n.jsx("strong",{children:"Search the entire web"})," if you want global search."]}),$n.jsxs("li",{children:["Copy the ",$n.jsx("strong",{children:"Search Engine ID"})," from the CSE dashboard (the `cx` parameter from the URL)."]}),$n.jsxs("li",{children:["Go to the"," ",$n.jsx("a",{href:"https://console.cloud.google.com/",target:"_blank",rel:"noopener noreferrer",children:"Google Cloud Console"}),"."]}),$n.jsx("li",{children:"Create a new project."}),$n.jsxs("li",{children:["Navigate to ",$n.jsx("strong",{children:"APIs & Services > Library"}),", search for"," ",$n.jsx("strong",{children:"Custom Search API"}),", and enable it."]}),$n.jsxs("li",{children:["Go to ",$n.jsx("strong",{children:"APIs & Services > Credentials"}),", click on"," ",$n.jsx("strong",{children:"Create Credentials > API key"}),", and copy your API key."]})]})]}),tavily_search:$n.jsxs("div",{className:"info",children:[$n.jsx("p",{children:"To use the Tavily Search tool, you need to set up a Tavily API key."}),$n.jsx("p",{children:"Follow these steps:"}),$n.jsxs("ol",{children:[$n.jsxs("li",{children:["Visit"," ",$n.jsx("a",{href:"https://tavily.com/",target:"_blank",rel:"noopener noreferrer",children:"Tavily AI"}),"."]}),$n.jsxs("li",{children:["Click ",$n.jsx("strong",{children:"Sign Up"})," and create an account."]}),$n.jsxs("li",{children:["Navigate to"," ",$n.jsx("a",{href:"https://app.tavily.com/",target:"_blank",rel:"noopener noreferrer",children:"Tavily API"}),"."]}),$n.jsxs("li",{children:["Generate an API key under ",$n.jsx("strong",{children:"API Keys"}),"."]})]})]}),duckduckgo_search:void 0,perplexity_search:$n.jsxs("div",{className:"info",children:[$n.jsx("p",{children:"To use the Perplexity Search tool, you need to set up a Perplexity API key."}),$n.jsx("p",{children:"Follow these steps:"}),$n.jsxs("ol",{children:[$n.jsxs("li",{children:["Visit"," ",$n.jsx("a",{href:"https://www.perplexity.ai/",target:"_blank",rel:"noopener noreferrer",children:"Perplexity AI"}),"."]}),$n.jsxs("li",{children:["Click ",$n.jsx("strong",{children:"Sign Up"})," and create an account."]}),$n.jsxs("li",{children:["Navigate to"," ",$n.jsx("a",{href:"https://www.perplexity.ai/settings/api",target:"_blank",rel:"noopener noreferrer",children:"Perplexity API"}),"."]}),$n.jsxs("li",{children:["Generate an API key under ",$n.jsx("strong",{children:"API Keys"}),"."]})]})]}),searxng_search:void 0,shared:void 0,custom:void 0},jm=(e,t,n=14)=>{if("custom"===t)return $n.jsx(gd,{"aria-hidden":"true",size:n,style:{width:n,height:n}});if("shared"===t)return $n.jsx(Md,{"aria-hidden":"true",size:n,style:{width:n,height:n}});switch(e){case"wikipedia_search":return $n.jsx("img",{src:Dn,alt:"Wikipedia Search Icon",style:{width:n,height:n}});case"youtube_search":return $n.jsx("img",{src:Rn,alt:"YouTube Search Icon",style:{width:n,height:n}});case"google_search":return $n.jsx("img",{src:In,alt:"Google Search Icon",style:{width:n,height:n}});case"tavily_search":return $n.jsx("img",{src:zn,alt:"Tavily Search Icon",style:{width:n,height:n}});case"duckduckgo_search":return $n.jsx("img",{src:Ln,alt:"DuckDuckGo Search Icon",style:{width:n,height:n}});case"perplexity_search":return $n.jsx("img",{src:On,alt:"Perplexity Search Icon",style:{width:n,height:n},className:"perplexity-icon"});case"searxng_search":return $n.jsx("img",{src:Pn,alt:"SearxNG Search Icon",style:{width:n,height:n}});default:return $n.jsx(gd,{"aria-hidden":"true",size:n,style:{width:n,height:n}})}},Am=[{value:"shared",label:"Shared Code",icon:$n.jsx(Md,{size:18,style:{marginLeft:2,width:16,height:16}})},{value:"wikipedia_search",label:"Wikipedia Search",icon:$n.jsx("img",{src:Dn,alt:"Wikipedia Search Icon",style:{width:20,height:20}})},{value:"youtube_search",label:"YouTube Search",icon:$n.jsx("img",{src:Rn,alt:"YouTube Search Icon",style:{width:20,height:20}})},{value:"tavily_search",label:"Tavily Search",icon:$n.jsx("img",{src:zn,alt:"Tavily Search Icon",style:{width:20,height:20}})},{value:"google_search",label:"Google Search",icon:$n.jsx("img",{src:In,alt:"Google Search Icon",style:{width:20,height:20}})},{value:"duckduckgo_search",label:"DuckDuckGo Search",icon:$n.jsx("img",{src:Ln,alt:"DuckDuckGo Search Icon",style:{width:20,height:20}})},{value:"perplexity_search",label:"Perplexity AI Search",icon:$n.jsx("img",{src:On,alt:"Perplexity AI Search Icon",style:{width:20,height:20},className:"perplexity-icon"})},{value:"searxng_search",label:"SearxNG Search",icon:$n.jsx("img",{src:Pn,alt:"SearxNG Search Icon",style:{width:20,height:20}})},{value:"custom",label:"Custom Tool",icon:$n.jsx(gd,{size:18,style:{marginLeft:2,width:16,height:16}})}],Sm=e.memo(e=>{const{id:t,data:n}=e,a=n.agentType;return"group_manager"===a?$n.jsx("div",{className:"agent-content"}):"user_proxy"===a?$n.jsx("div",{className:"agent-content",children:$n.jsx("div",{className:"agent-label margin-top-20","data-testid":`agent-${t}-label`,children:n.label})}):Nm(t,n)}),Nm=(t,n)=>{const a=jh(e=>e.getModels),s=jh(e=>e.getTools),[r,o]=e.useState(2),[i,l]=e.useState(2),[c,d]=e.useState(0),{tools:u,agentModelNames:h,agentWaldiezModelAPITypes:p,agentModelLogos:m}=e.useMemo(()=>{const e=a(),t=s(),r=n.modelIds.map(t=>e.find(e=>e.id===t)?.data.label??"").filter(e=>""!==e),o=n.modelIds.map(t=>e.find(e=>e.id===t)?.data.apiType??"").filter(e=>""!==e),i=o.map(e=>_n[e]??"").filter(e=>""!==e);return{tools:t,agentModelNames:r,agentWaldiezModelAPITypes:o,agentModelLogos:i}},[a,s,n.modelIds]),g=e.useCallback(e=>{const t=Math.floor(e/18),a=h.length,s=n.tools.length;if(t<=0)return{models:0,tools:0};let r=0,o=0;if(0===a)o=Math.min(s,t);else if(0===s)r=Math.min(a,t);else{if(r=Math.min(a,Math.ceil(t/2)),o=Math.min(s,t-r),r<Math.ceil(t/2)){const e=Math.min(a-r,t-(r+o));r+=Math.max(0,e)}if(o<Math.floor(t/2)){const e=Math.min(s-o,t-(r+o));o+=Math.max(0,e)}}return{models:r,tools:o}},[h.length,n.tools.length]),f=e.useCallback(e=>{if(!e)return;const t=()=>{const t=e.closest(".react-flow__node"),n=(t?.offsetHeight||e.offsetHeight)-20-20-40;d(n);const{models:a,tools:s}=g(n);o(a),l(s)};setTimeout(t,0);const n=new ResizeObserver(t);return n.observe(e),()=>{n.disconnect()}},[g]);return e.useEffect(()=>{if(0===c){const{models:e,tools:t}=g(120);o(e),l(t)}},[g,c]),e.useMemo(()=>{const e=h.length>0,a=n.tools.length>0,s=e&&r>0,o=a&&i>0;return $n.jsxs("div",{ref:f,className:"agent-content",children:[$n.jsx("div",{className:"agent-label","data-testid":`agent-${t}-label`,children:n.label}),s&&$n.jsxs("div",{className:"agent-models-preview",children:[h.slice(0,r).map((e,n)=>$n.jsxs("div",{className:"agent-model-preview","data-testid":"agent-model-preview",children:[$n.jsx("div",{className:`agent-model-img ${p[n]}`,children:$n.jsx("img",{src:m[n],title:e,alt:e})}),$n.jsx("div",{className:"font-small agent-model-name","data-testid":`agent-${t}-linked-model-${n}`,children:e})]},e)),h.length>r&&$n.jsxs("div",{className:"agent-more-indicator",children:[$n.jsx("div",{className:"agent-model-img",children:$n.jsx("span",{children:"⋯"})}),$n.jsxs("div",{className:"font-small agent-model-name",children:["+",h.length-r," more"]})]})]}),!e&&"user_proxy"!==n.agentType&&$n.jsx("div",{className:"agent-models-preview",children:$n.jsx("div",{className:"font-small agent-model-name",children:"No models"})}),o&&$n.jsxs("div",{className:"agent-tools-preview",children:[n.tools.slice(0,i).map((e,n)=>{const a=u.find(t=>t.id===e.id);return a?$n.jsxs("div",{className:"agent-tool-preview","data-testid":"agent-tool-preview",children:[$n.jsx("div",{className:"agent-tool-img",children:jm(a.data.label,a.data.toolType)}),$n.jsx("div",{className:"font-small agent-tool-name","data-testid":`agent-${t}-linked-tool-${n}`,children:a.data.label})]},a.id):null}),n.tools.length>i&&$n.jsxs("div",{className:"agent-more-indicator",children:[$n.jsx("div",{className:"agent-tool-img",children:$n.jsx("span",{children:"⋯"})}),$n.jsxs("div",{className:"font-small agent-tool-name",children:["+",n.tools.length-i," more"]})]})]}),!a&&!["user_proxy","rag_user_proxy"].includes(n.agentType)&&$n.jsx("div",{className:"agent-tools-preview",children:$n.jsx("div",{className:"font-small agent-tool-name",children:"No tools"})})]})},[h,n.tools,n.label,n.agentType,r,i,f,t,p,m,u])},Tm=e=>{const{agentType:n,id:a,handleClassNameBase:s,selected:r,onEdgeConnection:o}=e,i=[{pos:t.Position.Top,label:"top"},{pos:t.Position.Bottom,label:"bottom"},{pos:t.Position.Left,label:"left"},{pos:t.Position.Right,label:"right"}];let l=`${s}handle `;if(r||(l+="not-selected "),"group_manager"===n)return i.map(({pos:e,label:n})=>$n.jsx(t.Handle,{className:`${l} ${n} target`,type:"target",isConnectableEnd:!0,position:e,onConnect:o,"data-testid":`agent-handle-${n}-target-${a}`,id:`agent-handle-${n}-target-${a}`},`target-${n}`));const c={[t.Position.Top]:{target:{left:"75%"},source:{left:"25%"}},[t.Position.Bottom]:{target:{left:"25%"},source:{left:"75%"}},[t.Position.Left]:{target:{top:"25%"},source:{top:"75%"}},[t.Position.Right]:{target:{top:"75%"},source:{top:"25%"}}};return i.flatMap(({pos:e,label:n})=>[$n.jsx(t.Handle,{className:`${l} ${n} target`,type:"target",isConnectableEnd:!0,position:e,onConnect:o,"data-testid":`agent-handle-${n}-target-${a}`,id:`agent-handle-${n}-target-${a}`,style:c[e].target},`target-${n}`),$n.jsx(t.Handle,{className:`${l} ${n} source`,type:"source",isConnectableStart:!0,position:e,onConnect:o,"data-testid":`agent-handle-${n}-source-${a}`,id:`agent-handle-${n}-source-${a}`,style:c[e].source},`source-${n}`)])},Em=e.memo(t=>{const{id:n,data:a,models:s,onDataChange:r}=t,o=e.useMemo(()=>s.map(e=>({label:e.data.label,value:e.id})),[s]),i=e.useMemo(()=>a.modelIds&&0!==a.modelIds.length?a.modelIds.map(e=>{const t=s.find(t=>t.id===e);return t?{label:t.data.label,value:t.id}:null}):[],[a.modelIds,s]),l=e.useCallback(e=>{if(e){const t=(Array.isArray(e)?e:[e]).map(e=>e.value);r({modelIds:t})}else r({modelIds:[]})},[r]);return $n.jsxs("div",{className:"agent-panel margin-bottom-10","data-testid":"agent-models-panel",children:[$n.jsxs("label",{htmlFor:`select-agent-models-${n}`,children:["Model","rag_user_proxy"===a.agentType?"":"s"," to use:"]}),$n.jsx(nd,{options:o,value:i,onChange:l,isMulti:"rag_user_proxy"!==a.agentType,inputId:`select-agent-models-${n}`,isClearable:!0,"aria-label":"Select agent's model"+("rag_user_proxy"===a.agentType?"":"s")})]})});Em.displayName="WaldiezAgentModels";const _m=e.memo(t=>{const{isModalOpen:n,flowId:a,id:s,data:r}=t,{groupMembers:o,models:i,initialAgent:l,initialAgentOptions:c,speakersOrder:d,onGroupNameChange:u,onManagerNameChange:h,onMaxRoundChange:p,onAddContextVariable:m,onDeleteContextVariable:g,onUpdateContextVariable:f,onInitialAgentChange:y,onEnableClearHistoryChange:b,onSendIntroductionsChange:v,onMaxRetriesForSelectingChange:x,onSpeakerSelectionMethodChange:w,onDescriptionChange:C,onAfterWorkChange:k,onMoveMemberUp:j,onMoveMemberDown:A}=(t=>{const{id:n,data:a,onDataChange:s}=t,r=jh(e=>e.getGroupMembers),o=jh(e=>e.getAgentById),i=jh(e=>e.getModels),l=e.useMemo(()=>{const e=r(n),t=a.speakers.order||[],s=new Set(e.map(e=>e.id)),o=t.filter(e=>s.has(e)),i=new Set(o),l=e.filter(e=>!i.has(e.id)).map(e=>e.id);let c=[...o,...l];return a.initialAgentId&&s.has(a.initialAgentId)&&(c=c.filter(e=>e!==a.initialAgentId),c.unshift(a.initialAgentId)),c},[r,n,a.speakers.order,a.initialAgentId]),c=e.useCallback(e=>{s({speakers:{...a.speakers,order:e}})},[a.speakers,s]),d=e.useCallback(e=>{if(!l.includes(e))return;const t=l.indexOf(e);if(t<=0)return;if(a.initialAgentId&&1===t)return;const n=[...l];[n[t-1],n[t]]=[n[t],n[t-1]],c(n)},[l,a.initialAgentId,c]),u=e.useCallback(e=>{if(!l.includes(e))return;const t=l.indexOf(e);if(t>=l.length-1)return;if(a.initialAgentId&&e===a.initialAgentId)return;const n=[...l];[n[t],n[t+1]]=[n[t+1],n[t]],c(n)},[l,a.initialAgentId,c]),h=e.useMemo(()=>i(),[i]),p=e.useMemo(()=>r(n),[r,n]),m=e.useMemo(()=>a.initialAgentId?o(a.initialAgentId):void 0,[a.initialAgentId,o]),g=e.useMemo(()=>m?{label:m.data.label,value:m}:void 0,[m]),f=e.useMemo(()=>p.map(e=>({label:e.data.label,value:e})),[p]),y=e.useCallback(e=>{const t={...a.speakers,...e};s({speakers:t})},[a.speakers,s]),b=e.useCallback(e=>{const t=e.target.value;s({groupName:t})},[s]),v=e.useCallback(e=>{const t=e.target.value;s({name:t,label:t})},[s]),x=e.useCallback(e=>{const t=e.target.value;s({description:t})},[s]),w=e.useCallback(e=>{const t=e.target.value;s({systemMessage:t})},[s]),C=e.useCallback(e=>{null!==e&&e>0&&s({maxRound:e})},[s]),k=e.useCallback((e,t)=>{const n={...a.contextVariables,[e]:t};s({contextVariables:n})},[a.contextVariables,s]),j=e.useCallback(e=>{const t={...a.contextVariables};delete t[e],s({contextVariables:t})},[a.contextVariables,s]),A=e.useCallback(e=>{s({contextVariables:e})},[s]),S=e.useCallback(e=>{if(!e)return void s({initialAgentId:void 0});const t=e.value.id;s({initialAgentId:t})},[s]),N=e.useCallback(e=>{s({enableClearHistory:e})},[s]),T=e.useCallback(e=>{s({sendIntroductions:e})},[s]),E=e.useCallback(e=>{y({maxRetriesForSelecting:e})},[y]),_=e.useCallback(e=>{y({selectionMethod:e?.value??void 0})},[y]),M=e.useCallback(e=>{s(e?{...a,afterWork:e}:{...a,afterWork:null})},[a,s]);return{models:h,groupMembers:p,speakersOrder:l,initialAgent:g,initialAgentOptions:f,onGroupNameChange:b,onManagerNameChange:v,onDescriptionChange:x,onSystemMessageChange:w,onMaxRoundChange:C,onAddContextVariable:k,onDeleteContextVariable:j,onUpdateContextVariable:A,onInitialAgentChange:S,onEnableClearHistoryChange:N,onSendIntroductionsChange:T,onMaxRetriesForSelectingChange:E,onSpeakerSelectionMethodChange:_,onAfterWorkChange:M,onMoveMemberUp:d,onMoveMemberDown:u}})(t),[S,N]=e.useState(0);e.useEffect(()=>{N(0)},[n]);const T=e.useMemo(()=>[{label:"Auto",value:"auto"},{label:"Manual",value:"manual"},{label:"Default",value:"default"},{label:"Random",value:"random"},{label:"Round Robin",value:"round_robin"}],[]),E=e.useMemo(()=>({label:T.find(e=>e.value===r.speakers?.selectionMethod)?.label??"Auto",value:r.speakers?.selectionMethod??"auto"}),[r.speakers?.selectionMethod,T]),_=!["manual","auto"].includes(r.speakers?.selectionMethod);return $n.jsxs(cp,{activeTabIndex:S,children:[$n.jsx(lp,{label:"Group",id:`wf-${a}-agent-group-manager-config-${s}`,children:$n.jsxs("div",{className:"modal-body  agent-panel",children:[$n.jsx(Zd,{label:"Group Name:",name:"group-name",value:r.groupName??"",onChange:u,dataTestId:`agent-name-input-${s}`,"aria-label":"Group name"}),$n.jsx("label",{htmlFor:`wf-${a}-agent-config-${s}-select-initial-agent`,children:"Initial Agent:"}),$n.jsx(nd,{options:c,value:l,onChange:y,inputId:`wf-${a}-agent-config-${s}-select-initial-agent`,"aria-label":"Select initial agent"}),$n.jsx(Fu,{name:"max-rounds",label:"Max Rounds:",value:r.maxRound,onChange:p,min:1,max:1e3,step:1,setNullOnLower:!1,forceInt:!0,labelInfo:"The maximum number of conversation rounds in the group.",dataTestId:`manager-max-rounds-input-${s}`,"aria-label":"Maximum conversation rounds"}),$n.jsx(Wd,{itemsType:"group-context-variables",viewLabel:"Context Variables",viewLabelInfo:"The context variables that will be available when the group chat starts.",onAdd:m,onDelete:g,onUpdate:f,items:r.contextVariables??{},allowEmptyValues:!0,"aria-label":"Group context variables"})]})}),$n.jsx(lp,{label:"Group Manager",id:`wf-${a}-agent-group-manager-agent-${s}`,children:$n.jsxs("div",{className:"modal-body agent-panel",children:[$n.jsx("div",{children:$n.jsx(Em,{id:s,data:t.data,models:i,onDataChange:t.onDataChange})}),$n.jsx("div",{children:$n.jsx(Zd,{label:"Group Manager's Name:",name:"group-manager-name",value:r.name??r.label??"",onChange:h,dataTestId:`agent-name-input-${s}`,placeholder:"Group Manager Name",className:"margin-top-5","aria-label":"Group manager name"})}),$n.jsx("label",{htmlFor:`agent-description-input-${s}`,children:"Description:"}),$n.jsx(Gd,{id:`agent-description-input-${s}`,title:"Agent description",rows:2,value:r.description,onChange:C,"data-testid":`agent-description-input-${s}`,"aria-label":"Manager description"}),$n.jsx(td,{label:"Send introductions",checked:!0===r.sendIntroductions,info:"Send a round of introductions at the start of the group chat, so agents know who they can speak to (default: False)",onChange:v,id:`manager-send-introductions-checkbox-${s}`,"aria-label":"Enable sending introductions"}),$n.jsx(td,{label:"Enable clear history",checked:!0===r.enableClearHistory,info:"Enable the possibility to clear history of messages for agents manually by providing 'clear history' phrase in user prompt.",onChange:b,id:`manager-enable-clear-history-checkbox-${s}`,"aria-label":"Enable clear history functionality"})]})}),$n.jsx(lp,{label:"Speakers",id:`wf-${a}-agent-group-manager-speakers-${s}`,children:$n.jsxs("div",{className:"modal-body agent-panel",children:[$n.jsx("div",{className:"margin-top-10",children:$n.jsxs("div",{className:"info",children:["The method for selecting the next speaker. The default is"," ",$n.jsx("strong",{className:"italic",children:"Auto"}),". Could be any of the following:",$n.jsxs("ul",{children:[$n.jsxs("li",{children:[$n.jsx("strong",{className:"italic",children:"Auto"}),": the next speaker is selected automatically by LLM."]}),$n.jsxs("li",{children:[$n.jsx("strong",{className:"italic",children:"Manual"}),": the next speaker is selected manually by user input."]}),$n.jsxs("li",{children:[$n.jsx("strong",{className:"italic",children:"Default"}),": the transitions to the speakers are explicitly defined in the workflow."]}),$n.jsxs("li",{children:[$n.jsx("strong",{className:"italic",children:"Random"}),": the next speaker is selected randomly."]}),$n.jsxs("li",{children:[$n.jsx("strong",{className:"italic",children:"Round Robin"}),": the next speaker is selected in a round robin fashion, i.e., iterating in the same order as provided in agents."]})]})]})}),$n.jsx("label",{htmlFor:`manager-speaker-selection-method-${s}`,children:"Speaker Selection Method:"}),$n.jsx(nd,{options:T,value:E,onChange:w,inputId:`manager-speaker-selection-method-${s}`,"aria-label":"Select speaker selection method"}),$n.jsx(Fu,{name:"max-retries-for-selecting",label:"Max Retries for selecting a speaker:",value:r.speakers?.maxRetriesForSelecting??0,onChange:x,min:0,max:100,step:1,onNull:0,setNullOnLower:!0,onLowerLabel:"Unset",labelInfo:"The maximum number of times the speaker selection re-query process will run. If, during speaker selection, multiple agent names or no agent names are returned by the LLM as the next agent, it will be queried again up to the maximum number of times until a single agent is returned or it exhausts the maximum attempts. Applies only to 'auto' speaker selection method.",dataTestId:`manager-max-retries-for-selecting-input-${s}`,"aria-label":"Maximum retries for speaker selection"}),"round_robin"===r.speakers?.selectionMethod&&$n.jsxs("div",{className:"margin-top-10",children:[$n.jsx("div",{className:"info",children:"The order in which the speakers will be selected in round robin mode. If not provided, the order will be automatically determined based on the agents in the group."}),$n.jsx("div",{className:"ordered-items-list",children:d.map((e,t)=>{const n=r.initialAgentId===e,a=t>0&&!(r.initialAgentId&&1===t),s=t<d.length-1&&!n,i=a||s;return $n.jsxs("div",{className:"ordered-item "+(i?"has-buttons":"no-buttons"),"data-testid":`group-speaker-${t}`,children:[$n.jsxs("div",{className:"reorder-buttons",children:[a&&$n.jsx("button",{type:"button",title:"Move up",className:"reorder-btn up-btn",onClick:()=>j(e),children:"↑"}),s&&$n.jsx("button",{type:"button",title:"Move down",className:"reorder-btn down-btn",onClick:()=>A(e),children:"↓"}),n&&$n.jsx("button",{type:"button",className:"reorder-btn no-click",children:$n.jsx(wd,{})})]}),$n.jsx("div",{className:"ordered-item-content",children:(l=e,o.find(e=>e.id===l)?.data.label??l)})]},`group-speaker-${e}`);var l})})]})]})}),_&&$n.jsx(lp,{label:"Afterwards",id:`wf-${a}-agent-group-manager-after-work-${s}`,children:$n.jsx("div",{className:"modal-body agent-panel",children:$n.jsx(od,{target:r.afterWork,agents:o,onChange:k,isForGroupChat:!0,"aria-label":"After work configuration"})})})]})});_m.displayName="WaldiezNodeGroupManagerTabs";const Mm=e.memo(t=>{const{id:n,data:a}=t,{onMultimodalChange:s,onNameChange:r,onDescriptionChange:o,onSystemMessageChange:i,onHumanInputModeChange:l,onMaxConsecutiveAutoReplyChange:c,onAgentDefaultAutoReplyChange:d}=(t=>{const{onDataChange:n,onAgentTypeChange:a}=t;return{onRagChange:e.useCallback(e=>{a(e?"rag_user_proxy":"user_proxy")},[a]),onMultimodalChange:e.useCallback(e=>{n({isMultimodal:e})},[n]),onNameChange:e.useCallback(e=>{const t=e.target.value;n({label:t})},[n]),onDescriptionChange:e.useCallback(e=>{const t=e.target.value;n({description:t})},[n]),onSystemMessageChange:e.useCallback(e=>{const t=e.target.value;n({systemMessage:t})},[n]),onHumanInputModeChange:e.useCallback(e=>{if(e){const t=e.value;n({humanInputMode:t})}},[n]),onMaxConsecutiveAutoReplyChange:e.useCallback(e=>{n({maxConsecutiveAutoReply:e})},[n]),onAgentDefaultAutoReplyChange:e.useCallback(e=>{const t=e.target.value;n({agentDefaultAutoReply:t})},[n])}})(t),u=e.useMemo(()=>({ALWAYS:"Always",NEVER:"Never",TERMINATE:"Terminate"}),[]),h=e.useMemo(()=>[{label:"Always",value:"ALWAYS"},{label:"Never",value:"NEVER"},{label:"Terminate",value:"TERMINATE"}],[]),p=e.useMemo(()=>({label:u[a.humanInputMode],value:a.humanInputMode}),[a.humanInputMode,u]);return $n.jsxs("div",{className:"agent-panel agent-basic-panel",children:["assistant"===a.agentType&&$n.jsx(td,{label:"Multimodal",info:"If checked, the agent will handle uploaded images from the user. NOTE: Make sure you use a compatible LLM model that supports multimodal inputs (e.g. GPT-4o-mini).",checked:a.isMultimodal??!1,onChange:s,id:`agent-multimodal-toggle-${n}`}),$n.jsx(Zd,{label:"Name:",name:"human-input-name",value:a.label,onChange:r,dataTestId:`agent-name-input-${n}`,"aria-label":"Agent name"}),$n.jsx("label",{htmlFor:`agent-description-input-${n}`,children:"Description:"}),$n.jsx(Gd,{id:`agent-description-input-${n}`,title:"Agent description",rows:2,value:a.description,onChange:o,"data-testid":`agent-description-input-${n}`,"aria-label":"Agent description"}),$n.jsx("label",{htmlFor:`agent-system-message-input-${n}`,children:"System Message:"}),$n.jsx(Gd,{id:`agent-system-message-input-${n}`,title:"System message",rows:2,value:a.systemMessage??"",onChange:i,"data-testid":`agent-system-message-input-${n}`,"aria-label":"System message"}),$n.jsx(Hd,{label:"Human Input mode:",info:()=>$n.jsxs("div",{children:["Whether to ask for human inputs every time a message is received. ",$n.jsx("br",{}),"Possible values are: ",$n.jsx("br",{}),$n.jsxs("ul",{children:[$n.jsxs("li",{children:[$n.jsx("b",{children:"Always:"}),' the agent prompts for human input every time a message is received. Under this mode, the conversation stops when the human input is "exit", or when is_termination_msg is True and there is no human input.']}),$n.jsxs("li",{children:[$n.jsx("b",{children:"Terminate:"})," the agent only prompts for human input only when a termination message is received or the number of auto reply reaches the max_consecutive_auto_reply."]}),$n.jsxs("li",{children:[$n.jsx("b",{children:"Never:"})," the agent will never prompt for human input. Under this mode, the conversation stops when the number of auto reply reaches the max_consecutive_auto_reply or when is_termination_msg is True."]})]})]}),htmlFor:`agent-human-input-mode-${n}`}),$n.jsx("label",{htmlFor:`agent-human-input-mode-select-${n}`,className:"hidden",children:"Human Input mode:"}),$n.jsx(nd,{options:h,value:p,onChange:l,inputId:`agent-human-input-mode-select-${n}`,"aria-label":"Human input mode"}),$n.jsx(Fu,{name:"max-consecutive-auto-reply",label:"Max consecutive auto reply: ",value:a.maxConsecutiveAutoReply,onChange:c,min:0,max:1001,step:1,setNullOnUpper:!0,setNullOnLower:!1,onLowerLabel:"No auto reply",onUpperLabel:"Unset",labelInfo:"The maximum number of consecutive auto replies (i.e., when no code execution or llm-based reply is generated). Default is None (no limit provided). When set to 0, no auto reply will be generated.",dataTestId:`agent-max-consecutive-auto-reply-input-${n}`,"aria-label":"Maximum consecutive auto replies"}),$n.jsx("label",{htmlFor:`agent-default-auto-reply-input-${n}`,children:"Default Auto Reply:"}),$n.jsx("div",{className:"margin-top-5"}),$n.jsx(Gd,{className:"full-width margin-top-5",value:a.agentDefaultAutoReply??"",onChange:d,"data-testid":`agent-default-auto-reply-input-${n}`,"aria-label":"Default auto reply message"}),$n.jsx("div",{className:"margin-bottom-10"})]})});Mm.displayName="WaldiezAgentBasic";const Im=e.memo(t=>{const{id:n,data:a,flowId:s}=t,{agentLib:r,enableAgentLib:o,onEnableAgentLibChange:i,onFileUpload:l,onToolLibChange:c,onMaxRoundChange:d}=(t=>{const{data:n,onDataChange:a}=t,[s,r]=e.useState(n.agentLib.length>0),[o,i]=e.useState(n.agentLib);e.useEffect(()=>{i(n.agentLib)},[n]);const l=e.useCallback(e=>{a({...e})},[a]),c=e.useCallback(e=>{"number"==typeof e&&l({maxRound:e})},[l]),d=e.useCallback(e=>{l({toolLib:e?"default":null})},[l]),u=e.useCallback(e=>{r(e),l(e?{agentLib:o}:{agentLib:[]})},[l,o]),h=e.useCallback(e=>{const t=[];if(Array.isArray(e))for(const n of e)if("object"==typeof n&&null!==n){const{name:e,description:a}=n;if("string"==typeof e&&"string"==typeof a){const s=n,r="string"==typeof s.systemMessage?s.systemMessage:"string"==typeof s.system_message?s.system_message:null;r&&t.push({name:e,description:a,systemMessage:r})}}return t},[]),p=e.useCallback(e=>{if(!e.length)return;const t=e[0];if(!t)return;const n=new FileReader;n.onload=()=>{try{const e=n.result,t=JSON.parse(e),a=h(t);i(a),l({agentLib:a})}catch(e){}},n.readAsText(t)},[l,h]);return{agentLib:o,enableAgentLib:s,onEnableAgentLibChange:u,onFileUpload:p,onMaxRoundChange:c,onToolLibChange:d}})(t);return $n.jsxs("div",{className:"agent-panel agent-codeExecution-panel margin-top--10",children:[$n.jsx(Fu,{name:"max-round",label:"Max Round",labelInfo:"The maximum number of conversation rounds to be used in the generated groupchat.",value:a.maxRound,onChange:d,dataTestId:`agent-captain-max-round-${n}`,min:1,max:100,"aria-label":"Maximum rounds"}),$n.jsx(td,{id:`tool-lib-${n}`,label:"Include tool lib",info:"If enabled, the agents will be equipped with several tools",checked:"default"===a.toolLib,onChange:c,"aria-label":"Include tool library"}),$n.jsxs("div",{className:"margin-bottom-10",children:["If selected, you can find the available tools"," ",$n.jsx("a",{href:"https://github.com/ag2ai/ag2/tree/main/autogen/agentchat/contrib/captainagent/tools",target:"_blank",rel:"noreferrer nofollow noopener","aria-label":"View available tools on GitHub",children:"here"})]}),$n.jsx(td,{label:"Include agent lib",info:"If enabled, the captain agent will generate agents from a dedicated agents library",checked:o,onChange:i,id:`agent-captain-toggle-agent-lib-${n}`,"aria-label":"Include agent library"}),$n.jsxs("div",{className:"margin-bottom-10",children:["You can find an example of agents library"," ",$n.jsx("a",{href:"https://github.com/ag2ai/ag2/blob/main/notebook/agent_library_example.json",target:"_blank",rel:"noreferrer nofollow noopener","aria-label":"View example agent library on GitHub",children:"here"})]}),o&&$n.jsxs("div",{className:"agent-lib-container",children:[$n.jsx(qd,{flowId:s,allowedFileExtensions:[".json"],onUpload:l,"aria-label":"Upload agent library JSON file"}),r.length>0&&$n.jsx("div",{className:"margin-top-10",children:$n.jsx(Ud,{title:`Agent Library (${r.length} entries)`,dataTestId:`agent-lib-${n}`,expanded:!1,fullWidth:!0,"aria-label":"Agent library entries",children:$n.jsx("div",{className:"agent-lib-preview",style:{maxHeight:"300px",overflowY:"auto"},children:$n.jsx("pre",{children:JSON.stringify(r,null,2)})})})})]})]})});Im.displayName="WaldiezAgentCaptainTab";const Dm=e.memo(t=>{const{id:n,data:a,tools:s}=t,{codeExecutionValue:r,codeExecutionFunctionOptions:o,onUseCodeExecutionChange:i,onCodeExecutionWorkDirChange:l,onCodeExecutionLastNMessagesChange:c,onCodeExecutionTimeoutChange:d,onCodeExecutionUseDockerChange:u,onExecutionFunctionsChange:h}=(t=>{const{data:n,onDataChange:a,tools:s}=t,r=e.useCallback(e=>{const t=s.find(t=>t.id===e);return t?.data.label??"Unknown Tool"},[s]),o=e.useMemo(()=>s.map(e=>({label:e.data.label??"Unknown Tool",value:e.id})),[s]),i=e.useMemo(()=>!1===n.codeExecutionConfig?[]:(n.codeExecutionConfig?.functions??[]).map(e=>({label:r(e),value:e})),[n.codeExecutionConfig,r]),l=e.useCallback(e=>{const t=!!e&&{...n.codeExecutionConfig};a({codeExecutionConfig:t})},[n.codeExecutionConfig,a]),c=e.useCallback(e=>{const t=e.target.value;a({codeExecutionConfig:"object"==typeof n.codeExecutionConfig?{...n.codeExecutionConfig,workDir:t}:{workDir:t}})},[n.codeExecutionConfig,a]),d=e.useCallback(e=>{const t=e??0;a({codeExecutionConfig:"object"==typeof n.codeExecutionConfig?{...n.codeExecutionConfig,lastNMessages:t}:{lastNMessages:t}})},[n.codeExecutionConfig,a]),u=e.useCallback(e=>{const t=e??0;a({codeExecutionConfig:"object"==typeof n.codeExecutionConfig?{...n.codeExecutionConfig,timeout:t}:{timeout:t}})},[n.codeExecutionConfig,a]),h=e.useCallback(e=>{a({codeExecutionConfig:"object"==typeof n.codeExecutionConfig?{...n.codeExecutionConfig,useDocker:e}:{useDocker:e}})},[n.codeExecutionConfig,a]),p=e.useCallback(e=>{if(!e)return;const t=(Array.isArray(e)?e:[e]).map(e=>e?.value).filter(Boolean);a({codeExecutionConfig:"object"==typeof n.codeExecutionConfig?{...n.codeExecutionConfig,functions:t}:{functions:t}})},[n.codeExecutionConfig,a]);return{codeExecutionValue:i,codeExecutionFunctionOptions:o,getToolName:r,onUseCodeExecutionChange:l,onCodeExecutionWorkDirChange:c,onCodeExecutionLastNMessagesChange:d,onCodeExecutionTimeoutChange:u,onCodeExecutionUseDockerChange:h,onExecutionFunctionsChange:p}})(t),p=!1!==a.codeExecutionConfig,m=p&&!1!==a.codeExecutionConfig&&a.codeExecutionConfig?.lastNMessages&&"auto"!==a.codeExecutionConfig?.lastNMessages?a.codeExecutionConfig?.lastNMessages:0,g=p&&!1!==a.codeExecutionConfig&&!0===a.codeExecutionConfig?.useDocker,f=p&&!g&&s.length>0;return $n.jsxs("div",{className:"agent-panel agent-codeExecution-panel",children:[$n.jsx(td,{label:"Enable Code Execution",info:"Whether the agent is capable of executing code.",checked:p,onChange:i,id:`agent-code-execution-toggle-${n}`,"aria-label":"Enable code execution"}),p&&!1!==a.codeExecutionConfig&&$n.jsxs("div",{className:"agent-node-codeExecution-options margin-top-10",children:[$n.jsx(Zd,{label:"Working directory:",placeholder:"Working directory",className:"margin-top-10",name:"working-directory",value:a.codeExecutionConfig?.workDir??"",onChange:l,dataTestId:`agent-code-execution-work-dir-${n}`,"aria-label":"Code execution working directory"}),$n.jsx(Fu,{name:"last-n-messages",label:"Last N messages:",value:m,onChange:c,min:0,max:1e3,step:1,setNullOnLower:!0,forceInt:!0,onLowerLabel:"auto",labelInfo:"Maximum number of messages to use for code execution. If set to auto(0), all messages will be used.",dataTestId:`agent-code-execution-last-n-messages-${n}`,"aria-label":"Number of messages to include for code execution"}),$n.jsx(Fu,{label:"Timeout:",name:"timeout",value:a.codeExecutionConfig?.timeout??0,onChange:d,min:0,max:1e3,step:1,onNull:0,forceInt:!0,setNullOnLower:!0,onLowerLabel:"No timeout",labelInfo:"Maximum time in seconds to wait for code execution. If set to 0, no timeout will be used.",dataTestId:`agent-code-execution-timeout-${n}`,"aria-label":"Code execution timeout in seconds"}),$n.jsx("div",{className:"margin-top-10 margin-bottom-10 sr-only hidden",children:$n.jsx(td,{label:"Use Docker",info:"Whether to use Docker for code execution. If enabled, the agent will run code in a Docker container.",checked:g,onChange:u,id:`agent-code-execution-use-docker-${n}`,"aria-label":"Enable Docker for code execution"})}),f&&$n.jsx("div",{className:"codeExecution-functions",children:$n.jsxs("div",{className:"agent-node-functions",children:[$n.jsx("div",{className:"margin-top-20"}),$n.jsx("label",{htmlFor:`agent-code-execution-functions-${n}`,children:"Functions:"}),$n.jsx("div",{className:"margin-top-10",children:$n.jsx(nd,{isMulti:!0,options:o,value:r,onChange:h,inputId:`agent-code-execution-functions-${n}`,"aria-label":"Select code execution functions"})})]})})]})]})});Dm.displayName="WaldiezAgentCodeExecution";const Rm=e.memo(t=>{const{id:n,flowId:a,data:s,onDataChange:r}=t,o=e.useCallback(e=>{r({collectionName:e.target.value})},[r]),i=e.useCallback(e=>{r({resetCollection:e})},[r]),l=e.useCallback(e=>{r({queryEngine:{type:s.queryEngine?.type||"VectorChromaQueryEngine",dbPath:s.queryEngine?.dbPath||null,citationChunkSize:s.queryEngine?.citationChunkSize||512,enableQueryCitations:e}})},[s.queryEngine,r]),c=e.useCallback(e=>{let t=e.target.value||null;""===t?.trim()&&(t=null),r({queryEngine:{type:s.queryEngine?.type||"VectorChromaQueryEngine",enableQueryCitations:s.queryEngine?.enableQueryCitations||!1,citationChunkSize:s.queryEngine?.citationChunkSize||512,dbPath:t}})},[s.queryEngine,r]);return $n.jsxs("div",{className:"agent-panel",children:[$n.jsx(Zd,{label:"Collection Name:",name:"doc-agent-collection-name",dataTestId:`input-id-wf-${a}-wa-${n}-collection-name`,value:s.collectionName,onChange:o,placeholder:"Enter collection name",className:"margin-top-5"}),$n.jsx("div",{className:"margin-top-10",children:$n.jsx(td,{label:"Reset Collection",info:"If enabled, the collection will be reset before adding new documents.",id:`checkbox-id-wf-${a}-wa-${n}-reset-collection`,checked:s.resetCollection,onChange:i})}),$n.jsx("div",{className:"margin-top-10",children:$n.jsx(td,{label:"Enable Query Citations",info:"If enabled, citations will be included in query results.",id:`checkbox-id-wf-${a}-wa-${n}-enable-query-citations`,checked:s.queryEngine?.enableQueryCitations||!1,onChange:l})}),$n.jsx("div",{className:"margin-top-10",children:$n.jsx(Zd,{label:"Database Path:",name:"doc-agent-db-path",dataTestId:`input-id-wf-${a}-wa-${n}-db-path`,value:s.queryEngine?.dbPath||"",onChange:c,placeholder:"Enter database path",labelInfo:zm()})})]})}),zm=()=>{const e=(()=>{try{if("userAgentData"in navigator&&navigator.userAgentData&&"platform"in navigator.userAgentData&&"string"==typeof navigator.userAgentData.platform)return navigator.userAgentData.platform.toLowerCase().replace(/\s/g,"");if(navigator.platform)return navigator.platform.toLowerCase().replace(/\s/g,"");const e=navigator.userAgent.toLowerCase();return e.includes("mac")?"macos":e.includes("win")?"windows":e.includes("linux")?"linux":e.includes("android")?"android":e.includes("iphone")||e.includes("ipad")?"ios":"unknown"}catch{return"unknown"}})(),t=e.includes("mac"),n=e.includes("win");return t?$n.jsxs("div",{className:"help-instructions",children:[$n.jsx("h4",{children:"How to find folder path on Mac:"}),$n.jsxs("ol",{children:[$n.jsx("li",{children:"Open Finder and navigate to your folder"}),$n.jsx("li",{children:'Right-click the folder and select "Get Info"'}),$n.jsx("li",{children:'Copy the path from "Where:" field'}),$n.jsx("li",{children:"Or drag the folder into Terminal to see its path"})]}),$n.jsxs("p",{children:[$n.jsx("strong",{children:"Example:"})," /Users/yourname/Documents/MyProject"]})]}):n?$n.jsxs("div",{className:"help-instructions",children:[$n.jsx("h4",{children:"How to find folder path on Windows:"}),$n.jsxs("ol",{children:[$n.jsx("li",{children:"Open File Explorer and navigate to your folder"}),$n.jsx("li",{children:"Click on the address bar (or press Ctrl+L)"}),$n.jsx("li",{children:"The full path will be shown - copy it"}),$n.jsx("li",{children:"Or right-click folder → Properties → Location"})]}),$n.jsxs("p",{children:[$n.jsx("strong",{children:"Example:"})," C:\\Users\\yourname\\Documents\\MyProject"]})]}):$n.jsxs("div",{className:"help-instructions",children:[$n.jsx("h4",{children:"How to find folder path:"}),$n.jsxs("ol",{children:[$n.jsx("li",{children:"Open your file manager"}),$n.jsx("li",{children:"Navigate to the folder you want"}),$n.jsx("li",{children:"Look for the path in the address bar"}),$n.jsx("li",{children:"Or right-click and check properties"})]}),$n.jsxs("p",{children:[$n.jsx("strong",{children:"Example:"})," /home/yourname/Documents/MyProject"]})]})},Om=e.memo(t=>{const{id:n,data:a,darkMode:s,agents:r,edges:o,onDataChange:i}=t,l="doc_agent"===a.agentType,{groupOptions:c,currentGroupManager:d,selectedGroup:u,groupMembers:h,onSelectGroupChange:p,onJoinGroup:m,onLeaveGroup:g,onAfterWorkChange:f}=(t=>{const{id:n,agents:a,data:s,onDataChange:r}=t,o=e.useMemo(()=>a.filter(e=>"group_manager"===e.data.agentType),[a]),i=e.useMemo(()=>s.parentId?a.filter(e=>e.data.parentId===s.parentId&&e.id!==n):[],[a,s.parentId,n]),l=e.useMemo(()=>s.parentId?o.find(e=>e.id===s.parentId):void 0,[o,s.parentId]),c=e.useMemo(()=>o.map(e=>({label:e.data.label,value:e})),[o]),[d,u]=e.useState(l);e.useEffect(()=>{u(l)},[l]);const h=e.useCallback(e=>{u(e?e.value:void 0)},[]),p=e.useCallback(()=>{r({parentId:d?.id})},[d,r]),m=e.useCallback(()=>{r({parentId:void 0})},[r]),g=e.useCallback(e=>{r({afterWork:e})},[r]);return{groupOptions:c,currentGroupManager:l,selectedGroup:d,groupMembers:i,onSelectGroupChange:h,onJoinGroup:p,onLeaveGroup:m,onAfterWorkChange:g}})(t),y=e.useMemo(()=>u?{label:u.data.label,value:u}:null,[u]),b=!!d,v=null===u;return $n.jsx("div",{className:"agent-panel agent-group-panel",children:$n.jsxs(cp,{activeTabIndex:0,children:[$n.jsx(lp,{id:`wa-${n}-group-membership`,label:"Membership",children:$n.jsxs("div",{style:{padding:"1rem"},"data-testid":`agent-group-panel-${n}`,children:[$n.jsx("div",{className:"info margin-bottom-10",children:"Should this agent be part of a group chat?"}),b?$n.jsxs("div",{className:"flex-align-center space-between current-group-info",children:[$n.jsx("div",{className:"agent-panel-group-label","data-testid":`group-label-agent-${n}`,children:d.data.label}),$n.jsx("div",{className:"agent-panel-group-actions",children:$n.jsx("button",{title:"Leave group",type:"button",className:"agent-panel-group-action",onClick:g,"data-testid":`leave-group-button-agent-${n}`,"aria-label":"Leave current group",children:"Leave group"})})]}):$n.jsxs("div",{children:[$n.jsx("label",{htmlFor:`agent-select-group-${n}`,children:"Group:"}),$n.jsx("div",{className:"margin-top-10"}),$n.jsxs("div",{className:"flex-align-center space-between",children:[$n.jsx(nd,{options:c,value:y,onChange:p,inputId:`agent-select-group-${n}`,className:"flex-1 margin-right-10","aria-label":"Select a group to join"}),$n.jsx("button",{type:"button",title:"Join group",className:"agent-panel-select-group-action",onClick:m,disabled:v,"data-testid":`join-group-button-agent-${n}`,"aria-label":"Join selected group",children:"Join group"})]})]})]})}),b&&$n.jsx(lp,{id:`wa-${n}-group-handoffs`,label:"Handoffs",children:$n.jsx(eu,{agents:r,edges:o,id:n,data:a,onDataChange:i})}),b&&!l&&$n.jsx(lp,{id:`wa-${n}-group-update-state`,label:"State",children:$n.jsx(kp,{data:a,darkMode:s,onDataChange:i})}),b&&$n.jsx(lp,{label:"Afterwards",id:`wa-${n}-group-after-work`,children:$n.jsx("div",{style:{paddingLeft:"1rem",paddingRight:"1rem"},"data-testid":`after-work-panel-${n}`,children:$n.jsx(od,{target:a.afterWork,agents:h,onChange:f,isForGroupChat:!1,"aria-label":"After work configuration"})})})]})})});Om.displayName="WaldiezAgentGroupMember";const Lm={conditionType:"string_llm",prompt:""},Pm={type:"none",value:""},Bm=e.memo(t=>{const{id:n,flowId:a,agentConnections:s,data:r,edges:o,onDataChange:i}=t,l=e.useMemo(()=>((e,t)=>{const n=[];return e.nestedChats.length>0&&e.nestedChats[0].messages.length>0?n.push(e.nestedChats[0]):n.push({triggeredBy:[],messages:[],condition:{conditionType:"string_llm",prompt:""},available:{type:"none",value:""}}),t.forEach(e=>{n.length>0&&-1===n[0]?.messages.findIndex(t=>t.id===e.id)&&n[0]?.messages.push({id:e.id,isReply:!1})}),structuredClone(n)})(r,o),[r,o]);e.useEffect(()=>{if(!r?.nestedChats?.length)return;const e=new Set(r.nestedChats[0]?.messages.map(e=>e.id)),t=new Set(o.map(e=>e.id)),n=o.filter(t=>!e.has(t.id)),a=r.nestedChats[0]?.messages.filter(e=>!t.has(e.id));if(n.length>0||a.length>0){const e=[...r.nestedChats[0].messages.filter(e=>t.has(e.id)),...n.map(e=>({id:e.id,isReply:!1}))],a=[{...r.nestedChats[0],messages:e}];i({nestedChats:a})}},[r.nestedChats,o,i]);const c=e.useMemo(()=>l.length>0?l[0]?.messages.length:0,[l]),d=e.useCallback(e=>{const t=s.targets.edges.find(t=>t.id===e);if(!t)return"";const n=s.targets.nodes.find(e=>e.id===t.target);return n?n.data.label:""},[s.targets.edges,s.targets.nodes]),u=e.useCallback(e=>{const t=[...l];if(t[0]&&Array.isArray(t[0].messages)&&void 0!==t[0].messages[e]&&void 0!==t[0].messages[e-1]){const n=t[0].messages[e];t[0].messages[e]=t[0].messages[e-1],t[0].messages[e-1]=n,i({nestedChats:t})}},[l,i]),h=e.useCallback(e=>{const t=[...l],n=t[0].messages;if(void 0!==n[e+1]){const a=n[e];n[e]=n[e+1],n[e+1]=a,i({nestedChats:structuredClone(t)})}},[l,i]),p=e.useCallback(e=>{const t=structuredClone(l);t[0].condition=e||Lm,i({nestedChats:t})},[l,i]),m=e.useCallback(e=>{const t=structuredClone(l);t[0].available=e||Pm,i({nestedChats:t})},[l,i]);return $n.jsx("div",{className:"agent-panel","data-testid":`agent-group-nested-chat-tabs-${n}`,children:$n.jsxs(cp,{activeTabIndex:0,children:[$n.jsx(lp,{label:"Queue",id:`wf-${a}-wa-${n}-nested-chats-queue`,children:$n.jsx("div",{className:"flex-column margin-10 nested-chat-queue",children:l[0]?.messages.map((e,t)=>$n.jsxs("div",{className:"flex-align-center margin-bottom-10 queue-item","data-testid":`nested-chat-queue-item-${t}`,children:[$n.jsxs("div",{className:"margin-right-10 reorder-buttons",children:[t>0&&(c||0)>1&&$n.jsx("button",{type:"button",title:"Move up",className:"reorder-btn up-btn","data-testid":`move-nested-recipient-up-button-${t}`,onClick:()=>u(t),"aria-label":`Move ${d(e.id)} up`,children:"↑"}),t<(c||0)-1&&$n.jsx("button",{title:"Move down",type:"button",className:"reorder-btn down-btn","data-testid":`move-nested-recipient-down-button-${t}`,onClick:()=>h(t),"aria-label":`Move ${d(e.id)} down`,children:"↓"})]}),$n.jsx("div",{className:"agent-nested-recipient-name",children:d(e.id)})]},`agent-${n}-nestedChat-recipient-${t}`))})}),$n.jsx(lp,{label:"Condition",id:`wf-${a}-wa-${n}-nested-chat-condition`,children:$n.jsx(Xd,{condition:l[0]?.condition||Lm,onDataChange:p,"aria-label":"Handoff condition settings"})}),$n.jsx(lp,{label:"Availability",id:`wf-${a}-wa-${n}-nested-chat-availability`,children:$n.jsx($d,{available:l[0]?.available||Pm,onDataChange:m,"aria-label":"Handoff availability settings"})})]})})});Bm.displayName="WaldiezAgentGroupNestedChatTabs";const Fm=e.memo(t=>{const{id:n,chat:a,selectOptions:s,selectedRecipient:r,getEdgeLabel:o,onSelectedRecipientChange:i,onSelectedRecipientIsReplyChange:l,onAddNestedChatConnection:c,onRemoveRecipient:d,onNestedChatRecipientMovedUp:u,onNestedChatRecipientMovedDown:h,getMessageLabel:p}=t,m=e.useMemo(()=>r?{label:o(r.id),value:r.id}:null,[r,o]),g=!r||!r.id,f=0===a.messages.length;return $n.jsxs("div",{className:"nested-chat-messages","data-testid":`nested-chat-messages-${n}`,children:[$n.jsxs("div",{className:"info",children:[$n.jsx("b",{children:"Messages:"})," Specifies which nested chat will be triggered. The final message is returned to the main chat. ",$n.jsx("br",{}),$n.jsx("b",{children:"Agent's Reply:"}),' Indicates the recipient of the trigger message. If selected, it is the second in the order. For example, if "User => Assistant" with the box ticked, the message is sent to the User; otherwise, it is sent to the Assistant.']}),$n.jsx("label",{htmlFor:`new-nested-chat-select-recipient-${n}`,className:"nested-chat-messages-label",children:"Messages:"}),$n.jsxs("div",{className:"nested-chats-add-message",children:[$n.jsxs("div",{className:"nested-chat-recipients margin-right-10",children:[$n.jsx("label",{htmlFor:`new-nested-chat-select-recipient-${n}`,className:"hidden",children:"Recipient"}),$n.jsx(nd,{options:s,onChange:i,value:m,inputId:`new-nested-chat-select-recipient-${n}`,"aria-label":"Select message recipient"})]}),$n.jsx(ed,{id:`new-nested-chat-recipient-is-agent-reply-${n}`,label:"Agent's reply",isChecked:r?.isReply??!1,onCheckedChange:l,"data-testid":`new-nested-chat-recipient-is-agent-reply-${n}`}),$n.jsx("div",{className:"nested-chat-add-button",children:$n.jsx("button",{type:"button",title:"Add",className:"add-nested-chat",disabled:g,onClick:c,"data-testid":`new-nested-chat-add-recipient-${n}`,"aria-label":"Add message to nested chat",children:"Add"})})]}),$n.jsx("div",{className:"nested-chats-registered-messages",children:f?$n.jsx("div",{className:"nested-chat-registered-message",children:"No messages to include"}):$n.jsx("div",{className:"flex-1 messages-list",children:a.messages.map((e,t)=>$n.jsx(Um,{target:e,index:t,messageCount:a.messages.length,getMessageLabel:p,onMoveUp:u,onMoveDown:h,onRemove:d,id:n},`${e.id}-${t}`))})})]})}),Um=e.memo(({target:e,index:t,messageCount:n,getMessageLabel:a,onMoveUp:s,onMoveDown:r,onRemove:o,id:i})=>{const l=n>1&&0!==t,c=n>1&&t!==n-1;return $n.jsxs("div",{className:"nested-chat-registered-message","data-testid":`nested-chat-message-${i}-${t}`,children:[$n.jsxs("span",{className:"message-label",children:[a(t),e.isReply&&$n.jsx("span",{className:"reply-indicator",children:" (Reply)"})]}),$n.jsxs("div",{className:"nested-chat-message-actions",children:[l&&$n.jsx("div",{className:"nested-chat-reorder",children:$n.jsx("button",{type:"button",title:"Move up",onClick:()=>s(t),"data-testid":`nested-chat-reorder-up-${t}`,"aria-label":`Move message ${t+1} up`,children:"↑"})}),c&&$n.jsx("div",{className:"nested-chat-reorder",children:$n.jsx("button",{type:"button",title:"Move down",onClick:()=>r(t),"data-testid":`nested-chat-reorder-down-${t}`,"aria-label":`Move message ${t+1} down`,children:"↓"})}),$n.jsx("div",{className:"nested-chat-remove",children:$n.jsx("button",{type:"button",title:"Remove",onClick:()=>o(t),"data-testid":`remove-nested-chat-recipient-${t}`,"aria-label":`Remove message ${t+1}`,children:"Remove"})})]})]})});Fm.displayName="WaldiezAgentNestedChatsMessages",Um.displayName="MessageListItem";const Hm=e.memo(t=>{const{id:n,selectOptions:a,selectedTriggers:s,onSelectedTriggersChange:r}=t,o=e.useMemo(()=>s.map(e=>{const t=a.find(t=>t.value===e);return{label:t?.label||"Unknown",value:e}}),[s,a]);return $n.jsxs("div",{className:"nested-chat-triggers margin-bottom--10","data-testid":`nested-chat-triggers-${n}`,children:[$n.jsxs("div",{className:"info",children:[$n.jsx("b",{children:"Trigged by:"})," The agent triggers a sequence of nested chats when a message is received. If it is the termination message of a selected chat (e.g., max turns is set to 1) the trigger won't be activated."]}),$n.jsx("label",{htmlFor:`new-nested-chat-select-trigger-${n}`,className:"nested-chat-triggers-label",children:"Triggered by:"}),$n.jsx("div",{className:"nested-chat-select-trigger-view",children:$n.jsx("div",{className:"nested-chat-select-trigger",children:$n.jsx(nd,{options:a,value:o,onChange:r,isMulti:!0,inputId:`new-nested-chat-select-trigger-${n}`,"aria-label":"Select triggers for nested chat"})})})]})});Hm.displayName="WaldiezAgentNestedChatsTriggers";const Wm=e.memo(t=>{const{id:n}=t,{chat:a,triggerSelectOptions:s,messageSelectOptions:r,selectedTriggers:o,selectedRecipient:i,onSelectedTriggersChange:l,onSelectedRecipientChange:c,onSelectedRecipientIsReplyChange:d,onAddNestedChatConnection:u,onRemoveRecipient:h,onNestedChatRecipientMovedUp:p,onNestedChatRecipientMovedDown:m,getMessageLabel:g,getEdgeLabel:f}=(t=>{const{data:n,onDataChange:a,agentConnections:s}=t;e.useEffect(()=>{0===n.nestedChats.length&&a({nestedChats:[{messages:[],triggeredBy:[],condition:{conditionType:"string_llm",prompt:""},available:{type:"none",value:""}}]})},[n.nestedChats,a]);const r=e.useMemo(()=>n.nestedChats.length>0&&n.nestedChats[0]||{messages:[],triggeredBy:[],condition:{conditionType:"string_llm",prompt:""},available:{type:"none",value:""}},[n.nestedChats]),[o,i]=e.useState(null),[l,c]=e.useState(r.triggeredBy),{sources:d,targets:u}=s,h=e.useMemo(()=>[...new Map([...d.nodes,...u.nodes].map(e=>[e.id,e])).values()],[d.nodes,u.nodes]),p=e.useMemo(()=>d.edges.concat(u.edges),[d.edges,u.edges]),m=e.useMemo(()=>h.map(e=>({label:e.data?.label,value:e.id})),[h]),g=e.useMemo(()=>p.map(e=>({label:e.data?.label,value:e.id})),[p]),f=e.useCallback(e=>{const t=p.find(t=>t.id===e);return t?.data?.label||"Unknown"},[p]),y=e.useCallback(e=>e<0||e>=r.messages.length?"Invalid message":f(r.messages[e].id),[r.messages,f]),b=e.useCallback(()=>{if(!o)return;if(r.messages.some(e=>e.id===o.id&&e.isReply===o.isReply))return;const e={messages:[...r.messages,{id:o.id,isReply:o.isReply}],triggeredBy:r.triggeredBy,condition:r.condition,available:r.available};a({nestedChats:[e]})},[o,r,a]),v=e.useCallback(e=>{const t={...r,messages:r.messages.filter((t,n)=>n!==e)};a({nestedChats:[t]})},[r,a]),x=e.useCallback(e=>{if(e<=0||e>=r.messages.length)return;const t=[...r.messages],n=t[e];t[e]=t[e-1],t[e-1]=n;const s={...r,messages:t};a({nestedChats:[s]})},[r,a]),w=e.useCallback(e=>{if(e<0||e>=r.messages.length-1)return;const t=[...r.messages];if(void 0!==t[e]&&void 0!==t[e+1]){const n=t[e];t[e]=t[e+1],t[e+1]=n}const n={...r,messages:t};a({nestedChats:[n]})},[r,a]),C=e.useCallback(e=>{c(e?e.map(e=>e.value):[]);const t={...r,messages:e?r.messages:[],triggeredBy:e?e.map(e=>e.value):[]};a({nestedChats:[t]})},[r,a]),k=e.useCallback(e=>{e&&e.value?i(t=>({id:e.value,isReply:t?.isReply||!1})):i(null)},[]),j=e.useCallback(e=>{o&&i(t=>({...t,isReply:e}))},[o]);return{chat:r,triggerSelectOptions:m,messageSelectOptions:g,selectedTriggers:l,selectedRecipient:o,onSelectedTriggersChange:C,onSelectedRecipientChange:k,onSelectedRecipientIsReplyChange:j,onAddNestedChatConnection:b,onRemoveRecipient:v,onNestedChatRecipientMovedUp:x,onNestedChatRecipientMovedDown:w,getMessageLabel:y,getEdgeLabel:f}})(t),y=a.triggeredBy.length>0;return $n.jsxs("div",{className:"agent-panel agent-nestedChats-panel margin-top-10","data-testid":`agent-nested-chats-panel-${n}`,children:[$n.jsx(Hm,{id:n,selectedTriggers:o,onSelectedTriggersChange:l,selectOptions:s}),y&&$n.jsxs($n.Fragment,{children:[$n.jsx("hr",{className:"nested-chat-separator margin-top--10",style:{width:"100%",opacity:.3},"aria-hidden":"true"}),$n.jsx(Fm,{id:n,chat:a,selectOptions:r,selectedRecipient:i,onSelectedRecipientChange:c,onSelectedRecipientIsReplyChange:d,onAddNestedChatConnection:u,onRemoveRecipient:h,onNestedChatRecipientMovedUp:p,onNestedChatRecipientMovedDown:m,getMessageLabel:g,getEdgeLabel:f})]})]})});Wm.displayName="WaldiezAgentNestedChats";const qm=[{label:"Chroma",value:"chroma"},{label:"Qdrant",value:"qdrant"},{label:"Pgvector",value:"pgvector"},{label:"MongoDB",value:"mongodb"}],Vm={chroma:"Chroma",pgvector:"Pgvector",mongodb:"MongoDB",qdrant:"Qdrant"},Gm={chroma:"all-MiniLM-L6-v2",pgvector:"all-MiniLM-L6-v2",mongodb:"all-MiniLM-L6-v2",qdrant:"BAAI/bge-small-en-v1.5"},Km=()=>$n.jsxs("div",{children:["The model for embedding. ",$n.jsx("br",{}),"The defaults are: ",$n.jsx("br",{}),$n.jsx("b",{children:"Chroma:"})," all-MiniLM-L6-v2; ",$n.jsx("br",{}),$n.jsx("b",{children:"Pgvector:"})," all-MiniLM-L6-v2; ",$n.jsx("br",{}),$n.jsx("b",{children:"MongoDB:"})," all-MiniLM-L6-v2; ",$n.jsx("br",{}),$n.jsx("b",{children:"Qdrant:"})," BAAI/bge-small-en-v1.5."]}),$m=e.memo(t=>{const{id:n,data:a}=t,{retrieveConfig:s}=a,{onVectorDbChange:r,onModelChange:o,onQdrantUseMemoryChange:i,onQdrantUseLocalStorageChange:l,onQdrantLocalStoragePathChange:c,onChromaUseLocalStorageChange:d,onChromaLocalStoragePathChange:u,onDbConfigConnectionUrlChange:h}=(t=>{const{data:n,onDataChange:a}=t,s=e.useCallback(e=>{a({...n,retrieveConfig:{...n.retrieveConfig,...e}})},[n,a]),r=e.useCallback(e=>{s({dbConfig:{...n.retrieveConfig.dbConfig,...e}})},[n,s]);return{onVectorDbChange:e.useCallback(e=>{e&&s({vectorDb:e.value})},[s]),onModelChange:e.useCallback(e=>{s({model:e.target.value})},[s]),onQdrantUseMemoryChange:e.useCallback(e=>{r({useMemory:e,useLocalStorage:!1})},[r]),onQdrantUseLocalStorageChange:e.useCallback(e=>{r({useMemory:!1,useLocalStorage:e})},[r]),onQdrantLocalStoragePathChange:e.useCallback(e=>{r({localStoragePath:e.target.value})},[r]),onChromaUseLocalStorageChange:e.useCallback(e=>{r({useLocalStorage:e})},[r]),onChromaLocalStoragePathChange:e.useCallback(e=>{r({localStoragePath:e.target.value})},[r]),onDbConfigConnectionUrlChange:e.useCallback(e=>{r({connectionUrl:e.target.value})},[r])}})(t),p=e.useMemo(()=>({label:Vm[s.vectorDb??"chroma"],value:s.vectorDb??"chroma"}),[s.vectorDb]),m=e.useMemo(()=>s.dbConfig.model??Gm[s.vectorDb??"chroma"],[s.dbConfig.model,s.vectorDb]),g="qdrant"===s.vectorDb,f="chroma"===s.vectorDb,y=g&&s.dbConfig.useMemory,b=s.dbConfig.useLocalStorage,v=!g||g&&!y&&!b;return $n.jsxs("div",{className:"flex-column vector-db-config","data-testid":`rag-vector-db-config-${n}`,children:[$n.jsx("label",{htmlFor:`rag-vector-db-${n}`,children:"Vector DB:"}),$n.jsx(nd,{options:qm,value:p,onChange:r,inputId:`rag-vector-db-${n}`,"aria-label":"Select vector database type"}),$n.jsx(Hd,{label:"Embedding Model:",info:Km,htmlFor:`rag-vector-db-model-${n}`}),$n.jsx("input",{type:"text",title:"Embedding model",value:m,onChange:o,"data-testid":`rag-vector-db-model-${n}`,id:`rag-vector-db-model-${n}`,"aria-label":"Embedding model name"}),g&&$n.jsxs($n.Fragment,{children:[$n.jsx(td,{label:"Use Memory Storage ",info:"Use memory for the vector db. Default is True.",checked:s.dbConfig.useMemory,id:`rag-vector-db-use-memory-${n}`,onChange:i,"aria-label":"Use memory storage for Qdrant"}),!y&&$n.jsxs($n.Fragment,{children:[$n.jsx(td,{label:"Use Local Storage ",info:'Use local storage for the vector db. Default is: True if "Use Memory Storage" is False.',checked:b,onChange:l,id:`rag-vector-db-use-local-storage-${n}`,"aria-label":"Use local storage for Qdrant"}),b&&$n.jsxs($n.Fragment,{children:[$n.jsx("label",{htmlFor:`rag-vector-db-local-storage-path-${n}`,children:"Storage Path:"}),$n.jsx("input",{id:`rag-vector-db-local-storage-path-${n}`,title:"Storage path",type:"text",value:s.dbConfig.localStoragePath??"",onChange:c,"data-testid":`rag-vector-db-local-storage-path-${n}`,"aria-label":"Qdrant local storage path"})]})]})]}),f&&$n.jsxs($n.Fragment,{children:[$n.jsx(td,{label:"Use Persistent Storage ",info:"Use persistent storage for the vector db (i.e., whether to store data after closing the session). Default is False.",checked:b,id:`rag-vector-db-use-local-storage-${n}`,onChange:d,"aria-label":"Use persistent storage for Chroma"}),b&&$n.jsxs($n.Fragment,{children:[$n.jsx("label",{htmlFor:`rag-vector-db-chroma-local-storage-path-${n}`,children:"Storage Path:"}),$n.jsx("input",{id:`rag-vector-db-chroma-local-storage-path-${n}`,title:"Storage path",type:"text",value:s.dbConfig.localStoragePath??"",onChange:u,"data-testid":`rag-vector-db-local-storage-path-${n}`,"aria-label":"Chroma storage path"})]})]}),v&&$n.jsxs("div",{className:"flex-column",children:[$n.jsx(Hd,{htmlFor:`rag-vector-db-connection-url-${n}`,label:"Connection URL:",info:"The connection URL for the vector db. If using chroma and not provided, a new chroma db server will be spawned. For pgvector and mongodb, this is required."}),$n.jsx("input",{type:"text",title:"Connection URL",value:s.dbConfig.connectionUrl??"",onChange:h,"data-testid":`rag-vector-db-connection-url-${n}`,id:`rag-vector-db-connection-url-${n}`,"aria-label":"Vector DB connection URL"})]})]})});$m.displayName="WaldiezAgentRagUserVectorDb";const Zm=[{label:"Code",value:"code"},{label:"QA",value:"qa"},{label:"Default",value:"default"}],Qm={code:"Code",qa:"QA",default:"Default"},Ym=[".txt",".pdf",".doc",".docx",".rtf",".xlsx",".xls",".csv",".json",".yaml",".yml",".xml",".md",".odt"],Xm=e.memo(t=>{const{id:n,flowId:a,uploadsEnabled:s,data:r}=t,{retrieveConfig:o}=r,{onFilesUpload:i,onTaskChange:l,onAddDocsPath:c,onRemoveDocsPath:d,onDocPathChange:u,onCollectionNameChange:h,onNResultsChange:p,onDistanceThresholdChange:m}=(t=>{const{data:n,onDataChange:a,filesToUpload:s,onFilesToUploadChange:r}=t,o=e.useCallback(e=>{a({...n,retrieveConfig:{...n.retrieveConfig,...e}})},[n,a]);return{onFilesUpload:e.useCallback(e=>{if(!e.length)return;const t=[...n.retrieveConfig.docsPath],a=[...s];for(const n of e){const e=`file:///${n.name}`;t.includes(e)||(t.push(e),a.push(n))}r(a),o({docsPath:t})},[n.retrieveConfig.docsPath,s,r,o]),onTaskChange:e.useCallback(e=>{e&&o({task:e.value})},[o]),onAddDocsPath:e.useCallback(e=>{o({docsPath:[...n.retrieveConfig.docsPath,e]})},[n.retrieveConfig.docsPath,o]),onRemoveDocsPath:e.useCallback(e=>{if(s.length){const t=s.filter(t=>`file:///${t.name}`!==e);r(t.length?t:[])}const t=n.retrieveConfig.docsPath.filter(t=>t!==e);o({docsPath:t})},[n.retrieveConfig.docsPath,s,r,o]),onDocPathChange:e.useCallback((e,t)=>{o({docsPath:n.retrieveConfig.docsPath.map(n=>n===e?t:n)})},[n.retrieveConfig.docsPath,o]),onCollectionNameChange:e.useCallback(e=>{o({collectionName:e.target.value})},[o]),onNResultsChange:e.useCallback(e=>{if(e.target.value&&""!==e.target.value.trim())try{const t=parseInt(e.target.value,10);o({nResults:isNaN(t)||t<1?null:t})}catch(t){o({nResults:null})}else o({nResults:null})},[o]),onDistanceThresholdChange:e.useCallback(e=>{if(e.target.value&&""!==e.target.value.trim())try{const t=parseFloat(e.target.value);o({distanceThreshold:isNaN(t)||t<0?null:t})}catch(t){o({distanceThreshold:null})}else o({distanceThreshold:null})},[o])}})(t),g=e.useMemo(()=>({label:Qm[o.task],value:r.retrieveConfig.task}),[r.retrieveConfig.task,o.task]);return $n.jsxs("div",{className:"rag-retrieve-config-container","data-testid":`rag-retrieve-config-${n}`,children:[$n.jsxs("div",{className:"flex-column",children:[$n.jsx(Hd,{label:"Task:",info:'The task of the retrieve chat. Possible values are "code", "qa" and "default". The system prompt will be different for different tasks. The default value is `default`, which supports both code and qa, and provides source information in the end of the response.',htmlFor:`rag-retrieve-task-input-${n}`}),$n.jsx("label",{className:"hidden",htmlFor:`rag-retrieve-task-${n}`,children:"Task"}),$n.jsx(nd,{options:Zm,value:g,onChange:l,inputId:`rag-retrieve-task-${n}`,"aria-label":"Select RAG task type"})]}),$n.jsxs("div",{className:"flex-column",children:[s&&$n.jsx("div",{className:"margin-top-20",children:$n.jsx(qd,{flowId:a,onUpload:i,allowedFileExtensions:Ym,multiple:!0,"aria-label":"Upload documents for RAG"})}),$n.jsx(ip,{viewLabel:"Docs Paths:",viewLabelInfo:"The paths of the documents for the retrieve chat. It can be a list of directories, files and urls. Default is None, which works only if the collection is already created.",items:o.docsPath,itemsType:"rag-doc",onItemAdded:c,onItemDeleted:d,onItemChange:u,"aria-label":"Document paths"})]}),$n.jsxs("div",{className:"flex-column",children:[$n.jsx(Hd,{label:"Collection Name:",info:"The name of the collection to be used in the vector database. If not provided, a default name `autogen-docs` will be used.",htmlFor:`rag-retrieve-collection-name-${n}`}),$n.jsx("input",{type:"text",title:"Collection name",value:o.collectionName??"",onChange:h,"data-testid":`rag-retrieve-collection-name-${n}`,"aria-label":"Collection name",id:`rag-retrieve-collection-name-${n}`})]}),$n.jsxs("div",{className:"flex-column",children:[$n.jsx(Hd,{label:"Number of results:",info:"The number of results to return. Default is None, which means the system will return all the results. Will be ignored if < 1.",htmlFor:`rag-retrieve-n-results-${n}`}),$n.jsx("input",{title:"Number of results",type:"number",value:o.nResults??"",onChange:p,"data-testid":`rag-retrieve-n-results-${n}`,"aria-label":"Number of results",id:`rag-retrieve-n-results-${n}`})]}),$n.jsxs("div",{className:"flex-column",children:[$n.jsx(Hd,{htmlFor:`rag-retrieve-distance-threshold-${n}`,label:"Distance Threshold:",info:"The threshold for the distance score, only distance smaller than it will be returned. Will be ignored if < 0. Default is -1."}),$n.jsx("input",{title:"Distance threshold",type:"number",value:o.distanceThreshold??-1,onChange:m,"data-testid":`rag-retrieve-distance-threshold-${n}`,"aria-label":"Distance threshold",id:`rag-retrieve-distance-threshold-${n}`})]})]})});Xm.displayName="WaldiezAgentRagUserRetrieveConfig";const Jm=[{label:"Multi Lines",value:"multi_lines"},{label:"One Line",value:"one_line"}],eg={multi_lines:"Multi Lines",one_line:"One Line"},tg=e.memo(t=>{const{id:n,data:a}=t,{retrieveConfig:s}=a,{onChunkTokenSizeChange:r,onContextMaxTokensChange:o,onChunkModeChange:i,onMustBreakAtEmptyLineChange:l}=(t=>{const{data:n,onDataChange:a}=t,s=e.useCallback(e=>{a({...n,retrieveConfig:{...n.retrieveConfig,...e}})},[n,a]);return{onChunkTokenSizeChange:e.useCallback(e=>{if(e.target.value&&""!==e.target.value.trim())try{const t=parseInt(e.target.value,10);if(isNaN(t)||t<1)return;s({chunkTokenSize:t})}catch(t){}else s({chunkTokenSize:void 0})},[s]),onContextMaxTokensChange:e.useCallback(e=>{if(e.target.value&&""!==e.target.value.trim())try{const t=parseInt(e.target.value,10);if(isNaN(t)||t<1)return;s({contextMaxTokens:t})}catch(t){}else s({contextMaxTokens:void 0})},[s]),onChunkModeChange:e.useCallback(e=>{e&&s({chunkMode:e.value})},[s]),onMustBreakAtEmptyLineChange:e.useCallback(e=>{s({mustBreakAtEmptyLine:e})},[s])}})(t),c=e.useMemo(()=>({label:eg[s.chunkMode],value:s.chunkMode}),[s.chunkMode]),d="multi_lines"===s.chunkMode;return $n.jsxs("div",{className:"text-split-config","data-testid":`rag-text-split-config-${n}`,children:[$n.jsxs("div",{className:"flex-column",children:[$n.jsx(Hd,{label:"Chunk Token Size:",info:"The chunk token size for the retrieve chat. If not provided, a default size `max_tokens * 0.4` will be used.",htmlFor:`rag-chunk-token-size-${n}`}),$n.jsx("input",{title:"Chunk token size",type:"number",value:s.chunkTokenSize??"",onChange:r,"data-testid":`rag-chunk-token-size-${n}`,id:`rag-chunk-token-size-${n}`,"aria-label":"Chunk token size"})]}),$n.jsxs("div",{className:"flex-column",children:[$n.jsx(Hd,{label:"Context Max Tokens:",info:"The context max token size for the retrieve chat. If not provided, a default size `max_tokens * 0.8` will be used.",htmlFor:`rag-context-max-tokens-${n}`}),$n.jsx("input",{title:"Context max tokens",type:"number",value:s.contextMaxTokens??"",onChange:o,"data-testid":`rag-context-max-tokens-${n}`,id:`rag-context-max-tokens-${n}`,"aria-label":"Context maximum tokens"})]}),$n.jsxs("div",{className:"flex-column",children:[$n.jsx(Hd,{htmlFor:`rag-chunk-mode-${n}`,label:"Chunk Mode:",info:'The chunk mode for the retrieve chat. Possible values are "Multi Lines" and "One Line". If not provided, a default mode "Multi Lines" will be used.'}),$n.jsx("label",{className:"hidden",htmlFor:`rag-select-chunk-mode-${n}`,children:"Chunk Mode"}),$n.jsx(nd,{options:Jm,value:c,onChange:i,inputId:`rag-select-chunk-mode-${n}`,"aria-label":"Select chunk mode"})]}),d&&$n.jsx("div",{className:"flex-column",children:$n.jsx(td,{label:"Must Break at Empty Line ",info:'Chunk will only break at empty line if True. Default is True. If chunk_mode is "one_line", this parameter will be ignored.',id:`rag-must-break-at-empty-line-${n}`,checked:s.mustBreakAtEmptyLine,onChange:l,"aria-label":"Must break at empty line"})})]})});tg.displayName="WaldiezAgentRagUserTextSplit";const ng=e.memo(t=>{const{id:n,data:a}=t,{retrieveConfig:s}=a,{onCustomizedPromptChange:r,onCustomizedAnswerPrefixChange:o,onUpdateContextChange:i,onGetOrCreateChange:l,onNewDocsChange:c,onOverwriteChange:d,onRecursiveChange:u}=(t=>{const{data:n,onDataChange:a}=t,s=e.useCallback(e=>{a({...n,retrieveConfig:{...n.retrieveConfig,...e}})},[n,a]);return{onCustomizedPromptChange:e.useCallback(e=>{s({customizedPrompt:e.target.value})},[s]),onCustomizedAnswerPrefixChange:e.useCallback(e=>{s({customizedAnswerPrefix:e.target.value})},[s]),onUpdateContextChange:e.useCallback(e=>{s({updateContext:e})},[s]),onGetOrCreateChange:e.useCallback(e=>{s({getOrCreate:e})},[s]),onNewDocsChange:e.useCallback(e=>{s({newDocs:e})},[s]),onOverwriteChange:e.useCallback(e=>{s({overwrite:e})},[s]),onRecursiveChange:e.useCallback(e=>{s({recursive:e})},[s])}})(t);return $n.jsxs("div",{className:"rag-advanced-settings","data-testid":`rag-advanced-settings-${n}`,children:[$n.jsxs("div",{className:"flex-column",children:[$n.jsx(Hd,{label:"Customized Prompt:",info:"The customized prompt for the retrieve chat. Default is None.",htmlFor:`rag-customized-prompt-${n}`}),$n.jsx(Gd,{title:"Customized prompt",rows:2,value:s.customizedPrompt??"",onChange:r,"data-testid":`rag-customized-prompt-${n}`,id:`rag-customized-prompt-${n}`,"aria-label":"Customized prompt for RAG"})]}),$n.jsxs("div",{className:"flex-column",children:[$n.jsx(Hd,{label:"Customized Answer Prefix:",info:'The customized answer prefix for the retrieve chat. Default is "".If not "" and the customized_answer_prefix is not in the answer, `Update Context` will be triggered.',htmlFor:`rag-customized-answer-prefix-${n}`}),$n.jsx("input",{type:"text",title:"Customized answer prefix",value:s.customizedAnswerPrefix??"",onChange:o,"data-testid":`rag-customized-answer-prefix-${n}`,id:`rag-customized-answer-prefix-${n}`,"aria-label":"Customized answer prefix"})]}),$n.jsx("div",{className:"flex-column",children:$n.jsx(td,{label:"Update Context ",info:"If False, will not apply `Update Context` for interactive retrieval. Default is True.",checked:s.updateContext,onChange:i,id:`rag-update-context-${n}`,"aria-label":"Update context for interactive retrieval"})}),$n.jsx("div",{className:"flex-column",children:$n.jsx(td,{label:"Get or Create ",info:"Whether to get the collection if it exists. Default is True.",checked:s.getOrCreate,id:`rag-get-or-create-${n}`,onChange:l,"aria-label":"Get or create collection"})}),$n.jsx("div",{className:"flex-column",children:$n.jsx(td,{label:"New Docs ",info:"When True, only adds new documents to the collection; when False, updates existing documents and adds new ones. The default value is True. Document id is used to determine if a document is new or existing. By default, the id is the hash value of the content.",checked:s.newDocs,onChange:c,id:`rag-new-docs-${n}`,"aria-label":"Only add new documents"})}),$n.jsx("div",{className:"flex-column",children:$n.jsx(td,{label:"Overwrite ",info:"Whether to overwrite the collection if it exists. Default is False. Case 1. if the collection does not exist, create the collection. Case 2. the collection exists, if overwrite is True, it will overwrite the collection. Case 3. the collection exists and overwrite is False, if get_or_create is True, it will get the collection, otherwise it raise a ValueError.",checked:s.overwrite,onChange:d,id:`rag-overwrite-${n}`,"aria-label":"Overwrite existing collection"})}),$n.jsx("div",{className:"flex-column",children:$n.jsx(td,{label:"Recursive ",info:"Whether to search documents recursively in the docs_path. Default is True.",checked:s.recursive,onChange:u,id:`rag-recursive-${n}`,"aria-label":"Search documents recursively"})})]})});ng.displayName="WaldiezAgentRagUserAdvanced";const ag=e.memo(t=>{const{flowId:n,data:a,isDarkMode:s}=t,{retrieveConfig:r}=a,{onUseCustomEmbeddingChange:o,onEmbeddingFunctionChange:i,onUseCustomTokenCountChange:l,onCustomTokenCountFunctionChange:c,onUseCustomTextSplitChange:d,onCustomTextSplitFunctionChange:u}=(t=>{const{data:n,onDataChange:a}=t,s=e.useCallback(e=>{a({...n,retrieveConfig:{...n.retrieveConfig,...e}})},[n,a]);return{onUseCustomEmbeddingChange:e.useCallback(e=>{s({useCustomEmbedding:e})},[s]),onEmbeddingFunctionChange:e.useCallback(e=>{void 0!==e&&s({embeddingFunction:e})},[s]),onUseCustomTokenCountChange:e.useCallback(e=>{s({useCustomTokenCount:e})},[s]),onCustomTokenCountFunctionChange:e.useCallback(e=>{void 0!==e&&s({customTokenCountFunction:e})},[s]),onUseCustomTextSplitChange:e.useCallback(e=>{s({useCustomTextSplit:e})},[s]),onCustomTextSplitFunctionChange:e.useCallback(e=>{void 0!==e&&s({customTextSplitFunction:e})},[s])}})(t),h=e.useMemo(()=>r.embeddingFunction??'"""Custom embedding function."""\n# provide the function to embed the input text\n# complete the `custom_embedding_function` below.\n# Do not change the name of the function.\n# See https://docs.trychroma.com/integrations for more information and examples.\n# examples:\n# def custom_embedding_function():\n#    # type: () -> callable\n#   import chromadb.utils.embedding_functions as embedding_functions\n#   huggingface_ef = embedding_functions.HuggingFaceEmbeddingFunction(\n#        api_key="YOUR_API_KEY",\n#        model_name="sentence-transformers/all-MiniLM-L6-v2"\n#   )\n#   return huggingface_ef\n#\n# def custom_embedding_function():\n#    # type: () -> callable\n#    import chromadb.utils.embedding_functions as embedding_functions\n#    openai_ef = embedding_functions.OpenAIEmbeddingFunction(\n#       api_key="YOUR_API_KEY",\n#       model_name="text-embedding-3-small"\n#    )\n#    return openai_ef\n#\ndef custom_embedding_function():\n    # type: () -> callable\n    """Complete the custom embedding function."""\n    ...\n',[r.embeddingFunction]),p=e.useMemo(()=>r.customTokenCountFunction??'"""Custom function to count the number of tokens in a string.\n\nThe function should take (text:str, model:str) as input and return the\ntoken_count(int). the retrieve_config["model"] will be passed in the function.\nDefault is autogen.token_count_utils.count_token that uses tiktoken, which may\nnot be accurate for non-OpenAI models.\n"""\n# provide the function to count the number of tokens in a string.\n# complete the `custom_token_count_function` below. Do not change the name or the arguments of the function.\n# only complete the function body and the docstring and return the token count.\n\n# example:\n# def custom_token_count_function(text, model):\n#    # type: (Union[str, List, Dict], str) -> int\n#    return len(text.split())\n#\ndef custom_token_count_function(text, model):\n    """Complete the custom token count function."""\n    ...\n',[r.customTokenCountFunction]),m=e.useMemo(()=>r.customTextSplitFunction??'"""Custom text split function.\n\nA custom function to split a string into a list of strings. The default function is\n\'autogen.retrieve_utils.split_text_to_chunks\'.\n"""\n# provide the function to split the text into chunks.\n# complete the `custom_text_split_function` below. Do not change the name or the arguments of the function.\n# only complete the function body and the docstring and return the list of strings.\n# example:\n# def custom_text_split_function(\n#    text: str,\n#    max_tokens: int = 4000,\n#    chunk_mode: str = "multi_lines",\n#    must_break_at_empty_line: bool = True,\n#    overlap: int = 0,  # number of overlapping lines\n# ) -> list[str]:\n#    return text.split("\\n")\n#\ndef custom_text_split_function(\n    text,  # type: str\n    max_tokens,  # type: int\n    chunk_mode,  # type: str (multi_lines or one_line)\n    must_break_at_empty_line,  # type: bool\n    overlap,  # type: int # number of overlapping lines\n):\n    # type: (...) -> list[str]\n    """Complete the custom text split function."""\n    ...\n',[r.customTextSplitFunction]),g=r.useCustomEmbedding??!1,f=r.useCustomTokenCount??!1,y=r.useCustomTextSplit??!1,b={marginTop:-20,marginBottom:-10};return $n.jsxs("div",{className:"waldiez-agent-rag-user-custom-functions","data-testid":`rag-custom-functions-${n}`,children:[$n.jsx(Ud,{title:"Embedding Function",dataTestId:`${n}-rag-use-custom-embedding`,"aria-label":"Embedding function settings",children:$n.jsxs("div",{className:"flex-column",style:b,children:[$n.jsx("div",{className:"info",children:$n.jsx("div",{className:"info-tooltip",children:"If selected, the agent will use a custom embedding function. Default is False."})}),$n.jsx(ed,{id:`${n}-rag-use-custom-embedding-checkbox`,label:"Use Custom Embedding Function",isChecked:g,onCheckedChange:o,"data-testid":`${n}-rag-use-custom-embedding-checkbox`}),g&&$n.jsxs($n.Fragment,{children:[$n.jsx("label",{htmlFor:`${n}-embedding-function-editor`,children:"Embedding Function:"}),$n.jsx("div",{className:"margin-top-10",children:$n.jsx(Vd,{darkMode:s,value:h,onChange:i,"aria-label":"Custom embedding function code editor"})})]})]})}),$n.jsx(Ud,{title:"Token Count",dataTestId:`${n}-rag-use-custom-tokenCount`,"aria-label":"Token count function settings",children:$n.jsxs("div",{className:"flex-column",style:b,children:[$n.jsx("div",{className:"info",children:$n.jsx("div",{className:"info-tooltip",children:"If selected, the agent will use a custom token count function. Default is False."})}),$n.jsx(ed,{id:`${n}-rag-use-custom-tokenCount-checkbox`,label:"Use Custom Token Count Function",isChecked:f,onCheckedChange:l,"data-testid":`${n}-rag-use-custom-tokenCount-checkbox`}),f&&$n.jsxs($n.Fragment,{children:[$n.jsx("label",{htmlFor:`${n}-token-count-function-editor`,children:"Custom Token Count Function:"}),$n.jsx("div",{className:"margin-top-10",children:$n.jsx(Vd,{darkMode:s,value:p,onChange:c,"aria-label":"Custom token count function code editor"})})]})]})}),$n.jsx(Ud,{title:"Text Split",dataTestId:`${n}-rag-use-custom-textSplit`,"aria-label":"Text split function settings",children:$n.jsxs("div",{className:"flex-column",style:b,children:[$n.jsx("div",{className:"info",children:$n.jsx("div",{className:"info-tooltip",children:"If selected, the agent will use a custom text split function. Default is False."})}),$n.jsx(ed,{id:`${n}-rag-use-custom-textSplit-checkbox`,label:"Use Custom Text Split Function",isChecked:y,onCheckedChange:d,"data-testid":`${n}-rag-use-custom-textSplit-checkbox`}),y&&$n.jsxs($n.Fragment,{children:[$n.jsx("label",{htmlFor:`${n}-text-split-function-editor`,children:"Custom Text Split Function:"}),$n.jsx("div",{className:"margin-top-10",children:$n.jsx(Vd,{darkMode:s,value:m,onChange:u,"aria-label":"Custom text split function code editor"})})]})]})})]})});ag.displayName="WaldiezAgentRagUserCustomFunctions";const sg=e.memo(t=>{const{id:n,data:a,tools:s,skipExecutor:r}=t,{toolOptions:o,agentOptions:i,selectedTool:l,selectedTools:c,selectedExecutor:d,getToolName:u,getAgentName:h,onSelectedToolChange:p,onSelectedToolsChange:m,onSelectedExecutorChange:g,onAddTool:f,onRemoveTool:y}=(t=>{const{id:n,data:a,tools:s,agents:r,onDataChange:o}=t,i=jh(e=>e.updateAgentData),[l,c]=e.useState(null),[d,u]=e.useState(null);e.useEffect(()=>{const e=s.map(e=>e.id),t=a.tools.filter(t=>e.includes(t.id));t.length!==a.tools.length&&i(n,{tools:t})},[s,a.tools,i,n]);const h=e.useMemo(()=>a.tools.map(e=>{const t=s.find(t=>t.id===e.id);return t?{label:t.data.label,value:t}:null}),[a.tools,s]),p=e.useCallback(e=>{e&&0!==e.length?o({tools:e.filter(e=>null!==e).map(e=>({id:e.value.id,executorId:n}))}):o({tools:[]})},[o,n]),m=e.useMemo(()=>s.filter(e=>"shared"!==e.data.toolType).map(e=>({label:e.data.label??"Unknown tool",value:e})),[s]),g=e.useMemo(()=>r.map(e=>({label:e.data.label??"Unknown Agent",value:e})),[r]),f=e.useCallback(e=>{const t=s.find(t=>t.id===e.id);return t?t.data.label:"Unknown tool"},[s]),y=e.useCallback(e=>{const t=r.find(t=>t.id===e.executorId);return t?t.data.label:"Unknown Agent"},[r]),b=e.useCallback(()=>{if(!l||!d)return;const e=l.value,t=d.value;if(!a.tools.find(n=>n.executorId===t.id&&n.id===e.id)){const n={id:e.id,executorId:t.id},s=[...a.tools,n];o({tools:s}),c(null),u(null)}},[l,d,a.tools,o]),v=e.useCallback(e=>{const t=a.tools.filter((t,n)=>n!==e);o({tools:t})},[a.tools,o]);return{toolOptions:m,agentOptions:g,selectedTool:l,selectedTools:h,selectedExecutor:d,getToolName:f,getAgentName:y,onSelectedToolChange:c,onSelectedToolsChange:p,onSelectedExecutorChange:u,onAddTool:b,onRemoveTool:v}})(t);return 0===s.length?$n.jsx("div",{className:"agent-panel agent-tools-panel margin-bottom-10",children:$n.jsx("div",{className:"margin-top-10 margin-left-10",children:"No tools found in the workspace"})}):!0===r?$n.jsx("div",{className:"agent-panel agent-tools-panel margin-top-10 margin-bottom-10",children:$n.jsxs("div",{className:"agent-panel-select-tools",children:[$n.jsx("label",{htmlFor:`select-agent-tools-${n}`,children:"Tools:"}),$n.jsx(nd,{options:o,onChange:m,value:c,isMulti:!0,isClearable:!0,inputId:`select-agent-tool-${n}`,"aria-label":"Select tools"})]})}):$n.jsx("div",{className:"agent-panel agent-tools-panel margin-top-10 margin-bottom-10",children:$n.jsxs("div",{children:[$n.jsxs("div",{className:"agent-panel-add-tool",children:[$n.jsx("label",{htmlFor:`select-agent-tool-${n}`,children:"Tool:"}),$n.jsx(nd,{options:o,onChange:p,value:l,inputId:`select-agent-tool-${n}`,"aria-label":"Select tool"}),$n.jsx("label",{htmlFor:`select-agent-tool-executor-${n}`,children:"Executor:"}),$n.jsx(nd,{options:i,onChange:g,value:d,inputId:`select-agent-tool-executor-${n}`,"aria-label":"Select executor agent"}),$n.jsx("button",{type:"button",title:"Add tool",disabled:!l||!d,onClick:f,"data-testid":`add-agent-tool-${n}`,"aria-label":"Add tool",children:"Add"})]}),a.tools.length>0&&$n.jsxs("div",{className:"agent-panel-current-tools margin-top-10",children:[$n.jsx("div",{className:"agent-panel-current-tools-heading",children:"Current tools:"}),a.tools.map((e,t)=>$n.jsx("div",{className:"agent-panel-current-tool",children:$n.jsxs("div",{className:"agent-panel-current-tool-entry",children:[$n.jsxs("div",{className:"tool-item",children:["Tool:"," ",$n.jsx("div",{className:"tool-name","data-testid":`tool-name-${n}-${t}`,children:u(e)})]}),$n.jsxs("div",{className:"agent-item",children:["Executor:"," ",$n.jsx("div",{className:"agent-name","data-testid":`agent-name-${n}-${t}`,children:h(e)})]}),$n.jsx("button",{type:"button",title:"Remove tool",onClick:()=>y(t),"data-testid":`remove-agent-tool-${n}-${t}`,"aria-label":`Remove ${u(e)}`,children:"Remove"})]})},`tool-${n}-${e.id}-${e.executorId}`))]})]})})});sg.displayName="WaldiezAgentTools";const rg=e.memo(t=>{const{id:n,data:a,agents:s,models:r,tools:o,flowId:i,agentConnections:l,isDarkMode:c,isModalOpen:d,onDataChange:u,filesToUpload:h,onFilesToUploadChange:p,uploadsEnabled:m,showNestedChatsTab:g}=t,[f,y]=e.useState(0);return e.useEffect(()=>{y(0)},[d]),$n.jsx("div",{className:"agent-panel agent-ragUser-panel margin-bottom-10","data-testid":`agent-rag-user-panel-${n}`,children:$n.jsxs(cp,{activeTabIndex:f,children:[$n.jsx(lp,{label:"Model",id:`wf-${i}-wa-${n}-models`,children:$n.jsx("div",{className:"modal-tab-body",children:$n.jsx(Em,{id:n,data:a,models:r,onDataChange:u})})}),$n.jsx(lp,{label:"Code Execution",id:`wf-${i}-wa-${n}-codeExecution`,children:$n.jsx("div",{className:"modal-tab-body",children:$n.jsx(Dm,{id:n,data:a,tools:o,onDataChange:u})})}),$n.jsx(lp,{label:"Tools",id:`wf-${i}-wa-${n}-tools`,children:$n.jsx("div",{className:"modal-tab-body",children:$n.jsx(sg,{id:n,data:a,agents:s,tools:o,skipExecutor:!1,onDataChange:u})})}),g&&$n.jsx(lp,{label:"Nested chat",id:`wf-${i}-wa-${n}-nested`,children:$n.jsx("div",{className:"modal-tab-body",children:$n.jsx(Wm,{id:n,data:a,onDataChange:u,agentConnections:l})})}),$n.jsx(lp,{label:"RAG",id:`wf-${i}-wa-${n}-rag`,children:$n.jsxs(cp,{activeTabIndex:0,children:[$n.jsx(lp,{label:"Retrieve Config",id:`wf-${i}-wa-${n}-rag-retrieveConfig`,children:$n.jsx(Xm,{id:n,flowId:i,data:a,onDataChange:u,uploadsEnabled:m,filesToUpload:h,onFilesToUploadChange:p})}),$n.jsx(lp,{label:"Text splitting",id:`wf-${i}-wa-${n}-rag-textSplit`,children:$n.jsx(tg,{id:n,data:a,onDataChange:u})}),$n.jsx(lp,{label:"Vector DB Config",id:`wf-${i}-wa-${n}-rag-vectorDb`,children:$n.jsx($m,{id:n,data:a,onDataChange:u})}),$n.jsx(lp,{label:"Custom Functions",id:`wf-${i}-wa-${n}-rag-customFunctions`,children:$n.jsx(ag,{id:n,flowId:i,data:a,isDarkMode:c,onDataChange:u})}),$n.jsx(lp,{label:"Advanced",id:`wf-${i}-wa-${n}-rag-advanced`,children:$n.jsx(ng,{id:n,data:a,onDataChange:u})})]})})]})})});rg.displayName="WaldiezAgentRagUserTabs";const og=e.memo(t=>{const{id:n,data:a}=t,{reasoningMethodOptions:s,reasoningMethodValue:r,answerApproachOptions:o,answerApproachValue:i,isBeamSearch:l,isSimulationBasedMethod:c,onVerboseChange:d,onReasoningMethodChange:u,onMaxDepthChange:h,onForestSizeChange:p,onRatingScaleChange:m,onBeamSizeChange:g,onAnswerApproachChange:f,onNSimChange:y,onExplorationConstantChange:b}=(t=>{const{data:n,onDataChange:a}=t,s=e.useMemo(()=>[{value:"beam_search",label:"Beam Search"},{value:"mcts",label:"Monte Carlo Tree Search"},{value:"lats",label:"Language Agent Tree Search"},{value:"dfs",label:"Depth First Search"}],[]),r=e.useMemo(()=>({value:n.reasonConfig.method,label:s.find(e=>e.value===n.reasonConfig.method)?.label||"Beam Search"}),[n.reasonConfig.method,s]),o=e.useMemo(()=>[{value:"pool",label:"Pool"},{value:"best",label:"Best"}],[]),i=e.useMemo(()=>({value:n.reasonConfig.answerApproach,label:o.find(e=>e.value===n.reasonConfig.answerApproach)?.label||"Pool"}),[n.reasonConfig.answerApproach,o]),l=e.useMemo(()=>["mcts","lats"].includes(n.reasonConfig.method),[n.reasonConfig.method]),c=e.useMemo(()=>"beam_search"===n.reasonConfig.method,[n.reasonConfig.method]),d=e.useCallback(e=>{a({...e})},[a]),u=e.useCallback(e=>{d({verbose:e})},[d]),h=e.useCallback(e=>{e&&d({reasonConfig:{...n.reasonConfig,answerApproach:e.value}})},[d,n.reasonConfig]),p=e.useCallback(e=>{null!==e&&d({reasonConfig:{...n.reasonConfig,forestSize:e}})},[d,n.reasonConfig]),m=e.useCallback(e=>{e&&d({reasonConfig:{...n.reasonConfig,method:e.value}})},[d,n.reasonConfig]),g=e.useCallback(e=>{null!==e&&d({reasonConfig:{...n.reasonConfig,maxDepth:e}})},[d,n.reasonConfig]),f=e.useCallback(e=>{null!==e&&d({reasonConfig:{...n.reasonConfig,ratingScale:e}})},[d,n.reasonConfig]),y=e.useCallback(e=>{null!==e&&d({reasonConfig:{...n.reasonConfig,beamSize:e}})},[d,n.reasonConfig]),b=e.useCallback(e=>{null!==e&&d({reasonConfig:{...n.reasonConfig,nsim:e}})},[d,n.reasonConfig]),v=e.useCallback(e=>{null!==e&&d({reasonConfig:{...n.reasonConfig,explorationConstant:e}})},[d,n.reasonConfig]);return{reasoningMethodOptions:s,answerApproachOptions:o,isSimulationBasedMethod:l,isBeamSearch:c,reasoningMethodValue:r,answerApproachValue:i,onVerboseChange:u,onAnswerApproachChange:h,onForestSizeChange:p,onReasoningMethodChange:m,onMaxDepthChange:g,onRatingScaleChange:f,onBeamSizeChange:y,onNSimChange:b,onExplorationConstantChange:v}})(t);return $n.jsxs("div",{className:"agent-panel agent-codeExecution-panel margin-top--10",children:[$n.jsx(td,{label:"Verbose",info:"When enabled, the agent will provide additional information about the reasoning process.",checked:a.verbose,onChange:d,id:`agent-reasoning-verbose-toggle-${n}`,"aria-label":"Enable verbose reasoning output"}),$n.jsx("label",{className:"agent-panel-label",htmlFor:`agent-reasoning-method-${n}`,children:"Reasoning Method:"}),$n.jsx(nd,{options:s,value:r,onChange:u,inputId:`agent-reasoning-method-${n}`,"aria-label":"Select reasoning method"}),$n.jsx(Fu,{label:"Max Depth:",name:"max-depth",value:a.reasonConfig.maxDepth,onChange:h,min:1,max:10,dataTestId:`agent-reasoning-max-depth-${n}`,"aria-label":"Maximum depth for reasoning"}),$n.jsx(Fu,{label:"Forest Size:",name:"forest-size",value:a.reasonConfig.forestSize,onChange:p,min:1,max:10,dataTestId:`agent-reasoning-forest-size-${n}`,"aria-label":"Forest size for reasoning"}),$n.jsx(Fu,{label:"Rating Scale:",name:"rating-scale",value:a.reasonConfig.ratingScale,onChange:m,min:1,max:10,dataTestId:`agent-reasoning-rating-scale-${n}`,"aria-label":"Rating scale for reasoning"}),l&&$n.jsxs($n.Fragment,{children:[$n.jsx(Fu,{name:"beam-size",label:"Beam Size:",value:a.reasonConfig.beamSize,onChange:g,min:1,max:10,dataTestId:`agent-reasoning-beam-size-${n}`,"aria-label":"Beam size for beam search"}),$n.jsx("label",{className:"agent-panel-label",htmlFor:`agent-reasoning-answer-approach-${n}`,children:"Answer Approach:"}),$n.jsx(nd,{options:o,value:i,onChange:f,inputId:`agent-reasoning-answer-approach-${n}`,"aria-label":"Select answer approach"})]}),c&&$n.jsxs($n.Fragment,{children:[$n.jsx(Fu,{name:"number-of-simulations",label:"Number of Simulations:",value:a.reasonConfig.nsim,onChange:y,min:1,max:10,dataTestId:`agent-reasoning-nsim-${n}`,"aria-label":"Number of simulations for MCTS/LATS"}),$n.jsx(Fu,{label:"Exploration Constant:",name:"exploration-constant",value:a.reasonConfig.explorationConstant,onChange:b,min:0,max:10,step:.01,dataTestId:`agent-reasoning-exploration-constant-${n}`,"aria-label":"Exploration constant for MCTS/LATS"})]})]})});og.displayName="WaldiezAgentReasoning";const ig=[{label:"Keyword is found",value:"found"},{label:"Keyword is the last word",value:"ending"},{label:"Keyword is the first word",value:"starting"},{label:"Exact match",value:"exact"}],lg=[{label:"None",value:"none"},{label:"Keyword",value:"keyword"},{label:"Method",value:"method"}],cg=e.memo(t=>{const{id:n}=t,{data:a,isDarkMode:s,terminationCriterionOptions:r,terminationTypeOptions:o,defaultTerminationMethodContent:i,onTerminationTypeChange:l,onTerminationMethodChange:c,onTerminationCriterionChange:d,onAddTerminationKeyword:u,onDeleteTerminationKeyword:h,onTerminationKeywordChange:p}=(t=>{const{data:n,onDataChange:a}=t,{isDark:s}=Qn(),r=e.useMemo(()=>n.termination.methodContent&&n.termination.methodContent.length>1?n.termination.methodContent:'"""Custom termination message function."""\n# provide the function to check if the message is a termination message\n# complete the `is_termination_message` below. Do not change the name or the arguments of the function.\n# only complete the function body and the docstring and return True if the message is a termination message, False otherwise.\n# example:\n# def is_termination_message(message):\n#    # type: (dict[str, any]) -> bool\n#    return message.get("content", "").lower() == "terminate"\n#\ndef is_termination_message(message):\n    """Complete the termination message function"""\n    ...\n',[n.termination.methodContent]),o=e.useCallback(e=>{if(!e)return;const t=e.value;a({termination:{...n.termination,keywords:"keyword"===t?n.termination.keywords:[],methodContent:"method"===t?r:"",criterion:"keyword"===t?n.termination.criterion:"found",type:t}})},[n.termination,a,r]),i=e.useCallback(e=>{e&&a({termination:{...n.termination,methodContent:e}})},[n.termination,a]),l=e.useCallback(e=>{if(!e)return;const t=e.value;a({termination:{...n.termination,criterion:t}})},[n.termination,a]),c=e.useCallback(e=>{a({termination:{...n.termination,keywords:[...n.termination.keywords,e]}})},[n.termination,a]),d=e.useCallback(e=>{a({termination:{...n.termination,keywords:n.termination.keywords.filter(t=>t!==e)}})},[n.termination,a]),u=e.useCallback((e,t)=>{a({termination:{...n.termination,keywords:n.termination.keywords.map(n=>n===e?t:n)}})},[n.termination,a]);return{data:n,terminationCriterionOptions:ig,terminationTypeOptions:lg,defaultTerminationMethodContent:r,isDarkMode:s,onTerminationTypeChange:o,onTerminationMethodChange:i,onTerminationCriterionChange:l,onAddTerminationKeyword:c,onDeleteTerminationKeyword:d,onTerminationKeywordChange:u}})(t),m=e.useMemo(()=>({label:o.find(e=>e.value===a.termination.type)?.label??"None",value:a.termination?.type??"none"}),[a.termination.type,o]),g=e.useMemo(()=>{const e=r.find(e=>e.value===a.termination.criterion);if(e)return{label:e.label,value:e.value}},[a.termination.criterion,r]),f=a.termination&&"method"===a.termination.type,y=a.termination&&"keyword"===a.termination.type;return $n.jsxs("div",{className:"agent-panel agent-termination-panel",children:[$n.jsx("div",{className:"info",children:"After receiving each message, the agent will send a reply to the sender unless the termination condition is met. A termination condition can be a keyword or a custom method."}),$n.jsx("label",{htmlFor:`termination-type-${n}`,children:"Termination Type:"}),$n.jsx("div",{className:"margin-top-10"}),$n.jsx(nd,{options:o,value:m,onChange:l,inputId:`termination-type-${n}`,"aria-label":"Select termination type"}),f&&$n.jsxs($n.Fragment,{children:[$n.jsx("label",{htmlFor:`termination-method-editor-${n}`,children:"Termination Method:"}),$n.jsx("div",{className:"margin-top-10"}),$n.jsx(Vd,{"data-testid":`termination-method-editor-${n}`,darkMode:s,value:i,onChange:c,"aria-label":"Edit termination method code"})]}),y&&$n.jsxs("div",{className:"margin-top-10",children:[$n.jsx("label",{htmlFor:`termination-criterion-${n}`,children:"Termination Criterion:"}),$n.jsx("div",{className:"margin-top-10"}),$n.jsx(nd,{options:r,value:g,onChange:d,inputId:`termination-criterion-${n}`,"aria-label":"Select termination criterion"}),$n.jsx(ip,{viewLabel:"Termination Keywords:",viewLabelInfo:"List of keywords to check for termination.",items:a.termination?.keywords??[],itemsType:"termination-keyword",onItemAdded:u,onItemDeleted:h,onItemChange:p,"aria-label":"Termination keywords list"})]})]})});cg.displayName="WaldiezAgentTermination";const dg=e.memo(t=>{const{id:n,flowId:a,data:s,tools:r,showNestedChatsTab:o,onDataChange:i,agentConnections:l,agents:c}=t,d=e.useCallback(e=>{i({label:e.target.value})},[i]),u=e.useCallback(e=>{i({maxConsecutiveAutoReply:e})},[i]),h=e.useCallback(e=>{i({agentDefaultAutoReply:e.target.value})},[i]);return $n.jsx("div",{className:"agent-panel agent-user-panel margin-bottom-10","data-testid":`agent-user-panel-${n}`,children:$n.jsxs(cp,{children:[$n.jsx(lp,{label:"User",id:`wf-${a}-wa-${n}-user`,children:$n.jsxs("div",{className:"modal-tab-body",children:[$n.jsx(Zd,{label:"Name:",name:"agent-name",value:s.label,onChange:d,dataTestId:`agent-name-input-${n}`,"aria-label":"Agent name",className:"margin-top-5"}),$n.jsx(Fu,{name:"max-consecutive-auto-reply",label:"Max consecutive auto reply: ",value:s.maxConsecutiveAutoReply,onChange:u,min:0,max:1001,step:1,setNullOnUpper:!0,setNullOnLower:!1,onLowerLabel:"No auto reply",onUpperLabel:"Unset",labelInfo:"The maximum number of consecutive auto replies (i.e., when no code execution or llm-based reply is generated). Default is None (no limit provided). When set to 0, no auto reply will be generated.",dataTestId:`agent-max-consecutive-auto-reply-input-${n}`,"aria-label":"Maximum consecutive auto replies"}),$n.jsx("div",{className:"margin-bottom-20"}),$n.jsx("label",{htmlFor:`agent-default-auto-reply-input-${n}`,children:"Default Auto Reply:"}),$n.jsx("div",{className:"margin-top-5"}),$n.jsx(Gd,{className:"full-width margin-top-5",value:s.agentDefaultAutoReply??"",onChange:h,"data-testid":`agent-default-auto-reply-input-${n}`,"aria-label":"Default auto reply message",placeholder:"Type your default auto reply message here..."})]})}),$n.jsx(lp,{label:"Code Execution",id:`wf-${a}-wa-${n}-codeExecution`,children:$n.jsx("div",{className:"modal-tab-body",children:$n.jsx(Dm,{id:n,data:s,tools:r,onDataChange:i})})}),$n.jsx(lp,{label:"Tools",id:`wf-${a}-wa-${n}-tools`,children:$n.jsx("div",{className:"modal-tab-body",children:$n.jsx(sg,{id:n,data:s,agents:c,tools:r,skipExecutor:!1,onDataChange:i})})}),o&&$n.jsx(lp,{label:"Nested chat",id:`wf-${a}-wa-${n}-nested`,children:$n.jsx("div",{className:"modal-tab-body",children:$n.jsx(Wm,{id:n,data:s,onDataChange:i,agentConnections:l})})})]})})});dg.displayName="WaldiezAgentUserTabs";const ug=e.memo(({id:t,data:n,flowId:a,isModalOpen:s,isDarkMode:r,filesToUpload:o,onDataChange:i,onAgentTypeChange:l,onFilesToUploadChange:c})=>{const d=jh(e=>e.getAgentConnections),u=jh(e=>e.getAgents),h=jh(e=>e.getModels),p=jh(e=>e.getTools),m=jh(e=>e.getEdges),g=jh(e=>e.onUpload),[f,y]=e.useState(0);e.useEffect(()=>{y(0)},[s]);const b=e.useMemo(()=>({isManager:"group_manager"===n.agentType,isGroupMember:"group_manager"!==n.agentType&&!!n.parentId,isRagUser:"rag_user_proxy"===n.agentType,isReasoning:"reasoning"===n.agentType,isCaptain:"captain"===n.agentType,isDocAgent:"doc_agent"===n.agentType}),[n.agentType,n.parentId]),{isManager:v,isGroupMember:x,isRagUser:w,isReasoning:C,isCaptain:k,isDocAgent:j}=b,A=e.useMemo(()=>{const e=d(t),a=h(),s=u(),r=p(),o=m(),i=s.filter(e=>"group_manager"===e.data.agentType),l=e.targets.edges.length+e.sources.edges.length,c=!x&&l>0;let f=!1,y=[],b=[];x&&(y=s.filter(e=>e.data.parentId===n.parentId),b=e.targets.edges.filter(e=>-1===y.findIndex(t=>t.id===e.target)),f=b.length>0);return{agentConnections:e,models:a,agents:s,edges:o,tools:r,groupManagers:i,showNestedChatsTab:c,showGroupNestedChatTab:f,groupMembers:y,connectionsOutsideGroup:b,uploadsEnabled:!!g}},[d,h,u,m,p,t,x,n.parentId,g]),{agentConnections:S,models:N,agents:T,edges:E,tools:_,groupManagers:M,showNestedChatsTab:I,showGroupNestedChatTab:D,connectionsOutsideGroup:R,uploadsEnabled:z}=A;return w?$n.jsx(rg,{id:t,flowId:a,isDarkMode:r,isModalOpen:s,agents:T,models:N,tools:_,agentConnections:S,showNestedChatsTab:I,uploadsEnabled:z,data:n,onDataChange:i,filesToUpload:o,onFilesToUploadChange:c}):"user_proxy"===n.agentType?$n.jsx(dg,{id:t,flowId:a,isDarkMode:r,isModalOpen:s,data:n,agents:T,tools:_,showNestedChatsTab:I,agentConnections:S,onDataChange:i}):$n.jsxs(cp,{activeTabIndex:f,children:[$n.jsx(lp,{label:"Agent",id:`wf-${a}-wa-${t}-basic`,children:$n.jsx("div",{className:"modal-tab-body",children:$n.jsx(Mm,{id:t,data:n,onDataChange:i,onAgentTypeChange:l})})}),C&&$n.jsx(lp,{label:"Reasoning",id:`wf-${a}-wa-${t}-reasoning`,children:$n.jsx("div",{className:"modal-tab-body",children:$n.jsx(og,{id:t,data:n,onDataChange:i})})}),k&&$n.jsx(lp,{label:"Captain",id:`wf-${a}-wa-${t}-captain`,children:$n.jsx("div",{className:"modal-tab-body",children:$n.jsx(Im,{id:t,flowId:a,data:n,onDataChange:i})})}),j&&$n.jsx(lp,{label:"Documents",id:`wf-${a}-wa-${t}-documents`,children:$n.jsx("div",{className:"modal-tab-body",children:$n.jsx(Rm,{id:t,flowId:a,data:n,onDataChange:i})})}),$n.jsx(lp,{label:"Termination",id:`wf-${a}-wa-${t}-termination`,children:$n.jsx("div",{className:"modal-tab-body",children:$n.jsx(cg,{id:t,data:n,onDataChange:i})})}),$n.jsx(lp,{label:"Code Execution",id:`wf-${a}-wa-${t}-codeExecution`,children:$n.jsx("div",{className:"modal-tab-body",children:$n.jsx(Dm,{id:t,data:n,tools:_,onDataChange:i})})}),$n.jsx(lp,{label:"Models",id:`wf-${a}-wa-${t}-models`,children:$n.jsx("div",{className:"modal-tab-body",children:$n.jsx(Em,{id:t,data:n,models:N,onDataChange:i})})}),!(j&&x)&&$n.jsx(lp,{label:"Tools",id:`wf-${a}-wa-${t}-tools`,children:$n.jsx("div",{className:"modal-tab-body",children:$n.jsx(sg,{id:t,data:n,agents:T,tools:_,skipExecutor:x,onDataChange:i})})}),I&&$n.jsx(lp,{label:"Nested chat",id:`wf-${a}-wa-${t}-nested`,children:$n.jsx("div",{className:"modal-tab-body",children:$n.jsx(Wm,{id:t,data:n,onDataChange:i,agentConnections:S})})}),x&&D&&$n.jsx(lp,{label:"Nested chat",id:`wf-${a}-wa-${t}-group-nested`,children:$n.jsx("div",{className:"modal-tab-body",children:$n.jsx(Bm,{id:t,flowId:a,darkMode:r,data:n,agentConnections:S,edges:R,onDataChange:i})})}),!v&&M.length>0&&$n.jsx(lp,{id:`wf-${a}-wa-${t}-group`,label:"Group",children:$n.jsx("div",{className:"modal-tab-body",children:$n.jsx(Om,{id:t,data:n,agents:T,edges:E,darkMode:r,onDataChange:i})})})]})});ug.displayName="WaldiezNodeAgentModalTabs";const hg=(e,t,n,a,s)=>{const r=n.toLowerCase(),o=n.charAt(0).toUpperCase()+n.slice(1);return $n.jsxs("div",{className:"modal-header-import-export",children:[$n.jsx("input",{title:`Import ${o}`,id:`file-upload-${r}-${e}-${t}`,"data-testid":`file-upload-${r}-${e}-${t}`,type:"file",accept:`.waldiez${o}`,onChange:a,className:"hidden"}),$n.jsx("label",{htmlFor:`file-upload-${r}-${e}-${t}`,className:"modal-header-import-button file-label",title:`Import ${o}`,children:$n.jsx(Nc,{})}),$n.jsx("div",{role:"button",className:"modal-header-export-button",onClick:s,title:`Export ${o}`,"data-testid":`export-${r}-${e}-${t}`,children:$n.jsx(Sc,{})})]})},pg=e.memo(t=>{const{id:n,data:a,isOpen:s,onClose:r}=t,{flowId:o,isDirty:i,isDarkMode:l,agentData:c,filesToUpload:d,onDataChange:u,onAgentTypeChange:h,onFilesToUploadChange:p,onImport:m,onExport:g,onSave:f,onSaveAndClose:y,onCancel:b}=((t,n,a,s)=>{const r=jh(e=>e.flowId),o=jh(e=>e.getAgentById),i=jh(e=>e.updateAgentData),l=jh(e=>e.updateEdgeData),c=jh(e=>e.exportAgent),d=jh(e=>e.importAgent),u=jh(e=>e.getAgentConnections),h=jh(e=>e.removeGroupMember),p=jh(e=>e.addGroupMember),m=jh(e=>e.updateEdgePath),g=jh(e=>e.onUpload),f=jh(e=>e.onFlowChanged),[y,b]=e.useState({...a}),[v,x]=e.useState([]),[w,C]=e.useState(!1),{isDark:k}=Qn();e.useEffect(()=>{C(!1),x([])},[n]);const j=e.useCallback(e=>{const n=document.getElementById(`flow-${r}-agent-description-${t}`);n&&(n.value=e)},[r,t]),A=e.useCallback(()=>{const e=o(t);if(!e)return j(y.description),void C(!1);e.data&&(b({...e.data}),C(!1)),j(e.data.description),f()},[t,y.description,o,j,f]),S=e.useCallback(()=>{const e=u(t,{sourcesOnly:!1,targetsOnly:!1}),n=e.sources.edges,s=e.targets.edges,r=y.label,o=a.label;n.forEach(e=>{const t=` => ${o}`,n=` => ${r}`,a=e.data?.label.indexOf(t);if("number"==typeof a&&a>-1){const a=e.data?.label.replace(t,n);l(e.id,{...e.data,label:a})}}),s.forEach(e=>{const t=`${o} => `,n=`${r} => `,a=e.data?.label.indexOf(t);if("number"==typeof a&&a>-1){const a=e.data?.label.replace(t,n);l(e.id,{...e.data,label:a})}})},[t,y.label,a.label,u,l]),N=e.useCallback(e=>{u(t,{targetsOnly:!0}).targets.edges.forEach(t=>{m(t.id,e)})},[t,u,m]),T=e.useCallback(e=>{const t=e.agentType;N(t),"rag_user_proxy"!==t||e.retrieveConfig?"user_proxy"===t&&e.retrieveConfig&&delete e.retrieveConfig:e.retrieveConfig=Oe},[N]),E=e.useCallback(e=>{const n=a.parentId,s=e.parentId;n!==s&&(n&&h(n,t),s&&p(s,t))},[a.parentId,t,h,p]),_=e.useCallback(e=>{e.agentType!==a.agentType&&T(e),E(e),i(t,e),a.label!==e.label&&S(),x([]),A()},[a,t,T,E,i,S,A]),M=e.useCallback(e=>{if(v.length>0&&g)g(v).then(t=>{const n=[...y.retrieveConfig.docsPath];for(let e=0;e<v.length;e++){const a=n.indexOf(`file:///${v[e]?.name}`);a>-1&&("string"==typeof t[e]?n[a]=t[e]:n.splice(a,1))}e.retrieveConfig.docsPath=n}).catch(e=>{}).finally(()=>{const t=e.retrieveConfig.docsPath;e.retrieveConfig.docsPath=[...t].filter(e=>"string"==typeof e&&e.length>0&&!e.startsWith("file:///")),x([]),_(e)});else{const t=y.retrieveConfig.docsPath;e.retrieveConfig.docsPath=t.filter(e=>"string"==typeof e&&e.length>0&&!e.startsWith("file:///")),x([]),_(e)}},[y,v,g,_]),I=e.useCallback(()=>{const e=y;e.agentType="rag_user_proxy",e.retrieveConfig||(e.retrieveConfig=Oe),e.retrieveConfig.docsPath=[],b({...y,...e})},[y]),D=e.useCallback(()=>{const e=y;e.agentType="user_proxy",e.retrieveConfig&&delete e.retrieveConfig,b({...y,...e})},[y]),R=e.useCallback(()=>{const e={...y};"rag_user_proxy"===y.agentType?M(e):_(e)},[y,M,_]),z=e.useCallback(()=>{R(),s()},[R,s]),O=e.useCallback(e=>{const t=!dm({...y,...e},a);b(t=>({...t,...e})),C(t)},[y,a]),L=e.useCallback((e,n)=>{const a=d(n,t,!0,e?.position,!1);O({...a.data})},[t,d,O]),P=e.useCallback(e=>{te(e,o.bind(null,t),L)},[t,o,L]),B=e.useCallback(async()=>{await J(y.label,"agent",c.bind(null,t,!0))},[y.label,t,c]),F=e.useCallback(()=>{const e=o(t);if(!e)return C(!1),void s();e.data&&b({...e.data}),C(!1),s()},[t,o,s]),U=e.useCallback(e=>{"rag_user_proxy"===e?I():D(),C(a.agentType!==e)},[a.agentType,I,D]),H=e.useCallback(e=>{const t=!dm(e,v);x(e),C(t)},[v]);return{flowId:r,filesToUpload:v,agentData:y,isDirty:w,isDarkMode:k,onDataChange:O,onAgentTypeChange:U,onFilesToUploadChange:H,onImport:P,onExport:B,onSave:R,onSaveAndClose:z,onCancel:F}})(n,s,a,r),v=e.useMemo(()=>"group_manager"!==a.agentType?hg(o,n,"agent",m,g):void 0,[a.agentType,o,n,m,g]),x=e.useMemo(()=>"group_manager"===a.agentType?c.groupName:c.label,[a.agentType,c]),w=e.useMemo(()=>"group_manager"===a.agentType?$n.jsx(_m,{isModalOpen:s,flowId:o,id:n,data:c,onDataChange:u,isDarkMode:l}):$n.jsx(ug,{id:n,flowId:o,data:c,isDarkMode:l,onDataChange:u,isModalOpen:s,onAgentTypeChange:h,filesToUpload:d,onFilesToUploadChange:p}),[a.agentType,s,o,n,c,u,l,h,d,p]);return $n.jsxs(ou,{flowId:o,title:x,isOpen:s,onClose:b,onSaveAndClose:y,beforeTitle:v,dataTestId:`wf-${o}-agent-modal-${n}`,hasUnsavedChanges:i,preventCloseIfUnsavedChanges:!0,children:[$n.jsx("div",{className:"modal-body",children:w}),$n.jsxs("div",{className:"modal-actions",children:[$n.jsx("button",{className:"secondary",onClick:b,"data-testid":`cancel-agent-data-${n}`,type:"button",title:"Cancel","aria-label":"Cancel",children:"Cancel"}),$n.jsxs("div",{className:"flex-row",children:[$n.jsx("button",{type:"button",title:"Save & Close",className:"save margin-right-10",onClick:y,"data-testid":`submit-and-close-agent-data-${n}`,disabled:!i,"aria-label":"Save and Close",children:"Save & Close"}),$n.jsx("button",{type:"button",title:i?"Save":"No changes to save",className:"primary",onClick:f,"data-testid":`submit-agent-data-${n}`,disabled:!i,"aria-label":"Save",children:"Save"})]})]})]})});pg.displayName="WaldiezNodeAgentModal";const mg={minWidth:490,minHeight:330},gg={minWidth:130,minHeight:120};function fg(e){return fc({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M11.445 20.913a1.665 1.665 0 0 1 -1.12 -1.23a1.724 1.724 0 0 0 -2.573 -1.066c-1.543 .94 -3.31 -.826 -2.37 -2.37a1.724 1.724 0 0 0 -1.065 -2.572c-1.756 -.426 -1.756 -2.924 0 -3.35a1.724 1.724 0 0 0 1.066 -2.573c-.94 -1.543 .826 -3.31 2.37 -2.37c1 .608 2.296 .07 2.572 -1.065c.426 -1.756 2.924 -1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543 -.94 3.31 .826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.31 .318 1.643 1.79 .997 2.694"},child:[]},{tag:"path",attr:{d:"M15 19l2 2l4 -4"},child:[]},{tag:"path",attr:{d:"M9 12a3 3 0 1 0 6 0a3 3 0 0 0 -6 0"},child:[]}]})(e)}const yg=[{label:"OpenAI",value:"openai"},{label:"Claude",value:"anthropic"},{label:"NIM",value:"nim"},{label:"Gemini",value:"google"},{label:"Cohere",value:"cohere"},{label:"DeepSeek",value:"deepseek"},{label:"Mistral",value:"mistral"},{label:"Azure",value:"azure"},{label:"Groq",value:"groq"},{label:"Together",value:"together"},{label:"Bedrock",value:"bedrock"},{label:"Other",value:"other"}],bg={openai:"OPENAI_API_KEY",azure:"AZURE_API_KEY",bedrock:"BEDROCK_API_KEY",deepseek:"DEEPSEEK_API_KEY",google:"GOOGLE_GEMINI_API_KEY",anthropic:"ANTHROPIC_API_KEY",cohere:"COHERE_API_KEY",mistral:"MISTRAL_API_KEY",groq:"GROQ_API_KEY",together:"TOGETHER_API_KEY",nim:"NIM_API_KEY",other:"OPENAI_API_KEY"},vg={openai:"https://platform.openai.com/docs/models",anthropic:"https://docs.anthropic.com/en/docs/about-claude/models/all-models",google:"https://ai.google.dev/gemini-api/docs/models",deepseek:"https://api-docs.deepseek.com/quick_start/pricing",cohere:"https://docs.cohere.com/v2/docs/models",together:"https://docs.together.ai/docs/serverless-models",nim:"https://docs.nvidia.com/nim/large-language-models/latest/models.html",mistral:"https://docs.mistral.ai/getting-started/models/models_overview/",azure:"https://learn.microsoft.com/en-us/azure/cognitive-services/openai/concepts/models",bedrock:"https://docs.aws.amazon.com/bedrock/latest/userguide/models-regions.html",groq:"",other:""},xg={openai:[{label:"GPT-5",value:"gpt-5"},{label:"GPT-5 Mini",value:"gpt-5-mini"},{label:"GPT-5 Nano",value:"gpt-5-nano"},{label:"GPT-4.1",value:"gpt-4.1"},{label:"GPT-4",value:"gpt-4"},{label:"GPT-4 Turbo",value:"gpt-4-turbo"},{label:"GPT-3.5 Turbo",value:"gpt-3.5-turbo"},{label:"GPT-4o",value:"gpt-4o"},{label:"GPT-4o Mini",value:"gpt-4o-mini"},{label:"GPT Image 1",value:"gpt-image-1"},{label:"o4-mini",value:"o4-mini"},{label:"o3",value:"o3"}],anthropic:[{label:"Claude 4.1 Opus",value:"claude-opus-4-1-20250805"},{label:"Claude 4 Sonnet",value:"claude-sonnet-4-20250514"},{label:"Claude 4 Opus",value:"claude-opus-4-20250514"},{label:"Claude 3.7 Sonnet",value:"claude-3-7-sonnet-20250219"},{label:"Claude 3.5 Haiku",value:"claude-3-5-haiku-20241022"},{label:"Claude 3.5 Sonnet v2",value:"claude-3-5-sonnet-20241022"},{label:"Claude 3.5 Sonnet",value:"claude-3-5-sonnet-20240620"},{label:"Claude 3 Opus",value:"claude-3-opus-20240229"},{label:"Claude 3 Sonnet",value:"claude-3-sonnet-20240229"},{label:"Claude 3 Haiku",value:"claude-3-haiku-20240307"}],google:[{label:"Gemini 2.5 Flash Preview 04-17",value:"gemini-2.5-flash-preview-04-17"},{label:"Gemini 2.5 Pro Preview",value:"gemini-2.5-pro-preview-03-25"},{label:"Gemini 2.0 Flash",value:"gemini-2.0-flash"},{label:"Gemini 2.0 Flash-Lite",value:"gemini-2.0-flash-lite"},{label:"Gemini 1.5 Flash",value:"gemini-1.5-flash"},{label:"Gemini 1.5 Pro",value:"gemini-1.5-pro"}],deepseek:[{label:"DeepSeek-V3",value:"deepseek-chat"},{label:"DeepSeek-R1",value:"deepseek-reasoner"}],cohere:[{label:"Command-R",value:"command-r"},{label:"Command-R+",value:"command-r-plus"},{label:"Command Light Nightly",value:"command-light-nightly"},{label:"Command A",value:"command-a-03-2025"},{label:"Command Nightly",value:"command-nightly"},{label:"Command R7B",value:"command-r7b-12-2024"}],together:[{label:"Llama 4 Maverick",value:"meta-llama/Llama-4-Maverick-17B-128E-Instruct-FP8"},{label:"Llama 4 Scout",value:"meta-llama/Llama-4-Scout-17B-16E-Instruct"},{label:"DeepSeek-R1",value:"deepseek-ai/DeepSeek-R1"},{label:"DeepSeek-R1 Distill Llama 70B",value:"deepseek-ai/DeepSeek-R1-Distill-Llama-70B"},{label:"DeepSeek-V3",value:"deepseek-ai/DeepSeek-V3"},{label:"Llama 3.3 70B Instruct Turbo",value:"meta-llama/Llama-3.3-70B-Instruct-Turbo"},{label:"Mistral Small 3 Instruct",value:"mistral-ai/Mistral-Small-3-Instruct"},{label:"Mistral (7B) Instruct v0.3",value:"mistralai/Mistral-7B-Instruct-v0.3"}],nim:[{label:"GPT-OSS-20B",value:"openai/gpt-oss-20b"},{label:"GPT-OSS-120B",value:"openai/gpt-oss-120b"},{label:"Meta Llama 3 8B Instruct",value:"meta/llama3-8b-instruct"},{label:"Meta Llama 3 70B Instruct",value:"meta/llama3-70b-instruct"},{label:"Llama 3.3 70B Instruct",value:"meta/llama-3.3-70b-instruct"},{label:"Llama 3.1 Nemotron Ultra 253B v1",value:"nvidia/llama-3.1-nemotron-ultra-253b-v1"},{label:"Llama 3.1 Nemotron Super 49B v1",value:"nvidia/llama-3.3-nemotron-super-49b-v1"},{label:"Llama 3.1 Nemotron Nano 8B v1",value:"nvidia/llama-3.1-nemotron-nano-8b-v1"}],mistral:[{label:"Codestral",value:"codestral-latest"},{label:"Mistral Large",value:"mistral-large-latest"},{label:"Pixtral Large",value:"pixtral-large-latest"},{label:"Mistral Saba",value:"mistral-saba-latest"},{label:"Ministral 3B",value:"ministral-3b-latest"},{label:"Ministral 8B",value:"ministral-8b-latest"}],bedrock:[],azure:[],groq:[],other:[]},wg={async signRequest(e,t,n,a,s,r,o,i={},l=""){const{host:c,path:d}=this.parseUrl(t),u=(new Date).toISOString().replace(/[:-]|\.\d{3}/g,""),h=u.slice(0,8),p=await H(l),m={...i,host:c,"x-amz-date":u,"x-amz-content-sha256":p};o&&(m["x-amz-security-token"]=o);const g=this.buildCanonicalHeaders(m),f=this.buildSignedHeadersList(m),y=[e,d,"",g,f,p].join("\n"),b="AWS4-HMAC-SHA256",v=`${h}/${n}/${a}/aws4_request`,x=[b,u,v,await H(y)].join("\n"),w=await this.getSignatureKey(r,h,n,a),C=await W(w,x,"hex");return m.Authorization=`${b} Credential=${s}/${v}, SignedHeaders=${f}, Signature=${C}`,m},parseUrl(e){try{const t=new URL(e);return{host:t.host,path:t.pathname}}catch(t){throw new Error(`Invalid URL: ${e}`)}},buildCanonicalHeaders:e=>Object.keys(e).sort().map(t=>`${t.toLowerCase()}:${e[t]?.trim()}\n`).join(""),buildSignedHeadersList:e=>Object.keys(e).sort().map(e=>e.toLowerCase()).join(";"),async getSignatureKey(e,t,n,a){const s=await W("AWS4"+e,t),r=await W(s,n),o=await W(r,a);return await W(o,"aws4_request")}},Cg={openai:"https://api.openai.com/v1",google:"https://generativelanguage.googleapis.com/v1beta",anthropic:"https://api.anthropic.com/v1",cohere:"https://api.cohere.com/v1",deepseek:"https://api.deepseek.com",mistral:"https://api.mistral.ai/v1",groq:"https://api.groq.com/openai/v1",together:"https://api.together.xyz/v1",nim:"https://integrate.api.nvidia.com/v1",bedrock:"https://bedrock.{region}.amazonaws.com",azure:"",other:""},kg={openai:"/models",azure:"/openai/deployments",deepseek:"/models",google:"/models",anthropic:"/models",cohere:"/models",mistral:"/models",groq:"/models",together:"/models",nim:"/models",other:"/v1/models",bedrock:""},jg=["openai","google","groq","anthropic","cohere","mistral","nim","other"],Ag=e=>{const{success:t,message:n,details:a}=(e=>{if(["azure","other"].includes(e.apiType)&&!e.baseUrl)return{success:!1,message:"Missing base URL"};let t=e.baseUrl||Cg[e.apiType];return["azure","other"].includes(e.apiType)&&e.baseUrl&&(t=e.baseUrl),t.trim()?{success:!0,message:"Model validated successfully",details:t}:{success:!1,message:"Missing base URL"}})(e);return t?e.apiKey?e.label.trim()?"azure"!==e.apiType||e.apiVersion?{success:!0,message:n,details:a}:{success:!1,message:"Missing Azure API version"}:{success:!1,message:"Missing model name"}:{success:!1,message:"Missing API key"}:{success:t,message:n,details:a}},Sg=(e,t)=>{let n=t.replace(/\/$/,"")+kg[e.apiType];const a=Object.fromEntries(Object.entries(e.defaultHeaders||{}).map(([e,t])=>[e,String(t)]));return"azure"===e.apiType?(n+=`?api-version=${e.apiVersion}`,a["api-key"]=e.apiKey):e.apiKey&&(a.Authorization=`Bearer ${e.apiKey}`),{url:n,headers:a}},Ng=async(e,t,n)=>{try{const a=await Mg(e,{method:"GET",headers:t});if(!a.ok)return{success:!1,message:"Azure API error"};const s=await a.json();return Array.isArray(s.data)&&s.data.some(e=>e.id===n)?{success:!0,message:"Model validated successfully"}:{success:!1,message:"Model not found"}}catch(a){return Dg(a)}},Tg=async(e,t,n)=>{const a=Rg(n);if(!a.success)return a;const{region:s,accessKey:r,secretKey:o,sessionToken:i}=n,l="bedrock",c=`https://${l}.${s}.amazonaws.com/foundation-models/${encodeURIComponent(t)}`;try{const n=await wg.signRequest("GET",c,s,l,r,o,i,e),a=await Mg(c,{method:"GET",headers:n});return await zg(a,t,s)}catch(d){return Dg(d)}},Eg=async(e,t,n)=>{try{const a=`${e}/${encodeURIComponent(n)}`,s=await Mg(a,{method:"GET",headers:t});return s.ok?{success:!0,message:"Model validated successfully"}:Ig(s)}catch(a){return Dg(a)}},_g=async(e,t,n)=>{try{const s=await Mg(e,{method:"GET",headers:t});if(!s.ok)return Ig(s);let r={data:[]};try{r=await s.json()}catch(a){return{success:!1,message:"Could not fetch model",details:a instanceof Error?a.message:String(a)}}return Array.isArray(r.data)&&r.data.some(e=>e.id===n)?{success:!0,message:"Model validated successfully"}:{success:!1,message:"Model not found"}}catch(a){return Dg(a)}},Mg=async(e,t)=>{const n=new AbortController,a=setTimeout(()=>n.abort(),4e3);try{return await fetch(e,{...t,signal:n.signal})}finally{clearTimeout(a)}},Ig=async e=>{try{const t=await e.json().catch(()=>({})),n=t?.error?.message||e.statusText||"Unknown error";let a="API error";return 404===e.status&&(a="Model not found"),{success:!1,message:a,details:n}}catch(t){return Dg(t)}},Dg=e=>({success:!1,message:e instanceof DOMException&&"AbortError"===e.name?"Could not get a response from the model's endpoint":"Unknown error",details:e instanceof Error?e.message:String(e)}),Rg=e=>{if(!e)return{success:!1,message:"Model fetch failed",details:"Missing AWS configuration"};const{region:t,accessKey:n,secretKey:a}=e;return t&&n&&a?{success:!0,message:"Model validated successfully"}:{success:!1,message:"Model fetch failed",details:"Missing required AWS credentials (region, accessKey, or secretKey)"}},zg=async(e,t,n)=>{if(e.ok)return{success:!0,message:"Model validated successfully",details:`Model ${t} is available in region ${n}`};if(404===e.status)return{success:!1,message:"Model not found",details:`Model ${t} not found in region ${n}`};if(403===e.status)return{success:!1,message:"API error",details:`Not authorized to access model ${t} in region ${n}`};try{const t=await e.text();return{success:!1,message:"API error",details:`Error (${e.status}): ${t}`}}catch(a){return{success:!1,message:"API error",details:`Error (${e.status})`}}},Og=(t,n)=>{const a=jh(e=>e.getModelById),s=jh(e=>e.updateModelData),r=jh(e=>e.cloneModel),o=jh(e=>e.deleteModel),i=jh(e=>e.importModel),l=jh(e=>e.exportModel),c=jh(e=>e.onFlowChanged),d=jh(e=>e.flowId),[u,h]=e.useState(_n[n.apiType]||""),[p,m]=e.useState(!1),[g,f]=e.useState(n),[y,b]=e.useState(!1);e.useEffect(()=>{f(n),h(_n[n.apiType]||""),b(!1)},[n]);const v=e.useCallback(()=>{m(!0),b(!1)},[]),x=e.useCallback(()=>{o(t),b(!1),c()},[o,t,c]),w=e.useCallback(()=>{r(t),b(!1),c()},[r,t,c]),C=e.useCallback((e,a)=>{const s=i(a,t,e?.position,!1);f(s.data),b(!dm(n,s.data))},[i,t,n]),k=e.useCallback(e=>{te(e,(e=>a(e)).bind(null,t),C)},[a,t,C]),j=e.useCallback(async()=>{await J(n.label,"model",()=>l(t,!0))},[n.label,l,t]),A=e.useCallback(e=>{f(t=>{const a={...t,...e};return b(!dm(a,n)),a})},[n]),S=e.useCallback(()=>{h(_n[n.apiType]||""),f(n),b(!1),m(!1)},[n]),N=e.useCallback(()=>{(async e=>{const t=Ag(e);if(!t.success||!t.details)return t;const{url:n,headers:a}=Sg(e,t.details);return"azure"===e.apiType?Ng(n,a,e.label.trim()):"bedrock"===e.apiType?Tg(a,e.label.trim(),e.aws):jg.includes(e.apiType)?Eg(n,a,e.label.trim()):_g(n,a,e.label.trim())})(g).then(e=>{e.success?Mr({flowId:d,message:e.message,level:"success",details:null,duration:3e3,withCloseButton:!1}):Mr({flowId:d,message:e.message,level:"error",details:e.details,duration:void 0,withCloseButton:!0})}).catch(e=>{const t=e instanceof Error?e.message:String(e);Mr({flowId:d,message:"Error validating model",level:"error",details:t,duration:void 0,withCloseButton:!0})})},[g,d]),T=e.useCallback(()=>{const e=_n[g.apiType]||"";h(e),s(t,g);const n=a(t);n?.data&&f(n.data),b(!1),c()},[g,s,t,a,c]),E=e.useCallback(()=>{T(),m(!1)},[T]);return e.useMemo(()=>({flowId:d,isOpen:p,isDirty:y,logo:u,modelData:g,setLogo:h,onOpen:v,onImport:k,onExport:j,onDataChange:A,onDelete:x,onClone:w,onSave:T,onSaveAndClose:E,onCancel:S,onCheck:N}),[d,p,y,u,g,h,v,k,j,A,x,w,T,E,S,N])},Lg=e.memo(t=>{const{data:n}=t,{temperature:a,topP:s,maxTokens:r,defaultHeaders:o,tags:i}=n,{onTemperatureChange:l,onTopPChange:c,onMaxTokensChange:d,onUpdateHeaders:u,onDeleteHeader:h,onAddHeader:p,onAddTag:m,onUpdateTag:g,onDeleteTag:f}=(t=>{const{data:n,onDataChange:a}=t;return{onTemperatureChange:e.useCallback(e=>{let t=null;e>=0&&(t=e),a({temperature:t})},[a]),onTopPChange:e.useCallback(e=>{let t=null;e>=0&&(t=e),a({topP:t})},[a]),onMaxTokensChange:e.useCallback(e=>{let t=null;e>=0&&(t=e),a({maxTokens:t})},[a]),onUpdateHeaders:e.useCallback(e=>{a({defaultHeaders:e})},[a]),onDeleteHeader:e.useCallback(e=>{const t={...n.defaultHeaders};delete t[e],a({defaultHeaders:t})},[n.defaultHeaders,a]),onAddHeader:e.useCallback((e,t)=>{const s={...n.defaultHeaders};s[e]=t,a({defaultHeaders:s})},[n.defaultHeaders,a]),onAddTag:e.useCallback(e=>{const{tags:t}=n;if(!t.includes(e)){const n=[...t,e];a({tags:n})}},[n,a]),onUpdateTag:e.useCallback((e,t)=>{const{tags:s}=n,r=s.indexOf(e);if(r>=0){const e=[...s];e[r]=t,a({tags:e})}},[n,a]),onDeleteTag:e.useCallback(e=>{const t=[...n.tags],s=t.indexOf(e);s>=0&&(t.splice(s,1),a({tags:t}))},[n.tags,a])}})(t);return $n.jsxs("div",{className:"flex-column",children:[$n.jsx(Fu,{name:"temperature",label:"Temperature:",value:null!==a?a:-.001,onChange:l,min:-.001,max:1,step:.001,setNullOnLower:!0,onLowerLabel:"Unset",dataTestId:"model-modal-temperature"}),$n.jsx(Fu,{name:"top-p",label:"Top P:",labelInfo:"Top P value for sampling (it is recommended to use either temperature or top P, not both)",value:null!==s?s:-.001,onChange:c,min:-.001,max:1,step:.001,setNullOnLower:!0,onLowerLabel:"Unset",dataTestId:"model-modal-top-p"}),$n.jsx(Fu,{name:"max-tokens",label:"Max Tokens:",value:null!==r?r:0,onChange:d,min:0,max:5e4,step:1,forceInt:!0,setNullOnLower:!0,onLowerLabel:"No limit",dataTestId:"model-modal-max-tokens"}),$n.jsx(Wd,{viewLabel:"Default Headers:",viewLabelInfo:"Optional headers to be included in every request",items:o,itemsType:"model-header",onUpdate:u,onDelete:h,onAdd:p}),$n.jsx(ip,{viewLabel:"Tags:",items:i,itemsType:"tag",placeholder:"Tag",onItemAdded:m,onItemChange:g,onItemDeleted:f})]})}),Pg=e.memo(({data:t,onDataChange:n})=>{const a=e.useCallback(e=>{n({aws:{...t.aws,accessKey:e.target.value}})},[t.aws,n]),s=e.useCallback(e=>{n({aws:{...t.aws,secretKey:e.target.value}})},[t.aws,n]),r=e.useCallback(e=>{n({aws:{...t.aws,region:e.target.value}})},[t.aws,n]),o=e.useCallback(e=>{n({aws:{...t.aws,profileName:e.target.value}})},[t.aws,n]),i=e.useCallback(e=>{n({aws:{...t.aws,sessionToken:e.target.value}})},[t.aws,n]);return $n.jsxs("div",{className:"flex-column",children:[$n.jsx(Zd,{value:t.aws?.accessKey||"",name:"aws-access-key",label:"AWS Access Key:",placeholder:"AWS Access Key",onChange:a}),$n.jsx(Zd,{value:t.aws?.secretKey||"",name:"aws-secret-key",label:"AWS Secret Key:",placeholder:"AWS Secret Key",onChange:s}),$n.jsx(Zd,{value:t.aws?.region||"",name:"aws-region",label:"AWS Region:",placeholder:"AWS Region",onChange:r}),$n.jsx(Zd,{value:t.aws?.profileName||"",name:"aws-profile-name",label:"AWS Profile Name:",placeholder:"AWS Profile Name",onChange:o}),$n.jsx(Zd,{value:t.aws?.sessionToken||"",name:"aws-session-token",label:"AWS Session Token:",placeholder:"AWS Session Token",onChange:i})]})}),Bg=e.memo(t=>{const{ref:n,onChange:a}=t,s=e.useMemo(()=>Object.entries(xg).filter(([e,t])=>t.length>0).map(([e,t])=>({label:e,options:t.map(t=>({label:t.label,value:t.value,apiType:e}))})),[]);return $n.jsxs("div",{className:"margin-bottom-5",children:[$n.jsx("label",{htmlFor:"predefined-models-select",children:"Predefined models:"}),$n.jsx("div",{className:"margin-top-10"}),$n.jsx(nd,{ref:n,inputId:"predefined-models-select",options:s,onChange:e=>{a(e?{label:e.value,apiType:e.apiType}:void 0)},placeholder:"Select a model...",formatGroupLabel:e=>{const t=_n[e.label];return $n.jsxs("div",{className:`model-logo ${e.label} flex items-center`,children:[$n.jsx("img",{src:t,alt:`${e.label} logo`,style:{width:20,height:20,marginRight:10,backgroundColor:"transparent"}}),$n.jsx("strong",{children:e.label})]})},isSearchable:!0,isClearable:!0,"aria-label":"Predefined models",className:"full-width"})]})});Bg.displayName="ModelSelector";const Fg=e.memo(t=>{const{id:n,data:a}=t,{label:s,apiType:r,apiKey:o,baseUrl:i}=a,{apiTypeLabel:l,apiKeyInfo:c,apiKeyEnv:d,urlIsEditable:u,apiKeyVisible:h,apiTypeOptions:p,readOnlyBaseUrl:m,predefinedModelsSelectRef:g,onDataChange:f,onApiKeyVisibleChange:y,onLabelChange:b,onApiTypeChange:v,onApiKeyChange:x,onBaseUrlChange:w}=(t=>{const{data:n,onDataChange:a,onLogoChange:s}=t,{apiType:r}=n,o=e.useRef(null),[i,l]=e.useState(!1),c=e.useCallback(e=>Cg[e],[]),d=e.useCallback(e=>["other","azure"].includes(e),[]),u=e.useCallback(e=>{a({label:e.target.value})},[a]),h=e.useCallback(e=>{a({description:e.target.value})},[a]),p=e.useCallback(e=>{e&&(o.current?.clearValue(),a({apiType:e.value}),s(_n[e.value]))},[a,s]),m=e.useCallback(e=>{a({apiKey:e.target.value})},[a]),g=e.useCallback(e=>{a({baseUrl:e.target.value})},[a]),f=e.useCallback(()=>{l(e=>!e)},[]),y=e.useMemo(()=>bg[r],[r]),b=e.useMemo(()=>`API key to use if the '${y}' environment variable is not set`,[y]),v=e.useMemo(()=>{return"anthropic"===(e=r)?"Claude":"deepseek"===e?"DeepSeek":"google"===e?"Gemini":"openai"===e?"OpenAI":"nim"===e?"NIM":e&&0!==e.length&&"other"!==e?e[0].toUpperCase()+e.slice(1):"Other";var e},[r]),x=e.useMemo(()=>c(r),[c,r]),w=e.useMemo(()=>d(r),[d,r]);return{apiTypeOptions:yg,apiKeyVisible:i,apiKeyEnv:y,apiKeyInfo:b,apiTypeLabel:v,readOnlyBaseUrl:x,urlIsEditable:w,predefinedModelsSelectRef:o,onDataChange:a,onLabelChange:u,onDescriptionChange:h,onApiTypeChange:p,onApiKeyChange:m,onBaseUrlChange:g,onApiKeyVisibleChange:f}})(t),C=e.useMemo(()=>e=>{if(!e)return;const{label:t,apiType:n}=e;f({label:t,apiType:n})},[f]),k=e.useMemo(()=>$n.jsx("div",{className:"flex-column",children:Object.entries(vg).filter(([e,t])=>t.length>0).map(([e,t])=>$n.jsxs("div",{className:"flex-row margin-bottom-5",children:[$n.jsxs("span",{className:"flex-shrink-0",children:[ve(e)," models:  "]}),$n.jsx("a",{href:t,target:"_blank",rel:"noreferrer",className:"text-truncate",children:t})]},e))}),[]),j=e.memo(e=>{const{innerProps:t,data:n}=e;return $n.jsxs("div",{...t,className:"flex margin-10",children:[$n.jsx("div",{className:`margin-right-10 margin-left-5 model-logo ${n.value}`,children:$n.jsx("img",{src:_n[n.value],alt:n.label,style:{width:20,height:20}})}),$n.jsx("span",{className:"label",children:n.label})]})}),A=`model-name-input-${n}`,S=`model-api-type-select-${n}`,N=`model-api-key-input-${n}`,T=`model-base-url-input-${n}`;return $n.jsxs("div",{className:"flex-column",children:[$n.jsxs("div",{className:"info margin-bottom-10",children:["You can select one of the predefined models from the list below or manually enter the model name and type. In the latter case, make sure that the model's name is a valid name (based on the provider). You can use the ",$n.jsx("strong",{children:"Test"})," button to check if the model parameters are correct, but model credits might be used for this test (depending on the provider). ",$n.jsx("br",{}),$n.jsx("strong",{children:"Note"}),' that if testing the model fails with a "Failed to load" message (for example a NIM model), it doesn\'t mean that the configuration is not correct (it could be a browser/CORS issue).',$n.jsx(Ud,{title:"Useful Links",expanded:!1,fullWidth:!0,className:"transparent color-info no-padding margin-top-5 margin-bottom-5",contentClassName:"background-info",children:k})]}),$n.jsx(Bg,{ref:g,onChange:C}),$n.jsxs("div",{className:"margin-top-10",children:[$n.jsx("label",{htmlFor:A,children:"Name:"}),$n.jsx("div",{className:"margin-top-10"}),$n.jsx("input",{id:A,type:"text",value:s||"",onChange:b,title:"Model name","data-testid":"model-name-input",className:"full-width","aria-label":"Model name"})]}),$n.jsxs("div",{className:"margin-top-0",children:[$n.jsx(Hd,{htmlFor:`model-type-${n}`,label:"Model Type:",info:"API type to use for the model. Use 'other' for custom openai compatible models"}),$n.jsx("label",{htmlFor:S,className:"hidden",children:"Model Type:"}),$n.jsx(nd,{options:p,value:{label:l,value:r},components:{Option:j},onChange:v,inputId:S,"aria-label":"Model API type",className:"full-width"})]}),"bedrock"!==r&&$n.jsxs("div",{className:"margin-top-0",children:[$n.jsx(Hd,{label:"API Key:",info:c,htmlFor:N}),$n.jsxs("div",{className:"flex full-width",children:[$n.jsx("input",{id:N,className:"flex-1 margin-right-10",type:h?"text":"password",value:o||"",placeholder:d,onChange:x,"data-testid":"model-api-key-input","aria-label":"API key"}),$n.jsx("button",{type:"button",className:"toggle-visibility-btn",onClick:y,title:h?"Hide API key":"Show API key","aria-label":h?"Hide API key":"Show API key","data-testid":`visibility-apiKey-model-${n}`,children:h?$n.jsx(jc,{}):$n.jsx(Ac,{})})]})]}),$n.jsxs("div",{className:"margin-top-0",children:[$n.jsx(Hd,{label:"Base URL:",info:"Model's base URL (including version)",htmlFor:T}),u?$n.jsx("input",{id:T,title:"Model base URL",type:"text",value:i||"",onChange:w,"data-testid":"model-base-url-input",className:"full-width","aria-label":"Base URL"}):$n.jsx("input",{id:T,type:"text",title:"Model base URL",readOnly:!0,disabled:!0,value:m,"data-testid":"model-base-url-input-read-only",className:"full-width","aria-label":"Base URL (read-only)"})]})]})});Fg.displayName="WaldiezNodeModelModalBasicTab";const Ug=e.memo(t=>{const{modelId:n,data:a}=t,{onPricePromptChange:s,onPriceCompletionChange:r}=(t=>{const{data:n,onDataChange:a}=t;return{onPricePromptChange:e.useCallback(e=>{const t=parseFloat(e.target.value);if(isNaN(t))return;const s=n.price?.completionTokenPricePer1k??null;a({price:{completionTokenPricePer1k:s,promptPricePer1k:t>=0?t:null}})},[n.price?.completionTokenPricePer1k,a]),onPriceCompletionChange:e.useCallback(e=>{const t=parseFloat(e.target.value);if(isNaN(t))return;const s=n.price?.promptPricePer1k??null;a({price:{completionTokenPricePer1k:t>=0?t:null,promptPricePer1k:s}})},[n.price?.promptPricePer1k,a])}})(t),o=e.useMemo(()=>null!==a.price?.promptPricePer1k?a.price.promptPricePer1k:-1,[a.price?.promptPricePer1k]),i=e.useMemo(()=>null!==a.price?.completionTokenPricePer1k?a.price.completionTokenPricePer1k:-1,[a.price?.completionTokenPricePer1k]),l=`model-modal-price-prompt-${n}`,c=`model-modal-price-completion-${n}`,d=`price-prompt-${n}`,u=`price-completion-${n}`;return $n.jsx("div",{className:"flex-column",children:$n.jsxs("div",{className:"model-price",children:[$n.jsx(Hd,{label:"Price:",info:"Price in USD ($). Use 0 if it's free, -1 to skip setting a value",htmlFor:"prompt-price-inputs"}),$n.jsxs("div",{className:"flex-column margin-left-10 margin-bottom-10 padding-left-10",children:[$n.jsxs("div",{className:"flex-column margin-bottom-10",children:[$n.jsx("label",{htmlFor:d,children:"Prompt price per 1K tokens:"}),$n.jsx("input",{id:d,title:"Prompt price per 1K tokens",type:"number",min:"-1",step:"0.0001",className:"number-max-width",value:o,onChange:s,"data-testid":l,"aria-label":"Prompt price per 1000 tokens"})]}),$n.jsxs("div",{className:"flex-column",children:[$n.jsx("label",{htmlFor:u,children:"Completion price per 1K tokens:"}),$n.jsx("input",{id:u,title:"Completion price per 1K tokens",type:"number",min:"-1",step:"0.0001",className:"number-max-width",value:i,onChange:r,"data-testid":c,"aria-label":"Completion price per 1000 tokens"})]})]})]})})});Ug.displayName="WaldiezNodeModelModalPriceTab";const Hg=t=>{const{flowId:n,modelId:a,data:s,isOpen:r,isDirty:o,importExportView:i,onDataChange:l,onLogoChange:c,onClose:d,onSave:u,onSaveAndClose:h,onTest:p,onCancel:m}=t,[g,f]=e.useState(0);return e.useEffect(()=>{f(0)},[r]),$n.jsx(ou,{flowId:n,beforeTitle:i,title:s.label,dataTestId:`model-modal-${a}`,isOpen:r,onClose:d,onSaveAndClose:h,hasUnsavedChanges:o,preventCloseIfUnsavedChanges:!0,children:$n.jsxs("div",{className:"modal-body",children:[$n.jsxs(cp,{activeTabIndex:g,children:[$n.jsx(lp,{label:"Basic",id:`model-config-basic-${a}`,children:$n.jsx("div",{className:"model-panel",children:$n.jsx(Fg,{id:a,data:s,onDataChange:l,onLogoChange:c})})}),"bedrock"===s.apiType&&$n.jsx(lp,{label:"AWS",id:`model-config-aws-${a}`,children:$n.jsx("div",{className:"model-panel",children:$n.jsx(Pg,{data:s,onDataChange:l})})}),$n.jsx(lp,{label:"Advanced",id:`model-config-advanced-${a}`,children:$n.jsx("div",{className:"model-panel",children:$n.jsx(Lg,{data:s,onDataChange:l})})}),$n.jsx(lp,{label:"Price",id:`model-config-price-${a}`,children:$n.jsx("div",{className:"model-panel",children:$n.jsx(Ug,{modelId:a,data:s,onDataChange:l})})})]}),$n.jsxs("div",{className:"modal-actions",children:[$n.jsx("button",{type:"button",title:"Cancel",className:"modal-action-cancel",onClick:m,"data-testid":`modal-cancel-btn-${a}`,children:"Cancel"}),$n.jsxs("div",{className:"flex-row",children:[$n.jsx("button",{type:"button",title:"Test",className:"margin-right-10 neutral",onClick:p,"data-testid":`modal-test-btn-${a}`,disabled:o,children:"Test"}),$n.jsx("button",{title:"Save & Close",type:"button",className:"save margin-right-10",onClick:h,"data-testid":`modal-submit-and-close-btn-${a}`,disabled:!o,children:"Save & Close"}),$n.jsx("button",{type:"button",title:"Save",className:"modal-action-submit",onClick:u,"data-testid":`modal-submit-btn-${a}`,disabled:!o,children:"Save"})]})]})]})})},Wg=(t,n)=>{const a=jh(e=>e.flowId),s=jh(e=>e.updateToolData),r=jh(e=>e.cloneTool),o=jh(e=>e.deleteTool),i=jh(e=>e.getToolById),l=jh(e=>e.importTool),c=jh(e=>e.exportTool),d=jh(e=>e.onFlowChanged),{isDark:u}=Qn(),[h,p]=e.useState(!1),[m,g]=e.useState(n),[f,y]=e.useState(!1),b=e.useMemo(()=>(e=>{const t=new Date(e);return t.toLocaleDateString()+" "+t.toLocaleTimeString()})(n.updatedAt),[n.updatedAt]),v=e.useMemo(()=>jm(n.label,n.toolType,18),[n.label,n.toolType]);e.useEffect(()=>{g(n),y(!1)},[n]);const x=e.useCallback(()=>{p(!0),y(!1)},[]),w=e.useCallback(()=>{h||(r(t),d())},[h,r,t,d]),C=e.useCallback(()=>{o(t),y(!1),d()},[o,t,d]),k=e.useCallback(()=>{g(n),p(!1),y(!1)},[n]),j=e.useCallback(e=>{g(t=>{const a={...t,...e};return y(!dm(a,n)),a})},[n]),A=e.useCallback(async()=>{await J(n.label,"tool",()=>c(t,!0))},[n.label,c,t]),S=e.useCallback((e,a)=>{const s=l(a,t,e?.position,!1);g(s.data),y(!dm(n,s.data))},[l,t,n]),N=e.useCallback(e=>{te(e,(e=>i(e)).bind(null,t),S)},[i,t,S]),T=e.useCallback(()=>{s(t,m);const e=i(t);e?.data&&g(e.data),y(!1),d()},[s,t,m,i,d]),E=e.useCallback(()=>{T(),p(!1)},[T]);return{flowId:a,isModalOpen:h,isDirty:f,logo:v,toolData:m,isDark:u,updatedAt:b,onOpen:x,onClone:w,onDelete:C,onCancel:k,onSave:T,onSaveAndClose:E,onChange:j,onExport:A,onImport:N}},qg=t=>{const{data:n,onDataChange:a}=t,s=e.useCallback(e=>{a({secrets:e})},[a]),r=e.useCallback(e=>{const{[e]:t,...s}=n.secrets;a({secrets:s})},[n.secrets,a]),o=e.useCallback((e,t)=>{a({secrets:{...n.secrets,[e]:t}})},[n.secrets,a]),i=e.useCallback(e=>{a({toolType:e,content:hs[e],kwargs:{},secrets:{}})},[a]);return{onUpdateSecrets:s,onDeleteSecret:r,onAddSecret:o,onToolContentChange:e.useCallback(e=>{e&&a({content:e})},[a]),onToolLabelChange:e.useCallback(e=>{if("string"==typeof e)return void a({label:e});a({label:e.target.value})},[a]),onToolDescriptionChange:e.useCallback(e=>{if("string"==typeof e)return void a({description:e});a({description:e.target.value})},[a]),onToolTypeChange:i,onToolTypeSelectionChange:e.useCallback(e=>{rs.includes(e.value)?a({toolType:e.value,content:hs[e.value]||"",kwargs:{},secrets:{},label:e.value,description:os[e.value]||e.label}):a({toolType:e.value,content:"",kwargs:{},secrets:{},label:is[e.value]||"",description:os[e.value]||e.label})},[a]),onAddTag:e.useCallback(e=>{a({tags:[...n.tags,e]})},[n.tags,a]),onDeleteTag:e.useCallback(e=>{a({tags:n.tags.filter(t=>t!==e)})},[n.tags,a]),onTagChange:e.useCallback((e,t)=>{a({tags:n.tags.map(n=>n===e?t:n)})},[n.tags,a]),onAddRequirement:e.useCallback(e=>{a({requirements:[...n.requirements,e]})},[n.requirements,a]),onDeleteRequirement:e.useCallback(e=>{a({requirements:n.requirements.filter(t=>t!==e)})},[n.requirements,a]),onRequirementChange:e.useCallback((e,t)=>{a({requirements:n.requirements.map(n=>n===e?t:n)})},[n.requirements,a]),onSetToolKwarg:e.useCallback((e,t)=>{const s={...n.kwargs,[e]:t};a({kwargs:s})},[n.kwargs,a])}},Vg=e.memo(t=>{const{data:n}=t,{onUpdateSecrets:a,onDeleteSecret:s,onAddSecret:r,onAddRequirement:o,onDeleteRequirement:i,onRequirementChange:l,onAddTag:c,onDeleteTag:d,onTagChange:u}=qg(t),h=e.useMemo(()=>$n.jsxs("div",{children:["Requirements to ",$n.jsx("span",{className:"bold italic",children:"pip install"})," for this tool"]}),[]);return $n.jsxs($n.Fragment,{children:[$n.jsx(Wd,{viewLabel:"Environment Variables:",items:n.secrets,itemsType:"tool-secret",onUpdate:a,onDelete:s,onAdd:r,areValuesSecret:!0}),$n.jsx(ip,{viewLabel:"Requirements:",viewLabelInfo:h,placeholder:"Add a requirement...",items:n.requirements,itemsType:"tool-requirements",onItemAdded:o,onItemDeleted:i,onItemChange:l}),$n.jsx(ip,{viewLabel:"Tags:",placeholder:"Add a tag...",items:n.tags,itemsType:"tool-tags",onItemAdded:c,onItemDeleted:d,onItemChange:u})]})}),Gg=e.memo(t=>{const{toolId:n,data:a,darkMode:s}=t,{onToolContentChange:r,onToolLabelChange:o,onToolDescriptionChange:i,onToolTypeChange:l,onAddSecret:c,onSetToolKwarg:d}=qg(t),u=e.useMemo(()=>Am.find(e=>e.value===a.toolType)||Am.find(e=>e.value===a.label)||Am[0],[a.toolType,a.label]),h=e.useCallback(e=>{e&&(rs.includes(e.value)?(l("predefined"),o(e.value),i(os[e.value]||e.label)):(l(e.value),o(is[e.value]||""),i(os[e.value]||"")))},[l,o,i]),p=`tool-type-select-${n}`,m=`tool-label-input-${n}`,g=`tool-description-input-${n}`,f=`tool-content-editor-${n}`,y=e.useCallback((e,t)=>{const n=t.target.value;c(e,n)},[c]),b=e.useCallback((e,t)=>{const n=t.target.value;d(e,n)},[d]),v=e.memo(e=>{const{innerProps:t,data:n}=e;return $n.jsxs("div",{...t,className:"flex margin-5 clickable",children:[n.icon&&$n.jsx("div",{className:"icon margin-right-10 margin-top-5 margin-left-5",children:n.icon}),$n.jsx("span",{className:"label",children:n.label})]})});return $n.jsxs("div",{className:"flex-column",children:[$n.jsxs("div",{className:"margin-bottom-10",children:[$n.jsx("label",{htmlFor:p,children:"Type:"}),$n.jsx("div",{className:"margin-top-10"}),$n.jsx(nd,{inputId:p,options:Am,value:u,onChange:h,"data-testid":p,"aria-label":"Tool type",components:{Option:v}})]}),"predefined"!==a.toolType&&$n.jsxs("div",{className:"margin-bottom-10",children:[$n.jsx("label",{htmlFor:m,children:"Name:"}),$n.jsx("div",{className:"margin-top-10"}),$n.jsx("input",{title:"Name",type:"text",value:a.label||"","data-testid":m,id:m,onChange:o,className:"full-width","aria-label":"Tool name"})]}),"predefined"!==a.toolType&&$n.jsxs("div",{className:"margin-bottom-10",children:[$n.jsx("label",{htmlFor:g,children:"Description:"}),$n.jsx("div",{className:"margin-top-10"}),$n.jsx(Gd,{title:"Description",rows:2,value:a.description||"","data-testid":g,id:g,onChange:i,className:"full-width","aria-label":"Tool description"})]}),"predefined"!==a.toolType&&$n.jsxs("div",{children:[$n.jsx("label",{htmlFor:f,children:"Content:"}),$n.jsx("div",{className:"margin-top-10"}),$n.jsx(Vd,{value:a.content||"",onChange:r,darkMode:s,"aria-label":"Tool content","data-testid":f})]}),"predefined"===a.toolType&&km[a.label]&&$n.jsx("div",{className:"margin-top-10",children:km[a.label]}),"predefined"===a.toolType&&cs[a.label]&&cs[a.label].length>0&&$n.jsx("div",{className:"margin-top-10",children:cs[a.label]?.map((e,t)=>$n.jsx("div",{className:"margin-bottom-5",children:$n.jsx(Zd,{name:e.label,label:`${e.label}:`,dataTestId:`env-var-input-${t}-${e.key}`,value:(a.kwargs?a.kwargs[e.key]:"")||"",onChange:b.bind(null,e.key),className:"margin-top-10",isPassword:!1,placeholder:`Enter the ${e.label}`})},t))}),"predefined"===a.toolType&&ls[a.label]&&ls[a.label].length>0&&$n.jsx("div",{className:"margin-top-10",children:ls[a.label]?.map((e,t)=>$n.jsx("div",{className:"margin-bottom-5",children:$n.jsx(Zd,{name:e.label,label:`${e.label}:`,dataTestId:`env-var-input-${t}-${e.key}`,value:a.secrets[e.key]||"",onChange:y.bind(null,e.key),className:"margin-top-10",placeholder:`Enter the ${e.label}`,isPassword:!0})},t))})]})});Gg.displayName="WaldiezToolBasicTab";const Kg=t=>{const{toolId:n,flowId:a,data:s,isModalOpen:r,isDirty:o,onClose:i,onCancel:l,onSave:c,onSaveAndClose:d,onImport:u,onExport:h}=t,p=hg(a,n,"tool",u,h),[m,g]=e.useState(0);return e.useEffect(()=>{g(0)},[r]),$n.jsxs(ou,{flowId:a,beforeTitle:p,title:s.label,isOpen:r,onSaveAndClose:d,onClose:i,hasUnsavedChanges:o,preventCloseIfUnsavedChanges:!0,children:[$n.jsx("div",{className:"modal-body",children:$n.jsxs(cp,{activeTabIndex:m,children:[$n.jsx(lp,{label:"Basic",id:`tool-basic-tab-${n}`,children:$n.jsx("div",{className:"tool-panel",children:$n.jsx(Gg,{...t})})}),"predefined"!==s.toolType&&$n.jsx(lp,{label:"Advanced",id:`tool-advanced-tab-${n}`,children:$n.jsx("div",{className:"tool-panel",children:$n.jsx(Vg,{...t})})})]})}),$n.jsxs("div",{className:"modal-actions",children:[$n.jsx("button",{type:"button",title:"Cancel",className:"modal-action-cancel",onClick:l,"data-testid":`modal-cancel-btn-${n}`,children:"Cancel"}),$n.jsx("button",{title:"Save & Close",type:"button",className:"modal-action-submit margin-right-10 ",onClick:d,"data-testid":`modal-submit-and-close-btn-${n}`,disabled:!o,children:"Save & Close"}),$n.jsx("button",{title:"Save",type:"button",className:"modal-action-submit",onClick:c,"data-testid":`modal-submit-btn-${n}`,disabled:!o,children:"Save"})]})]})},$g={chat:tm,hidden:sm,nested:nm,group:am},Zg={agent:n=>{const{id:a,data:s,selected:r}=n,o=s.agentType,{edge:i,flowId:l,isReadOnly:c,isNodeModalOpen:d,isEdgeModalOpen:u,isModalOpen:h,isDragging:p,isSender:m,isRecipient:g,activeEvent:f,onDragOver:y,onDragLeave:b,onDrop:v,onDelete:x,onClone:w,onOpenNodeModal:C,onCloseNodeModal:k,onOpenEdgeModal:j,onCloseEdgeModal:A,onEdgeConnection:S}=(t=>{const n=jh(e=>e.getEdgeById),a=jh(e=>e.addEdge),s=jh(e=>e.deleteAgent),r=jh(e=>e.cloneAgent),o=jh(e=>e.onFlowChanged),{isSender:i,isRecipient:l,activeEvent:c}=jh(e=>({isSender:e.activeSenderId===t,isRecipient:e.activeRecipientId===t&&e.activeRecipientId!==e.activeSenderId,activeEvent:e.activeEventType})),d=jh(e=>e.flowId),u=jh(e=>e.isReadOnly),h=e.useMemo(()=>!0===u,[u]),[p,m]=e.useState(!1),[g,f]=e.useState(!1),[y,b]=e.useState(null),[v,x]=e.useState(!1),w=e.useMemo(()=>p||g,[p,g]),C=e.useCallback(()=>{h||w||(s(t),o())},[h,w,s,t,o]),k=e.useCallback(()=>{h||w||(r(t),o())},[h,w,r,t,o]),j=e.useCallback(()=>{h||m(!0)},[h,m]),A=e.useCallback(()=>{m(!1)},[m]),S=e.useCallback(e=>{if(!h&&!p&&!g){const t=e.currentTarget.getAttribute("data-edge-id");if(t){const e=n(t);e&&(b(e),f(!0))}}},[h,p,g,n,f,b]),N=e.useCallback(()=>{f(!1),b(null)},[f,b]),T=e.useCallback(e=>{if(!h&&!p){const t=a({flowId:d,connection:e,hidden:!1});b(t)}},[h,p,a,d,b]),E=e.useCallback(e=>{e.preventDefault(),e.stopPropagation(),x(!0)},[]),_=e.useCallback(e=>{e.preventDefault(),e.stopPropagation(),x(!1)},[]),M=e.useCallback(e=>{x(!1)},[]);return{flowId:d,edge:y,isNodeModalOpen:p,isEdgeModalOpen:g,isModalOpen:w,isReadOnly:h,isDragging:v,isSender:i,isRecipient:l,activeEvent:c,onDelete:C,onClone:k,onOpenNodeModal:j,onCloseNodeModal:A,onOpenEdgeModal:S,onCloseEdgeModal:N,onEdgeConnection:T,onDragOver:E,onDragLeave:_,onDrop:M}})(a),N=e.useMemo(()=>{let e=h?"nodrag nowheel ":"";return s.parentId?e+=`agent-node ${o} group-member`:e+=`agent-node ${o}`,"group_manager"===o&&(e+=" flex-column flex-1",p&&(e+=" dragging")),m&&(e+=" active-sender"),g&&(e+=" active-recipient"),e},[h,s.parentId,o,m,g,p]),T=e.useMemo(()=>s.parentId?"group-member ":"group_manager"===o?"group-manager ":"",[s.parentId,o]),E=e.useMemo(()=>"group_manager"===o?mg.minWidth:gg.minWidth,[o]),_=e.useMemo(()=>"group_manager"===o?mg.minHeight:gg.minHeight,[o]),M=Mn[o];return $n.jsxs("div",{className:N,"data-testid":`agent-node-${a}-view`,onDragOver:y,onDragLeave:b,onDrop:v,"data-activity":m&&f?(I=f,I?"thinking"===I?" ⏳ ":"tool"===I?" ⚙️ ":"message"===I?" 💬 ":void 0:""):void 0,children:[(m||g)&&$n.jsxs("div",{className:"agent-badge-wrap",children:[$n.jsx("span",{className:"agent-badge-chip",children:m?"SENDING":"RECEIVING"}),m&&f&&$n.jsx("span",{className:"agent-activity-label",children:$n.jsx(Cm,{activity:f})})]}),$n.jsx(t.NodeResizer,{color:Sn[o],minWidth:E,minHeight:_,handleStyle:{color:Sn[o],borderColor:Sn[o]},handleClassName:o}),!c&&!p&&r&&$n.jsxs("div",{className:`agent-actions ${o}`,"data-testid":`agent-actions-${a}`,children:[$n.jsx(Td,{role:"button",onClick:x,title:"Delete Agent",className:"delete-icon clickable margin-right-20","aria-label":"Delete Agent"}),"group_manager"!==s.agentType&&$n.jsx(Cc,{role:"button",onClick:w,title:"Clone Agent",className:"copy-icon margin-right-20 clickable","aria-label":"Clone Agent"}),$n.jsx(Vp,{role:"button",className:"clickable cog-icon",onClick:C,"aria-label":"Open Settings",title:"Open Settings"})]}),$n.jsxs("div",{className:"agent-main",children:[$n.jsxs("div",{className:"agent-top",children:[$n.jsxs("div",{className:"agent-icon-with-label",children:[$n.jsx("img",{className:"agent-icon-image",src:M,alt:"Agent"}),$n.jsx("div",{className:"agent-icon-label",children:s.label})]}),$n.jsx(Sm,{flowId:l,id:a,data:s,isModalOpen:h,isReadOnly:c,onOpenModal:C})]}),Tm({agentType:o,id:a,handleClassNameBase:T,selected:r,onEdgeConnection:S}),$n.jsx("button",{title:"Open Node Modal",type:"button","data-node-id":a,"data-testid":`open-agent-node-modal-${a}`,className:"hidden",onClick:C}),$n.jsx("button",{title:"Open Edge Modal",type:"button","data-testid":`open-edge-modal-node-${a}`,className:"hidden",onClick:j,"data-edge-node-id":a,"data-edge-id":""}),i&&$n.jsx(wm,{isOpen:u,edgeId:i.id,onClose:A}),$n.jsx(pg,{id:a,data:s,isOpen:d,onClose:k})]})]});var I},model:({id:e,data:t})=>{const{flowId:n,isOpen:a,isDirty:s,logo:r,modelData:o,setLogo:i,onOpen:l,onImport:c,onExport:d,onDataChange:u,onDelete:h,onClone:p,onSave:m,onSaveAndClose:g,onCancel:f,onCheck:y}=Og(e,t),b=hg(n,e,"model",c,d);return $n.jsxs("div",{className:a?"model-node nodrag nowheel":"model-node nodrag",children:[$n.jsxs("div",{className:"model-header",children:[$n.jsx("div",{role:"button",title:"Edit",className:"clickable","data-node-id":e,"data-testid":`open-model-node-modal-${e}`,onClick:l,children:$n.jsx(xd,{})}),$n.jsx("div",{id:`node-label-${e}`,className:"node-label","data-testid":`node-label-${e}`,children:t.label}),$n.jsx("div",{className:`model-logo ${t.apiType}`,children:$n.jsx("img",{src:r,alt:"logo"})})]}),$n.jsxs("div",{className:"model-footer","data-testid":`model-footer-${e}`,children:[$n.jsx("div",{role:"button",title:"Delete",className:"clickable",id:`delete-node-${e}`,"data-testid":`delete-node-${e}`,onClick:h,children:$n.jsx(Nd,{})}),$n.jsxs("div",{className:"flex-align-center",children:[$n.jsx("div",{role:"button",title:"Check",className:"clickable margin-right-10",id:`test-model-${e}`,"data-testid":`test-model-${e}`,onClick:y,children:$n.jsx(fg,{fontSize:"1.1em"})}),$n.jsx("div",{role:"button",title:"Clone",className:"clickable",id:`clone-node-${e}`,"data-testid":`clone-node-${e}`,onClick:p,children:$n.jsx(yd,{})})]})]}),$n.jsx(Hg,{flowId:n,modelId:e,data:o,isOpen:a,isDirty:s,importExportView:b,onLogoChange:i,onDataChange:u,onClose:f,onCancel:f,onSave:m,onTest:y,onSaveAndClose:g})]})},tool:e=>{const{id:t}=e,{flowId:n,isModalOpen:a,isDirty:s,toolData:r,isDark:o,logo:i,onOpen:l,onClone:c,onDelete:d,onCancel:u,onSave:h,onSaveAndClose:p,onChange:m,onExport:g,onImport:f}=Wg(e.id,e.data);return $n.jsxs("div",{className:a?"tool-node nodrag nowheel":"tool-node nodrag",children:[$n.jsxs("div",{className:"tool-header",children:[$n.jsx("div",{role:"button",title:"Edit",className:"clickable","data-node-id":t,"data-testid":`open-tool-node-modal-${t}`,onClick:l,children:$n.jsx(xd,{})}),$n.jsx("div",{"data-testid":`node-label-${t}`,className:"node-label",children:r.label}),$n.jsx("div",{className:`tool-logo ${r.toolType}`,children:i})]}),$n.jsx("div",{className:"tool-content",children:$n.jsx("div",{className:"description","data-test-id":`node-description-${t}`,children:r.description})}),$n.jsxs("div",{className:"tool-footer","data-testid":`tool-footer-${t}`,children:[$n.jsx("div",{role:"button",title:"Delete",className:"clickable",id:`delete-node-${t}`,"data-testid":`delete-node-${t}`,onClick:d,children:$n.jsx(Nd,{})}),$n.jsx("div",{role:"button",title:"Clone",className:"clickable",id:`clone-node-${t}`,"data-testid":`clone-node-${t}`,onClick:c,children:$n.jsx(yd,{})})]}),$n.jsx(Kg,{toolId:t,flowId:n,data:r,isModalOpen:a,darkMode:o,isDirty:s,onClose:u,onCancel:u,onSave:h,onSaveAndClose:p,onDataChange:m,onImport:f,onExport:g})]})}},Qg=e.createContext(void 0),Yg=({children:t,collapsed:n})=>{const a="boolean"==typeof n?n:Jg(),[s,r]=e.useState(a);e.useEffect(()=>{Xg(s)},[s]);return $n.jsx(Qg.Provider,{value:{isCollapsed:s,toggleSidebar:()=>{r(e=>!e)}},children:t})},Xg=e=>{e?(document.body.classList.add("waldiez-sidebar-collapsed"),document.body.classList.remove("waldiez-sidebar-expanded")):(document.body.classList.add("waldiez-sidebar-expanded"),document.body.classList.remove("waldiez-sidebar-collapsed"))},Jg=()=>!!document.body.classList.contains("waldiez-sidebar-collapsed")||!document.body.classList.contains("waldiez-sidebar-expanded")&&window.innerWidth<768;function ef(e){return fc({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z"},child:[]},{tag:"path",attr:{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z"},child:[]},{tag:"path",attr:{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4"},child:[]},{tag:"path",attr:{d:"M17.599 6.5a3 3 0 0 0 .399-1.375"},child:[]},{tag:"path",attr:{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5"},child:[]},{tag:"path",attr:{d:"M3.477 10.896a4 4 0 0 1 .585-.396"},child:[]},{tag:"path",attr:{d:"M19.938 10.5a4 4 0 0 1 .585.396"},child:[]},{tag:"path",attr:{d:"M6 18a4 4 0 0 1-1.967-.516"},child:[]},{tag:"path",attr:{d:"M19.967 17.484A4 4 0 0 1 18 18"},child:[]}]})(e)}const tf=t=>{const{isOpen:n,onClose:a}=t,s=jh(e=>e.getFlowInfo),r=jh(e=>e.updateFlowInfo),o=jh(e=>e.updateFlowOrder),i=jh(e=>e.updateFlowPrerequisites),l=s(),{name:c,description:d,requirements:u,tags:h,isAsync:p,cacheSeed:m}=l,[g,f]=e.useState({name:c,description:d,requirements:u,tags:h,isAsync:p,cacheSeed:m}),[y,b]=e.useState(null),v=jh(e=>e.getFlowEdges),{used:x,remaining:w}=v(),C=jh(e=>e.onFlowChanged),[k,j]=e.useState(x),[A,S]=e.useState(w),N=!dm(g,{name:c,description:d,requirements:u,tags:h,isAsync:p,cacheSeed:m}),T=!dm(k,x),[E,_]=e.useState(N||T),M=e.useCallback(()=>{const{name:e,description:t,requirements:n,tags:a,isAsync:r,cacheSeed:o}=s();f({name:e,description:t,requirements:n,tags:a,isAsync:r,cacheSeed:o});const{used:i,remaining:l}=v();j(i),S(l),_(!1)},[v,s]);e.useEffect(()=>{M()},[n,M]);const I=e=>e.map((t,n)=>{if(0===n)return{...t,data:{...t.data,order:0,prerequisites:[]}};const a=e[n-1];return{...t,data:{...t.data,order:n,prerequisites:[a?.id]}}});return{flowData:g,isOpen:n,sortedEdgesState:k,remainingEdgesState:A,selectedNewEdge:y,isDirty:E,onClose:a,onSubmit:()=>{if(r(g),g.isAsync)i(k);else{const e=k.map((e,t)=>({id:e.id,order:t})).concat(A.map(e=>({id:e.id,order:-1})));o(e)}C(),_(!1)},onCancel:()=>{M(),a()},onDataChange:e=>{const t=!dm({...g,...e},{name:c,description:d,requirements:u,tags:h,isAsync:p,cacheSeed:m}),n=!dm(k,x);f({...g,...e}),_(t||n)},onSelectedNewEdgeChange:e=>{e&&b(e.value)},onAddEdge:()=>{if(y&&A.find(e=>e.id===y.id)){const e=(()=>{let e=k[k.length-1]?.data?.order;return void 0===e?e=k.length:e++,e<0&&(e=0),e})(),t={...y,data:{...y.data,order:e}};j([...k,t]),S(A.filter(e=>e.id!==y.id)),b(null),_(!0)}},onRemoveEdge:e=>{1!==k.length&&k.find(t=>t.id===e.id)&&(j(k.filter(t=>t.id!==e.id)),S([...A,{...e,data:{...e.data,order:-1,prerequisites:[]}}]),_(!0))},onMoveEdgeUp:e=>{if(e>0&&void 0!==k[e]&&void 0!==k[e-1]&&k.find(t=>t.id===k[e]?.id)){const t=k[e-1],n=k[e],a=k.slice();a[e-1]=n,a[e]=t,j(I(a)),_(!0)}},onMoveEdgeDown:e=>{if(k.find(t=>t.id===k[e]?.id)){const t=k[e+1],n=t?.data?.order,a=k[e],s=a?.data?.order,r=k.slice();r[e+1]={...a,data:{...a?.data,order:n}},r[e]={...t,data:{...t?.data,order:s}},j(I(r)),_(!0)}},onPrerequisitesChange:(e,t)=>{const n=k.map(n=>n.id===e.id?{...n,data:{...n.data,prerequisites:t}}:n);j(n),_(!0)}}},nf=e=>{const{sortedEdges:t,remainingEdges:n,selectedNewEdge:a,onSelectedNewEdgeChange:s,onAddEdge:r,onRemoveEdge:o,onPrerequisitesChange:i}=e,l=(e,t)=>{if(t){const n=t.map(e=>e.value.id);i(e,n)}else i(e,[])};return $n.jsxs("div",{className:"flow-chat-prerequisites-wrapper",children:[$n.jsx("div",{className:"info",children:"Specify the chats to run when the flow initializes and their prerequisites (if more than one). You should remove the ones that are expected to be triggered during the flow (like in nested chats)."}),t.map((e,n)=>$n.jsxs("div",{className:"flow-chat-prerequisites",children:[$n.jsx("div",{className:"flow-chat-prerequisite-source",children:$n.jsx("span",{children:e.data?.label})}),t.length>1&&$n.jsxs("div",{className:"flow-chat-prerequisite-actions",children:[$n.jsx("label",{htmlFor:"chat-pre-requisites-select",children:"Prerequisites:"}),$n.jsx(nd,{placeholder:"Select prerequisites...",options:t.filter(t=>t.id!==e.id).map(e=>({value:e,label:e.data?.label})),value:e.data?.prerequisites.map(e=>{const n=t.find(t=>t.id===e);return n?{value:n,label:n.data?.label}:[]}),onChange:l.bind(null,e),isMulti:!0,inputId:"chat-pre-requisites-select"}),t.length>1&&$n.jsx("div",{className:"flow-chat-remove",children:t.length>1&&$n.jsx("button",{type:"button",title:"Remove",className:"flow-order-item-action","data-testid":`remove-edge-button-${n}`,onClick:o.bind(null,e),children:"Remove"})})]})]},e.id)),n.length>0&&$n.jsxs("div",{className:"flow-order-add-wrapper",children:[$n.jsxs("div",{className:"flex-1 margin-right-10",children:[$n.jsx("label",{htmlFor:"new-edge-select",className:"hidden",children:"Add new chat"}),$n.jsx(nd,{options:n.map(e=>({value:e,label:e.data?.label})),value:a?{value:a,label:a.data?.label}:null,onChange:s,inputId:"new-edge-select"})]}),$n.jsx("button",{type:"button",title:"Add chat",className:"flow-order-add-button",disabled:!a,onClick:r,"data-testid":"add-edge-to-flow-button",children:"Add"})]})]})},af=e=>{const{sortedEdges:t,remainingEdges:n,selectedNewEdge:a,onSelectedNewEdgeChange:s,onAddEdge:r,onRemoveEdge:o,onMoveEdgeUp:i,onMoveEdgeDown:l}=e;return $n.jsxs("div",{className:"flow-chat-order-wrapper",children:[$n.jsx("div",{className:"info",children:"Specify the chats to run when the flow initializes and their order (if more than one). You should remove the ones that are expected to be triggered during the flow (like in nested chats)."}),t.map((e,n)=>$n.jsxs("div",{className:"flow-order-item-wrapper",children:[$n.jsx("div",{className:"flow-order-item",children:$n.jsx("span",{className:"flow-order-item-entry",children:e.data?.label})}),t.length>1&&$n.jsxs("div",{className:"flow-order-item-actions",children:[n>0&&t.length>1&&$n.jsx("button",{type:"button",title:"Move up",className:"flow-order-item-action","data-testid":`move-edge-up-button-${n}`,onClick:i.bind(null,n),children:"↑"}),n<t.length-1&&$n.jsx("button",{title:"Move down",type:"button",className:"flow-order-item-action","data-testid":`move-edge-down-button-${n}`,onClick:l.bind(null,n),children:"↓"}),t.length>1&&$n.jsx("button",{type:"button",title:"Remove",className:"flow-order-item-action","data-testid":`remove-edge-button-${n}`,onClick:o.bind(null,e),children:"Remove"})]})]},e.id)),n.length>0&&$n.jsxs("div",{className:"flow-order-add-wrapper",children:[$n.jsxs("div",{className:"flex-1 margin-right-10",children:[$n.jsx("label",{htmlFor:"new-edge-select",className:"hidden",children:"Add new chat"}),$n.jsx(nd,{options:n.map(e=>({value:e,label:e.data?.label})),value:a?{value:a,label:a.data?.label}:null,onChange:s,inputId:"new-edge-select"})]}),$n.jsx("button",{type:"button",title:"Add chat",className:"flow-order-add-button",disabled:!a,onClick:r,"data-testid":"add-edge-to-flow-button",children:"Add"})]})]})},sf=e=>{const{flowId:t,data:n,sortedEdges:a,remainingEdges:s,onDataChange:r}=e,{name:o,description:i,isAsync:l}=n,c=a.length+s.length;return $n.jsxs("div",{className:"flex-column padding-left-10 padding-right-10",id:`rf-${t}-edit-flow-modal`,children:[$n.jsx("label",{htmlFor:`rf-${t}-edit-flow-modal-name`,children:"Name"}),$n.jsx("input",{type:"text",className:"margin-right--20 margin-top-5 margin-bottom-10",id:`rf-${t}-edit-flow-modal-name`,placeholder:"Flow name",value:o,onChange:e=>{const t=e.target.value;r({name:t})},"data-testid":`edit-flow-${t}-name-input`}),$n.jsx("label",{htmlFor:`rf-${t}-edit-flow-modal-description`,children:"Description"}),$n.jsx("div",{className:"margin-bottom-5"}),$n.jsx(Gd,{id:`rf-${t}-edit-flow-modal-description`,placeholder:"Flow description",rows:2,value:i,onChange:e=>{const t=e.target.value;r({description:t})},"data-testid":`edit-flow-${t}-description-input`}),$n.jsx("div",{className:"margin-bottom-5"}),$n.jsx(ed,{id:`edit-flow-${t}-modal-async-mode`,label:"Async Mode",isChecked:l,onCheckedChange:e=>{r({isAsync:e})}}),$n.jsxs("div",{className:"margin-top-5 margin-left-5",children:["Chat order ",l&&"& prerequisites"," "]}),0===c?$n.jsx("div",{className:"info",children:"No chats added to the flow yet."}):l?$n.jsx(nf,{...e}):$n.jsx(af,{...e})]})},rf=e=>{const{flowId:t,data:n,onDataChange:a}=e,{tags:s,requirements:r,cacheSeed:o}=n;return $n.jsxs("div",{className:"padding-left-10 padding-right-10","data-testid":`edit-flow-${t}-modal-other-view`,children:[$n.jsx(ed,{id:`edit-flow-${t}-modal-cache-seed-toggle`,label:"Disable cache",isChecked:"number"!=typeof o,onCheckedChange:e=>{a({cacheSeed:e?null:42})},"data-testid":`edit-flow-${t}-modal-cache-seed-toggle`}),"number"==typeof o&&$n.jsxs("div",{className:"margin-top-5 flex-align-center",children:[$n.jsx("div",{className:"margin-left-5 margin-right-5",children:" Cache seed:"}),$n.jsx("input",{type:"number",step:1,placeholder:"42",value:o,onChange:e=>{try{const t=parseInt(e.target.value);a({cacheSeed:t})}catch(t){}},id:`edit-flow-${t}-cache-seed-input`,"data-testid":`edit-flow-${t}-cache-seed-input`})]}),$n.jsx(ip,{items:r,itemsType:"requirement",viewLabel:"Additional Requirements",viewLabelInfo:()=>$n.jsxs("div",{children:["Requirements to ",$n.jsx("span",{className:"bold italic",children:"pip install"})," before running this flow"]}),onItemAdded:e=>{a({requirements:[...r,e]})},onItemDeleted:e=>{a({requirements:r.filter(t=>t!==e)})},onItemChange:(e,t)=>{a({requirements:r.map(n=>n===e?t:n)})}}),$n.jsx(ip,{items:s,itemsType:"tag",viewLabel:"Tags",onItemAdded:e=>{a({tags:[...s,e]})},onItemDeleted:e=>{a({tags:s.filter(t=>t!==e)})},onItemChange:(e,t)=>{a({tags:s.map(n=>n===e?t:n)})}})]})},of=e=>{const{flowId:t}=e,{flowData:n,isOpen:a,sortedEdgesState:s,remainingEdgesState:r,selectedNewEdge:o,isDirty:i,onClose:l,onSubmit:c,onCancel:d,onDataChange:u,onSelectedNewEdgeChange:h,onAddEdge:p,onRemoveEdge:m,onMoveEdgeUp:g,onMoveEdgeDown:f,onPrerequisitesChange:y}=tf(e),b=()=>{c(),l()};return $n.jsx(ou,{title:"Edit Flow",flowId:t,isOpen:a,onSaveAndClose:b,onClose:l,className:"edit-flow-modal",hasMaximizeBtn:!0,dataTestId:`edit-flow-modal-${t}`,hasUnsavedChanges:i,preventCloseIfUnsavedChanges:!0,children:$n.jsxs("div",{className:"modal-body",children:[$n.jsxs(cp,{activeTabIndex:0,children:[$n.jsx(lp,{label:"Properties",id:`rf-${t}-edit-flow-modal`,children:$n.jsx(sf,{flowId:t,data:n,remainingEdges:r,sortedEdges:s,selectedNewEdge:o,onPrerequisitesChange:y,onSelectedNewEdgeChange:h,onAddEdge:p,onRemoveEdge:m,onMoveEdgeUp:g,onMoveEdgeDown:f,onDataChange:u})}),$n.jsx(lp,{label:"Other",id:`rf-${t}-edit-flow-modal-extras`,children:$n.jsx(rf,{flowId:t,data:n,onDataChange:u})})]}),$n.jsxs("div",{className:"modal-actions",children:[$n.jsx("button",{className:"modal-action-cancel",onClick:d,"data-testid":"edit-flow-cancel-button",type:"button",title:"Cancel",children:"Cancel"}),$n.jsxs("div",{className:"flex-row",children:[$n.jsx("button",{title:"Save & Close",type:"button",className:"primary save margin-right-10",onClick:b,"data-testid":`modal-submit-and-close-btn-${t}`,disabled:!i,children:"Save & Close"}),$n.jsx("button",{type:"button",title:"Save",className:"modal-action-submit",onClick:c,"data-testid":"edit-flow-submit-button",disabled:!i,children:"Save"})]})]})]})})},lf=t=>{const{isReadonly:n}=t,{flowId:a,isEditModalOpen:s,isAgentsViewCollapsed:r,onOpenEditModal:o,onCloseEditModal:i,onShowAgents:l,onShowModels:c,onShowTools:d,onUserDragStart:u,onAssistantDragStart:h,onDocDragStart:p,onReasoningDragStart:m,onCaptainDragStart:g,onManagerDragStart:f}=(t=>{const{selectedNodeType:n,onSelectNodeType:a}=t,[s,r]=e.useState(!1),[o,i]=e.useState(!1),l=jh(e=>e.flowId),c=e.useCallback((e,t,n)=>{e.dataTransfer.setData("application/node",t),"agent"===t&&n&&e.dataTransfer.setData("application/agent",n),e.dataTransfer.effectAllowed="move"},[]),d=e.useCallback(()=>{"agent"!==n?(a("agent"),i(!1)):i(e=>!e)},[n,a]),u=e.useCallback(()=>{a("model")},[a]),h=e.useCallback(()=>{a("tool")},[a]),p=e.useCallback(e=>{c(e,"agent","user_proxy")},[c]),m=e.useCallback(e=>{c(e,"agent","assistant")},[c]),g=e.useCallback(e=>{c(e,"agent","rag_user_proxy")},[c]),f=e.useCallback(e=>{c(e,"agent","doc_agent")},[c]),y=e.useCallback(e=>{c(e,"agent","reasoning")},[c]),b=e.useCallback(e=>{c(e,"agent","captain")},[c]),v=e.useCallback(e=>{c(e,"agent","group_manager")},[c]),x=e.useCallback(()=>{r(!0)},[]),w=e.useCallback(()=>{r(!1)},[]),C=e.useMemo(()=>({user_proxy:p,assistant:m,reasoning:y,captain:b,group_manager:v,rag_user_proxy:g}),[p,m,y,b,v,g]);return{flowId:l,isEditModalOpen:s,isAgentsViewCollapsed:o,onOpenEditModal:x,onCloseEditModal:w,onShowAgents:d,onShowModels:u,onShowTools:h,onUserDragStart:p,onDocDragStart:f,onAssistantDragStart:m,onReasoningDragStart:y,onCaptainDragStart:b,onManagerDragStart:v,agentDragHandlers:C}})(t),{isCollapsed:y,toggleSidebar:b}=(()=>{const t=e.useContext(Qg);if(!t)throw new Error("useSidebar must be used within a SidebarProvider context");return t})();return $n.jsxs("div",{className:"sidebar"+(n?" hidden":""),"data-testid":`sidebar-${a}`,style:{width:y?"40px":"200px"},children:[$n.jsxs("div",{className:"sidebar-header",style:{justifyContent:y?"center":"space-between"},children:[!y&&$n.jsx("div",{className:"title",children:"Waldiez"}),$n.jsx("div",{className:"sidebar-toggle",onClick:b,role:"button","aria-hidden":"true","data-testid":"sidebar-toggle",children:$n.jsx(cd,{className:"sidebar-toggle-button tooltip-container clickable",title:y?"Open sidebar":"Close sidebar","aria-hidden":"true"})})]}),$n.jsxs("div",{className:"sidebar-content",children:[$n.jsxs("ul",{children:[$n.jsx("li",{className:"clickable",id:`edit-flow-${a}-sidebar-button`,"data-testid":`edit-flow-${a}-sidebar-button`,onClick:o,title:"Edit flow",children:y?$n.jsx(kc,{}):$n.jsxs("div",{className:"flex-align-center",children:[$n.jsx(kc,{}),$n.jsx("div",{children:"Edit flow"})]})}),$n.jsx("li",{className:"clickable","data-node-type":"model","data-testid":"show-models",onClick:c,children:y?$n.jsx(ef,{}):$n.jsxs("div",{className:"flex-align-center",children:[$n.jsx(ef,{}),$n.jsx("div",{children:"Models"})]})}),$n.jsx("li",{className:"clickable","data-node-type":"tool","data-testid":"show-tools",onClick:d,children:y?$n.jsx(zc,{}):$n.jsxs("div",{className:"flex-align-center",children:[$n.jsx(zc,{}),$n.jsx("div",{children:"Tools"})]})}),$n.jsxs("li",{className:"clickable expandable","data-node-type":"agent","data-testid":"show-agents",onClick:l,children:[$n.jsxs("div",{className:"flex-align-center",children:[$n.jsx(jd,{}),!y&&$n.jsx("span",{children:"Agents"})]}),!y&&$n.jsx("div",{className:"expand-icon",children:r?$n.jsx(Qp,{}):$n.jsx(Yp,{})})]})]}),!y&&!r&&$n.jsxs($n.Fragment,{children:[$n.jsx("div",{className:"dnd-description",children:$n.jsx("p",{children:"Drag n' drop an agent to the canvas to add it to the flow"})}),$n.jsxs("div",{className:"dnd-area","data-testid":"user-dnd",onDragStart:u,draggable:!0,children:[$n.jsx("img",{src:Mn.user_proxy,alt:"User proxy icon",title:"User Proxy Agent"}),"User"]}),$n.jsxs("div",{className:"dnd-area","data-testid":"assistant-dnd",onDragStart:h,draggable:!0,children:[$n.jsx("img",{alt:"Assistant agent icon",src:Mn.assistant,title:"Assistant Agent"}),"Assistant"]}),$n.jsxs("div",{className:"dnd-area","data-testid":"doc-dnd",onDragStart:p,draggable:!0,children:[$n.jsx("img",{alt:"Doc agent icon",src:Mn.doc_agent,title:"Document Agent"}),"Docs Agent"]}),$n.jsxs("div",{className:"dnd-area","data-testid":"reasoning-dnd",onDragStart:m,draggable:!0,children:[$n.jsx("img",{alt:"Reasoning agent icon",src:Mn.reasoning,title:"Reasoning Agent"}),"Reasoning"]}),$n.jsxs("div",{className:"dnd-area","data-testid":"captain-dnd",onDragStart:g,draggable:!0,children:[$n.jsx("img",{alt:"Captain agent icon",src:Mn.captain,title:"Captain Agent"}),"Captain"]}),$n.jsxs("div",{className:"dnd-area","data-testid":"group-manager-dnd",onDragStart:f,draggable:!0,children:[$n.jsx("img",{alt:"Group manager icon",src:Mn.group_manager,title:"Group Manager Agent"}),"Group Manager"]})]})]}),$n.jsx("div",{className:"spacer"}),s&&$n.jsx(of,{flowId:a,isOpen:s,onClose:i})]})},cf=e.memo(n=>{const{flowId:a,skipExport:s,skipImport:r,skipHub:o,chat:i,stepByStep:l}=n,c=e.useRef(null),d=e.useRef("agent"),[u,h]=e.useState(!1),[p,m]=e.useState(!1),[g,f]=e.useState(!1),y=jh(e=>e.nodes),b=jh(e=>e.edges),v=jh(e=>e.isReadOnly),x=jh(e=>e.viewport),w=jh(e=>e.addModel),C=jh(e=>e.addTool),k=jh(e=>e.onViewportChange),j=jh(e=>e.onFlowChanged),A=jh(e=>e.showNodes),S=jh(e=>e.onReconnect),N=jh(e=>e.onSave),{isDark:T}=Qn(),E=e.useMemo(()=>T?"dark":"light",[T]),_=!0===v,{onKeyDown:M}=Sp(a,N),{convertToPy:I,convertToIpynb:D,exportFlow:R,onExport:z,onRun:O,onStepRun:L,onFlowInit:P,onNodesChange:B,onEdgesChange:F,onNodeDoubleClick:U,onEdgeDoubleClick:H}=(t=>{const n=jh(e=>e.isReadOnly),a=jh(e=>e.skipImport),s=jh(e=>e.skipExport),r=!0===n,o=jh(e=>e.onRun),i=jh(e=>e.onStepRun),l=jh(e=>e.onConvert),c=jh(e=>e.setRfInstance),d=jh(e=>e.onNodesChange),u=jh(e=>e.onEdgesChange),h=jh(e=>e.onEdgeDoubleClick),p=jh(e=>e.onNodeDoubleClick),m=jh(e=>e.onFlowChanged),g=jh(e=>e.getAgents),f=jh(e=>e.getFlowEdges),y=jh(e=>e.getFlowInfo),b=jh(e=>e.exportFlow),v=e.useCallback(e=>{const n=ne(t),o=r||!0===a&&!0===s,i=e.getNodes().length>0||e.getEdges().length>0;if(n){if(o){const e=n.querySelector(".react-flow__controls-interactive");e&&e.click()}i?requestAnimationFrame(()=>{requestAnimationFrame(()=>{e.fitView({includeHiddenNodes:!1,padding:.2,duration:100}).then(()=>{c(e)})})}):(e.setViewport({x:0,y:0,zoom:1}).then(()=>{}),c(e))}else c(e)},[t,r,a,s,c]),x=e.useCallback(e=>{r||d(e)},[r,d]),w=e.useCallback(e=>{r||(u(e),m())},[r,u,m]),C=e.useCallback((e,t)=>{r||h(e,t)},[r,h]),k=e.useCallback((e,t)=>{if(r)return;const n=e.target;n instanceof Element&&"TEXTAREA"===n.tagName||p(e,t)},[r,p]),j=e.useCallback(()=>{if(r)return!1;const e=g(),n=e.length;if(n<2)return Mr({flowId:t,message:(0===n?"No agents":"Only one agent")+" found in the flow",level:"error",details:void 0,duration:3e3}),!1;if(e.find(e=>"group_manager"===e.data.agentType))return!0;const{used:a,remaining:s}=f();return a.length>0&&0===s.length},[r,g,f,t]),A=e.useCallback(()=>{if(!r&&l){const e=m();l(JSON.stringify(e),"py")}},[r,m,l]),S=e.useCallback(()=>{if(!r&&l){const e=m();l(JSON.stringify(e),"ipynb")}},[r,m,l]),N=e.useCallback(()=>{if(!r&&"function"==typeof o)if(j()){const e=m();e&&o(JSON.stringify(e))}else{const e=`edit-flow-${t}-sidebar-button`,n=document.getElementById(e);n&&n.click()}},[r,o,j,m,t]),T=e.useCallback(()=>{if(r||"function"!=typeof i)return;const e=m();e&&i(JSON.stringify(e))},[r,i,m]),E=e.useCallback(async e=>{if(r)return;const{name:n}=y();await J(n,"flow",()=>b(!0,!1),()=>{Mr({flowId:t,message:"Could not export the flow",level:"error",details:void 0,duration:3e3})})},[r,y,b,t]);return e.useMemo(()=>({convertToPy:A,convertToIpynb:S,exportFlow:b,onExport:E,onRun:N,onStepRun:T,onFlowInit:v,onNodesChange:x,onEdgesChange:w,onNodeDoubleClick:k,onEdgeDoubleClick:C}),[A,S,b,E,N,T,v,x,w,k,C])})(a);e.useEffect(()=>{A("agent")},[A]);const W=e.useCallback(e=>{d.current=e,h(e=>!e)},[]),q=e.useCallback(()=>{m(!0)},[]),V=e.useCallback(()=>{m(!1)},[]),G=e.useCallback(()=>{f(!1)},[]),K=e.useCallback(e=>{d.current!==e&&W(e),A(e)},[W,A]),$=e.useCallback(()=>{"model"===d.current?(w(),j()):"tool"===d.current&&(C(),j())},[w,C,j]),Z=e.useCallback(()=>{requestAnimationFrame(()=>{"agent"!==d.current&&(W("agent"),A("agent")),j()})},[W,A,j]),Q=e.useCallback(e=>{k(e,d.current)},[k]),Y=e.useCallback(async e=>{o?await z(e):f(!0)},[o,z]),X=e.useCallback(()=>{const e=R(!0,!1);return JSON.stringify(e)},[R]),{onDragOver:ee,onDrop:te,onNodeDrag:ae,onNodeDragStop:se}=(n=>{const{screenToFlowPosition:a,getIntersectingNodes:s}=t.useReactFlow(),r=jh(e=>e.addAgent),o=jh(e=>e.setAgentGroup),i=jh(e=>e.addGroupMember),l=jh(e=>e.getRfInstance),c=jh(e=>e.highlightNode),d=jh(e=>e.clearNodeHighlight),u=e.useCallback(e=>{if("agent"!==e.dataTransfer.getData("application/node"))return;const t=e.dataTransfer.getData("application/agent");return We.includes(t)?t:void 0},[]),h=e.useCallback(e=>{e.preventDefault(),e.dataTransfer.dropEffect="move",document.body.classList.add("dragging")},[]),p=e.useCallback(e=>e.find(e=>"agent"===e.type&&"group_manager"===e.data.agentType),[]),m=e.useCallback(e=>{const{x:t,y:n}=e,a={x:t,y:n,width:100,height:100};try{const e=s(a);if(e.length>0)return p(e)}catch(r){}},[s,p]),g=e.useCallback(e=>{const t=l();if(!t)return;const n=t.getInternalNode(e.id);return n?.internals.positionAbsolute?{x:n.internals.positionAbsolute.x,y:n.internals.positionAbsolute.y}:void 0},[l]),f=e.useCallback((e,t)=>{let n=a({x:e.clientX,y:e.clientY},{snapToGrid:!1});const s=t||m(n);if(s){const t=g(s);if(t){const s=a({x:e.clientX,y:e.clientY});n={x:s.x-t.x-50,y:s.y-t.y-50}}}return{position:n,parent:s}},[a,m,g]),y=e.useCallback((e,t)=>{const{position:n,parent:a}=f(e),s=r(t,n,a?.id);return a&&(s.parentId=a.id,s.data.parentId=a.id,window.requestAnimationFrame(()=>{o(s.id,a.id)})),s},[f,r,o]),b=e.useCallback(e=>{document.body.classList.remove("dragging");const t=u(e);t&&(e.preventDefault(),y(e,t),n())},[u,y,n]),v=e.useCallback((e,t)=>{try{const e=s(t).filter(e=>"agent"===e.type&&"group_manager"===e.data.agentType);if(1===e.length)return e[0]}catch(n){}},[s]),x=e.useCallback((e,t)=>{if(t.parentId||"group_manager"===t.data.agentType)d();else{const n=v(e,t);n?c(n.id):d()}},[v,c,d]),w=e.useCallback((e,t)=>{if(!t.parentId&&"group_manager"!==t.data.agentType){const n=v(e,t);if(n){const{position:a}=f(e,n);i(n.id,t.id,a)}}d()},[v,f,i,d]);return e.useMemo(()=>({onDragOver:h,onDrop:b,onNodeDrag:x,onNodeDragStop:w}),[h,b,x,w])})(Z),re=e.useMemo(()=>y,[y]),oe=e.useMemo(()=>b,[b]);return $n.jsxs("div",{className:`flow-wrapper ${E}`,id:`rf-root-${a}`,"data-flow-id":a,"data-testid":`rf-root-${a}`,children:[$n.jsxs("div",{className:"flow-main",children:[$n.jsx(lf,{onSelectNodeType:K,selectedNodeType:d.current,isReadonly:_}),$n.jsx("div",{className:"react-flow-wrapper","data-testid":`rf-wrapper-${a}`,ref:c,children:$n.jsxs(t.ReactFlow,{id:a,nodeTypes:Zg,edgeTypes:$g,onInit:P,nodes:re,edges:oe,onNodesChange:B,onEdgesChange:F,deleteKeyCode:[],onKeyDown:M,onNodeDoubleClick:U,onEdgeDoubleClick:H,onReconnect:S,colorMode:E,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!0,snapToGrid:!0,defaultViewport:x,onDrop:te,onDragOver:ee,onViewportChange:Q,connectOnClick:!0,zoomOnDoubleClick:!1,noWheelClassName:"no-wheel",width:c.current?.clientWidth,height:c.current?.clientHeight,onNodeDrag:ae,onNodeDragStop:se,children:[$n.jsx(t.Controls,{showInteractive:!0}),$n.jsx(Gp,{flowId:a,skipExport:s,skipImport:r,skipHub:o,selectedNodeType:d.current,onAddNode:$,onRun:O,onStepRun:L,onConvertToPy:I,onConvertToIpynb:D,onOpenImportModal:q,onExport:Y}),$n.jsx("div",{className:"hidden","data-testid":`drop-area-${a}`}),$n.jsx(t.Background,{variant:t.BackgroundVariant.Dots})]})})]}),$n.jsx(op,{flowId:a,stepByStep:l}),$n.jsx(Mp,{flowId:a,chat:i,isDarkMode:T}),p&&$n.jsx(Hp,{flowId:a,isOpen:p,onClose:V,typeShown:d.current,onTypeShownChange:K}),g&&$n.jsx(Dp,{flowId:a,isOpen:g,onClose:G,onDownload:z,onExport:X})]})});cf.displayName="WaldiezFlowView";const df=a=>{const s=a.flowId??`wf-${ee()}`,r="boolean"==typeof a.skipImport&&a.skipImport,o="boolean"==typeof a.skipExport&&a.skipExport,i="boolean"==typeof a.skipHub&&a.skipHub,l=a.nodes??[],c=a.edges??[],d=a.readOnly??!1,{monacoVsPath:u,chat:h,stepByStep:p}=a;return e.useEffect(()=>{hf(),pf(),window.localStorage.removeItem(`snackbar-${s}.lock`)},[s]),e.useEffect(()=>{u&&n.loader.config({paths:{vs:u}})},[u]),$n.jsx(Rr,{children:$n.jsx(ta,{children:$n.jsx(or,{fallbackRender:uf,children:$n.jsx(kr,{initiallyActiveScopes:[s],children:$n.jsx(t.ReactFlowProvider,{children:$n.jsx(Yg,{children:$n.jsx(rp,{...a,flowId:s,nodes:l,edges:c,isReadOnly:d,skipImport:r,skipExport:o,children:$n.jsx(cf,{flowId:s,skipImport:r,skipExport:o,skipHub:i,chat:h,stepByStep:p})})})})})})})})},uf=e=>{const{error:t}=e;return $n.jsx(Er,{error:t})},hf=()=>{const e=Yn();Xn(e)},pf=()=>{if(!document.body.classList.contains("waldiez-sidebar-collapsed")&&!document.body.classList.contains("waldiez-sidebar-expanded")){if(window.matchMedia("(prefers-sidebar: collapsed)").matches)document.body.classList.add("waldiez-sidebar-collapsed");else{window.matchMedia("(max-width: 768px)").matches?document.body.classList.add("waldiez-sidebar-collapsed"):document.body.classList.add("waldiez-sidebar-expanded")}}};exports.WORKFLOW_CHAT_END_MARKERS=m,exports.WORKFLOW_STEP_END_MARKERS=se,exports.WORKFLOW_STEP_MARKERS=re,exports.WORKFLOW_STEP_START_MARKERS=ae,exports.Waldiez=df,exports.WaldiezBreakpointUtils=class{static fromString(e){if("all"===e)return{type:"all"};if(e.startsWith("event:")){return{type:"event",event_type:e.slice(6)}}if(e.startsWith("agent:")){return{type:"agent",agent_name:e.slice(6)}}if(e.includes(":")&&!e.startsWith("event:")&&!e.startsWith("agent:")){const[t,n]=e.split(":",2);return{type:"agent_event",agent_name:t,event_type:n}}return{type:"event",event_type:e}}static toString(e){switch(e.type){case"event":return`event:${e.event_type}`;case"agent":return`agent:${e.agent_name}`;case"agent_event":return`${e.agent_name}:${e.event_type}`;default:return"all"}}static matches(e,t){switch(e.type){case"all":return!0;case"event":return t.type===e.event_type;case"agent":return t.sender===e.agent_name||t.recipient===e.agent_name;case"agent_event":return t.type===e.event_type&&(t.sender===e.agent_name||t.recipient===e.agent_name);default:return!1}}static normalize(e){return"string"==typeof e?this.fromString(e):e}static getDisplayName(e){switch(e.type){case"event":return`Event: ${e.event_type}`;case"agent":return`Agent: ${e.agent_name}`;case"agent_event":return`${e.agent_name} → ${e.event_type}`;case"all":return"All Events";default:return"Unknown"}}},exports.WaldiezChatMessageProcessor=F,exports.WaldiezStepByStepProcessor=me,exports.WaldiezStepByStepUtils=be,exports.default=df,exports.exportFlow=(e,t=!0,n=!0)=>{const a=Ys.importFlow(e);return Ys.exportFlow(Ys.toReactFlow(a),t,n)},exports.importFlow=e=>{const t=Ys.importFlow(e);return Ys.toReactFlow(t)},exports.showSnackbar=Mr;
